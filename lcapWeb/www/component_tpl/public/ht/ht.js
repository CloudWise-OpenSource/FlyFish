!function(_,t,D){"use strict";function n(B,I){if("function"!=typeof I&&null!==I)throw new TypeError("Super expression must either be null or a function");B.prototype=t.create(I&&I.prototype,{constructor:{value:B,writable:!0,configurable:!0}}),I&&Vr(B,I)}function y(v){var b=t.prototype.toString.call(v);return"Array]"===b.substring(b.length-6)}function N(R,X,q,i,D,Z){X=X||[],q=q||[],i=i||[];try{X.push(R);var w=Function.apply(0,X);return q[q.length]="return "+w,Function.apply(0,q).apply(0,i)}catch(W){return Z&&Z(W),D}}function Q(n){var a={};return{get:function(u){if(a[u]!==D)return a[u];var S;switch(u){case"WEBGL_depth_texture":S=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":S=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":S=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":S=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":S=n.getExtension("WEBGL_compressed_texture_etc1");break;default:S=n.getExtension(u)}return a[u]=S,S}}}function p(I,F,U){function z(){if(R!==D)return R;var u=F.get("EXT_texture_filter_anisotropic");return R=null!==u?I.getParameter(u.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function C(J){if("highp"===J){if(I.getShaderPrecisionFormat(I.VERTEX_SHADER,I.HIGH_FLOAT).precision>0&&I.getShaderPrecisionFormat(I.FRAGMENT_SHADER,I.HIGH_FLOAT).precision>0)return"highp";J="mediump"}return"mediump"===J&&I.getShaderPrecisionFormat(I.VERTEX_SHADER,I.MEDIUM_FLOAT).precision>0&&I.getShaderPrecisionFormat(I.FRAGMENT_SHADER,I.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var R;U=U||{};var t="undefined"!=typeof WebGL2RenderingContext&&I instanceof WebGL2RenderingContext,s=U.precision!==D?U.precision:"highp",Z=C(s);Z!==s&&(console.warn("WebGL:",s,"not supported, using",Z,"instead."),s=Z);var K=U.logarithmicDepthBuffer===!0,w=I.getParameter(I.MAX_TEXTURE_IMAGE_UNITS),n=I.getParameter(I.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=I.getParameter(I.MAX_TEXTURE_SIZE),f=I.getParameter(I.MAX_CUBE_MAP_TEXTURE_SIZE),j=I.getParameter(I.MAX_VERTEX_ATTRIBS),H=I.getParameter(I.MAX_VERTEX_UNIFORM_VECTORS),T=I.getParameter(I.MAX_VARYING_VECTORS),v=I.getParameter(I.MAX_FRAGMENT_UNIFORM_VECTORS),b=n>0,m=t||!!F.get("OES_texture_float"),o=(t||!!F.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,q=b&&m,a=t?I.getParameter(I.MAX_SAMPLES):0;return{getMaxAnisotropy:z,getMaxPrecision:C,precision:s,logarithmicDepthBuffer:K,maxTextures:w,maxVertexTextures:n,maxTextureSize:x,maxCubemapSize:f,maxAttributes:j,maxVertexUniforms:H,maxVaryings:T,maxFragmentUniforms:v,vertexTextures:b,floatFragmentTextures:m,elementTypeUint:o,floatVertexTextures:q,maxSamples:a}}function v(j,U){return j.z!==U.z?U.z-j.z:j.id-U.id}var X="ht";if(!_[X]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),_.performance&&_.performance.now||function(){var D=Date.now();_.performance||(_.performance={}),_.performance.now=function(){return Date.now()-D}}();for(var d=Date.now(),q=16,U=["ms","moz","webkit","o"],m=0;m<U.length&&!_.requestAnimationFrame;++m)_.requestAnimationFrame=_[U[m]+"RequestAnimationFrame"],_.cancelAnimationFrame=_[U[m]+"CancelAnimationFrame"]||_[U[m]+"CancelRequestAnimationFrame"];_.requestAnimationFrame||(_.requestAnimationFrame=function(r){var X=Date.now(),s=q+d-X;return 0>s&&(s=0),d=X,_.setTimeout(function(){d=Date.now(),r(performance.now())},s)}),_.cancelAnimationFrame||(_.cancelAnimationFrame=function(L){return _.clearTimeout(L)}),t.assign===D&&(t.assign=function(O){if(O===D||null===O)throw new TypeError("Cannot convert undefined or null to object");for(var p=t(O),s=1;s<arguments.length;s++){var V=arguments[s];if(V!==D&&null!==V)for(var b in V)t.prototype.hasOwnProperty.call(V,b)&&(p[b]=V[b])}return p}),_.btoa===D&&(_.btoa=function(n){for(var w,i,r=String(n),a=0,Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",x="";r.charAt(0|a)||(Z="=",a%1);x+=Z.charAt(63&w>>8-8*(a%1))){if(i=r.charCodeAt(a+=.75),i>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");w=w<<8|i}return x})}();var x,w,o,c,d=_.location,s=d&&_.document,G=null,V=D,q=_[X]={},u=_[X+"config"],m=q.Default=u&&u.Default||{},e=q.Style=u&&u.Style||{},h=q.Attr=u&&u.Attr||{},r=function(){return!0},W=function(){return!1},B=function(D){return D},z=function(V){return!V},l=q.Color=u&&u.Color||{},F=q.IsGetter=u&&u.IsGetter||{};!function(){var z=!1;try{var X=t.defineProperty({},"passive",{get:function(){return z=!0,D}});d&&(o=x=d)&&_.addEventListener("test",X,X),d&&(c=w=d)&&_.removeEventListener("test",X,X)}catch(G){z=!1}m.passiveSupported=z}();var R,f,H,O,K=m.passiveSupported,T=m.eventListenerOptionsFalse=K?{passive:!1,capture:!1}:!1,g=m.eventListenerOptionsTrue=K?{passive:!1,capture:!0}:!0,$=function(z,a,M,Q){z.addEventListener(a,M,Q?g:T)},J=function(R,w,E,U){R.removeEventListener(w,E,U?g:T)},b=Math,A=b.round,i=b.floor,U=b.ceil,j=b.sqrt,L=b.max,S=b.min,E=b.abs,Z=b.cos,M=b.acos,P=b.sin,a=b.pow,C=b.asin,I=b.exp,Y=b.PI,k=2*Y,Rm=Y/2,yh=b.tan,pd=b.atan2,ps=b.random,Wr=b.log,Nh=a(2,1),Oq=!1,Iq=_.parseInt||global.parseInt,tc="2021-9-15",Zd=d&&(_.navigator?_.navigator.platform.indexOf("Win")>-1:!1),xi=function(J){return J*J},Qi=d&&_.setTimeout,ii=d&&_.clearTimeout,Co=d&&(_.navigator?_.navigator.userAgent.toLowerCase():""),Vb=function(G){return G.test(Co)},Xc=Vb(/msie/),jr=Vb(/msie/)||Vb(/trident/),qi=Vb(/msie 10/),gm=Vb(/edge/),ro=Vb(/firefox/),Uh=Vb(/mac/),cj=Vb(/mscAndroid/),yr=m.isTouchable===D?Zd?!1:s?"ontouchend"in s:!1:m.isTouchable,Qg="default",sl="single",xk="multiple",rs="front",hb="back",xb="left",ui="right",am="top",ye="bottom",Wl="center",vs="eye",Uf="middle",nm="east",kk="west",Wg="north",Yf="none",Fn="px",Zf="absolute",Lj="border",zg="triangle",Aq="rect",Wh="circle",Jq="cylinder",sj="shape",gg="items",wf="normal",ai="remove",$k="clear",_i="width",Uc="height",Bo="ingroup",mg="check",sd="uncheck",Qd="radio",wo="radioOn",Jk="radioOff",gj="points",qf="values",ks="series",Sr="body",Me="label",Am="label2",uk="note",Te="note2",Yc="icons",Vh="labelFont",Hl="labelColor",ue="labelSelectColor",oe="note.expanded",Vk="note2.expanded",_j="edge.expanded",Ig="edge.points",cd="edge.type",fb="rotation",Bc="hidden",lb="visible",Wk="tuv",rf="no",Zn="draw",dk="select",hs="currentSubGraph",Oe="selectBackground",qg="autoMakeVisible",ef="autoHideScrollBar",Cb="scrollBarColor",To="scrollBarSize",$r="indent",Ke="rowHeight",Kh="columnLineColor",ug="rowLineColor",Qb="columnLineVisible",Cj="rowLineVisible",Bd="visibleFunc",Sm="expandIcon",Ge="collapseIcon",Wd="checkMode",Hf="sortFunc",rc="editable",ak="batchEditable",hl="tristate",nb="asc",Jh="desc",Bm="position",Ok="__",en="elevation",Uj="children",zo="translateX",Zp="translateY",Bp="dataModel",Zc="maxSize",yd="enc",Cl="state",he=yd+"o"+"de",ig="shape3d",Po="shape3d.resolution",We="shape3d.visible",Ff="shape3d.from.visible",as="shape3d.to.visible",ah="shape3d.top.visible",tl="shape3d.bottom.visible",Eq="repeat.uv.length",Jf="serializeValue",vp="deserializeValue",Im="centerUniform",sb="uniform",Dd="rgba(255,255,255,0)",be="style",hf="attr",ee="field",Sh="string",zs="boolean",Ld="color",Pn="int",In="number",qe="ew-resize",Eh="ns-resize",Cd="pointer",yc="auto",jd="mousedown",Gr="mousemove",Fb="mouseup",Nr="mouseout",Zh="touchstart",Cg="touchmove",Er="touchend",Tg="keydown",eb="keyup",Xj=["DOMMouseScroll","mousewheel"],$q=ro?Xj[0]:Xj[1],Up=Ok+X+Ok+he,wm=[Zh,Cg,Er],jo=[jd,Gr,Fb,Nr,$q,"wheel","mouseenter","mouseleave","mouseover"],dd=[Tg,eb,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Xr=yr?wm.concat(dd):jo.concat(dd),Qq=G,$e=G,Mb=G,dh=G,Ko=!1,nq=Fb.length,mc=function(){Mb&&(ii(Mb.timeout),Mb=G)},dl=function(){Mb&&On(Mb.e,Mb.info)};_.addEventListener&&(V=d)&&(yr||($(_,Nr,function(){mc()}),$(_,$q,function(){rn()})),$(_,eb,function(b){91===b.keyCode?zh={}:delete zh[b.keyCode]},!0),$(_,Tg,function(Z){zh[Z.keyCode]=!0},!0),$(_,"blur",function(){zh={}}));var Km,Xl,Wm,Lh=0,Bi=G,gc=function(x,U){var q=Qi(function(){delete Bi[q],_k(Bi)&&(Bi=G),x()},U);return q},so=G,Hc=G,ok={},Sn={},an={},$p={},Fg={},zh={},ck={},fn={},bm={},pm={},Sb=/.json$/,Wf=/\.(json|bin)$/,De=/^data:image\/svg\+xml/,oq={},ur=[],_d={},uc=G,ws=G,Hb=function(){},Ck=function(){throw"Oops!"},kc=[0,0,0],rg={x:0,y:0,width:0,height:0},Fr=G,Mo=G,Yq=G,pk=function(R,P){Sn[R]=P,P&&P.comps&&!P.uuid&&(P.uuid=q.Math.generateUUID()),Id[R]&&(P.cacheRule=Id[R],delete Id[R])},Xp=function(_){Mo&&!_._72O&&(Yq||(Yq={}),Yq[_._72O=Fe()]=_),Km!=G?Ih()<.05&&O&&!Xl&&(jf=mc):jf=Xd},Sd=function(c,A,u,T){Mo||(Mo={});var i=Mo[c];if(i){if(i.url===A)return;i.image?(i.image.onload=Hb,i.image.onerror=Hb):i.request&&(i.request.onload=Hb,i.request.onerror=Hb)}if(Sb.test(A)){var V=new Ei;if(Mo[c]={request:V,url:A},A=m.beforeLoadURL(A,c),A.data){var Z=m.parse(A.data);En(c,Z),m.handleImageLoaded(c,Z)}else{V.onload=function(){if(200===this.status||0===this.status){var x=m.parse(V.getResponseText());En(c,x),m.handleImageLoaded(c,x)}else En(c,m.handleUnfoundImage(c,A)||G)},V.onerror=function(){En(c,m.handleUnfoundImage(c,A)||G)};var L={};L.url=encodeURI(A),L.sync=!1,V.send(L)}}else{var Z=new Image;Mo[c]={image:Z,url:A},/^data:image/.test(A)||(A=m.beforeLoadURL(A,c),A=m.appendTimeStamp(A),A=encodeURI(A),Z.crossOrigin=m.crossOrigin),m.convertImageSrc(A,function(C){jr&&(A.toLowerCase().indexOf(".svg")>0||De.test(A))?(s.body.appendChild(Z),Z.style.visibility="hidden",Z.onload=function(){Qi(function(){if(u&&(Z.width=u),T&&(Z.height=T),!Z.width||!Z.height){var B=Z.width||Z.clientWidth,d=Z.height||Z.clientHeight;Z.width=B,Z.height=d}m.handleImageLoaded(c,Z),En(c,Z),s.body.removeChild(Z),Z.style.visibility=""},180)},Z.onerror=function(){En(c,m.handleUnfoundImage(c,A)||G),s.body.removeChild(Z),Z.style.visibility=""}):(Z.onload=function(){u&&(Z.width=u),T&&(Z.height=T),m.handleImageLoaded(c,Z),En(c,Z)},Z.onerror=function(){En(c,m.handleUnfoundImage(c,A)||G)}),Z.src=C})}},En=function(K,d){if(pk(K,d),delete Mo[K],_k(Mo)&&(Mo=G,Yq)){for(var E in Yq){var U=Yq[E];U._2O&&U._2O[K]&&(U.deleteTexture(K),delete U._2O[K]),U.invalidateAll&&U.invalidateAll(D,"imageLoaded",K),U.redraw&&U.redraw(),U.iv(),d&&d.layoutAttach&&Yo(U.dm)&&U.dm().updateLayoutAttach(K),delete U._72O}Yq=G}if(d&&Yq)for(var E in Yq){var U=Yq[E];U.invalidateAll&&U.invalidateAll(D,"imageLoading",K),U.redraw&&U.redraw(),U.iv(),d.layoutAttach&&Yo(U.dm)&&U.dm().updateLayoutAttach(K)}},Oi=function(){return Wr=b&&Date,function(){return _.performance&&_.performance.now?_.performance.now():Date.now()}}(),Vl=function(S,e,n){return{width:S,height:e,comps:bf(n)?n:[n]}},jh=function(P,X){return{type:Wh,rect:[P,X,1.6,1.6],borderWidth:1,borderColor:Vp,gradient:vm,gradientColor:dn,background:Vp}},kn=function(Y,k){return Vl(16,16,{type:zg,rect:[4,4,10,8],background:Y,rotation:k?1.57:3.14})},kp=function(A,d){return Vl(16,16,{type:zg,rect:[4,4,8,7],background:A,rotation:d?3.14:0})},wh=function(u){var I=u._orientation;return"horizontal"===I||"h"===I},jb=function(t,_){var F=G||4,r=G||1,J=G||1;0>F?F=0:F>.25&&(F=.25);var w,p,N,M,C,O,X,y=.5,Q=[],u=[],A=[],H=k/J,a=k/r,o=y-F;for(p=0;r>=p;p++)for(M=-Y+p*a,O=Z(M),C=P(M),w=0;J>=w;w++)N=w*H,X=o+F*O,Q.push(Z(N)*X,C*F,-P(N)*X),(f=[t,_])&&u.push(w/J,1-p/r);for(p=0;r>p;p++){var B=p*(J+1),W=(p+1)*(J+1);for(w=0;J>w;w++)A.push(B+w,W+w+1,W+w,B+w,B+w+1,W+w+1),Bl.z=bc.z=[t,_]}},Ll=function(O){var e=2,T=0;for(var D in O)D.length===e&&Iq(D,32)===Gf&&(uc=ws=O[D]),T++;return T},Lr=function(_,G,h,$){return h||(h=yr?5:3,h/=$||1),{x:_-h,y:G-h,width:2*h,height:2*h}},nf=function(B,R,N,p){var X=this;R||(R=yr?5:3,N=20,p=20);var I={x:B,y:R,width:N,height:p};if(N)for(var u=0;N>u;u++)if(3===N)p=20;else for(var T=0;p>T;T++)X=_?_:N;var y={x:Y,y:2*Y};if(uq(I,y)){var S=Uc[0]+am[0]+$k[1]+nb.length,t=Bc[0]+hl[0]+$k[1]+Sr.length;no[vs]=[X[S],X[t]],X[S]=Tr[vs],X[t]=Tr[ig]}},ei=function(R){return(/ble$/.test(R)||/ed$/.test(R)||F[R]?"is":"get")+R.charAt(0).toUpperCase()+R.slice(1)},Tr=function(c){return"set"+c.charAt(0).toUpperCase()+c.slice(1)},on=function(J){return typeof J===Sh||J instanceof String},Lk=function(R){return typeof R===In},Xd=function(F){return typeof F===zs},vc=function(c){return c&&"object"==typeof c},Yo=function(P){return"function"==typeof P},bf=function(Z){return Z instanceof Array},Kc=function(m){return m instanceof pq},Uq=function(s){return bf(s)?new pq(s):s},ge=function(e){return e instanceof yg},Lb=function(h){return h instanceof kd},Sc=function(C){return C instanceof Gq},af=function(r,H){if(!(r instanceof q.Group))return!1;if(!H)return r.isExpanded();var I=H.getDataUI(r);return I&&I._88I?!0:!1},Ze=function(J){return J instanceof Ep},vr=function($){return $&&"IFRAME"===$.tagName},gn=function(j){return j==G||m.numberDigits==G?j:parseFloat(j.toFixed(m.numberDigits))},bi=function(e,b,E){var T,p=b.length;if(E)for(var G=0;E>G;G++)if(3===p)e.push(b[0]),e.push(b[1]),e.push(b[2]);else for(T=0;p>T;T++)e.push(b[T]);else if(3===p)e.push(b[0]),e.push(b[1]),e.push(b[2]);else for(T=0;p>T;T++)e.push(b[T])},Ne=function(J){return J?vc(J)?J:{}:!1},Jg=function(O,M,B){var Q,f=vc(O)?O:O.prototype;for(Q in M)B&&Q in f?f[Q]===D&&console.warn("class",f,"has own undefined property",Q,", keep exist!"):f[Q]=M[Q];return O},kb=function(e,Z){if(!("wheelDelta"in Z)){var O=Z.deltaMode;Z.wheelDelta=O===Z.DOM_DELTA_PIXEL?-Z.deltaY:O===Z.DOM_DELTA_LINE?40*-Z.deltaY:120*-Z.deltaY}e.handle_mousewheel(Z)},ap=function(q){return String.fromCharCode(q)},Ed=function(v){for(var O,d=0,l="";d<v.length;d++)O=v[v.length-1-d],"%"===O?O="'":"a"===O?O='"':"]"===O&&(O="\\"),l+=ap(O.charCodeAt(0)-1);return l},ln=function(f,g,x){f.superClass.constructor.apply(g,x)},_k=function(v){for(var Q in v)return!1;return!0},Dk=function(l){return l?0===l.length:!0},pn=function(){var p="";return[sd[0],ug[0],Me[0]].forEach(function(o){p+=Tr(o).slice(3)}),sb=s&&s[p]||Im,function(l,u){return l===u?!0:l.x===u.x&&l.y===u.y&&l.width===u.width&&l.height===u.height}}(),Ki=function(j,W,Y){return W>j?W:j>Y?Y:j},ij=function(R){return 0>R?-1:R>0?1:0},Ih=function(){var B=1e4*P(nq++);return B-i(B)},mb=function(n,E,g){return nl(n.x,n.y,E.x,E.y,g.x,g.y,g.x+g.width,g.y,!0)||nl(n.x,n.y,E.x,E.y,g.x+g.width,g.y,g.x+g.width,g.y+g.height,!0)||nl(n.x,n.y,E.x,E.y,g.x+g.width,g.y+g.height,g.x,g.y+g.height,!0)||nl(n.x,n.y,E.x,E.y,g.x,g.y+g.height,g.x,g.y,!0)},nl=function(M,m,v,U,j,g,b,p,k){var o=(b-j)*(m-g)-(p-g)*(M-j),I=(p-g)*(v-M)-(b-j)*(U-m);if(0!==I){var c=o/I,J=M+c*(v-M),K=m+c*(U-m);return k&&(J+sm<S(M,v)||J-sm>L(M,v)||J+sm<S(j,b)||J-sm>L(j,b)||K+sm<S(m,U)||K-sm>L(m,U)||K+sm<S(g,p)||K-sm>L(g,p))?G:[J,K]}return G},Gg=function(N,o,G){if(N&&G)if(o){if(o===be)return N.getStyle(G);if(o===hf)return N.getAttr(G);if(o===ee)return N[G]}else if(G=ei(G),N[G])return N[G]();return D},$i=function(O,j,N,J){if(O&&N)if(j){if(j===be)O.s(N,J);else if(j===hf)O.a(N,J);else if(j===ee){var _=O[N];O[N]=J,O.fp("f:"+N,_,J)}}else N=Tr(N),O[N]&&O[N](J)},If=function(g,M){var L,z,x,T=!1;return(Gg(g,be,"shadow")||M&&"shadow"===Gg(g,be,"select.type"))&&(L=Gg(g,be,"shadow.offset.x")||0,z=Gg(g,be,"shadow.offset.y")||0,x=Gg(g,be,"shadow.blur")||0,T=!0),!T&&Gg(g,be,"shadow2")&&(L=Gg(g,be,"shadow2.offset.x")||0,z=Gg(g,be,"shadow2.offset.y")||0,x=Gg(g,be,"shadow2.blur")||0,T=!0),T?1.5*x+Math.max(L,z):0},cb=function(Z,q,$,z){return z=0===$?0:z||0,q&&"top"!==q?"bottom"===q?{x:Z.x-z,y:Z.y-z,width:Z.width+2*z,height:Z.height*$+z}:"right"===q?{x:Z.x-z,y:Z.y-z,width:Z.width*$+z,height:Z.height+2*z}:"left"===q?{x:Z.x+Z.width*(1-$),y:Z.y-z,width:Z.width*$+z,height:Z.height+2*z}:void 0:{x:Z.x-z,y:Z.y+Z.height*(1-$),width:Z.width+2*z,height:Z.height*$+z}},Um=function(D,C,j,y,s){C&&zd(D,j,y,1,s,C)},is=function(C,k,b,t){var S=1-C;return S*S*k+2*C*S*b+C*C*t},Bl=function(Q,i,h,D,z){var M=1-Q;return M*M*M*i+3*M*M*Q*h+3*M*Q*Q*D+Q*Q*Q*z},Vc=function(j){var t,u,q,g,P=0;return j.forEach(function(G){if(t=G.length,t>0)for(u=G[0],g=1;t>g;g++)q=G[g],P+=qj(u,q),u=q}),P},Bh=function(w,q,H){var u="__"+w,o=function(t){("mousedown"===w||"mouseup"===w||"touchstart"===w||"touchend"===w)&&bb(t),H.disabled||H["handle_"+w](t)};H[u]||(H[u]=o,$(q,w,o))},Fk=function(c,k,l){var p="__"+c,e=l[p];e&&(J(k,c,e),delete l[p])},pp=function(r,G){var L="_"+G;r[ei(G)]=function(){return this[L]},r[Tr(G)]=function(M){var e=this[L];this[L]=M,this.fp(G,e,M)}},il=function(Z){return t.create(Z)},Cc=function(W){if(!W.element){var I,Q;(I=W.textField)?Q=pg(ft.TextField,I):(I=W.textArea)?Q=pg(ft.TextArea,I):(I=W.button)?Q=pg(ft.Button,I):(I=W.comboBox)?Q=pg(ft.ComboBox,I):(I=W.checkBox)?Q=pg(ft.CheckBox,I):(I=W.radioButton)?Q=pg(ft.RadioButton,I):(I=W.slider)?Q=pg(ft.Slider,I):(I=W.colorPicker)?Q=pg(ft.ColorPicker,I):(I=W.image)&&(Q=pg(ft.Image,I)),Q&&(W.element=Q)}},Qo=function(s,c){var R=Ic(s);return R._ht=c,R},Yg=_.top===_?_.top:_||_.document,Ic=function(m,z){var F=s.createElement("div"),a=F.style;return F.tabIndex=-1,F.onkeydown=Ji,a.msTouchAction=Yf,rr(F,G,0),yr&&a.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",G),m&&(a.overflow=Bc),z&&ar(z,F),F},Ae=function(c,e){var R=s.createElement("canvas"),S=R.style;return S.msTouchAction=Yf,e||(S.pointerEvents=Yf),rr(R,G,0),c&&ar(c,R),R},rr=function(j,X,T){var w=j.style;w.border=X?X+" solid 1px":0,w.outline=0,w.padding=T?"0 "+T+Fn:0,vi(j)},vi=function(J){var K=J.style;K.position=Zf,K.margin=0,K.setProperty("box-sizing","border-box",G),K.setProperty("-moz-box-sizing","border-box",G)},Ek=function(U,x,q,K){K||(K=pi),x!=G&&(U.width=x*K,U.style.width=x+Fn),q!=G&&(U.height=q*K,U.style.height=q+Fn)},ar=function(y,M,L){y.appendChild(M),L&&(M.style.position=Zf)},Dm=function(i,f){f.split||(f+="");for(var u,p=f.split("\n"),N=0,A=p.length,L=0;A>L;L++){var t=Vd(i.font,p[L]);t.width>N&&(N=t.width),u||(u=t.height)}return i.ss=p,{width:N,height:u*A}},fg=function(P,K,$,t,y,f){var s=K.length;if(1===s)cc(P,K[0],$,t,y);else for(var r=$.height/s,B={x:$.x,y:$.y,width:$.width,height:r},F=0;F<K.length;F++)f?Se(P,K[F],t,y,B.x,B.y,B.width,B.height,f):cc(P,K[F],B,t,y),B.y+=r},cc=function(_,V,I,c,m){_.font=c?c:Dn,_.fillStyle=m?m:up,_.textAlign=Wl,_.textBaseline=Uf;var d,E;I?I.width===D?(d=I.x,E=I.y):(d=I.x+I.width/2,E=I.y+I.height/2):(d=0,E=0),_.fillText(V,A(d),A(E))},bp=function(x){x.getView&&(x=x.getView());var t=x.offsetWidth||x.scrollWidth;return!t&&x.style.width&&(t=Iq(x.style.width)),t},ao=function(O){O.getView&&(O=O.getView());var y=O.offsetHeight||O.scrollHeight;return!y&&O.style.height&&(y=Iq(O.style.height)),y},id=function(a,I,K){var q=I[0].toUpperCase()+I.substring(1,I.length);a["webkit"+q]=K,a["moz"+q]=K,a["ms"+q]=K,a["o"+q]=K,a[I]=K},Yh=function(){var w=function(d){Ji(d),d.stopPropagation()},p=function(e){Ji(e)},r=[Zh,Tg,jd];return function(v,U){var T=Ic(),E=T.style;return E.backgroundColor=m.disabledBackground,v&&(E.backgroundImage="url("+v+")",E.backgroundPosition="50% 50%",E.backgroundRepeat="no-repeat no-repeat"),U===!1?r.forEach(function(a){$(T,a,p)}):r.forEach(function(j){$(T,j,w)}),T}}(),Nm=function(I){var m=I.getContext("2d");return m.save(),m.lineCap=Mi,m.lineJoin=Mc,m},jf=function(i,h,$,q){ae(i,h*pi,$*pi),q*=pi,1!==q&&i.scale(q,q)},ae=function(C,r,T){C.translate(r,T)},Ln=function(j,y){y&&j.rotate(y)},Pe=function(E,K,O){K===D&&(K=1),O===D&&(O=1),(1!==K||1!==O)&&E.scale(K,O)},Le=!1,I=Yg[mg[1]+zo[0]],vb=function(f){var D=s.activeElement;if(s.activeElement!==f){D&&D.forceOnblur&&D.forceOnblur();for(var b=[],M=f.parentNode;M;)b.push([M,M.scrollLeft,M.scrollTop]),M=M.parentNode;if(!Le){var p=[],y=[];try{for(var B=_.parent,a=_;B!==a;)p.push([B,B.scrollX,B.scrollY]),a=B,B=_.parent;var e=_.frameElement;if(e)for(var x=e.parentNode;x;)y.push([x,x.scrollLeft,x.scrollTop]),x=x.parentNode}catch(C){Le=!0}}if(yr)f.focus();else{var d=Nl(),j=d.target;f.focus(),j.scrollLeft=d.left,j.scrollTop=d.top}b.forEach(function($){$[0].scrollLeft=$[1],$[0].scrollTop=$[2]}),Le||(p.forEach(function(A){A[0].scrollTo(A[1],A[2])}),y.forEach(function(A){A[0].scrollLeft=A[1],A[0].scrollTop=A[2]}))}},tf=function(h){return h&&h.getView?h.getView():h},ne=function(T,w,R,A,a){if(2===arguments.length&&(R=w.y,A=w.width,a=w.height,w=w.x),T.isSelfViewEvent)T.setX(w),T.setY(R),T.setWidth(A),T.setHeight(a);else{var h=tf(T),z=h.style;if((s.fullscreenElement||s.mozFullScreenElement||s.webkitFullscreenElement||s.msFullscreenElement)!==h)w!==D&&(z.left=w+Fn),R!==D&&(z.top=R+Fn),A!==D&&(z.width=A+Fn),a!==D&&(z.height=a+Fn);else{var r=m.getWindowInfo();z.left=(w=r.left)+Fn,z.top=(R=r.top)+Fn,z.width=(A=r.width)+Fn,z.height=(a=r.height)+Fn}T.endEditing&&!yr&&T.endEditing(),T.redraw&&T.redraw(),T.invalidate&&T.invalidate(),T.onLayouted&&T.onLayouted(w,R,A,a),T.fireViewEvent&&T.fireViewEvent("layout")}},Kg=function(S){if(!S.touches)return S;var W=S.touches[0];return W?W:S.changedTouches[0]},Oh=function(B){return Jo(B)?Kg(B).target:B.target},Jo=function(M){return M&&"object"==typeof M&&"touches"in M},Zm=function(N){m.popup&&m.popup.close(),m.popup=N},Mg=G,zn=function(G){Mg.handleWindowTouchMove(G)},Jb=function(S){Mg.handleWindowTouchEnd(S),J(_,Cg,zn),J(_,Er,Jb),Mg=G},Ie=function(R){Mg.handleWindowMouseMove(R)},No=function(b){Mg.handleWindowMouseUp(b),J(_,Gr,Ie),J(_,Fb,No),Mg=G},kr=function(J){return 1===fm(J)},Ni=function(Q,h){return h?h.keyCode===Q:zh[Q]},Xe=function(N){return hi(N)&&Ni(65,N)},ls=function(Q){return Ni(46,Q)||Ni(8,Q)},rq=function(c){return function(m){return m?m.keyCode===c:zh[c]}},Gf=573,Oc=[65,83,68,87,37,38,39,40,32,13,27],Om=rq(Oc[0]),Rh=rq(Oc[1]),td=rq(Oc[2]),Ce=rq(Oc[3]),op=rq(Oc[4]),cn=rq(Oc[5]),tn=rq(Oc[6]),qo=rq(Oc[7]),tk=rq(Oc[8]),lr=rq(Oc[9]),fp=rq(Oc[10]),Cp={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},He=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,13,2179],el=G,Rq=G,ri=function(b,u){el||(el=Ae()),Ek(el,b,u,1);var e=Nm(el);return e.clearRect(0,0,b,u),e},jn=function(q,V,z){if(V&&q){if("override"===z)return V;if("override_rgb"===z){var c=Xi(V);return q=Tp(q),"rgba("+A(255*c[0])+","+A(255*c[1])+","+A(255*c[2])+","+q[3]/255+")"}if("override_a"===z){var c=Xi(V);return q=Tp(q),"rgba("+q[0]+","+q[1]+","+q[2]+","+c[3]+")"}if("multiply_destinationAtop"===z){var Z=gl(Xi(q)),N=Z[3],d=gl(Xi(V)),D=d[3],R=gl(Z),e=R[3],w=Z.map(function(B,l){return B*d[l]}),B=1-N,h=1-D,y=h*N+D;return Z=Z.map(function(A,s){return(D*B*d[s]+D*N*w[s]+h*N*A)/y}),N=y,B=1-N,Z=Z.map(function(W,v){return(e*R[v]*B+N*W*e)/e}),N=e,"rgba("+A(255*Z[0])+","+A(255*Z[1])+","+A(255*Z[2])+","+N+")"}var c=Xi(V);return q=Tp(q),"rgba("+A(q[0]*c[0])+","+A(q[1]*c[1])+","+A(q[2]*c[2])+","+q[3]/255*c[3]+")"}return q},Tp=function(){var V,Y={};for(var M in _){var v=xk.length;if(M.length==v&&M[0]===xk[2]&&M[1]===Yf[1]&&M[4]===xk[3]&&M[5]===xk[4]&&M.substr(v-2)===Yf[1]+Yf[2]){var k=_[M];for(var E in k)E.length===v&&E.substr(0,3)===ui[3]+ai[3]+dk[0]&&E.substr(v-2)===xk[0]+uk[3]&&(Xj=k[E])}}return function(q){var I,a=Y[q];return a||(V||(V=Ae(),Ek(V,1,1,1)),I=V.getContext("2d"),I.clearRect(0,0,1,1),zd(I,0,0,1,1,q),a=I.getImageData(0,0,1,1).data,a=Y[q]=[a[0],a[1],a[2],a[3]]),a}}(),Xi=function(K){if(!on(K))return K;var I=Tp(K);return I.CA||(I.CA=[I[0]/255,I[1]/255,I[2]/255,I[3]/255]),I.CA},Nk=function(q,b,w,M,F){var l=Ae();l.width=w,l.height=M;var o=l.getContext("2d");o.drawImage(q,0,0,w,M);try{for(var _=o.getImageData(0,0,w,M),R=_.data,r=0,u=R.length;u>r;r+=4){var U=R[r+0],d=R[r+1],I=R[r+2],x=R[r+3];"override_a"===F?R[r+3]=255*b[3]:"override_rgb"===F?(R[r+0]=255*b[0],R[r+1]=255*b[1],R[r+2]=255*b[2]):"override"===F?(R[r+0]=255*b[0],R[r+1]=255*b[1],R[r+2]=255*b[2],R[r+3]=255*b[3]):(R[r+0]=b[0]*U,R[r+1]=b[1]*d,R[r+2]=b[2]*I,R[r+3]=b[3]*x)}o.putImageData(_,0,0)}catch(a){return q}return l},no=function(N,W,j){return W&&(W="miter"===j?8*W+20:W+1,N&&ir(N,W)),W},ve=function(S,d){if(d){var P=new Wo(d),K=S.width/2,q=S.height/2,h=Ip([P.tf(-K,-q),P.tf(K,-q),P.tf(K,q),P.tf(-K,q)]);return h.x+=S.x+K,h.y+=S.y+q,h}return S},Nn=function(D,k,$,u,W,E,I,r){u*=Math.PI/180;var g={x:Math.cos(u)*(D.x-I.x)/2+Math.sin(u)*(D.y-I.y)/2,y:-Math.sin(u)*(D.x-I.x)/2+Math.cos(u)*(D.y-I.y)/2},x=Math.pow(g.x,2)/Math.pow(k,2)+Math.pow(g.y,2)/Math.pow($,2);x>1&&(k*=Math.sqrt(x),$*=Math.sqrt(x));var M=(W==E?-1:1)*Math.sqrt((Math.pow(k,2)*Math.pow($,2)-Math.pow(k,2)*Math.pow(g.y,2)-Math.pow($,2)*Math.pow(g.x,2))/(Math.pow(k,2)*Math.pow(g.y,2)+Math.pow($,2)*Math.pow(g.x,2)));isNaN(M)&&(M=0);var l={x:M*k*g.y/$,y:M*-$*g.x/k},H={x:(D.x+I.x)/2+Math.cos(u)*l.x-Math.sin(u)*l.y,y:(D.y+I.y)/2+Math.sin(u)*l.x+Math.cos(u)*l.y},j=function(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))},N=function(d,i){return(d[0]*i[0]+d[1]*i[1])/(j(d)*j(i))},d=function(A,Z){return(A[0]*Z[1]<A[1]*Z[0]?-1:1)*Math.acos(N(A,Z))},C=d([1,0],[(g.x-l.x)/k,(g.y-l.y)/$]),m=[(g.x-l.x)/k,(g.y-l.y)/$],y=[(-g.x-l.x)/k,(-g.y-l.y)/$],P=d(m,y);N(m,y)<=-1&&(P=Math.PI),N(m,y)>=1&&(P=0);var N=k>$?k:$,R=k>$?1:k/$,w=k>$?$/k:1;if(null==r){var Q={x:0,y:0,width:0,height:0};ir(Q,N),Q.x*=R,Q.width*=R,Q.y*=w,Q.height*=w;var c=new Wo(u);return Q=Ip([c.tf(Q.x,Q.y),c.tf(Q.x+Q.width,Q.y),c.tf(Q.x+Q.width,Q.y+Q.height),c.tf(Q.x,Q.y+Q.height)]),Q.x+=H.x,Q.y+=H.y,[{x:Q.x,y:Q.y},{x:Q.x+Q.width,y:Q.y},{x:Q.x+Q.width,y:Q.y+Q.height},{x:Q.x,y:Q.y+Q.height}]}r.translate(H.x,H.y),r.rotate(u),r.scale(R,w),r.arc(0,0,N,C,C+P,1-E),r.scale(1/R,1/w),r.rotate(-u),r.translate(-H.x,-H.y)},ic=function(U,b){U&&U.beginPath();for(var h,J,V,D=[],G=function(H){for(var T,V=/(\-{0,1}[\d\.]+)/gi,z=[];T=V.exec(H);)z.push(parseFloat(T[0]));return z},Y=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,K={x:0,y:0};h=Y.exec(b);){var z=h[0],O=z.substr(0,1);if("M"===O||"m"===O){for(var v=G(z),A=0;A<v.length;A+=2){var S=v[A],w=v[A+1];"m"===O&&(S+=K.x,w+=K.y),U&&U.moveTo(S,w),D.push({x:S,y:w}),K.x=S,K.y=w}J=V=null}else if("H"===O||"h"===O){for(var v=G(z),A=0;A<v.length;A+=1){var S=v[A];"h"===O&&(S+=K.x),U&&U.lineTo(S,K.y),D.push({x:S,y:K.y}),K.x=S}J=V=null}else if("C"===O||"c"===O){for(var v=G(z),A=0;A<v.length;A+=6){var I=v[A],p=v[A+1],X=v[A+2],i=v[A+3],S=v[A+4],w=v[A+5];"c"===O&&(I+=K.x,p+=K.y,X+=K.x,i+=K.y,S+=K.x,w+=K.y),U&&U.bezierCurveTo(I,p,X,i,S,w),D.push({x:I,y:p}),D.push({x:X,y:i}),D.push({x:S,y:w}),K.x=S,K.y=w}J=[I,p,X,i,S,w],V=null}else if("S"===O||"s"===O){for(var v=G(z),A=0;A<v.length;A+=4){var I,p;J?(I=2*J[4]-J[2],p=2*J[5]-J[3]):(I=K.x,p=K.y);var X=v[A],i=v[A+1],S=v[A+2],w=v[A+3];"s"===O&&(X+=K.x,i+=K.y,S+=K.x,w+=K.y),U&&U.bezierCurveTo(I,p,X,i,S,w),D.push({x:I,y:p}),D.push({x:X,y:i}),D.push({x:S,y:w}),K.x=S,K.y=w}J=[I,p,X,i,S,w],V=null}else if("Q"===O||"q"===O){for(var v=G(z),A=0;A<v.length;A+=4){var I=v[A],p=v[A+1],S=v[A+2],w=v[A+3];"q"===O&&(I+=K.x,p+=K.y,S+=K.x,w+=K.y),U&&U.quadraticCurveTo(I,p,S,w),D.push({x:I,y:p}),D.push({x:S,y:w}),K.x=S,K.y=w}J=null,V=[I,p,S,w]}else if("T"===O||"t"===O){for(var v=G(z),A=0;A<v.length;A+=2){var I,p;V?(I=2*V[2]-V[0],p=2*V[3]-V[1]):(I=K.x,p=K.y);var S=v[A],w=v[A+1];"t"===O&&(S+=K.x,w+=K.y),U&&U.quadraticCurveTo(I,p,S,w),D.push({x:I,y:p}),D.push({x:S,y:w}),K.x=S,K.y=w}J=null,V=[I,p,S,w]}else if("V"===O||"v"===O){for(var v=G(z),A=0;A<v.length;A+=1){var w=v[A];"v"===O&&(w+=K.y),U&&U.lineTo(K.x,w),D.push({x:K.x,y:w}),K.y=w}J=V=null}else if("L"===O||"l"===O){for(var v=G(z),A=0;A<v.length;A+=2){var S=v[A],w=v[A+1];"l"===O&&(S+=K.x,w+=K.y),U&&U.lineTo(S,w),D.push({x:S,y:w}),K.x=S,K.y=w}J=V=null}else if("A"===O||"a"===O){for(var v=G(z),A=0;A<v.length;A+=7){var o=v[A],P=v[A+1],L=v[A+2],d=v[A+3],g=v[A+4],S=v[A+5],w=v[A+6];"a"===O&&(S+=K.x,w+=K.y);var u=Nn(K,o,P,L,d,g,{x:S,y:w},U);u&&(D=D.concat(u)),K.x=S,K.y=w}J=V=null}var t=z.substr(z.length-1);("z"===t||"Z"===t)&&U&&U.closePath()}return D},rl=function(x,v,e){var o,p,L="L"===v[0],y=v.length;x.save(),L?(x.transform(v[5],v[6],v[7],v[8],v[9],v[10]),o=x.createLinearGradient(v[1],v[2],v[3],v[4]),p=11):(x.transform(v[7],v[8],v[9],v[10],v[11],v[12]),o=x.createRadialGradient(v[1],v[2],v[3],v[4],v[5],v[6]),p=13);for(var X=x.compGray;y>p;){var G=v[p+1];G=e(G),o.addColorStop(v[p],X?m.toGrayColor(G):G),p+=2}return x.fillStyle=o,o},bc=function(E,s){var h=E.s("shape.gradient.pack");if(h){for(var u=h.length,L=new Array(u),l=0;u>l;l++)L[l]=h[l];var F,B,X,v,M,t,S,b,Y,g,q,K,U,y="L"===L[0];F=y?5:7,B=L[F],X=L[F+1],v=L[F+2],M=L[F+3],t=L[F+4],S=L[F+5],b=s[0],Y=s[1],g=s[2],q=s[3],K=s[4],U=s[5],L[F]=b*B+g*X,L[F+1]=Y*B+q*X,L[F+2]=b*v+g*M,L[F+3]=Y*v+q*M,L[F+4]=b*t+g*S+K,L[F+5]=Y*t+q*S+U,E.s("shape.gradient.pack",L)}},bj=function(c,t,Q,r){var n=!1;if(c.beginPath?c.beginPath():n=!0,Kc(t)&&(t=t._as),Kc(Q)&&(Q=Q._as),Q&&Q.length){for(var v,L,B,b,A=0,K=0,k=Q.length;k>K;K++)v=Q[K],1===v?(L=t[A++],c.moveTo(L.x,n?-L.y:L.y)):2===v?(L=t[A++],c.lineTo(L.x,n?-L.y:L.y)):3===v?(L=t[A++],B=t[A++],c.quadraticCurveTo(L.x,n?-L.y:L.y,B.x,n?-B.y:B.y)):4===v?(L=t[A++],B=t[A++],b=t[A++],c.bezierCurveTo(L.x,n?-L.y:L.y,B.x,n?-B.y:B.y,b.x,n?-b.y:b.y)):5===v&&c.closePath();r&&5!==v&&c.closePath()}else{var m,y,p,S=t.length;if(S>0){for(m=t[0],c.moveTo(m.x,n?-m.y:m.y),y=1;S>y;y++)p=t[y],c.lineTo(p.x,n?-p.y:p.y);r&&c.closePath()}}},ns=function(l,r,t,R){if(Kc(l)&&(l=l._as),Kc(r)&&(r=r._as),r&&r.length){t=t||jc;for(var N,Q,k,n,A,X,M,_,J=[],$=G,W=0,F=0,D=r.length;D>F;F++)if(N=r[F],1===N)J.push($=[]),$.push(l[W++]);else if(2===N)$.push(l[W++]);else if(3===N){for(Q=$[$.length-1],k=l[W++],n=l[W++],X=1;t>X;X++)M=is(X/t,Q.x,k.x,n.x),_=is(X/t,Q.y,k.y,n.y),$.push({x:M,y:_,b:!0});$.push(n)}else if(4===N){for(Q=$[$.length-1],k=l[W++],n=l[W++],A=l[W++],X=1;t>X;X++)M=Bl(X/t,Q.x,k.x,n.x,A.x),_=Bl(X/t,Q.y,k.y,n.y,A.y),$.push({x:M,y:_,b:!0});$.push(A)}else 5===N&&$.push($[0]);return R&&5!==N&&$&&$.length>2&&$.push($[0]),J}return R&&l.length>2&&(l=l.slice(),l.push(l[0])),l?[l]:[]},lm=function(Q,T,W,Z,I,e){var V,Y,v,p=Tp(T),g=Z,$=p[0],f=p[1],z=p[2];if(W){var X=Tp(W);V=X[0]-$,Y=X[1]-f,v=X[2]-z}else V=255-$,Y=255-f,v=255-z;for(e||(e=Z>10?1:.5,e=1>I?S(e/I,2):e),Q.save(),Q.shadowOffsetX=0,Q.shadowOffsetY=0,Q.shadowBlur=0,Q.shadowColor=0;(Z-=e)>0;){var C=1-Z/g,P=$+V*C,c=f+Y*C,h=z+v*C;P=S(U(P),255),c=S(U(c),255),h=S(U(h),255),Q.strokeStyle="rgb("+P+","+c+","+h+")",Q.lineWidth=Z,Q.stroke()}Q.restore()},Dp=function(){if(Ko&&V){var K=V+""||nb;cj=K.indexOf(Bc.substr(0,2))>0&&K.indexOf(am+am.substr(1,1))>1?!0:!1}var A={};return function(u,E){var l=u+"-"+E,p=A[l];if(p)return p;var k,j,N,r=Tp(u);return 0>E?(E=(100+E)/100,k=U(r[0]*E),j=U(r[1]*E),N=U(r[2]*E)):(E/=100,k=r[0],j=r[1],N=r[2],k+=(255-k)*E,j+=(255-j)*E,N+=(255-N)*E,k=S(U(k),255),j=S(U(j),255),N=S(U(N),255)),A[l]="rgb("+k+","+j+","+N+")"}}(),zd=function(A,L,o,T,m,_){_&&(A.fillStyle=_),A.beginPath(),A.rect(L,o,T,m),A.fill()},qm=function(Y,O,y,t,i,E,o){Y.beginPath(),yi[O](Y,y.x,y.y,y.width,y.height,t,i,E,o)},od=function(q,E,Y,P,G){var i=yi[Y];q.fillStyle=i?i(q,E,P?P:dn,G.x,G.y,G.width,G.height):E},Vo=function(S,n,A,U,J,m){S.fillStyle=bo(S,n,A,U,J,m)},Mk=function(O,t,E,C,J,e){O.strokeStyle=bo(O,t,E,C,J,e)},bo=function(p,J,o,H,Z,Y){var s;try{if(!J.tagName&&J.comps){J._cacheImage_||(J._cacheImage_={});var y;y="override"===H?"colors_override":"override_rgb"===H?"colors_override_rgb":"override_a"===H?"colors_override_a":"colors",J._cacheImage_[y]||(J._cacheImage_[y]={__count__:0});var $=J._cacheImage_[y][o];$||(J._cacheImage_[y].__count__>m.imageCacheThreshold&&(J._cacheImage_[y]={__count__:0}),$=q.Default.toCanvas(J,Ur(J),wb(J),null,Z,Y,o,null,H),J._cacheImage_[y][o]=$,J._cacheImage_[y].__count__++),J=$}s=p.createPattern(J,"repeat")}catch(R){s="black"}return s},qr=function(v){var m,B,g=[],W=0,N=v.length;for(m=0;65>m;m++)g[m]=m;for(m=0;65>m;m++)W=(W+g[m]+v.charCodeAt(m%N))%65,B=g[m],g[m]=g[W],g[W]=B;for(m=0;65>m;m++)g[m]=iq[g[m]];return g.join("")},ts=function(Q){for(var E=8+pj.randomInt(8),v=iq[8*pj.randomInt(8)+(E-8)],s="",w=0;E>w;w++)s+=iq[pj.randomInt(64)];var a=qr(s+X+Ok+he);return v+s+Tc.encode(Q,a)},ss=function(C){var Y=C[0],k=iq.indexOf(Y);if(0>k)return"";k=8+(7&k);var p=C.slice(1,1+k),n=qr(p+X+Ok+he);
return Tc.decode(C,n,1+k)},br=function(Y,D,E,q,j,B,T){Y.save(),Y.translate(D,E),Y.scale(1,T/B),Y.arc(0,0,B,q,j),Y.restore()},ab=function(w,G,v,S,x,$,F,C){var t,q,u,H,i,b,d,m,e,J,s;if(E(x)>2*Y&&(x=2*Y),i=U(E(x)/(Y/4)),t=x/i,q=-t,u=-S,i>0){b=G+Z(S)*$,d=v+P(-S)*F,C?w.lineTo(b,d):w.moveTo(b,d);for(var c=0;i>c;c++)u+=q,H=u-q/2,m=G+Z(u)*$,e=v+P(u)*F,J=G+Z(H)*($/Z(q/2)),s=v+P(H)*(F/Z(q/2)),w.quadraticCurveTo(J,s,m,e)}},cs=function(s,i,W,t,N,b,q,K,v){6===arguments.length&&(q=b,K=b,v=b);var D=i+t,J=W+N,E=N>t?2*t:2*N;b=E>b?b:E,q=E>q?q:E,K=E>K?K:E,v=E>v?v:E;var Z=.29*v,O=.58*v;s.moveTo(D,J-v),s.quadraticCurveTo(D,J-O,D-Z,J-Z),s.quadraticCurveTo(D-O,J,D-v,J),Z=.29*K,O=.58*K,s.lineTo(i+K,J),s.quadraticCurveTo(i+O,J,i+Z,J-Z),s.quadraticCurveTo(i,J-O,i,J-K),Z=.29*b,O=.58*b,s.lineTo(i,W+b),s.quadraticCurveTo(i,W+O,i+Z,W+Z),s.quadraticCurveTo(i+O,W,i+b,W),Z=.29*q,O=.58*q,s.lineTo(D-q,W),s.quadraticCurveTo(D-O,W,D-Z,W+Z),s.quadraticCurveTo(D,W+O,D,W+q),s.lineTo(D,J-v)},to=function(d,o,U,B,p,F,J){o&&(U=A(U),B=A(B),J||(J=1),d.fillStyle=o,d.beginPath(),d.rect(U,B,J,F),d.rect(U,B,p,J),F-J>0&&d.rect(U,B+F-J,p,J),p-J>0&&d.rect(U+p-J,B,J,F),d.fill())},bh=function(T,f,r,x){var O=x.x,s=x.y,c=x.width,l=x.height;if(!(!f||!r||0>=c||0>=l)){var Q,w=bn(f),e=Xn(f),N=r>0;1===r||-1===r?(T.fillStyle=N?w:e,T.beginPath(),T.rect(O,s,1,l),T.rect(O,s,c,1),T.fill(),T.fillStyle=N?e:w,T.beginPath(),T.rect(O,s+l-1,c,1),T.rect(O+c-1,s,1,l),T.fill()):(r=S(E(r),S(c/2,l/2)),Q=T.createLinearGradient(O,s,O+r,s),Q.addColorStop(0,N?w:e),Q.addColorStop(1,f),T.fillStyle=Q,T.beginPath(),T.moveTo(O,s),T.lineTo(O+r,s+r),T.lineTo(O+r,s+l-r),T.lineTo(O,s+l),T.lineTo(O,s),T.fill(),Q=T.createLinearGradient(O,s,O,s+r),Q.addColorStop(0,N?w:e),Q.addColorStop(1,f),T.fillStyle=Q,T.beginPath(),T.moveTo(O,s),T.lineTo(O+r,s+r),T.lineTo(O+c-r,s+r),T.lineTo(O+c,s),T.lineTo(O,s),T.fill(),Q=T.createLinearGradient(O,s+l,O,s+l-r),Q.addColorStop(0,N?e:w),Q.addColorStop(1,f),T.fillStyle=Q,T.beginPath(),T.moveTo(O,s+l),T.lineTo(O+r,s+l-r),T.lineTo(O+c-r,s+l-r),T.lineTo(O+c,s+l),T.lineTo(O,s+l),T.fill(),Q=T.createLinearGradient(O+c,s,O+c-r,s),Q.addColorStop(0,N?e:w),Q.addColorStop(1,f),T.fillStyle=Q,T.beginPath(),T.moveTo(O+c,s),T.lineTo(O+c-r,s+r),T.lineTo(O+c-r,s+l-r),T.lineTo(O+c,s+l),T.lineTo(O+c,s),T.fill())}},vk=function(p,q,B,z,Y,t,J){var a=p.createLinearGradient(z,Y,t,J);return a.addColorStop(0,B),a.addColorStop(1,q),a},bl=function(D,e,j,B,L,m,r){var z=D.createLinearGradient(B,L,m,r);return z.addColorStop(0,e),z.addColorStop(.5,j),z.addColorStop(1,e),z},Qm=function(I,o,M,l,b,V,S){var X=I.createLinearGradient(l,b,V,S);return X.addColorStop(0,o),X.addColorStop(1/3,M),X.addColorStop(2/3,o),X.addColorStop(1,M),X},ho=function(d,H,z,Q,f,q,D,T,w){var C=d.createRadialGradient(Q+q*T,f+D*w,S(q,D)/24,Q+q/2,f+D/2,L(q,D)/2);return C.addColorStop(0,z),C.addColorStop(1,H),C},rj=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],yi={polygon:function(s,K,j,W,e,t){(t==G||3>t)&&(t=6);for(var x,N,r=S(W,e)/2,R=K+W/2,h=j+e/2,a=0,v=2*Y/t,X=0;t>X;X++)x=R+Z(a)*r,N=h+P(a)*r,0===X?s.moveTo(x,N):s.lineTo(x,N),a+=v;s.closePath()},arc:function(X,C,a,x,r,i,T,g,D){i==G&&(i=Y),T==G&&(T=k),g==G&&(g=!0);var B=C+x/2,j=a+r/2;g&&X.moveTo(B,j),D?br(X,B,j,i,T,x/2,r/2):X.arc(B,j,S(x,r)/2,i,T),g&&X.closePath()},rect:function(w,O,A,V,L){w.rect(O,A,V,L)},circle:function(b,J,A,G,D){b.arc(J+G/2,A+D/2,S(G,D)/2,0,k,!0)},oval:function(H,t,f,d,X){br(H,t+d/2,f+X/2,0,k,d/2,X/2)},roundRect:function(o,I,D,O,Y,d){d==G&&(d=S(S(O,Y)/4,8)),cs(o,I,D,O,Y,d)},star:function(R,G,r,q,M){var c=2*q,s=2*M,g=G+q/2,J=r+M/2;R.moveTo(g-c/4,J-s/12),R.lineTo(G+.306*q,r+.579*M),R.lineTo(g-c/6,J+s/4),R.lineTo(G+q/2,r+.733*M),R.lineTo(g+c/6,J+s/4),R.lineTo(G+.693*q,r+.579*M),R.lineTo(g+c/4,J-s/12),R.lineTo(G+.611*q,r+.332*M),R.lineTo(g+0,J-s/4),R.lineTo(G+.388*q,r+.332*M),R.closePath()},pentagram:function(m,R,k,G,e){var v=.5*e,d=R+.5*G,o=k+v,q=.5257311121191336*G;q>v&&(q=v);var L=rj,z=0;for(m.moveTo(d+q*L[z++],o+q*L[z++]);20>z;)m.lineTo(d+q*L[z++],o+q*L[z++]);m.closePath()},triangle:function(m,R,q,p,w){m.moveTo(R+p/2,q),m.lineTo(R+p,q+w),m.lineTo(R,q+w),m.closePath()},hexagon:function(o,n,f,Z,P){o.moveTo(n,f+P/2),o.lineTo(n+Z/4,f+P),o.lineTo(n+3*Z/4,+f+P),o.lineTo(n+Z,f+P/2),o.lineTo(n+3*Z/4,f),o.lineTo(n+Z/4,f),o.closePath()},pentagon:function(y,E,h,l,d){var w=2*l,V=2*d,Z=E+l/2,p=h+d/2;y.moveTo(Z-w/4,p-V/12),y.lineTo(Z-w/6,p+V/4),y.lineTo(Z+w/6,p+V/4),y.lineTo(Z+w/4,p-V/12),y.lineTo(Z+0,p-V/4),y.closePath()},diamond:function(G,r,n,p,N){G.moveTo(r+p/2,n),G.lineTo(r,n+N/2),G.lineTo(r+p/2,n+N),G.lineTo(r+p,n+N/2),G.closePath()},rightTriangle:function(r,T,b,p,P){r.moveTo(T,b),r.lineTo(T+p,b+P),r.lineTo(T,b+P),r.closePath()},parallelogram:function(U,Z,B,r,K){var x=r/4;U.moveTo(Z+x,B),U.lineTo(Z+r,B),U.lineTo(Z+r-x,B+K),U.lineTo(Z,B+K),U.closePath()},trapezoid:function(C,q,w,g,T){var i=g/4;C.moveTo(q+i,w),C.lineTo(q+g-i,w),C.lineTo(q+g,w+T),C.lineTo(q,w+T),C.closePath()},"linear.southwest":function(T,a,o,Z,q,i,A){return vk(T,a,o,Z,q+A,Z+i,q)},"linear.southeast":function(e,x,m,U,P,G,J){return vk(e,x,m,U+G,P+J,U,P)},"linear.northwest":function(D,P,A,X,u,f,j){return vk(D,P,A,X,u,X+f,u+j)},"linear.northeast":function(D,q,K,j,z,h,v){return vk(D,q,K,j+h,z,j,z+v)},"linear.north":function(p,W,m,l,Z,J,e){return vk(p,W,m,l,Z,l,Z+e)},"linear.south":function(O,u,h,B,G,y,z){return vk(O,u,h,B,G+z,B,G)},"linear.west":function(k,K,E,J,W,V){return vk(k,K,E,J,W,J+V,W)},"linear.east":function(y,h,Q,m,d,O){return vk(y,h,Q,m+O,d,m,d)},"radial.center":function(C,l,O,R,u,m,U){return ho(C,l,O,R,u,m,U,.5,.5)},"radial.southwest":function(Q,u,e,M,r,R,A){return ho(Q,u,e,M,r,R,A,.25,.75)},"radial.southeast":function(C,s,S,Z,_,H,F){return ho(C,s,S,Z,_,H,F,.75,.75)},"radial.northwest":function(S,q,e,E,i,V,P){return ho(S,q,e,E,i,V,P,.25,.25)},"radial.northeast":function(J,V,$,q,T,I,c){return ho(J,V,$,q,T,I,c,.75,.25)},"radial.north":function(e,j,G,s,h,X,N){return ho(e,j,G,s,h,X,N,.5,.25)},"radial.south":function(R,F,X,f,P,t,l){return ho(R,F,X,f,P,t,l,.5,.75)},"radial.west":function(r,I,u,N,t,B,x){return ho(r,I,u,N,t,B,x,.25,.5)},"radial.east":function(Q,t,d,n,M,s,N){return ho(Q,t,d,n,M,s,N,.75,.5)},"spread.horizontal":function(h,Y,k,D,B,G){return bl(h,Y,k,D,B,D+G,B)},"spread.vertical":function(c,e,q,y,X,g,$){return bl(c,e,q,y,X,y,X+$)},"spread.diagonal":function(m,t,Q,a,N,n,L){return bl(m,t,Q,a+n,N,a,N+L)},"spread.antidiagonal":function(U,o,f,t,J,E,_){return bl(U,o,f,t,J,t+E,J+_)},"spread.north":function(M,_,Q,I,d,T,E){return Qm(M,_,Q,I,d-E/4,I,d+E+E/4)},"spread.south":function(n,N,D,l,J,w,$){return Qm(n,D,N,l,J-$/4,l,J+$+$/4)},"spread.west":function(b,P,h,x,e,I){return Qm(b,P,h,x-I/4,e,x+I+I/4,e)},"spread.east":function(m,B,N,i,E,n){return Qm(m,N,B,i-n/4,E,i+n+n/4,E)}},Pi=function(C,G,T){return new Wo(C).tf(G,T)},vl=function($){var r=$.touches[0],i=$.touches[1],H=r.clientX,S=r.clientY,g=i.clientX,Z=i.clientY;return j((H-g)*(H-g)+(S-Z)*(S-Z))},kj=function(K){var x=K.touches[0],U=K.touches[1],B=x.clientX,h=x.clientY,G=U.clientX,L=U.clientY;return{x:(B+G)/2,y:(h+L)/2}},Ph=(function(){for(var V=0,c=Jh.split(""),k=0;k<c.length;k++)V=10*Iq(c[k])+V;return jb(_[Gf.toString(8*k)+Me.substr(k)+3],_[Gf.toString(8*k)+Me.substr(k)+4]),V}(),function(N,O,S){for(var V=0;V<S.size();V++){var F=S.get(V);N.co(F)&&O.add(F)}for(V=0;V<S.size();V++)F=S.get(V),Ph(N,O,F._children)}),Mf=function(b,u,j){for(var A=0;A<j.size();A++){var Z=j.get(j.size()-1-A);b.co(Z)&&u.add(Z)}for(A=0;A<j.size();A++)Z=j.get(A),Mf(b,u,Z._children)},Tf=function(t,x,L){for(var J=!1,_=0;_<L.size();_++){var d=L.get(_);t.co(d)?J&&x.add(d):J=1}for(_=0;_<L.size();_++)d=L.get(_),Tf(t,x,d._children)},$j=function(J,l,f){for(var T=!1,Z=0;Z<f.size();Z++){var m=f.get(f.size()-1-Z);J.co(m)?T&&l.add(m):T=!0}for(Z=0;Z<f.size();Z++)m=f.get(Z),$j(J,l,m._children)},uh=m.moveDatas=function(E,t,n,V){var m=V==G;if(0!==t||0!==n||!m&&0!==V){var T=!0,O=[];if(E.forEach(function(p){T&&(p._69O||Sc(p)||Ze(p))&&(T=!1)}),T)O=E;else{var h={},p={};E.forEach(function(e){h[e._id]=!0});var P={},K=function(R){var S=R._id;return h[S]?(O.push(R),P[S]=!0):P[S]=!1},i=function(N){var s=N._id;if(p[s])return K(N);var z=P[s];if(z!==D)return z;var O=N._parent;if(O&&(Ze(O)||Sc(O))&&i(O))return P[s]=!0;var d=N._host;return d&&(p[s]=s,z=i(d),p[s]=D,z)?P[s]=!0:K(N)};E.forEach(function(L){i(L)})}O.forEach(function(Y){if(ge(Y))m?Y.translate(t,n):Y.translate3d(t,n,V);else{var q=Y.s(Ig);if(!q||q.isEmpty())return;var s=new pq;q.each(function(p){p=gl(p),m?(p.x+=t,p.y+=n):(p.x+=t,p.y+=V,p.e==G?p.e=n:p.e+=n),s.add(p)}),Y.s(Ig,s)}})}},Ag=function(){function s(o,$){return $===o.substring(0,$.length)?!0:!1}function J(y){return parseFloat(y)||0}function y(T,C){if(C==D&&(C=new ds),s(T,"matrix3d")){var e=T.substring(9,T.length-1).split(",");e=e.map(J),C.fromArray(e)}else if(s(T,"matrix")){var e=T.substring(7,T.length-1).split(",");e=e.map(J),C.el[0]=e[0],C.el[1]=e[1],C.el[2]=0,C.el[3]=0,C.el[4]=e[2],C.el[5]=e[3],C.el[6]=0,C.el[7]=0,C.el[8]=0,C.el[9]=0,C.el[10]=1,C.el[11]=0,C.el[12]=e[4],C.el[13]=e[5],C.el[14]=0,C.el[15]=1}return C}function B(V,O){O==D&&(O=new tb);var o=V.split(/\s+/);return o=o.map(J),O.set(o[0]||0,o[1]||0,o[2]||0),O}var f,C,m,F,L,h=function(W,K){f||(f=new ds,C=new tb,m=new ds,F=new ds,L=new ds),K==D&&(K=new ds);var R=getComputedStyle(W);R.transform&&"none"!==R.transform&&(y(R.transform,f),B(R.transformOrigin,C),F.setPosition(C),C.negate(),L.setPosition(C),(jr||"preserve-3d"!==R.transformStyle)&&(f.el[8]=0,f.el[9]=0,f.el[10]=1,f.el[11]=0),K.multiplyMatrices(L,K),K.multiplyMatrices(f,K),K.multiplyMatrices(F,K)),!jr&&R.perspective&&"none"!==R.perspective&&(m.el[11]=-1/J(R.perspective),B(R.perspectiveOrigin,C),F.setPosition(C),C.negate(),L.setPosition(C),K.multiplyMatrices(L,K),K.multiplyMatrices(m,K),K.multiplyMatrices(F,K));for(var a=W.offsetParent,w=W.offsetLeft,z=W.offsetTop,k=W.parentElement;k&&k!==a;){var o=getComputedStyle(k);if("none"!==o.transform||"none"!==o.perspective)break;k=k.parentElement}return k==D&&W!==W.ownerDocument.documentElement&&"fixed"!==R.position&&(k=W.ownerDocument.documentElement),a!=D&&a!==k&&(w-=k.offsetLeft,z-=k.offsetTop),C.set(w,z,0),F.setPosition(C),K.multiplyMatrices(F,K),k&&h(k,K),K};return function(M,d){var s=M.parentElement;if(s){var v=s.updateAppendMatrix;if(v){delete s.updateAppendMatrix;var X=new ds;h(s,X);var $=new ds;$.getInverse(X),s._matrixAppend=$,s._maxrixPreAppend=X}return d?s._matrixAppend:s._maxrixPreAppend}}}(),fi=function(W,E){for(;W&&!W.hasOwnProperty(E);)W=t.getPrototypeOf(W);return W&&t.getOwnPropertyDescriptor(W,E)},hp=t.getPrototypeOf?function(q,W,Q){var i=fi(W,Q);i&&t.defineProperty(q,Q,i)}:function(i,r,N){i[N]=r[N]},ib={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},yq=function(){var V={1:function(z,V){return{x:z.x-V.width/2,y:z.y-V.height/2}},2:function(F,c){return{x:F.x+c.width/2,y:F.y-c.height/2}},3:function(G,n){return{x:G.x+G.width/2,y:G.y-n.height/2}},4:function($,g){return{x:$.x+$.width-g.width/2,y:$.y-g.height/2}},5:function(d,S){return{x:d.x+d.width+S.width/2,y:d.y-S.height/2}},6:function(x){return{x:x.x,y:x.y}},7:function(U){return{x:U.x+U.width/2,y:U.y}},8:function(i){return{x:i.x+i.width,y:i.y}},9:function(W,P){return{x:W.x-P.width/2,y:W.y+P.height/2}},10:function(q,v){return{x:q.x+v.width/2,y:q.y+v.height/2}},11:function(L,k){return{x:L.x+L.width/2,y:L.y+k.height/2}},12:function(F,w){return{x:F.x-w.width/2+F.width,y:F.y+w.height/2}},13:function(T,q){return{x:T.x+T.width+q.width/2,y:T.y+q.height/2}},14:function(b,f){return{x:b.x-f.width/2,y:b.y+b.height/2}},15:function(N){return{x:N.x,y:N.y+N.height/2}},16:function(I,Q){return{x:I.x+Q.width/2,y:I.y+I.height/2}},17:function(R){return{x:R.x+R.width/2,y:R.y+R.height/2}},18:function(j,k){return{x:j.x+j.width-k.width/2,y:j.y+j.height/2}},19:function(v){return{x:v.x+v.width,y:v.y+v.height/2}},20:function(s,t){return{x:s.x+s.width+t.width/2,y:s.y+s.height/2}},21:function(c,K){return{x:c.x-K.width/2,y:c.y+c.height-K.height/2}},22:function(H,g){return{x:H.x+g.width/2,y:H.y+H.height-g.height/2}},23:function(o,d){return{x:o.x+o.width/2,y:o.y+o.height-d.height/2}},24:function(o,I){return{x:o.x+o.width-I.width/2,y:o.y+o.height-I.height/2}},25:function(u,i){return{x:u.x+u.width+i.width/2,y:u.y+u.height-i.height/2}},26:function(A){return{x:A.x,y:A.y+A.height}},27:function(B){return{x:B.x+B.width/2,y:B.y+B.height}},28:function(w){return{x:w.x+w.width,y:w.y+w.height}},29:function(H,f){return{x:H.x-f.width/2,y:H.y+H.height+f.height/2}},30:function(k,v){return{x:k.x+v.width/2,y:k.y+k.height+v.height/2}},31:function(m,j){return{x:m.x+m.width/2,y:m.y+m.height+j.height/2}},32:function(t,a){return{x:t.x+t.width-a.width/2,y:t.y+t.height+a.height/2}},33:function(v,w){return{x:v.x+v.width+w.width/2,y:v.y+v.height+w.height/2}},34:function(J,b){return{x:J.x,y:J.y-b.height/2}},35:function(j,b){return{x:j.x+j.width,y:j.y-b.height/2}},36:function(i,L){return{x:i.x,y:i.y+i.height+L.height/2}},37:function(c,_){return{x:c.x+c.width,y:c.y+c.height+_.height/2}},38:function(o,S){return{x:o.x+o.width/4,y:o.y-S.height/2}},39:function(N,v){return{x:N.x+3*N.width/4,y:N.y-v.height/2}},40:function(s){return{x:s.x+s.width/4,y:s.y}},41:function(d){return{x:d.x+3*d.width/4,y:d.y}},42:function(y,S){return{x:y.x+y.width/4,y:y.y+S.height/2}},43:function(v,E){return{x:v.x+3*v.width/4,y:v.y+E.height/2}},44:function(O,A){return{x:O.x+O.width/2,y:O.y+O.height/2-A.height/2}},45:function(C){return{x:C.x+C.width/4,y:C.y+C.height/2}},46:function(D,v){return{x:D.x+D.width/2-v.width/2,y:D.y+D.height/2}},47:function(i,g){return{x:i.x+i.width/2+g.width/2,y:i.y+i.height/2}},48:function(o){return{x:o.x+3*o.width/4,y:o.y+o.height/2}},49:function(z,u){return{x:z.x+z.width/2,y:z.y+z.height/2+u.height/2}},50:function(F,S){return{x:F.x+F.width/4,y:F.y+F.height-S.height/2}},51:function(c,z){return{x:c.x+3*c.width/4,y:c.y+c.height-z.height/2}},52:function(j){return{x:j.x+j.width/4,y:j.y+j.height}},53:function(c){return{x:c.x+3*c.width/4,y:c.y+c.height}},54:function(C,r){return{x:C.x+C.width/4,y:C.y+C.height+r.height/2}},55:function(B,$){return{x:B.x+3*B.width/4,y:B.y+B.height+$.height/2}}};return Ll(_)?function(Y,S,u){return V[Y](S,u?u:rg)}:void 0}();Jg(l,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var wj=l.reverse,Uo=l.transparent,ni=l.rectSelectBackground,or=l.dash,vj=l.titleBackground,Hh=l.titleIconBackground,Tk=l.headerBackground,Gl=l.headerIconBackground,kl=l.headerSeparator,pb=l.headerLine,cg=l.contentIconBackground,nd=l.contentLine,ko=(l.widgetIconHighlight,l.widgetIconBorder),Vp=(l.widgetIconGradient,l.imageBackground),dn=l.imageGradient,Xg=l.highlight,Mh=l.label,aj=l.labelSelect;if(tc&&!_.shutAlert1){var Jj=new Date,yk=tc.split("-"),zi=new Date(Jj.getFullYear(),Jj.getMonth(),Jj.getDate()),tc=new Date(Iq(yk[0],10),Iq(yk[1],10)-1,Iq(yk[2],10)),xm=zi.getTime(),rb=tc.getTime(),Wb=X+"_try",nk=_.alert;try{var ng=_.localStorage;if(ng&&nk)if(rb>xm&&1728e6>rb-xm){var sc=(rb-xm)/864e5;ng&&ng[Wb]!=sc&&(ng[Wb]=sc,_.htWillExpire?nk(_.htWillExpire.replace("{{day}}",sc)):nk("HT for Web free trial license will expire in "+sc+" days, please apply for a new license!"))}else xm>=rb&&(_.htExpired?nk(_.htExpired):nk("Your free trial of HT for Web has expired!")),ng&&delete ng[Wb]}catch(Tl){}}Math.sign===D&&(Math.sign=function(m){return 0>m?-1:m>0?1:+m});var iq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Tc={encode:function(G,g){var A,p,H,w,m,a,O,i="",j=0;for(G=unescape(encodeURIComponent(G));j<G.length;)A=G.charCodeAt(j++),p=G.charCodeAt(j++),H=G.charCodeAt(j++),w=A>>2,m=(3&A)<<4|p>>4,a=(15&p)<<2|H>>6,O=63&H,isNaN(p)?a=O=64:isNaN(H)&&(O=64),i=i+g.charAt(w)+g.charAt(m)+g.charAt(a)+g.charAt(O);return i},decode:function(Z,S,f){for(var J,q,Q,s,K,t,e,P="",k=f||0;k<Z.length;)s=S.indexOf(Z.charAt(k++)),K=S.indexOf(Z.charAt(k++)),t=S.indexOf(Z.charAt(k++)),e=S.indexOf(Z.charAt(k++)),J=s<<2|K>>4,q=(15&K)<<4|t>>2,Q=(3&t)<<6|e,P+=String.fromCharCode(J),64!=t&&(P+=String.fromCharCode(q)),64!=e&&(P+=String.fromCharCode(Q));return P=decodeURIComponent(escape(P))},_utf8_encode:function(J){J=J.replace(/\r\n/g,"\n");for(var A="",N=0;N<J.length;N++){var E=J.charCodeAt(N);128>E?A+=String.fromCharCode(E):E>127&&2048>E?(A+=String.fromCharCode(192|E>>6),A+=String.fromCharCode(128|63&E)):(A+=String.fromCharCode(224|E>>12),A+=String.fromCharCode(128|63&E>>6),A+=String.fromCharCode(128|63&E))}return A},_utf8_decode:function(E){for(var x="",W=0,k=0,r=0,u=0;W<E.length;)k=E.charCodeAt(W),128>k?(x+=String.fromCharCode(k),W++):k>191&&224>k?(r=E.charCodeAt(W+1),x+=String.fromCharCode((31&k)<<6|63&r),W+=2):(r=E.charCodeAt(W+1),u=E.charCodeAt(W+2),x+=String.fromCharCode((15&k)<<12|(63&r)<<6|63&u),W+=3);return x}},$f=[],Zr=[],pj=q.Math={generateUUID:function(){for(var d=[],U=0;256>U;U++)d[U]=(16>U?"0":"")+U.toString(16).toUpperCase();return function(){var X=0|4294967295*Math.random(),h=0|4294967295*Math.random(),o=0|4294967295*Math.random(),K=0|4294967295*Math.random();return d[255&X]+d[255&X>>8]+d[255&X>>16]+d[255&X>>24]+"-"+d[255&h]+d[255&h>>8]+"-"+d[64|15&h>>16]+d[255&h>>24]+"-"+d[128|63&o]+d[255&o>>8]+"-"+d[255&o>>16]+d[255&o>>24]+d[255&K]+d[255&K>>8]+d[255&K>>16]+d[255&K>>24]}}(),clamp:function(D,E,b){return Math.max(E,Math.min(b,D))},generateIncreasingID:function(){var A=0;return function(){return++A}}(),encodeBase64:function(h,B){return Tc.encode(h,B||iq)},decodeBase64:function(t,z){return Tc.decode(t,z||iq)},randomArray:function(G,H){H=H||G.length;for(var j=H-1;j>0;j--){var e=Math.floor(Math.random()*(j+1)),O=G[j];G[j]=G[e],G[e]=O}return G},randomInt:function(r,w){return w===D&&(w=r,r=0),r+Math.floor(Math.random()*(w-r))},isPOT:function(s){return s>0&&0===(s-1&s)},nearestPOT:function(j){if(!j)return 1;var g=j;g--,g|=g>>1,g|=g>>2,g|=g>>4,g|=g>>8,g|=g>>16,g++;var G=g>>1;return j-G>g-j?g:G},requestMatrix4:function(){return $f.length>0?$f.pop():new pj.Matrix4},releaseMatrix4:function(d){$f.push(d)},requestVector3:function(){return Zr.length>0?Zr.pop():new pj.Vector3},releaseVector3:function(R){Zr.push(R)}},Qh=q.Matrix=q.Math.Matrix2d=function(o,U,X,L,d){this.setFromTransform(o,U,X,L,d)},Wo=Qh;Qh.prototype={},Qh.prototype.constructor=Qh,Qh.prototype.set=function(k,n,t,r,Q,M){return this.a=k,this.b=n,this.c=t,this.d=r,this.tx=Q,this.ty=M,this},Qh.prototype.setFromTransform=function(F,G,n,m,N){var x=this;if(F===D)return x.a=1,x.b=0,x.c=0,x.d=1,x.tx=0,x.ty=0,void 0;var J,X;return F?(J=P(F),X=Z(F)):(J=0,X=1),m=m||1,N=N||1,x.a=X*m,x.b=J*m,x.c=-J*N,x.d=X*N,x.tx=G||0,x.ty=n||0,x},Qh.prototype.apply=function(Z,L){L=L||new ac;var l=Z.x,R=Z.y;return L.x=this.a*l+this.c*R+this.tx,L.y=this.b*l+this.d*R+this.ty,L},Qh.prototype.applyInverse=function(t,Q){Q=Q||new ac;var v=1/(this.a*this.d+this.c*-this.b),T=t.x,k=t.y;return Q.x=this.d*v*T+-this.c*v*k+(this.ty*this.c-this.tx*this.d)*v,Q.y=this.a*v*k+-this.b*v*T+(-this.ty*this.a+this.tx*this.b)*v,Q},Qh.prototype.translate=function(U,l){return this.tx+=U,this.ty+=l,this},Qh.prototype.scale=function(Q,m){return this.a*=Q,this.d*=m,this.c*=Q,this.b*=m,this.tx*=Q,this.ty*=m,this},Qh.prototype.rotate=function(x){var R=Math.cos(x),_=Math.sin(x),b=this.a,Y=this.c,g=this.tx;return this.a=b*R-this.b*_,this.b=b*_+this.b*R,this.c=Y*R-this.d*_,this.d=Y*_+this.d*R,this.tx=g*R-this.ty*_,this.ty=g*_+this.ty*R,this},Qh.prototype.appendTranslate=function(L,K){return this.tx+=this.a*L+this.c*K,this.ty+=this.b*L+this.d*K,this},Qh.prototype.appendScale=function(X,n){return this.a*=X,this.d*=n,this.c*=n,this.b*=X,this},Qh.prototype.appendRotate=function(x){if(!x)return this;var w=Math.cos(x),M=Math.sin(x),O=this.a,f=this.b;return this.a=O*w+this.c*M,this.b=f*w+this.d*M,this.c=-O*M+this.c*w,this.d=-f*M+this.d*w,this},Qh.prototype.append=function(N){var D=this.a,l=this.b,o=this.c,B=this.d;return this.a=N.a*D+N.b*o,this.b=N.a*l+N.b*B,this.c=N.c*D+N.d*o,this.d=N.c*l+N.d*B,this.tx=N.tx*D+N.ty*o+this.tx,this.ty=N.tx*l+N.ty*B+this.ty,this},Qh.prototype.setTransform=function(a,z,N,D,k,u,v,U,X){var d,w,I,H,$,l,R,q,h,x;return $=Math.sin(v),l=Math.cos(v),R=Math.cos(X),q=Math.sin(X),h=-Math.sin(U),x=Math.cos(U),d=l*k,w=$*k,I=-$*u,H=l*u,this.a=R*d+q*I,this.b=R*w+q*H,this.c=h*d+x*I,this.d=h*w+x*H,this.tx=a+(N*d+D*I),this.ty=z+(N*w+D*H),this},Qh.prototype.prepend=function(K){var k=this.tx;if(1!==K.a||0!==K.b||0!==K.c||1!==K.d){var v=this.a,Q=this.c;this.a=v*K.a+this.b*K.c,this.b=v*K.b+this.b*K.d,this.c=Q*K.a+this.d*K.c,this.d=Q*K.b+this.d*K.d}return this.tx=k*K.a+this.ty*K.c+K.tx,this.ty=k*K.b+this.ty*K.d+K.ty,this},Qh.prototype.transform=Qh.prototype.prepend,Qh.prototype.invert=function(){var D=this.a,m=this.b,T=this.c,b=this.d,l=this.tx,w=D*b-m*T;return this.a=b/w,this.b=-m/w,this.c=-T/w,this.d=D/w,this.tx=(T*this.ty-b*l)/w,this.ty=-(D*this.ty-m*l)/w,this},Qh.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Qh.prototype.clone=function(){var G=new Qh;return G.a=this.a,G.b=this.b,G.c=this.c,G.d=this.d,G.tx=this.tx,G.ty=this.ty,G},Qh.prototype.copy=function(f){return f.a=this.a,f.b=this.b,f.c=this.c,f.d=this.d,f.tx=this.tx,f.ty=this.ty,f},Qh.prototype.tf=function(K,f){1===arguments.length&&(f=K.y,K=K.x);var R=this;return{x:R.a*K+R.c*f+R.tx,y:R.b*K+R.d*f+R.ty}},Qh.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Qh.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Qh.prototype.tfi=function(F,z){1===arguments.length&&(z=F.y,F=F.x);var C=this,f=1/(C.a*C.d+C.c*-C.b);return{x:C.d*f*F+-C.c*f*z+(C.ty*C.c-C.tx*C.d)*f,y:C.a*f*z+-C.b*f*F+(-C.ty*C.a+C.tx*C.b)*f}},Qh.IDENTITY=new Qh,Qh.TEMP_MATRIX=new Qh;var sq=q.Math.Quaternion=function(H,g,Z,Q){this.set(H,g,Z,Q)};t.assign(sq.prototype,{set:function(U,W,L,F){var R=this;return R._x=U||0,R._y=W||0,R._z=L||0,R._w=F!==D?F:1,R},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(d){var j=this;return j._x=d._x,j._y=d._y,j._z=d._z,j._w=d._w,j},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(J){return this._x*J._x+this._y*J._y+this._z*J._z+this._w*J._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var V=this.length();return 0===V?(this._x=0,this._y=0,this._z=0,this._w=1):(V=1/V,this._x=this._x*V,this._y=this._y*V,this._z=this._z*V,this._w=this._w*V),this},fromArray:function(X,T){T===D&&(T=0);var m=this;return m._x=X[T],m._y=X[T+1],m._z=X[T+2],m._w=X[T+3],this},slerp:function(P,g){if(0===g)return this;if(1===g)return this.copy(P);var o=this._x,h=this._y,v=this._z,r=this._w,V=r*P._w+o*P._x+h*P._y+v*P._z;if(0>V?(this._w=-P._w,this._x=-P._x,this._y=-P._y,this._z=-P._z,V=-V):this.copy(P),V>=1)return this._w=r,this._x=o,this._y=h,this._z=v,this;var E=Math.sqrt(1-V*V);if(Math.abs(E)<.001)return this._w=.5*(r+this._w),this._x=.5*(o+this._x),this._y=.5*(h+this._y),this._z=.5*(v+this._z),this;var W=Math.atan2(E,V),O=Math.sin((1-g)*W)/E,p=Math.sin(g*W)/E;return this._w=r*O+this._w*p,this._x=o*O+this._x*p,this._y=h*O+this._y*p,this._z=v*O+this._z*p,this},setFromAxisAngle:function(v,D){var M=D/2,i=Math.sin(M);return this._x=v.x*i,this._y=v.y*i,this._z=v.z*i,this._w=Math.cos(M),this},setFromEuler:function(z){var o=z._x,R=z._y,V=z._z,l=z._order,M=Math.cos,n=Math.sin,Z=M(o/2),k=M(R/2),b=M(V/2),s=n(o/2),j=n(R/2),X=n(V/2);return"XYZ"===l?(this._x=s*k*b+Z*j*X,this._y=Z*j*b-s*k*X,this._z=Z*k*X+s*j*b,this._w=Z*k*b-s*j*X):"YXZ"===l?(this._x=s*k*b+Z*j*X,this._y=Z*j*b-s*k*X,this._z=Z*k*X-s*j*b,this._w=Z*k*b+s*j*X):"ZXY"===l?(this._x=s*k*b-Z*j*X,this._y=Z*j*b+s*k*X,this._z=Z*k*X+s*j*b,this._w=Z*k*b-s*j*X):"ZYX"===l?(this._x=s*k*b-Z*j*X,this._y=Z*j*b+s*k*X,this._z=Z*k*X-s*j*b,this._w=Z*k*b+s*j*X):"YZX"===l?(this._x=s*k*b+Z*j*X,this._y=Z*j*b+s*k*X,this._z=Z*k*X-s*j*b,this._w=Z*k*b-s*j*X):"XZY"===l&&(this._x=s*k*b-Z*j*X,this._y=Z*j*b-s*k*X,this._z=Z*k*X+s*j*b,this._w=Z*k*b+s*j*X),this},setFromRotationMatrix:function(h){var Z,I=h.el,z=I[0],V=I[4],H=I[8],g=I[1],c=I[5],r=I[9],p=I[2],L=I[6],R=I[10],t=z+c+R;return t>0?(Z=.5/Math.sqrt(t+1),this._w=.25/Z,this._x=(L-r)*Z,this._y=(H-p)*Z,this._z=(g-V)*Z):z>c&&z>R?(Z=2*Math.sqrt(1+z-c-R),this._w=(L-r)/Z,this._x=.25*Z,this._y=(V+g)/Z,this._z=(H+p)/Z):c>R?(Z=2*Math.sqrt(1+c-z-R),this._w=(H-p)/Z,this._x=(V+g)/Z,this._y=.25*Z,this._z=(r+L)/Z):(Z=2*Math.sqrt(1+R-z-c),this._w=(g-V)/Z,this._x=(H+p)/Z,this._y=(r+L)/Z,this._z=.25*Z),this},setFromToVectors:function(){var V,a;return function(s,C){return V===D&&(V=new tb),a=s.dot(C)+1,1e-7>a?(a=0,Math.abs(s.x)>Math.abs(s.z)?V.set(-s.y,s.x,0):V.set(0,-s.z,s.y)):V.crossVectors(s,C),this._x=V.x,this._y=V.y,this._z=V.z,this._w=a,this.normalize()}}(),setFromUnitVectors:function(){var f,d,F=1e-6;return function(E,G){return f===D&&(f=new tb),d=E.dot(G)+1,F>d?(d=0,Math.abs(E.x)>Math.abs(E.z)?f.set(-E.y,E.x,0):f.set(0,-E.z,E.y)):f.crossVectors(E,G),this._x=f.x,this._y=f.y,this._z=f.z,this._w=d,this.normalize()}}(),multiply:function(h){return this.multiplyQuaternions(this,h)},premultiply:function(y){return this.multiplyQuaternions(y,this)},multiplyQuaternions:function(l,V){var n=l._x,q=l._y,$=l._z,v=l._w,x=V._x,S=V._y,a=V._z,t=V._w;return this._x=n*t+v*x+q*a-$*S,this._y=q*t+v*S+$*x-n*a,this._z=$*t+v*a+n*S-q*x,this._w=v*t-n*x-q*S-$*a,this},toArray:function(M,A){return M||(M=[]),A=A||0,M[A]=this._x,M[A+1]=this._y,M[A+2]=this._z,M[A+3]=this._w,M}});var lk=q.Math.Vector4=function(T,h,x,k){this.x=T||0,this.y=h||0,this.z=x||0,this.w=k!==D?k:1};t.assign(lk.prototype,{isVector4:!0,set:function(n,z,L,S){return this.x=n,this.y=z,this.z=L,this.w=S,this},setScalar:function(l){return this.x=l,this.y=l,this.z=l,this.w=l,this},setX:function(z){return this.x=z,this},setY:function(Q){return this.y=Q,this},setZ:function(O){return this.z=O,this},setW:function(Z){return this.w=Z,this},setComponent:function(A,V){switch(A){case 0:this.x=V;break;case 1:this.y=V;break;case 2:this.z=V;break;case 3:this.w=V;break;default:throw new Error("index is out of range: "+A)}return this},getComponent:function(P){switch(P){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+P)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(C){return this.x=C.x,this.y=C.y,this.z=C.z,this.w=C.w!==D?C.w:1,this},add:function(x,E){return E!==D?this.addVectors(x,E):(this.x+=x.x,this.y+=x.y,this.z+=x.z,this.w+=x.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(X,p){return this.x=X.x+p.x,this.y=X.y+p.y,this.z=X.z+p.z,this.w=X.w+p.w,this},addScaledVector:function(e,s){return this.x+=e.x*s,this.y+=e.y*s,this.z+=e.z*s,this.w+=e.w*s,this},sub:function(n,U){return U!==D?this.subVectors(n,U):(this.x-=n.x,this.y-=n.y,this.z-=n.z,this.w-=n.w,this)},subScalar:function(h){return this.x-=h,this.y-=h,this.z-=h,this.w-=h,this},subVectors:function(D,R){return this.x=D.x-R.x,this.y=D.y-R.y,this.z=D.z-R.z,this.w=D.w-R.w,this},multiplyScalar:function(Q){return this.x*=Q,this.y*=Q,this.z*=Q,this.w*=Q,this},applyMatrix4:function(S){var $=this.x,f=this.y,m=this.z,w=this.w,Q=S.el;return this.x=Q[0]*$+Q[4]*f+Q[8]*m+Q[12]*w,this.y=Q[1]*$+Q[5]*f+Q[9]*m+Q[13]*w,this.z=Q[2]*$+Q[6]*f+Q[10]*m+Q[14]*w,this.w=Q[3]*$+Q[7]*f+Q[11]*m+Q[15]*w,this},divideScalar:function(z){return this.multiplyScalar(1/z)},setAxisAngleFromQuaternion:function(_){this.w=2*Math.acos(_.w);var P=Math.sqrt(1-_.w*_.w);return 1e-4>P?(this.x=1,this.y=0,this.z=0):(this.x=_.x/P,this.y=_.y/P,this.z=_.z/P),this},setAxisAngleFromRotationMatrix:function(B){var L,r,Y,a,C=.01,n=.1,R=B.el,O=R[0],w=R[4],P=R[8],f=R[1],S=R[5],i=R[9],N=R[2],c=R[6],d=R[10];if(Math.abs(w-f)<C&&Math.abs(P-N)<C&&Math.abs(i-c)<C){if(Math.abs(w+f)<n&&Math.abs(P+N)<n&&Math.abs(i+c)<n&&Math.abs(O+S+d-3)<n)return this.set(1,0,0,0),this;L=Math.PI;var W=(O+1)/2,y=(S+1)/2,z=(d+1)/2,T=(w+f)/4,t=(P+N)/4,_=(i+c)/4;return W>y&&W>z?C>W?(r=0,Y=.707106781,a=.707106781):(r=Math.sqrt(W),Y=T/r,a=t/r):y>z?C>y?(r=.707106781,Y=0,a=.707106781):(Y=Math.sqrt(y),r=T/Y,a=_/Y):C>z?(r=.707106781,Y=.707106781,a=0):(a=Math.sqrt(z),r=t/a,Y=_/a),this.set(r,Y,a,L),this}var p=Math.sqrt((c-i)*(c-i)+(P-N)*(P-N)+(f-w)*(f-w));return Math.abs(p)<.001&&(p=1),this.x=(c-i)/p,this.y=(P-N)/p,this.z=(f-w)/p,this.w=Math.acos((O+S+d-1)/2),this},min:function(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this.z=Math.min(this.z,A.z),this.w=Math.min(this.w,A.w),this},max:function(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this},clamp:function(D,_){return this.x=Math.max(D.x,Math.min(_.x,this.x)),this.y=Math.max(D.y,Math.min(_.y,this.y)),this.z=Math.max(D.z,Math.min(_.z,this.z)),this.w=Math.max(D.w,Math.min(_.w,this.w)),this},clampScalar:function(){var E,L;return function($,v){return E===D&&(E=new lk,L=new lk),E.set($,$,$,$),L.set(v,v,v,v),this.clamp(E,L)}}(),clampLength:function(n,j){var g=this.length();return this.divideScalar(g||1).multiplyScalar(Math.max(n,Math.min(j,g)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(Y){return this.normalize().multiplyScalar(Y)},lerp:function(q,l){return this.x+=(q.x-this.x)*l,this.y+=(q.y-this.y)*l,this.z+=(q.z-this.z)*l,this.w+=(q.w-this.w)*l,this},lerpVectors:function(Z,U,E){return this.subVectors(U,Z).multiplyScalar(E).add(Z)},equals:function(P){return P.x===this.x&&P.y===this.y&&P.z===this.z&&P.w===this.w
},fromArray:function(E,M){return M===D&&(M=0),this.x=E[M],this.y=E[M+1],this.z=E[M+2],this.w=E[M+3],this},toArray:function(k,O){return k===D&&(k=[]),O===D&&(O=0),k[O]=this.x,k[O+1]=this.y,k[O+2]=this.z,k[O+3]=this.w,k},fromBufferAttribute:function(x,H){return this.x=x.getX(H),this.y=x.getY(H),this.z=x.getZ(H),this.w=x.getW(H),this}});var tb=q.Math.Vector3=function(c,n,z){c===D?(this.x=0,this.y=0,this.z=0):"object"==typeof c?this.copy(c):this.set(c,n==D?c:n,z==D?c:z)},se=q.Math.Vector3;t.assign(tb.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(g,M,u){return this.x=g,this.y=M,this.z=u,this},equals:function(U){return U&&this.x===U.x&&this.y===U.y&&this.z===U.z},setScalar:function(A){return this.x=A,this.y=A,this.z=A,this},setX:function(P){return this.x=P,this},setY:function(K){return this.y=K,this},setZ:function(j){return this.z=j,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(L){return L.x===D?(this.x=L[0],this.y=L[1],this.z=L[2]):(this.x=L.x,this.y=L.y,this.z=L.z||0),this},add:function(S){return this.x+=S.x,this.y+=S.y,this.z+=S.z,this},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this},addVectors:function(e,Q){return this.x=e.x+Q.x,this.y=e.y+Q.y,this.z=e.z+Q.z,this},addScaledVector:function(G,k){return this.x+=G.x*k,this.y+=G.y*k,this.z+=G.z*k,this},sub:function(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this},subScalar:function(p){return this.x-=p,this.y-=p,this.z-=p,this},subVectors:function(t,o){return this.x=t.x-o.x,this.y=t.y-o.y,this.z=t.z-o.z,this},divide:function(p){return this.x/=p.x,this.y/=p.y,this.z/=p.z,this},multiply:function(W){return this.x*=W.x,this.y*=W.y,this.z*=W.z,this},multiplyScalar:function(M){return this.x*=M,this.y*=M,this.z*=M,this},divideScalar:function(G){if(0!==G){var p=1/G;this.x*=p,this.y*=p,this.z*=p}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(M){return Math.sqrt(this.distanceToSquared(M))},distanceToSquared:function(p){var o=this.x-p.x,z=this.y-p.y,R=this.z-p.z;return o*o+z*z+R*R},distanceToSquared2:function(M){var m=this.x-M[0],O=this.y-M[1],L=this.z-M[2];return m*m+O*O+L*L},divideVectors:function($,c){return this.x=$.x/c.x,this.y=$.y/c.y,this.z=$.z/c.z,this},multiplyVectors:function(F,U){return this.x=F.x*U.x,this.y=F.y*U.y,this.z=F.z*U.z,this},transformDirection:function(F){var A=this.x,V=this.y,z=this.z,e=F.el;return this.x=e[0]*A+e[4]*V+e[8]*z,this.y=e[1]*A+e[5]*V+e[9]*z,this.z=e[2]*A+e[6]*V+e[10]*z,this.normalize()},applyAxisAngle:function(){var p=new sq;return function(J,L){return this.applyQuaternion(p.setFromAxisAngle(J,L))}}(),applyEuler:function(){var T=new sq;return function(s){return this.applyQuaternion(T.setFromEuler(s))}}(),applyQuaternion:function(U){var E=this.x,p=this.y,Z=this.z,z=U._x,h=U._y,u=U._z,k=U._w,Q=k*E+h*Z-u*p,d=k*p+u*E-z*Z,f=k*Z+z*p-h*E,r=-z*E-h*p-u*Z;return this.x=Q*k+r*-z+d*-u-f*-h,this.y=d*k+r*-h+f*-z-Q*-u,this.z=f*k+r*-u+Q*-h-d*-z,this},applyMatrix4:function(U){var h=this.x,d=this.y,Y=this.z,J=U.el,M=1/(J[3]*h+J[7]*d+J[11]*Y+J[15]);return this.x=(J[0]*h+J[4]*d+J[8]*Y+J[12])*M,this.y=(J[1]*h+J[5]*d+J[9]*Y+J[13])*M,this.z=(J[2]*h+J[6]*d+J[10]*Y+J[14])*M,this},applyMatrix3:function(W){var M=this.x,B=this.y,e=this.z,d=W.el;return this.x=d[0]*M+d[3]*B+d[6]*e,this.y=d[1]*M+d[4]*B+d[7]*e,this.z=d[2]*M+d[5]*B+d[8]*e,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var E=new tb;return function(I){return this.sub(E.copy(I).multiplyScalar(2*this.dot(I)))}}(),dot:function(p){return this.x*p.x+this.y*p.y+this.z*p.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var n=this.length();return n?this.multiplyScalar(1/n):this},setLength:function(n){return this.normalize().multiplyScalar(n)},fromArray:function(w,m){return m===D&&(m=0),this.x=w[m],this.y=w[m+1],this.z=w[m+2],this},toArray:function(q,B){return q===D&&(q=[0,0,0]),B===D&&(B=0),q[B]=this.x,q[B+1]=this.y,q[B+2]=this.z,q},cross:function(s){return this.crossVectors(this,s)},angleTo:function(G){var p=this.dot(G)/Math.sqrt(this.lengthSq()*G.lengthSq());return p>1||-1>p?0:Math.acos(p)},lerp:function(N,Q){return this.x+=(N.x-this.x)*Q,this.y+=(N.y-this.y)*Q,this.z+=(N.z-this.z)*Q,this},lerpVectors:function(K,C,H){return this.subVectors(C,K).multiplyScalar(H).add(K)},crossVectors:function(J,G){var v=J.x,B=J.y,A=J.z,$=G.x,c=G.y,W=G.z;return this.x=B*W-A*c,this.y=A*$-v*W,this.z=v*c-B*$,this},min:function(S){return this.x=Math.min(this.x,S.x),this.y=Math.min(this.y,S.y),this.z=Math.min(this.z,S.z),this},max:function(G){return this.x=Math.max(this.x,G.x),this.y=Math.max(this.y,G.y),this.z=Math.max(this.z,G.z),this},setFromMatrixPosition:function(C){return this.setFromMatrixColumn(C,3)},setFromMatrixScale:function(g){var I=this.setFromMatrixColumn(g,0).length(),G=this.setFromMatrixColumn(g,1).length(),e=this.setFromMatrixColumn(g,2).length();return this.x=I,this.y=G,this.z=e,this},setFromMatrixColumn:function(i,d){return this.fromArray(i.el,4*d)}});var ac=q.Math.Vector2=function(k,B,L){"object"==typeof k&&(k.x!=D?(B=k.y,L=k.e,k=k.x):(L=k[2],B=k[1],k=k[0])),this.set(k||0,B||0,L)};ac.prototype={},ac.prototype.constructor=ac;var Lc=ac;t.defineProperties(ac.prototype,{width:{get:function(){return this.x},set:function(P){this.x=P}},height:{get:function(){return this.y},set:function(N){this.y=N}}}),ac.prototype.clone=function(){return new ac(this.x,this.y,this.e)},ac.prototype.copy=function(j){return this.set(j.x,j.y,j.e),this},ac.prototype.equals=function(Y){return Y.x===this.x&&Y.y===this.y&&Y.e===this.e},ac.prototype.set=function(Y,g,k){return this.x=Y||0,this.y=g||(0!==g?this.x:0),k!=D&&(this.e=k),this},ac.prototype.setScalar=function(A){return this.x=A,this.y=A,this.e=A,this},ac.prototype.setX=function(M){return this.x=M||0,this},ac.prototype.setY=function(U){return this.y=U||0,this},ac.prototype.setE=function(z){return this.e=z||0,this},ac.prototype.add=function(L){return this.x+=L.x,this.y+=L.y,this},ac.prototype.addVectors=function(W,s){return this.x=W.x+s.x,this.y=W.y+s.y,this},ac.prototype.addScalar=function(X){return this.x+=X,this.y+=X,this},ac.prototype.addScaledVector=function(a,Y){return this.x+=a.x*Y,this.y+=a.y*Y,this},ac.prototype.sub=function(f){return this.x-=f.x,this.y-=f.y,this},ac.prototype.subScalar=function(L){return this.x-=L,this.y-=L,this},ac.prototype.subVectors=function(K,u){return this.x=K.x-u.x,this.y=K.y-u.y,this},ac.prototype.multiply=function(y){return this.x*=y.x,this.y*=y.y,this},ac.prototype.multiplyScalar=function(d){return this.x*=d,this.y*=d,this},ac.prototype.divide=function(Y){return this.x/=Y.x,this.y/=Y.y,this},ac.prototype.divideScalar=function($){return this.multiplyScalar(1/$)},ac.prototype.min=function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this},ac.prototype.max=function(y){return this.x=Math.max(this.x,y.x),this.y=Math.max(this.y,y.y),this},ac.prototype.fromArray=function($,G){return G===D&&(G=0),this.x=$[G],this.y=$[G+1],this},ac.prototype.clamp=function(m,f){return this.x=Math.max(m.x,Math.min(f.x,this.x)),this.y=Math.max(m.y,Math.min(f.y,this.y)),this},ac.prototype.clampScalar=function(){var S,t;return function(w,A){return S===D&&(S=new ac,t=new ac),S.set(w,w),t.set(A,A),this.clamp(S,t)}}(),ac.prototype.clampLength=function(Y,H){var d=this.length();return this.multiplyScalar(Math.max(Y,Math.min(H,d))/d)},ac.prototype.dot=function(y){return this.x*y.x+this.y*y.y},ac.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},ac.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},ac.prototype.normalize=function(){return this.divideScalar(this.length())},ac.prototype.angle=function(){var F=Math.atan2(this.y,this.x);return 0>F&&(F+=2*Math.PI),F},ac.prototype.distanceTo=function(k){return Math.sqrt(this.distanceToSquared(k))},ac.prototype.distanceToSquared=function(d){var P=this.x-d.x,Z=this.y-d.y;return P*P+Z*Z},ac.prototype.isNearEnough=function(e){return this.distanceToSquared(e)<1e-8},ac.prototype.setLength=function(i){var u=this.length();return u?this.multiplyScalar(i/u):this},ac.prototype.lerp=function(K,z){return this.x+=(K.x-this.x)*z,this.y+=(K.y-this.y)*z,"number"==typeof K.e&&"number"==typeof this.e&&(this.e+=(K.e-this.e)*z),this},ac.prototype.lerpVectors=function(J,i,r){return this.subVectors(i,J).multiplyScalar(r).add(J)},ac.prototype.rotateAround=function(R,l){var D=R?R.x:0,o=R?R.y:0,z=Math.cos(l),Z=Math.sin(l),u=this.x-D,O=this.y-o;return this.x=u*z-O*Z+D,this.y=u*Z+O*z+o,this};var Pb=q.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};t.assign(Pb.prototype,{isMatrix3:!0,set:function(j,y,Q,J,A,O,p,F,g){var H=this.el;return H[0]=j,H[1]=J,H[2]=p,H[3]=y,H[4]=A,H[5]=F,H[6]=Q,H[7]=O,H[8]=g,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(_){var j=this.el,K=_.el;return j[0]=K[0],j[1]=K[1],j[2]=K[2],j[3]=K[3],j[4]=K[4],j[5]=K[5],j[6]=K[6],j[7]=K[7],j[8]=K[8],this},setFromMatrix4:function(O){var N=O.el;return this.set(N[0],N[4],N[8],N[1],N[5],N[9],N[2],N[6],N[10]),this},applyToBufferAttribute:function(){var R=new tb;return function(q){for(var F=0,m=q.count;m>F;F++)R.x=q.getX(F),R.y=q.getY(F),R.z=q.getZ(F),R.applyMatrix3(this),q.setXYZ(F,R.x,R.y,R.z);return q}}(),multiply:function(y){return this.multiplyMatrices(this,y)},premultiply:function(r){return this.multiplyMatrices(r,this)},multiplyMatrices:function(d,I){var j=d.el,J=I.el,c=this.el,X=j[0],Y=j[3],s=j[6],M=j[1],b=j[4],p=j[7],V=j[2],k=j[5],t=j[8],B=J[0],G=J[3],l=J[6],A=J[1],U=J[4],Q=J[7],w=J[2],m=J[5],P=J[8];return c[0]=X*B+Y*A+s*w,c[3]=X*G+Y*U+s*m,c[6]=X*l+Y*Q+s*P,c[1]=M*B+b*A+p*w,c[4]=M*G+b*U+p*m,c[7]=M*l+b*Q+p*P,c[2]=V*B+k*A+t*w,c[5]=V*G+k*U+t*m,c[8]=V*l+k*Q+t*P,this},multiplyScalar:function(l){var s=this.el;return s[0]*=l,s[3]*=l,s[6]*=l,s[1]*=l,s[4]*=l,s[7]*=l,s[2]*=l,s[5]*=l,s[8]*=l,this},determinant:function(){var u=this.el,s=u[0],l=u[1],c=u[2],d=u[3],E=u[4],n=u[5],M=u[6],Z=u[7],b=u[8];return s*E*b-s*n*Z-l*d*b+l*n*M+c*d*Z-c*E*M},getInverse:function(B){var $=B.el,g=this.el,w=$[0],o=$[1],R=$[2],h=$[3],y=$[4],x=$[5],D=$[6],S=$[7],I=$[8],u=I*y-x*S,C=x*D-I*h,Q=S*h-y*D,O=w*u+o*C+R*Q;if(0===O)return this.identity();var d=1/O;return g[0]=u*d,g[1]=(R*S-I*o)*d,g[2]=(x*o-R*y)*d,g[3]=C*d,g[4]=(I*w-R*D)*d,g[5]=(R*h-x*w)*d,g[6]=Q*d,g[7]=(o*D-S*w)*d,g[8]=(y*w-o*h)*d,this},transpose:function(){var l,n=this.el;return l=n[1],n[1]=n[3],n[3]=l,l=n[2],n[2]=n[6],n[6]=l,l=n[5],n[5]=n[7],n[7]=l,this},getNormalMatrix:function(l){return this.setFromMatrix4(l).getInverse(this).transpose()},transposeIntoArray:function(d){var z=this.el;return d[0]=z[0],d[1]=z[3],d[2]=z[6],d[3]=z[1],d[4]=z[4],d[5]=z[7],d[6]=z[2],d[7]=z[5],d[8]=z[8],this},setUvTransform:function(R,N,x,E,Q,j,m){var X=Math.cos(Q),d=Math.sin(Q);this.set(x*X,x*d,-x*(X*j+d*m)+j+R,-E*d,E*X,-E*(-d*j+X*m)+m+N,0,0,1)},scale:function(r,i){var a=this.el;return a[0]*=r,a[3]*=r,a[6]*=r,a[1]*=i,a[4]*=i,a[7]*=i,this},rotate:function(H){var Q=Math.cos(H),u=Math.sin(H),Z=this.el,K=Z[0],T=Z[3],t=Z[6],B=Z[1],Y=Z[4],U=Z[7];return Z[0]=Q*K+u*B,Z[3]=Q*T+u*Y,Z[6]=Q*t+u*U,Z[1]=-u*K+Q*B,Z[4]=-u*T+Q*Y,Z[7]=-u*t+Q*U,this},translate:function(s,D){var c=this.el;return c[0]+=s*c[2],c[3]+=s*c[5],c[6]+=s*c[8],c[1]+=D*c[2],c[4]+=D*c[5],c[7]+=D*c[8],this},equals:function(Z){for(var x=this.el,u=Z.el,t=0;9>t;t++)if(x[t]!==u[t])return!1;return!0},fromArray:function(T,S){S===D&&(S=0);for(var l=0;9>l;l++)this.el[l]=T[l+S];return this},toArray:function(x,u){x===D&&(x=[]),u===D&&(u=0);var Y=this.el;return x[u]=Y[0],x[u+1]=Y[1],x[u+2]=Y[2],x[u+3]=Y[3],x[u+4]=Y[4],x[u+5]=Y[5],x[u+6]=Y[6],x[u+7]=Y[7],x[u+8]=Y[8],x}});var Di=q.Math.Plane=function(m,I){this.normal=m!==D?m:new tb(1,0,0),this.constant=I!==D?I:0};t.assign(Di.prototype,{set:function(O,S){return this.normal.copy(O),this.constant=S,this},setComponents:function(t,B,h,w){return this.normal.set(t,B,h),this.constant=w,this},setFromNormalAndCoplanarPoint:function(h,e){return this.normal.copy(h),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var d=new tb,O=new tb;return function(q,c,X){var L=d.subVectors(X,c).cross(O.subVectors(q,c)).normalize();return this.setFromNormalAndCoplanarPoint(L,q),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(M){return this.normal.copy(M.normal),this.constant=M.constant,this},normalize:function(){var W=1/this.normal.length();return this.normal.multiplyScalar(W),this.constant*=W,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(v){return this.normal.dot(v)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(n,S){return S===D&&(S=new tb),S.copy(this.normal).multiplyScalar(-this.distanceToPoint(n)).add(n)},intersectLine:function(){var Q=new tb;return function(N,t){t===D&&(t=new tb);var f=N.delta(Q),V=this.normal.dot(f);if(0===V)return 0===this.distanceToPoint(N.start)?t.copy(N.start):D;var v=-(N.start.dot(this.normal)+this.constant)/V;return 0>v||v>1?D:t.copy(f).multiplyScalar(v).add(N.start)}}(),intersectsLine:function(y){var J=this.distanceToPoint(y.start),N=this.distanceToPoint(y.end);return 0>J&&N>0||0>N&&J>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(p){return p.intersectsPlane(this)},coplanarPoint:function(q){return q===D&&(q=new tb),q.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var j=new tb,i=new Pb;return function(S,L){var O=L||i.getNormalMatrix(S),_=this.coplanarPoint(j).applyMatrix4(S),b=this.normal.applyMatrix3(O).normalize();return this.constant=-_.dot(b),this}}(),translate:function(d){return this.constant-=d.dot(this.normal),this},equals:function(G){return G.normal.equals(this.normal)&&G.constant===this.constant}});var eo=q.Math.Ray=function(t,W){this.origin=t!==D?t.clone():new tb,this.direction=W!==D?W.clone():new tb};t.assign(eo.prototype,{set:function(x,_){return this.origin.copy(x),this.direction.copy(_),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Q){return this.origin.copy(Q.origin),this.direction.copy(Q.direction),this.maxHitLen=Q.maxHitLen,this},at:function(p,u){var o=u||new tb;return o.copy(this.direction).multiplyScalar(p).add(this.origin)},setMaxHitLength:function(Y){this.maxHitLen=Y},lookAt:function(d){return this.direction.copy(d).sub(this.origin).normalize(),this},applyMatrix4:function(x){var Q=this.maxHitLen;if(Q){var N=this.direction.clone().multiplyScalar(Q).add(this.origin);N.applyMatrix4(x)}return this.origin.applyMatrix4(x),this.direction.transformDirection(x),Q&&(this.maxHitLen=this.origin.distanceTo(N)),this},distanceToPlane:function(g){var x=g.normal.dot(this.direction);if(0===x)return 0===g.distanceToPoint(this.origin)?0:null;var d=-(this.origin.dot(g.normal)+g.constant)/x;return d>=0?d:null},intersectPlane:function(V,J){var N=this.distanceToPlane(V);return null===N?null:this.at(N,J)},intersectSphere:function(){var g=new tb;return function(X,f){g.subVectors(X.center,this.origin);var h=g.dot(this.direction),O=g.dot(g)-h*h,p=X.radius*X.radius;if(O>p)return null;var L=Math.sqrt(p-O),R=h-L,Y=h+L;return 0>R&&0>Y?null:0>R?this.at(Y,f):this.at(R,f)}}(),intersectEllipsoid:function(){var J=new tb,z=new tb;return function(Q,h){J.subVectors(Q.center,this.origin),J.divide(Q.radius),z.divideVectors(this.direction,Q.radius);var T=z.lengthSq(),C=J.dot(z),U=J.dot(J)*T-C*C;if(U>T)return null;var S=Math.sqrt(T-U),c=(C-S)/T,D=(C+S)/T;return 0>c&&0>D?null:0>c?this.at(D,h):this.at(c,h)}}(),intersectBox:function(S,C){var F,H,r,f,x,O,y=1/this.direction.x,Q=1/this.direction.y,Y=1/this.direction.z,z=this.origin;if(y>=0?(F=(S.min.x-z.x)*y,H=(S.max.x-z.x)*y):(F=(S.max.x-z.x)*y,H=(S.min.x-z.x)*y),Q>=0?(r=(S.min.y-z.y)*Q,f=(S.max.y-z.y)*Q):(r=(S.max.y-z.y)*Q,f=(S.min.y-z.y)*Q),F>f||r>H)return null;if((r>F||F!==F)&&(F=r),(H>f||H!==H)&&(H=f),Y>=0?(x=(S.min.z-z.z)*Y,O=(S.max.z-z.z)*Y):(x=(S.max.z-z.z)*Y,O=(S.min.z-z.z)*Y),F>O||x>H)return null;if((x>F||F!==F)&&(F=x),(H>O||H!==H)&&(H=O),0>H)return null;var M=F>=0?F:H,k=this.maxHitLen;return k&&M>k?null:this.at(M,C)},intersectTriangle:function(){var g=new tb,h=new tb,s=new tb,I=new tb;return function(m,a,K,o,G){h.subVectors(a,m),s.subVectors(K,m),I.crossVectors(h,s);var e,C=this.direction.dot(I);if(C>0){if(o)return null;e=1}else{if(!(0>C))return null;e=-1,C=-C}g.subVectors(this.origin,m);var p=e*this.direction.dot(s.crossVectors(g,s));if(0>p)return null;var n=e*this.direction.dot(h.cross(g));if(0>n||p+n>C)return null;var b=-e*g.dot(I);if(0>b)return null;var H=b/C,r=this.maxHitLen;return r&&H>r?null:this.at(H,G)}}()});var jl=q.Math.Box3=function(g,Q){this.min=g!==D?g:new tb(1/0,1/0,1/0),this.max=Q!==D?Q:new tb(-1/0,-1/0,-1/0)};t.assign(jl.prototype,{set:function(p,Z){return this.min.copy(p),this.max.copy(Z),this},setFromArray:function(h){for(var p=1/0,i=1/0,d=1/0,c=-1/0,f=-1/0,_=-1/0,V=0,P=h.length;P>V;V+=3){var e=h[V],H=h[V+1],E=h[V+2];p>e&&(p=e),i>H&&(i=H),d>E&&(d=E),e>c&&(c=e),H>f&&(f=H),E>_&&(_=E)}return this.min.set(p,i,d),this.max.set(c,f,_),this},setFromPoints:function(U){this.makeEmpty();for(var j=0,T=U.length;T>j;j++)this.expandByPoint(U[j]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},copy:function(f){return this.min.copy(f.min),this.max.copy(f.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(O){return this.min.min(O),this.max.max(O),this},expandByBox:function(A){return this.min.min(A.min),this.max.max(A.max),this},applyMatrix4:function(){var k=[new tb,new tb,new tb,new tb,new tb,new tb,new tb,new tb];return function(f){return this.isEmpty()?this:(k[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(f),k[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(f),k[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(f),k[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(f),k[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(f),k[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(f),k[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(f),k[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(f),this.setFromPoints(k),this)}}()});var te=q.Math.Sphere=function(W,S){this.center=W!==D?W:new tb,this.radius=S!==D?S:0};t.assign(te.prototype,{set:function(l,x){return this.center.copy(l),this.radius=x,this},setFromPoints:function(){var Q=new jl;return function(I,a){var p=this.center;a!==D?p.copy(a):Q.setFromPoints(I).getCenter(p);for(var C=0,N=0,y=I.length;y>N;N++)C=Math.max(C,p.distanceToSquared(I[N]));return this.radius=Math.sqrt(C),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(g){return this.center.copy(g.center),this.radius=g.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(U){return U.distanceTo(this.center)-this.radius},intersectsSphere:function(h){var l=this.radius+h.radius;return h.center.distanceToSquared(this.center)<=l*l},intersectsBox:function(s){return s.intersectsSphere(this)},intersectsPlane:function(x){return Math.abs(x.distanceToPoint(this.center))<=this.radius},clampPoint:function(i,E){var H=this.center.distanceToSquared(i);return E===D&&(E=new tb),E.copy(i),H>this.radius*this.radius&&(E.sub(this.center).normalize(),E.multiplyScalar(this.radius).add(this.center)),E},getBoundingBox:function(Q){return Q===D&&(Q=new jl),Q.set(this.center,this.center),Q.expandByScalar(this.radius),Q},applyMatrix4:function(c){return this.center.applyMatrix4(c),this.radius=this.radius*c.getMaxScaleOnAxis(),this},translate:function(k){return this.center.add(k),this},equals:function(y){return y.center.equals(this.center)&&y.radius===this.radius}});var re=q.Math.Frustum=function(h,X,$,Q,Z,O){this.planes=[h!==D?h:new Di,X!==D?X:new Di,$!==D?$:new Di,Q!==D?Q:new Di,Z!==D?Z:new Di,O!==D?O:new Di]};t.assign(re.prototype,{set:function(f,n,B,k,m,Q){var L=this.planes;return L[0].copy(f),L[1].copy(n),L[2].copy(B),L[3].copy(k),L[4].copy(m),L[5].copy(Q),this},clone:function(){return(new this.constructor).copy(this)},copy:function(A){for(var f=this.planes,l=0;6>l;l++)f[l].copy(A.planes[l]);return this},setFromMatrix:function(X){var c=this.planes,a=X.el,j=a[0],o=a[1],p=a[2],g=a[3],q=a[4],t=a[5],Y=a[6],N=a[7],E=a[8],l=a[9],d=a[10],W=a[11],r=a[12],H=a[13],F=a[14],C=a[15];return c[0].setComponents(g-j,N-q,W-E,C-r).normalize(),c[1].setComponents(g+j,N+q,W+E,C+r).normalize(),c[2].setComponents(g+o,N+t,W+l,C+H).normalize(),c[3].setComponents(g-o,N-t,W-l,C-H).normalize(),c[4].setComponents(g-p,N-Y,W-d,C-F).normalize(),c[5].setComponents(g+p,N+Y,W+d,C+F).normalize(),this},intersectsObject:function(){var u=new te;return function(y){var c=y.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),u.copy(c.boundingSphere).applyMatrix4(y.matrixWorld),this.intersectsSphere(u)}}(),intersectsSprite:function(){var R=new te;return function(J){return R.center.set(0,0,0),R.radius=.7071067811865476,R.applyMatrix4(J.matrixWorld),this.intersectsSphere(R)}}(),intersectsSphere:function(B){for(var C=this.planes,A=B.center,t=-B.radius,w=0;6>w;w++){var g=C[w].distanceToPoint(A);if(t>g)return!1}return!0},intersectsBox:function(){var V=new tb;return function(q){for(var O=this.planes,_=0;6>_;_++){var y=O[_];if(V.x=y.normal.x>0?q.max.x:q.min.x,V.y=y.normal.y>0?q.max.y:q.min.y,V.z=y.normal.z>0?q.max.z:q.min.z,y.distanceToPoint(V)<0)return!1}return!0}}(),containsPoint:function(_){for(var F=this.planes,p=0;6>p;p++)if(F[p].distanceToPoint(_)<0)return!1;return!0}});var ds=q.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};t.assign(ds.prototype,{set:function(l,C,I,S,O,N,z,x,e,Z,p,m,R,M,h,b){var P=this.el;return P[0]=l,P[4]=C,P[8]=I,P[12]=S,P[1]=O,P[5]=N,P[9]=z,P[13]=x,P[2]=e,P[6]=Z,P[10]=p,P[14]=m,P[3]=R,P[7]=M,P[11]=h,P[15]=b,this},clone:function(){return(new ds).fromArray(this.el)},fromArray:function(h,R){R===D&&(R=0);for(var V=this.el,w=0;16>w;w++)V[w]=h[w+R];return this},getElements:function(){return this.el},scale:function(I){var D=this.el,M=I.x,O=I.y,u=I.z;return D[0]*=M,D[4]*=O,D[8]*=u,D[1]*=M,D[5]*=O,D[9]*=u,D[2]*=M,D[6]*=O,D[10]*=u,D[3]*=M,D[7]*=O,D[11]*=u,this},makeRotationFromEuler:function(Z){var c=this.el,m=Z._x,W=Z._y,R=Z._z,g=Z._order,u=Math.cos(m),k=Math.sin(m),p=Math.cos(W),d=Math.sin(W),X=Math.cos(R),P=Math.sin(R);if("XYZ"===g){var D=u*X,l=u*P,Q=k*X,K=k*P;c[0]=p*X,c[4]=-p*P,c[8]=d,c[1]=l+Q*d,c[5]=D-K*d,c[9]=-k*p,c[2]=K-D*d,c[6]=Q+l*d,c[10]=u*p}else if("YXZ"===g){var A=p*X,x=p*P,M=d*X,q=d*P;c[0]=A+q*k,c[4]=M*k-x,c[8]=u*d,c[1]=u*P,c[5]=u*X,c[9]=-k,c[2]=x*k-M,c[6]=q+A*k,c[10]=u*p}else if("ZXY"===g){var A=p*X,x=p*P,M=d*X,q=d*P;c[0]=A-q*k,c[4]=-u*P,c[8]=M+x*k,c[1]=x+M*k,c[5]=u*X,c[9]=q-A*k,c[2]=-u*d,c[6]=k,c[10]=u*p}else if("ZYX"===g){var D=u*X,l=u*P,Q=k*X,K=k*P;c[0]=p*X,c[4]=Q*d-l,c[8]=D*d+K,c[1]=p*P,c[5]=K*d+D,c[9]=l*d-Q,c[2]=-d,c[6]=k*p,c[10]=u*p}else if("YZX"===g){var F=u*p,J=u*d,V=k*p,j=k*d;c[0]=p*X,c[4]=j-F*P,c[8]=V*P+J,c[1]=P,c[5]=u*X,c[9]=-k*X,c[2]=-d*X,c[6]=J*P+V,c[10]=F-j*P}else if("XZY"===g){var F=u*p,J=u*d,V=k*p,j=k*d;c[0]=p*X,c[4]=-P,c[8]=d*X,c[1]=F*P+j,c[5]=u*X,c[9]=J*P-V,c[2]=V*P-J,c[6]=k*X,c[10]=j*P+F}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this},makeRotationFromQuaternion:function(j){var W=this.el,M=j._x,D=j._y,y=j._z,K=j._w,L=M+M,v=D+D,d=y+y,g=M*L,V=M*v,c=M*d,h=D*v,F=D*d,n=y*d,G=K*L,$=K*v,a=K*d;return W[0]=1-(h+n),W[4]=V-a,W[8]=c+$,W[1]=V+a,W[5]=1-(g+n),W[9]=F-G,W[2]=c-$,W[6]=F+G,W[10]=1-(g+h),W[3]=0,W[7]=0,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function($){var t=this.el,Z=$.el,g=Z[0],y=Z[1],r=Z[2],A=Z[3],F=Z[4],v=Z[5],x=Z[6],m=Z[7],b=Z[8],R=Z[9],M=Z[10],s=Z[11],X=Z[12],c=Z[13],h=Z[14],E=Z[15],i=R*h*m-c*M*m+c*x*s-v*h*s-R*x*E+v*M*E,T=X*M*m-b*h*m-X*x*s+F*h*s+b*x*E-F*M*E,d=b*c*m-X*R*m+X*v*s-F*c*s-b*v*E+F*R*E,L=X*R*x-b*c*x-X*v*M+F*c*M+b*v*h-F*R*h,N=g*i+y*T+r*d+A*L;if(0===N)return this.identity();var q=1/N;return t[0]=i*q,t[1]=(c*M*A-R*h*A-c*r*s+y*h*s+R*r*E-y*M*E)*q,t[2]=(v*h*A-c*x*A+c*r*m-y*h*m-v*r*E+y*x*E)*q,t[3]=(R*x*A-v*M*A-R*r*m+y*M*m+v*r*s-y*x*s)*q,t[4]=T*q,t[5]=(b*h*A-X*M*A+X*r*s-g*h*s-b*r*E+g*M*E)*q,t[6]=(X*x*A-F*h*A-X*r*m+g*h*m+F*r*E-g*x*E)*q,t[7]=(F*M*A-b*x*A+b*r*m-g*M*m-F*r*s+g*x*s)*q,t[8]=d*q,t[9]=(X*R*A-b*c*A-X*y*s+g*c*s+b*y*E-g*R*E)*q,t[10]=(F*c*A-X*v*A+X*y*m-g*c*m-F*y*E+g*v*E)*q,t[11]=(b*v*A-F*R*A-b*y*m+g*R*m+F*y*s-g*v*s)*q,t[12]=L*q,t[13]=(b*c*r-X*R*r+X*y*M-g*c*M-b*y*h+g*R*h)*q,t[14]=(X*v*r-F*c*r-X*y*x+g*c*x+F*y*h-g*v*h)*q,t[15]=(F*R*r-b*v*r+b*y*x-g*R*x-F*y*M+g*v*M)*q,this},makeRotationAxis:function(x,t){var S=Math.cos(t),W=Math.sin(t),Q=1-S,d=x.x,k=x.y,b=x.z,m=Q*d,J=Q*k;return this.set(m*d+S,m*k-W*b,m*b+W*k,0,m*k+W*b,J*k+S,J*b-W*d,0,m*b-W*k,J*b+W*d,Q*b*b+S,0,0,0,0,1),this},multiply:function(K){return this.multiplyMatrices(this,K)},premultiply:function(b){return this.multiplyMatrices(b,this)},multiplyMatrices:function(C,h){var Q=C.el,m=h.el,L=this.el,E=Q[0],q=Q[4],v=Q[8],H=Q[12],p=Q[1],U=Q[5],$=Q[9],g=Q[13],Z=Q[2],u=Q[6],d=Q[10],S=Q[14],c=Q[3],D=Q[7],o=Q[11],l=Q[15],Y=m[0],b=m[4],w=m[8],f=m[12],a=m[1],W=m[5],N=m[9],I=m[13],R=m[2],t=m[6],k=m[10],e=m[14],r=m[3],J=m[7],B=m[11],P=m[15];return L[0]=E*Y+q*a+v*R+H*r,L[4]=E*b+q*W+v*t+H*J,L[8]=E*w+q*N+v*k+H*B,L[12]=E*f+q*I+v*e+H*P,L[1]=p*Y+U*a+$*R+g*r,L[5]=p*b+U*W+$*t+g*J,L[9]=p*w+U*N+$*k+g*B,L[13]=p*f+U*I+$*e+g*P,L[2]=Z*Y+u*a+d*R+S*r,L[6]=Z*b+u*W+d*t+S*J,L[10]=Z*w+u*N+d*k+S*B,L[14]=Z*f+u*I+d*e+S*P,L[3]=c*Y+D*a+o*R+l*r,L[7]=c*b+D*W+o*t+l*J,L[11]=c*w+D*N+o*k+l*B,L[15]=c*f+D*I+o*e+l*P,this},lookAt:function(){var q=new tb;return function(W,l,N){return q.subVectors(W,l),this.lookAtDirection(q,N)}}(),lookAtDirection:function(){var I=new tb,M=new tb,u=new tb;return function(H,w){var F=this.el;return u.copy(H),0===u.lengthSq()&&(u.z=1),u.normalize(),I.crossVectors(w,u),0===I.lengthSq()&&(1===Math.abs(w.z)?u.x+=1e-4:u.z+=1e-4,u.normalize(),I.crossVectors(w,u)),I.normalize(),M.crossVectors(u,I),F[0]=I.x,F[4]=M.x,F[8]=u.x,F[1]=I.y,F[5]=M.y,F[9]=u.y,F[2]=I.z,F[6]=M.z,F[10]=u.z,this}}(),extractScale:function(){var t;return function(Q){t===D&&(t=new tb),Q===D&&(Q=new tb);var o=t.setFromMatrixColumn(this,0).length(),p=t.setFromMatrixColumn(this,1).length(),q=t.setFromMatrixColumn(this,2).length();return Q.set(o,p,q),Q}}(),extractRotation:function(){var c;return function(a){c===D&&(c=new tb),a===D&&(a=new ds);var I=this.el,w=a.el,L=1/c.setFromMatrixColumn(a,0).length(),z=1/c.setFromMatrixColumn(a,1).length(),q=1/c.setFromMatrixColumn(a,2).length();return I[0]=w[0]*L,I[1]=w[1]*L,I[2]=w[2]*L,I[4]=w[4]*z,I[5]=w[5]*z,I[6]=w[6]*z,I[8]=w[8]*q,I[9]=w[9]*q,I[10]=w[10]*q,this}}(),multiplyScalar:function(O){var x=this.el;return x[0]*=O,x[4]*=O,x[8]*=O,x[12]*=O,x[1]*=O,x[5]*=O,x[9]*=O,x[13]*=O,x[2]*=O,x[6]*=O,x[10]*=O,x[14]*=O,x[3]*=O,x[7]*=O,x[11]*=O,x[15]*=O,this},getPosition:function(O){return O===D&&(O=new tb),O.setFromMatrixColumn(this,3)},setPosition:function(Y){var j=this.el;return j[12]=Y.x,j[13]=Y.y,j[14]=Y.z,this},toArray:function($,f){$===D&&($=[]),f===D&&(f=0);var V=this.el;return $[f]=V[0],$[f+1]=V[1],$[f+2]=V[2],$[f+3]=V[3],$[f+4]=V[4],$[f+5]=V[5],$[f+6]=V[6],$[f+7]=V[7],$[f+8]=V[8],$[f+9]=V[9],$[f+10]=V[10],$[f+11]=V[11],$[f+12]=V[12],$[f+13]=V[13],$[f+14]=V[14],$[f+15]=V[15],$},determinant:function(){var W=this.el,U=W[0],s=W[4],l=W[8],D=W[12],S=W[1],R=W[5],I=W[9],V=W[13],O=W[2],t=W[6],v=W[10],_=W[14],P=W[3],m=W[7],M=W[11],Y=W[15];return P*(+D*I*t-l*V*t-D*R*v+s*V*v+l*R*_-s*I*_)+m*(+U*I*_-U*V*v+D*S*v-l*S*_+l*V*O-D*I*O)+M*(+U*V*t-U*R*_-D*S*t+s*S*_+D*R*O-s*V*O)+Y*(-l*R*O-U*I*t+U*R*v+l*S*t-s*S*v+s*I*O)},copy:function(j){var n=this.el,V=j.el;return n[0]=V[0],n[1]=V[1],n[2]=V[2],n[3]=V[3],n[4]=V[4],n[5]=V[5],n[6]=V[6],n[7]=V[7],n[8]=V[8],n[9]=V[9],n[10]=V[10],n[11]=V[11],n[12]=V[12],n[13]=V[13],n[14]=V[14],n[15]=V[15],this},compose:function(h,f,F){var X=this.el,p=f._x,o=f._y,b=f._z,i=f._w,W=p+p,L=o+o,k=b+b,J=p*W,w=p*L,l=p*k,M=o*L,I=o*k,d=b*k,x=i*W,g=i*L,S=i*k,E=F.x,q=F.y,Z=F.z;return X[0]=(1-(M+d))*E,X[1]=(w+S)*E,X[2]=(l-g)*E,X[3]=0,X[4]=(w-S)*q,X[5]=(1-(J+d))*q,X[6]=(I+x)*q,X[7]=0,X[8]=(l+g)*Z,X[9]=(I-x)*Z,X[10]=(1-(J+M))*Z,X[11]=0,X[12]=h.x,X[13]=h.y,X[14]=h.z,X[15]=1,this},decompose:function(){var l=new tb,F=new ds;return function(h,Y,a){var K=this.el,o=l.set(K[0],K[1],K[2]).length(),S=l.set(K[4],K[5],K[6]).length(),U=l.set(K[8],K[9],K[10]).length(),k=this.determinant();0>k&&(o=-o),h.x=K[12],h.y=K[13],h.z=K[14],F.copy(this);var O=1/o,C=1/S,V=1/U;return F.el[0]*=O,F.el[1]*=O,F.el[2]*=O,F.el[4]*=C,F.el[5]*=C,F.el[6]*=C,F.el[8]*=V,F.el[9]*=V,F.el[10]*=V,Y.setFromRotationMatrix(F),a.x=o,a.y=S,a.z=U,this}}()});var Db=q.Math.Triangle=function(Q,F,S){this.a=Q!==D?Q:new tb,this.b=F!==D?F:new tb,this.c=S!==D?S:new tb};t.assign(Db,{barycoordFromPoint:function(){var j=new tb,r=new tb,v=new tb;return function(s,P,Y,I,d){j.subVectors(I,P),r.subVectors(Y,P),v.subVectors(s,P);var L=j.dot(j),N=j.dot(r),G=j.dot(v),b=r.dot(r),u=r.dot(v),k=L*b-N*N,M=d||new tb;if(0===k)return M.set(-2,-1,-1);var $=1/k,y=(b*G-N*u)*$,z=(L*u-N*G)*$;return M.set(1-y-z,z,y)}}()});var lh=q.Math.Euler=function(R,i,B,Z,M){this.set(R,i,B,Z,M)};lh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],lh.DefaultOrder="XYZ",lh.ReverseOrder=function(){var v={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(S){return v[S]}}(),t.defineProperties(lh.prototype,{x:{get:function(){return this._x},set:function(p){this._x=p,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(h){this._y=h,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(D){this._z=D,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(b){this._order=b,this.onChangeCallback()}}}),t.assign(lh.prototype,{set:function(s,L,c,p,V){return bf(s)&&(V=c,p=L,c=s[2],L=s[1],s=s[0]),p?V&&(p=lh.ReverseOrder(p)):p="ZYX",this._x=s||0,this._y=L||0,this._z=c||0,this._order=p||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(w){return this._x=w._x,this._y=w._y,this._z=w._z,this._order=w._order,this.onChangeCallback(),this},setFromRotationMatrix:function(g,t,V){var r=q.Math.clamp,H=g.el||g,j=H[0],U=H[4],F=H[8],C=H[1],w=H[5],Q=H[9],x=H[2],_=H[6],o=H[10];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(r(F,-1,1)),Math.abs(F)<.99999?(this._x=Math.atan2(-Q,o),this._z=Math.atan2(-U,j)):(this._x=Math.atan2(_,w),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(Q,-1,1)),Math.abs(Q)<.99999?(this._y=Math.atan2(F,o),this._z=Math.atan2(C,w)):(this._y=Math.atan2(-x,j),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(_,-1,1)),Math.abs(_)<.99999?(this._y=Math.atan2(-x,o),this._z=Math.atan2(-U,w)):(this._y=0,this._z=Math.atan2(C,j))):"ZYX"===t?(this._y=Math.asin(-r(x,-1,1)),Math.abs(x)<.99999?(this._x=Math.atan2(_,o),this._z=Math.atan2(C,j)):(this._x=0,this._z=Math.atan2(-U,w))):"YZX"===t?(this._z=Math.asin(r(C,-1,1)),Math.abs(C)<.99999?(this._x=Math.atan2(-Q,w),this._y=Math.atan2(-x,j)):(this._x=0,this._y=Math.atan2(F,o))):"XZY"===t?(this._z=Math.asin(-r(U,-1,1)),Math.abs(U)<.99999?(this._x=Math.atan2(_,w),this._y=Math.atan2(F,j)):(this._x=Math.atan2(-Q,o),this._y=0)):console.warn("unsupported order: "+t),this._order=t,V!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new ds;return function(D,F,O){return t.makeRotationFromQuaternion(D),this.setFromRotationMatrix(t,F,O)}}(),setFromVector3:function(W,l){return this.set(W.x,W.y,W.z,l||this._order)
},reorder:function(){var I=new sq;return function(_){return I.setFromEuler(this),this.setFromQuaternion(I,_)}}(),equals:function(Z){return Z._x===this._x&&Z._y===this._y&&Z._z===this._z&&Z._order===this._order},fromArray:function(l){return this._x=l[0],this._y=l[1],this._z=l[2],l[3]!==D&&(this._order=l[3]),this.onChangeCallback(),this},toArray:function(j,K){return j===D&&(j=[]),K===D&&(K=0),j[K]=this._x,j[K+1]=this._y,j[K+2]=this._z,j[K+3]=this._order,j},toVector3:function(A){return A?A.set(this._x,this._y,this._z):new tb(this._x,this._y,this._z)},onChange:function(c){return this.onChangeCallback=c,this},onChangeCallback:function(){}});var Qn={ms_ac:function(r,E){for(var Y=E.ms_ac,J=0;J<Y.length;J++)pp(r,Y[J])},ms_listener:function(B){B.addListeners=function(){var Y=this,f=Xr;m.mockTouch&&(f=wm.concat(jo).concat(dd)),Y.__events__=f;for(var w=0,v=f.length;v>w;w++){var X=f[w];"wheel"===X&&!Y.handle_wheel&&Y.handle_mousewheel&&(Y.handle_wheel=function($){kb(Y,$)}),Y["handle_"+X]&&Bh(X,Y.getView(),Y)}},B.removeListeners=function(){var S=this,d=S.__events__;if(d){S.__events__=D;for(var h=0,N=d.length;N>h;h++)S["handle_"+d[h]]&&Fk(d[h],S.getView(),S)}}},ms_fire:function(r){r.mp=function(b,s,w){this.addPropertyChangeListener(b,s,w)},r.ump=function(s,D){this.removePropertyChangeListener(s,D)},r.fp=function(s,e,B,l,Q){return this.firePropertyChange(s,e,B,l,Q)},r.addPropertyChangeListener=function(B,r,H){var t=this;t._62I||(t._62I=new mn),t._62I.add(B,r,H)},r.removePropertyChangeListener=function(U,Y){this._62I&&this._62I.remove(U,Y)},r.firePropertyChange=function(v,$,x,t,G){if(t){if(t($,x))return!1}else if($===x)return!1;var m=this,E=G||{};return E.property=v,E.oldValue=$,E.newValue=x,E.source=m,E.data=m,m._62I&&m._62I.fire(E),m.onPropertyChanged&&m.onPropertyChanged(E),!0}},ms_attr:function(u){u.a=function(B,z){var I=this;if(2===arguments.length)I.setAttr(B,z);else{if(!vc(B))return I.getAttr(B);for(var j in B)I.setAttr(j,B[j])}return I},u.getAttr=function(_,d){if(d===D&&(d=1),this._attrObject&&_ in this._attrObject)return this._attrObject[_];if(this.getImage){var W=this.getImage();if(on(W)&&(W=Sn[W]),vc(W)&&"dataBindings"in W)for(var c=W.dataBindings,O=c.length-1;O>=0;O--){var e=c[O];if(e.attr===_){if("defaultValue"in e)return e.defaultValue;break}}}return d?h[_]:D},u.setAttr=function(m,E){var B=this;B._attrObject||(B._attrObject={});var X=B._attrObject[m];E===D?delete B._attrObject[m]:B._attrObject[m]=E,B.fp&&B.fp("a:"+m,X,E)&&B.onAttrChanged&&B.onAttrChanged(m,X,E)},u.getSerializableAttrs=function(){var O,F={};for(O in this._attrObject)F[O]=1;return F}},ms_bnb:function(f){f.getBodyColor=function(k){return k.s("body.color")},f.getBorderColor=function(t){return t.s("border.color")}},_51o:function(R){R.mi=function(A,D,N){this.addInteractorListener(A,D,N)},R.umi=function(t,H){this.removeInteractorListener(t,H)},R.fi=function(o){this.fireInteractorEvent(o)},R.addInteractorListener=function(C,d,S){var t=this;t._63I||(t._63I=new mn),t._63I.add(C,d,S)},R.removeInteractorListener=function(l,Z){this._63I&&this._63I.remove(l,Z)},R.fireInteractorEvent=function(s){this._63I&&this._63I.fire(s)},R.setInteractors=function(t){var R=this,U=R._interactors;U&&U.each(function(D){D.tearDown()}),bf(t)&&(t=new pq(t)),R._interactors=t,t&&t.each(function(d){d.setUp()}),R.fp("interactors",U,t),R.invalidateSelection()},R.getInteractors=function(){return this._interactors}},_49o:function(q){q._44O=G,q._45O=G,q.getTopPainters=function(){return this._44O},q.getBottomPainters=function(){return this._45O},q.addTopPainter=function(T){var D=this;D._44O||(D._44O=new pq),D._44O.contains(T)||(D._44O.add(T),D.redraw&&D.redraw())},q.removeTopPainter=function(F){var J=this;J._44O&&(J._44O.remove(F),J.redraw&&J.redraw())},q.addBottomPainter=function(u){var J=this;J._45O||(J._45O=new pq),J._45O.contains(u)||(J._45O.add(u),J.redraw&&J.redraw())},q.removeBottomPainter=function(A){var J=this;J._45O&&(J._45O.remove(A),J.redraw&&J.redraw())},q._93db=function(x,s){var C=this;C._45O&&C._45O.each(function(J){J.draw?J.draw(x,s):J.call(C,x,s)})},q._92db=function(l,i){var t=this;t._44O&&t._44O.each(function(e){e.draw?e.draw(l,i):e.call(t,l,i)})}},ms_sm:function(w){w.sm=function(){return this.getSelectionModel()},w.setSelectableFunc=function(N){this.sm().setFilterFunc(N)},w.getSelectableFunc=function(){return this.sm().getFilterFunc()},w.getSelectionModel=function(){var v=this;return v._selectionModel?v._selectionModel:v.dm().sm()},w.isSelectionModelShared=function(){return!this._selectionModel},w.setSelectionModelShared=function(D){var n=this,a=!n._selectionModel,S=n.handleSelectionChange,P=n.dm();a!==D&&(n.invalidateSelection&&n.invalidateSelection(),D?(P.sm().ms(S,n),n._selectionModel.ums(S,n),n._selectionModel.dispose(),n._selectionModel=G):(P.sm().ums(S,n),n._selectionModel=new un(P),n._selectionModel.ms(S,n)),n.onSelectionModelSharedChanged(),n.fp("selectionModelShared",a,D))},w.onSelectionModelSharedChanged=function(){var e=this;e.redraw(),e.invalidateSelection&&e.invalidateSelection()},w.removeSelection=function(){var X=this.dm();X.beginTransaction(),this.sm().toSelection().each(X.remove,X),X.endTransaction()},w.selectAll=function(){var U=this;U.sm().ss(U.dm().toDatas(function(O){return U.isVisible(O)&&U.isSelectable(O)}))},w.isSelected=function(f){return this.sm().co(f)},w.isSelectedById=function(I){var G=this.dm().getDataById(I);return G?this.isSelected(G):!1},w.isSelectable=function(b){return this.sm().isSelectable(b)}},ms_tx:function(E){E._64I=0,E._65O=0,E.isScrollable=function(){return this.getWidth()<this._64I},E._40o=function(){return this.isScrollable()},E.getLogicalPoint=function(q){return Dg(q,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},E.tx=function(J){return J===D?this.getTranslateX():(this.setTranslateX(J),void 0)},E.getTranslateX=function(){return this._65O},E.setTranslateX=function(J){var b=this,L=b.getWidth()-b._64I;L>J&&(J=L),J>0&&(J=0),J=A(J);var h=b._65O;b._65O=J,b.fp(zo,h,J)}},ms_ty:function(i){i._23Q=0,i._66O=0,i._41o=function(){return this.getHeight()<this._23Q},i.getLogicalPoint=function(U){return Dg(U,this._canvas||this._view,this.tx?this.tx():0,this.ty())},i.ty=function(V){return V===D?this.getTranslateY():(this.setTranslateY(V),void 0)},i.getTranslateY=function(){return this._66O},i.setTranslateY=function(S){var h=this,P=h.getHeight()-h._23Q;P>S&&(S=P),S>0&&(S=0),S=A(S);var J=h._66O;h._66O=S,h.fp(Zp,J,S)}},ms_txy:function(u){u._65O=0,u._66O=0,u.tx=function(b){return b===D?this.getTranslateX():(this.setTranslateX(b),void 0)},u.ty=function(s){return s===D?this.getTranslateY():(this.setTranslateY(s),void 0)},u.onTranslateEnded=function(){},u.setTranslate=function(r,T,B){var V=this;if(B=Ne(B)){V._65I&&V._65I.stop(!0);var $=V.tx(),p=V.ty();B.action=function(y){V.setTranslate($+(r-$)*y,p+(T-p)*y)},B._37o=function(){delete V._66I,delete V._65I,V.onTranslateEnded()},V._66I=1,V._65I=mk(B)}else V.tx(r),V.ty(T)},u.getTranslateX=function(){return this._65O},u.setTranslateX=function(s){var $=this;s=$.adjustTranslateX(s);var L=$._65O;$._65O=s,$.fp(zo,L,s)},u.getTranslateY=function(){return this._66O},u.setTranslateY=function(E){var r=this;E=r.adjustTranslateY(E);var H=r._66O;r._66O=E,r.fp(Zp,H,E)},u.adjustTranslateX=function(l){return A(l)},u.adjustTranslateY=function(_){return A(_)},u.translate=function(U,C,L){this.setTranslate(this.tx()+U,this.ty()+C,L)},u.getLogicalPoint=function(H){var J=this;return Dg(H,this._canvas||J._view,J.tx(),J.ty())}},ms_dm:function(S){S.dm=function(H){return H?(this.setDataModel(H),void 0):this.getDataModel()},S.getDataModel=function(){return this._dataModel}},ms_lp:function(o){o.lp=function(q){return this.getLogicalPoint(q)}},ms_v:function(R){R._disabled=!1,R.setDisabled=function(Z,I){var n=this,G=n._disabled;G!==Z&&(G&&(Rl(n._63O),delete n._63O),Z&&(ar(n._view,n._63O=Yh(I)),n.iv()),n._disabled=Z,n.fp("disabled",G,Z))},R.isDisabled=function(){return this._disabled},R.getDisabledDiv=function(){return this._63O},R.getView=function(){return this._view},R.addToDOM=function(P){var a=this,b=a.getView(),W=b.style;P=P||s.body,P.appendChild(b),W.left="0",W.right="0",W.top="0",W.bottom="0",$(_,"resize",function(){a.iv()}),a.iv()},R.getWidth=function(){return this._view.clientWidth},R.getHeight=function(){return this._view.clientHeight},R.setWidth=function(h){var E=this;E._view.style.width=h+Fn,E.iv(),E.fp&&E.fp(_i,G,h)},R.setHeight=function(c){var q=this;q._view.style.height=c+Fn,q.iv(),q.fp&&q.fp(Uc,G,c)},R.setFocus=function(X){var b=this,c=b._currentEditor;return X&&c&&(c.getView&&(c=c.getView()),c.contains(X.target))?!1:(vb(b._view),b.endEditing&&b.endEditing(),b.fireViewEvent("focus"),!0)},R.iv=function(S){this.invalidate(S)},R.invalidate=function(m){var i=this;i._68I||(i._68I=1,Vm(i.validate,i,G,m),i.onInvalidated&&i.onInvalidated(),i.fireViewEvent("invalidate"))},R.validate=function(){var g=this,h=g._view;if(g._68I&&(delete g._68I,h.parentNode))if(0===h.offsetWidth&&0===h.offsetHeight&&g._67I!==G)g._67I===D&&(g._67I=m.reinvalidateCount),g._67I>0?g._67I--:g._67I=G,g.iv();else{g.fireViewEvent("beginValidate"),g.validateImpl(),g.onValidated&&g.onValidated(),g.fireViewEvent("validate");var I=g._63O;I&&(h.lastChild!==I&&(Rl(I),ar(h,I)),ne(I,0,0,g.getWidth(),g.getHeight())),Xp(g),Gn(g),Hr(g)}},R.layout=function(Q,F,J,h){1===arguments.length?ne(this,Q):ne(this,Q,F,J,h)},R.addViewListener=function(G,e,S){var Z=this;Z._67O||(Z._67O=new mn),Z._67O.add(G,e,S)},R.removeViewListener=function(G,X){this._67O.remove(G,X)},R.fireViewEvent=function(T){var C=this;C._67O&&(on(T)&&(T={kind:T}),C._67O.fire(T)),m.viewListener&&m.viewListener(C,T)}},ms_tip:function(K){K.setToolTipEnabled=function(b){var q=this;b?yr||q._13o||(q.enableToolTip(),q.fp("toolTipEnabled",!1,!0)):q._13o&&(q.disableToolTip(),q.fp("toolTipEnabled",!0,!1))},K.isToolTipEnabled=function(){return!!this._13o},K.enableToolTip=function(){var o=this;if(!yr&&!o._13o){o._13o=function(u){var v=o.getToolTip(u);v!=G?(m.toolTipContinual&&m.isToolTipShowing()?On(u,v):(rn(),Mb={timeout:Qi(dl,um),e:u,info:v}),dh={e:u,view:o}):rn()};var R=o.getView();$(R,Gr,o._13o),$(R,"mouseleave",m.hideToolTip)}},K.disableToolTip=function(){var x=this;if(x._13o){var H=x.getView();J(H,Gr,x._13o),J(H,"mouseleave",m.hideToolTip),delete x._13o}},K.getToolTip=function(L){var E=this;if(E.getDataAt){var J=E.getDataAt(L);return J?J.getToolTip():G}return E.getValue?E.getValue():void 0}},_52o:function(a){a._zoom=1,a._29I=rg,a.zoomIn=function(w,S){this.setZoom(this._zoom*dr,w,S)},a.zoomOut=function(l,Q){this.setZoom(this._zoom/dr,l,Q)},a.zoomReset=function(r,b){this.setZoom(1,r,b)},a.scrollZoomIn=function(d){this.setZoom(this._zoom*df,G,d)},a.scrollZoomOut=function(u){this.setZoom(this._zoom/df,G,u)},a.pinchZoomIn=function(U){this.setZoom(this._zoom*Sj,G,U)},a.pinchZoomOut=function(y){this.setZoom(this._zoom/Sj,G,y)},a.adjustZoom=function(p){return Kr>p?Kr:p>Uk?Uk:p},a.getZoom=function(){return this._zoom},a.setZoom=function(p,E,b){var I=this;if(E=Ne(E)){I._14o&&I._14o.stop(!0);var n=I._zoom;E.action=function(a){I._96O(n+(p-n)*a,b)},E._37o=function(){delete I._zooming,delete I._14o,I.onZoomEnded()},I._zooming=1,I._14o=mk(E)}else I._96O(p,b)},a._96O=function(v,r){var X=this;if(v=X.adjustZoom(v),v!==X._zoom){X.validate();var f=X._29I,d=X._zoom;0!==f.width&&0!==f.height&&(r=r?r:{x:f.x+f.width/2,y:f.y+f.height/2},X.tx((r.x-f.x)*d-r.x*v),X.ty((r.y-f.y)*d-r.y*v)),X._zoom=v,X.fp("zoom",d,v)}}},ms_edge:function(G){G._2I=function(W){var f=this;f._44I||(f._44I=new pq),f._42I||(f._42I=new pq),f._44I.add(W),f._42I.add(W),f._20I()},G._4I=function(F){var t=this;t._44I||(t._44I=new pq),t._43I||(t._43I=new pq),t._44I.add(F),t._43I.add(F),t._20I()},G._16I=function(d){var U=this;U._44I.remove(d),U._42I.remove(d),U._44I.isEmpty()&&delete U._44I,U._42I.isEmpty()&&delete U._42I,U._20I()},G._18I=function(H){var q=this;q._44I.remove(H),q._43I.remove(H),q._44I.isEmpty()&&delete q._44I,q._43I.isEmpty()&&delete q._43I,q._20I()},G._20I=function(){var M=this;if(delete M._45I,!M._44I||M._44I.isEmpty())return delete M._70O,void 0;var G;M._44I.each(function(i){i.isLooped()&&(G||(G={}),G[i._id]||(M._45I||(M._45I=new pq),M._45I.add(i),G[i._id]=i))}),G?(M._70O=new pq,M._44I.each(function(z){G[z._id]?"A"===G[z._id]||(G[z._id]="A",M._70O.add(z)):M._70O.add(z)})):M._70O=M._44I},G.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},G.getSourceAgentEdges=function(){return this._46I},G.getTargetAgentEdges=function(){return this._47I},G._1I=function(E){var T=this;T._46I||(T._46I=new pq),T._48I||(T._48I=new pq),T._46I.add(E),T._48I.add(E),T._19I()},G._3I=function(k){var i=this;i._47I||(i._47I=new pq),i._48I||(i._48I=new pq),i._47I.add(k),i._48I.add(k),i._19I()},G._15I=function(Y){var L=this;L._46I.remove(Y),L._48I.remove(Y),L._46I.isEmpty()&&delete L._46I,L._48I.isEmpty()&&delete L._48I,L._19I()},G._17I=function(b){var Z=this;Z._47I.remove(b),Z._48I.remove(b),Z._47I.isEmpty()&&delete Z._47I,Z._48I.isEmpty()&&delete Z._48I,Z._19I()},G._19I=function(){var I=this;delete I._49I;var V=I._48I;if(V&&!V.isEmpty()){var Y={};V.each(function(o){Y[o._id]?I._49I||(I._49I=new pq):Y[o._id]=o}),I._49I?V.each(function(y){Y[y._id]&&(I._49I.add(y),delete Y[y._id])}):I._49I=V}},G.getLoopedEdges=function(){return this._45I},G.getEdges=function(){return this._70O},G.getAgentEdges=function(){return this._49I},G.getSourceEdges=function(){return this._42I},G.getTargetEdges=function(){return this._43I},G._8I=function(){this._70O&&this._70O.each(function(A){A._7I()})}},ms_shadow:function(g){kf.PARAMS.forEach(function(Q){var m=Q.replace(/(^|\.)[a-z]/g,function(w){return w[w.length-1].toUpperCase()}),K=m.charAt(0).toLowerCase()+m.substr(1);g["getShadow"+m]=function(){return this._getShadowParam(K)},g["setShadow"+m]=function(A){this._setShadowParam(K,A)}}),g.enableShadow=function(U){this.shadowMap.setShadow(!0,U)},g.disableShadow=function(){this.shadowMap.setShadow(!1)},g._getShadowParam=function(y){return this.shadowMap.getShadow()[y]},g._setShadowParam=function(_,E){var X=this._getShadowParam(_),n={};n[_]=E;var V=this.shadowMap;V.setShadow(V.enable,n),this.firePropertyChange("shadow"+_.charAt(0).toUpperCase()+_.substr(1),X,E)}}};Jg(m,{getVersion:function(){return"7.2.4"}},!0),Jg(m,{numberDigits:5,crossOrigin:"",baseZIndex:D,isTouchable:yr,mockTouch:!0,devicePixelRatio:_.devicePixelRatio?_.devicePixelRatio:_.screen?_.screen.deviceXDPI/_.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:l.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Mg},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(N){return N*N},labelColor:Mh,labelSelectColor:aj,labelFont:"12px arial, sans-serif",widgetIndent:yr?30:20,widgetRowHeight:yr?30:20,widgetHeaderHeight:yr?32:22,widgetTitleHeight:yr?34:24,scrollBarColor:Uo,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:yr?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:mb,intersectionLineLine:nl,isEnter:lr,isEsc:fp,isDelete:ls,isSpace:tk,isLeft:op,isUp:cn,isRight:tn,isDown:qo,isTouchEvent:Jo,getTarget:Oh,isString:on,isNumber:Lk,isBoolean:Xd,isArray:bf,isSelectAll:Xe,isFunction:Yo,isObject:vc,getPropertyValue:Gg,setPropertyValue:$i,addMethod:Jg,createGradient:function(o,L,l,Y,H,U,v,x){var g=yi[L];return g(o,l,Y,H,U,v,x)},appendToScreen:function(P){P=P.getView?P.getView():P,(s.fullscreenElement||s.mozFullScreenElement||s.webkitFullscreenElement||s.msFullscreenElement||s.body).appendChild(P)},encodeString:function(o){return q.Math.encodeBase64(o,m.encodeStringKey)},decodeString:function(A){return q.Math.decodeBase64(A,m.encodeStringKey)},findView:function(n){var k=function(s,O){var t=O._ht;t&&s.push(t);var C=O.children,X=C.length;if(X)for(var Q=0;X>Q;Q++)k(s,C[Q])},_=[];k(_,s.body);var z=function(U,b){for(var P="2d"===b?hg.GraphView:Dl.Graph3dView,w=0,d=U.length;d>w;w++)if(U[w]instanceof P)return _[w];return null};return"all"===n?_:"2d"===n?z(_,"2d"):"3d"===n?z(_,"3d"):z(_,"3d")||z(_,"2d")},toggleFullscreen:function(u){var p=u.getView();if(s.fullscreenElement||s.mozFullScreenElement||s.webkitFullscreenElement||s.msFullscreenElement)s.exitFullscreen?s.exitFullscreen():s.msExitFullscreen?s.msExitFullscreen():s.mozCancelFullScreen?s.mozCancelFullScreen():s.webkitExitFullscreen&&s.webkitExitFullscreen();else{var I=!0;if(u.isSelfViewEvent){var h=u.getX(),v=u.getY(),P=u.getWidth(),$=u.getHeight(),o=p.style.background,j=p.style.backgroundColor;o||j||(p.style.backgroundColor="white"),p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen();var d=setInterval(function(){if(p!==(s.fullscreenElement||s.mozFullScreenElement||s.webkitFullscreenElement||s.msFullscreenElement))clearInterval(d),u.setX(h),u.setY(v),u.setWidth(P),u.setHeight($),u._fullscreen=!1,p.style.oldBackgroundColor=j,u.iv();else{var U=q.Default.getWindowInfo();(I||U.width!==u.getWidth()||U.height!==u.getHeight())&&(u.setX(U.left),u.setY(U.top),u.setWidth(U.width),u.setHeight(U.height),u._fullscreen=!0,u.iv(),I=!1)}},500)}else{var m=p.style.left,W=p.style.top,P=p.style.width,$=p.style.height,o=p.style.background,j=p.style.backgroundColor;o||j||(p.style.backgroundColor="white"),p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen();var d=setInterval(function(){if(p!==(s.fullscreenElement||s.mozFullScreenElement||s.webkitFullscreenElement||s.msFullscreenElement))clearInterval(d),p.style.left=m,p.style.top=W,p.style.width=P,p.style.height=$,p.style.oldBackgroundColor=j,u.iv();else{var y=q.Default.getWindowInfo();(I||y.width!==u.getWidth()||y.height!==u.getHeight())&&(ne(u),I=!1)}},500)}}},appendTimeStamp:function(s){return s},setCompType:function(t,B){on(B)&&B.substr(0,12)==Up&&(B=m.parse(B)),Yo(B)||vc(B)?ck[t]=B:Je(t)},getCompType:function(K){var N=ck[K];return N===D&&Sb.test(K)&&Je(K),N},getCompTypeMap:function(){return ck},drawCompType:function(m,I,B,q,J,F){m(I,B,q,J,F)},numberListener:function(){var y={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(K){var X=K.keyCode;y[X]||65===X&&m.isCtrlDown(K)||86===X&&m.isCtrlDown(K)||67===X&&m.isCtrlDown(K)||88===X&&m.isCtrlDown(K)||X>=35&&40>=X||(K.shiftKey||48>X||X>57)&&(96>X||X>105)&&K.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(f){var $=f.target.tagName;("DIV"===$||"CANVAS"===$)&&!(m.ignoreKeyCodes.indexOf(f.keyCode)>=0)&&("keydown"!==f.type||op(f)||tn(f)||cn(f)||qo(f)||ls(f)||65===f.keyCode&&(f.metaKey||f.ctrlKey))&&f.cancelable===!0&&(f.preventDefault(),f.preventManipulation&&f.preventManipulation())},getWindowInfo:function(){var V=s.documentElement,X=V&&(V.scrollLeft||V.scrollTop)?V:s.body;return{target:X,left:X.scrollLeft,top:X.scrollTop,width:_.innerWidth||X.clientWidth,height:_.innerHeight||X.clientHeight}},isDragging:function(){return!!Mg},isLeftButton:function(r){return Jo(r)?!0:0===r.button},isMiddleButton:function(p){return Jo(p)?!1:p&&(1===p.button||4&(p.buttons||0))},isRightButton:function(G){return Jo(G)?!1:G&&(2===G.button||2&(G.buttons||0))},isInput:function(J){if(!J)return!1;var c=J.tagName;return"INPUT"===c||"TEXTAREA"===c||"SELECT"===c},getTouchCount:function(e){return Jo(e)?e.touches.length:1},isDoubleClick:function(){function k(M){M.details=0,M.timeout=null,M.lastPoint=null}var $={};return so=new Wr,Hc=so.getTime(),function(O){if(fm(O)>1)return!1;var V=O.button==G?"":O.button,N=O.type+V,F=N+"_isDoubleClick",M=$[N];if(M||(M=$[N]={details:0,timeout:null,lastPoint:null}),O[F]===D){O[F]=!0;var q=Lp(O);M.timeout&&(ii(M.timeout),M.timeout=null);var a=Jo(O)?m.doubleTouchRange:m.doubleClickRange;M.lastPoint&&qj(M.lastPoint,q)>a&&k(M),M.lastPoint=q,M.details++,M.timeout=Qi(function(){k(this)}.bind(M),m.doubleClickSpeed)}return 2===M.details}}(),isShiftDown:function(q){return q?q.shiftKey:zh["16"]},isCtrlDown:function(p){return p?Uh?p.metaKey:p.ctrlKey:Uh?zh["91"]:zh["17"]},getClientPoint:function(k){return Jo(k)&&(k=Kg(k)),{x:k.clientX,y:k.clientY}},isMouseEvent:function(W){return W instanceof MouseEvent||0===W.type.indexOf("mouse")},getTargetElement:function(N){var U,k=fj(N);if(U=m.isMouseEvent(N)||!s.elementFromPoint?N.target:s.elementFromPoint(k.x,k.y),jr&&s.elementFromPoint){for(var $=[],E=[];"none"===U.style.pointerEvents;)$.push(U),E.push(U.style.display||""),U.style.display="none",U=s.elementFromPoint(k.x,k.y);$.forEach(function(F,w){F.style.display=E[w]})}return U},getPagePoint:function(D){return Jo(D)&&(D=Kg(D)),{x:D.pageX,y:D.pageY}},createObject:function(Z,R){var d=new Z;for(var u in R){var Q=R[u];if(Yo(Q))d[u]=Q;else if(0===u.indexOf("s:"))d.s(u.substr(2),R[u]);else if(0===u.indexOf("a:"))d.a(u.substr(2),R[u]);else{var Y=Tr(u),Q=R[u];d[Y]?(d[Y](Q),"setToolTip"===Y&&d.enableToolTip&&d.enableToolTip()):d[u]=Q}}return d},setImage:function(p,x,L,b){var F=arguments.length;4===F?Sd(p,b,x,L):2===F?on(x)?x.substr(0,12)==Up?pk(p,m.parse(x)):Sd(p,x):pk(p,x):1===F&&Sd(p,p)},getImage:function(z,R,p){var U;if(z==G)return G;if(vc(z)?U=z:(U=Sn[z],z&&U===D&&(Mo&&Mo[z]||Sd(z,z))),R&&U&&U.tagName){var b;b="override"===p?"colors_override":"override_rgb"===p?"colors_override_rgb":"override_a"===p?"colors_override_a":"colors",U[b]||(U[b]={__count__:0});var Y=U[b][R];return Y||(U[b].__count__>m.imageCacheThreshold&&(U[b]={__count__:0}),Y=Nk(U,Xi(R),U.width,U.height,p),U[b][R]=Y,U[b].__count__++),Y}return U},isImageComplete:function(Z,y,O){var e=Nd(Z);if(!e)return!1;if(e.tagName)return e.complete;for(var n,Z,P,x=e.comps,g=!0,r=0,N=x.length;N>r;r++)if(n=x[r],P=n.type,"image"===n.type){Z=n.name,Z&&Z.func&&(Z=$b(Z,y));var S=Kd(Z,y,O);if(!S){g=!1;break}}else if(Sb.test(P)&&m.getCompType(P)===D){g=!1,Je(P);break}return g},getId:function(){var W=1;return function(){return++W}}(),callLater:function(Z,R,s,y){var w=function(){Z.apply(R,s)};return y?Qi(w,y):_.requestAnimationFrame(w)},cancelLater:function(k,f){f?ii(k):_.cancelAnimationFrame(k)},clone:function(h){if(null==h||"object"!=typeof h)return h;if(h instanceof Date){var O=new Date;return O.setTime(h.getTime()),O}if(h instanceof Array){for(var O=[],P=0,p=h.length;p>P;P++)O[P]=gl(h[P]);return O}if(h instanceof pq){for(var O=new pq,P=0,p=h.length;p>P;P++)O.set(P,gl(h.get(P)));return O}if(h instanceof Em)return h;if(h instanceof sn){var O=new sn;return O.deserialize(h.serialize()),O}if(h instanceof t){var O={};for(var J in h)h.hasOwnProperty(J)&&(O[J]=gl(h[J]));return O}return h},callWhenLoaded:function(v,o){o=o||100;var C=gc(v,o);Bi||(Bi={}),Bi[C]={tick:C,cb:v,delay:o}},beforeLoadURL:function(p,j){if(Bi){var B={};for(var j in Bi){var o=Bi[j];ii(o.tick);var l=gc(o.cb,o.delay);B[l]={tick:l,delay:o.delay,cb:o.cb}}Bi=B}return m.convertURL?m.convertURL(p,j):p},convertURL:function(p){return p},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return m.getImage("default_blank")},resizeImagePOT:function(j,Y){if(!j||!j.tagName)return j;var w=j.width,q=j.height;if(!w||!q)return j;if(pj.isPOT(w)&&pj.isPOT(q)&&(!Y||w===q))return j;var o,E;Y?E=o=pj.nearestPOT(Math.min(w,q)):(o=pj.nearestPOT(w),E=pj.nearestPOT(q));var u=Ae(),b=u.getContext("2d");return Ek(u,o,E,1),b.drawImage(j,0,0,w,q,0,0,o,E),u},sortFunc:function(K,e){if(K===e)return 0;if(K==G&&e!=G)return 1;if(K!=G&&e==G)return-1;if(K==G&&e==G)return 0;var l,U=typeof K,i=typeof e;return U===Sh&&i===Sh?l=K.localeCompare(e):U===In&&i===In&&(l=K-e),l===D&&(l=(""+K).localeCompare(""+e)),l>0?1:0>l?-1:0},getClassMap:function(){return ok},getClass:function(y){if(on(y)){var Y,J=ok[y];if(!J){Y=y.split("."),J=_;for(var A=0;A<Y.length;A++)J=J[Y[A]];ok[y]=J}return J}return y},def:function(o,g,C){var l,P,Q,V=function(){};if(V.prototype=g.prototype,l=new V,on(o)){if(ok[o])throw"'"+o+"' already defined";Q=Kk(o),l.getClassName=function(){return o}}else Q=o;if(l.constructor=Q,l.getClass=function(){return Q},l.getSuperClass=function(){return g},C)for(P in C)Qn[P]&&Qn.hasOwnProperty(P)?Qn[P](l,C):hp(l,C,P);Q.prototype=l,Q.superClass=g.prototype},startAnim:function(){var R=function(s){s.duration&&(s.startTime=Oi()),s.timeId=Vm(s.tick,G,G,s.interval)};return function(a){return a=gl(a),a.easing=a.easing||m.animEasing,a.duration||a.frames||(a.duration=m.animDuration),a.t=0,a.duration?a.interval=0:(a.frame=0,a.interval=a.interval||10),a.tick=function(){if(a.duration){var s=(Oi()-a.startTime)/a.duration;if(s>1&&(s=1),a.t=s,a.action(a.easing(s),s),!a.isRunning())return;1===s?a.stop():a._isPaused||(a.timeId=Vm(a.tick))}else{if(a.frame++,s=a.t=a.frame/a.frames,a.action(a.easing(s),s),!a.isRunning())return;a.frame<a.frames?a._isPaused||(a.timeId=Vm(a.tick,G,G,a.interval)):a.stop()}},a.resume=function(){a._isPaused&&(delete a._isPaused,a.duration?a.t<1&&(a.startTime=Oi()-a.duration*a.t,a.timeId=Vm(a.tick)):a.frame<a.frames&&(a.timeId=Vm(a.tick,G,G,a.interval)))},a.pause=function(){Bb(a.timeId,!a.duration),a._isPaused=!0},a.isPaused=function(){return this._isPaused},a.stop=function(m){a.isRunning()&&(Bb(a.timeId,!a.duration),delete a.timeId,a.duration?a.t<1&&m&&(a.t=1,a.action(a.easing(1),1)):a.frame<a.frames&&m&&(a.frame=a.frames,a.action(a.easing(1),1)),a._37o&&a._37o(),a.finishFunc&&a.finishFunc())},a.isRunning=function(){return a.timeId!=G},a.delay?Vm(R,G,[a],a.delay):R(a),a}}(),getTextSize:function(){var e={},U=s?Ae().getContext("2d"):G;return function(v,c){U.font=v?v:Dn;var Q=e[U.font];return Q||(Q=2*U.measureText("e").width+4,e[U.font]=Q),{width:U.measureText(c).width+m.textExtraWidth,height:Q}}}(),drawText:function(s,c,F,f,z,C,Z,n,m,N,v){if(c!=G){var g=Vd(F,c),U={};if(U.y=N&&N!==Uf?N===am?C+g.height/2:C+n-g.height/2:C+n/2,U.x=m&&m!==xb?m===ui?z+Z-g.width/2:z+Z/2:z+g.width/2,cc(s,c,U,F,f),v){s.font=F;var R=s.measureText(c);s.beginPath(),s.strokeStyle=f,"underline"===v?(s.moveTo(U.x-g.width/2,U.y+R.actualBoundingBoxDescent+1),s.lineTo(U.x+g.width/2,U.y+R.actualBoundingBoxDescent+1)):"line.through"===v?(s.moveTo(U.x-g.width/2,U.y),s.lineTo(U.x+g.width/2,U.y)):"overline"===v&&(s.moveTo(U.x-g.width/2,U.y-R.fontBoundingBoxAscent),s.lineTo(U.x+g.width/2,U.y-R.fontBoundingBoxAscent)),s.stroke()}}},getDistance:function(z,I){var X=z.length;return I?3===X?j(xi(z[0]-I[0])+xi(z[1]-I[1])+xi(z[2]-I[2])):2===X?j(xi(z[0]-I[0])+xi(z[1]-I[1])):z.z===D?j(xi(I.x-z.x)+xi(I.y-z.y)):j(xi(I.x-z.x)+xi(I.y-z.y)+xi(I.z-z.z)):3===X?j(xi(z[0])+xi(z[1])+xi(z[2])):2===X?j(xi(z[0])+xi(z[1])):void 0},brighter:function(G,V){return 0>V&&(V=-V),Dp(G,V?V:40)},darker:function(A,p){return p>0&&(p=-p),Dp(A,p?p:-40)},unionPoint:function(Z,R){if(!Z)return G;if(2===arguments.length)return Z&&R?{x:S(Z.x,R.x),y:S(Z.y,R.y),width:E(Z.x-R.x),height:E(Z.y-R.y)}:G;var z=Z;if(z._as&&(z=z._as),z.length===D)return G;var a=z.length;if(0>=a)return G;for(var n=1,A=z[0],y={x:A.x,y:A.y,width:0,height:0};a>n;n++){A=z[n];var b=S(y.x,A.x),f=L(y.x+y.width,A.x),V=S(y.y,A.y),Q=L(y.y+y.height,A.y);y.x=b,y.y=V,y.width=f-b,y.height=Q-V}return y},unionRect:function(W,f){if(W&&!f)return gl(W);if(!W&&f)return gl(f);if(W&&f){var w={x:S(W.x,f.x),y:S(W.y,f.y)};return w.width=L(W.x+W.width,f.x+f.width)-w.x,w.height=L(W.y+W.height,f.y+f.height)-w.y,w}return G},containsPoint:function(W,j,O,a){if(a!=G&&1!==a){var p=W.x+W.width/2,X=W.y+W.height/2;W={x:p-W.width/2*a,y:X-W.height/2*a,width:W.width*a,height:W.height*a}}if(O){var w=W.width/2,R=W.height/2,H=P(-O),h=Z(-O),r=j.x-W.x-w,F=j.y-W.y-R;return j={x:h*r-H*F,y:H*r+h*F},uq({x:-w,y:-R,width:W.width,height:W.height},j)}return!(!W||j.x<W.x||j.y<W.y||j.x>W.x+W.width||j.y>W.y+W.height)},containsRect:function($,K){if(!$||!K)return!1;var L=K.x,v=K.y,f=K.width,P=K.height,s=$.width,k=$.height;if(0>(s|k|f|P))return!1;var g=$.x,M=$.y;if(g>L||M>v)return!1;if(s+=g,f+=L,L>=f){if(s>=g||f>s)return!1}else if(s>=g&&f>s)return!1;if(k+=M,P+=v,v>=P){if(k>=M||P>k)return!1}else if(k>=M&&P>k)return!1;return!0},intersectsRect:function(l,J){if(!l||!J)return!1;var V=J.width,X=J.height,U=l.width,R=l.height;if(0>=U||0>=R||0>=V||0>=X)return!1;var m=J.x,Z=J.y,B=l.x,W=l.y;return U+=B,R+=W,V+=m,X+=Z,U>m&&R>Z&&V>B&&X>W},intersection:function(S,U){if(!S||!U)return G;var s=U.x,E=U.y,V=S.x,o=S.y,_=s,x=E,b=V,i=o;return _+=U.width,x+=U.height,b+=S.width,i+=S.height,V>s&&(s=V),o>E&&(E=o),_>b&&(_=b),x>i&&(x=i),_-=s,x-=E,0>=_||0>=x?G:{x:s,y:E,width:_,height:x}},grow:function(i,P,h){h===D&&(h=P),i.x-=P,i.y-=h,i.width=i.width+2*P,i.height=i.height+2*h},getScreenPoint:function(w,E,O,J,e,x,K){var P=O.getBoundingClientRect(),H=w*(x||1)-O.scrollLeft+(J||0),R=E*(K||1)-O.scrollTop+(e||0),B=Ag(O,!1);if(B){var V=new tb(H,R,0);return V.applyMatrix4(B),console.log(V),{x:V.x,y:V.y}}return{x:H+P.left,y:R+P.top}},getLogicalPoint:function(_,I,L,w,k,s){var v,b,S=I.getBoundingClientRect();_.target?(hi(_)?Uh?zh["91"]=!0:zh["17"]=!0:Uh?zh["91"]=!1:zh["17"]=!1,zh["16"]=Fj(_)?!0:!1,_=Jo(_)?Kg(_):_,v=_.clientX,b=_.clientY):(v=_.x,b=_.y);var N=Ag(I,!0);if(N){var r=new tb(v,b,0);r.applyMatrix4(N);do{if(Math.abs(r.z)<=1e-6)break;var y=new tb(v,b,1);if(y.applyMatrix4(matrix),Math.abs(y.z)<=1e-6){r=y;break}if(y.sub(r),Math.abs(y.z)<=1e-6)break;r.addScaledVector(y,-r.z/y.z)}while(!1);return{x:(r.x+I.scrollLeft-(L||0))/(k||1),y:(r.y+I.scrollTop-(w||0))/(s||1)}}return{x:(v-S.left+I.scrollLeft-(L||0))/(k||1),y:(b-S.top+I.scrollTop-(w||0))/(s||1)}},removeHTML:function(){var B;return function(e){return e&&e.getView&&(e=e.getView()),e&&e.parentNode?B===e?!0:(B=e,e.parentNode.removeChild(e),B=G,!0):!1}}(),getToolTipDiv:function(){if(!Qq){Qq=Ic(),$e=Ic();var v=Qq.style;m.baseZIndex!=G&&(v.zIndex=Iq(m.baseZIndex)+3+""),v.whiteSpace="nowrap",v.color=m.toolTipLabelColor,v.background=m.toolTipBackground,v.font=m.toolTipLabelFont,v.padding="5px",v.boxShadow="0px 0px 3px "+m.toolTipShadowColor}return Qq},isToolTipShowing:function(){return Qq&&Qq.parentNode?!0:$e&&$e.parentNode?!0:!1},updateToolTipContent:function(b,o){if(m.isToolTipShowing()&&(o||(o=dh&&dh.view),b===D&&o&&dh.e&&(b=o.getToolTip(dh.e)),b!=G)){var S;b.html?(b=b.html,S=$e):S=Qq,S.innerHTML=b}},hideToolTip:function(){if(m.isToolTipShowing()){Rl(Qq),Rl($e),mc();var x=dh&&dh.view;x&&x.onHideToolTip&&x.onHideToolTip(),dh=G}},showToolTip:function(e,n,H){if(!e||n==G)return rn(),void 0;m.getToolTipDiv();var Z,o;if(n.html?(n=n.html,Z=$e,Rl(Qq)):(Z=Qq,Rl($e)),o=Z.style,Z.innerHTML=n,Z.parentNode||q.Default.appendToScreen(Z),e.target){e=fj(e);var y=Nl(),r=e.x,B=e.y,u=yr?60:12;if(yr){var L=Z.getBoundingClientRect();o.left=r-L.width/2+Fn,o.top=B-L.height-u<y.top?B+u+Fn:B-L.height-u+Fn}else{o.left=r+u+Fn,o.top=B+u+Fn;var L=Z.getBoundingClientRect();L.left+L.width>y.width&&(o.left=r-u-L.width+Fn),L.top+L.height>y.height&&(o.top=B-u-L.height+Fn),L.left<0&&(o.left=r+u+Fn),L.top<0&&(o.top=B+u+Fn)}}else o.left=e.x+Fn,o.top=e.y+Fn;mc(),H===D?H=dh&&dh.view:dh={e:e,view:H},H&&H.onShowToolTip&&H.onShowToolTip()},startDragging:function(i,g,S){S==D&&(S=!0),i!==Mg&&(Mg?S&&(Jo(g)?Mg.handleWindowTouchEnd(g):Mg.handleWindowMouseUp(g)):Jo(g)?($(_,Cg,zn),$(_,Er,Jb)):($(_,Gr,Ie),$(_,Fb,No)),Mg=i)},getImageMap:function(){return Sn},toBoundaries:function(t,U,K,y){var G=[];return ns(t,U,K,y).forEach(function(f){var j=[];f.forEach(function(x){j.push(x.x,x.y)}),G.push(j)}),G},getCurrentKeyCodeMap:function(){return zh},drawCenterImage:function(Y,h,f,J,E,s,p,e){!E&&s&&s.isSelfViewEvent&&(E=s);var O=Ur(h,E,s),T=wb(h,E,s);Rb(Y,h,A(f-O/2),A(J-T/2),O,T,E,s,p,e)},drawStretchImage:function(F,L,D,r,g,N,H,a,_,f,k,s){!a&&_&&_.isSelfViewEvent&&(a=_);var C,K=Ur(L,a,_,N),W=wb(L,a,_,H);
"uniform"===D?(C=S(N/K,H/W),K*=C,W*=C,r+=A((N-K)/2),g+=A((H-W)/2),N=K,H=W):"centerUniform"===D&&((K>N||W>H)&&(C=S(N/K,H/W),K*=C,W*=C),r+=A((N-K)/2),g+=A((H-W)/2),N=K,H=W);var m=F.interactiveInfo;if(m){var t;if(t="center"===D?{x:r+N/2-K/2,y:g+H/2-W/2,width:K,height:W}:{x:r,y:g,width:N,height:H},m.rect){var R=m.compInfos,P=R.length;P&&(R[P-1].rect.image=L)}else m.rect=t}if("center"===D){var w=k!==!1&&(K>N||W>H);w&&(F.save(),F.beginPath(),F.rect(r,g,N,H),F.clip()),Rb(F,L,r+N/2-K/2,g+H/2-W/2,K,W,a,_,f,s),w&&F.restore()}else Rb(F,L,r,g,N,H,a,_,f,s)},toCanvas:function(q,L,n,H,i,U,h,Y,a){q=Nd(q,h),L=L||Ur(q,i),n=n||wb(q,i);var I=Ae(),X=Nm(I);return Y?(Ek(I,L,n,Y),X.scale(Y,Y)):Ek(I,L,n,1),gr(X,q,H,0,0,L,n,i,U,h,a),q&&q.clampToEdge&&(I.clampToEdge=q.clampToEdge),X.restore(),I},toGrayColor:function(Y){if(!Y)return Y;var i=Tp(Y),H=A(.299*i[0]+.587*i[1]+.114*i[2]);return"rgba("+H+","+H+","+H+","+i[3]/255+")"},createGradientImage:function(L,o,$,W){for(var K=["L",0,0,L,0,1,0,0,1,0,0],M=0,P=Math.min(o.length,$.length);P>M;M++)K.push($[M],o[M]);var w=q.Default.toCanvas({width:L,height:L,clampToEdge:!0,comps:[{type:"shape",rotation:W||0,points:[0,0,L,0,L,L,0,L],background:"#ffffff",gradientPack:K}]});return w},createElement:function(E,f,K,C){var H=s.createElement(E);return rr(H,f||l.widgetBorder,2),H.style.font=K?K:Dn,C!=G&&(H.value=C),m.onElementCreated&&m.onElementCreated(H),H},containedInView:function(z,c){var Y=tf(c).getBoundingClientRect();return uq({x:Y.left,y:Y.top,width:Y.width,height:Y.height},Lp(z))},isIsolating:function(){return Lh>0},setIsolating:function(j){j?Lh++:Lh--},getMSMap:function(){return Qn},stringify:function($,e,U){var B=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var O=sn.prototype.toJSON;sn.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},e=U?0:e==G?2:e;var o=JSON.stringify($,function(E,d){return"function"==typeof d?"__ht__"+(d.__ht__||d.toString()):Lk(d)?gn(d):d instanceof q.List?"__ht__list"+(d.__ht__list||m.stringify(d._as)):d},e);return Date.prototype.toJSON=B,sn.prototype.toJSON=O,U&&(o=Up+ts(o)),o},parse:function(N,s){return on(N)?N.substr(0,12)!=Up||(N=ss(N.substr(12)),on(N))?(s=s||{},JSON.parse(N,function(J,b){if(on(b))if(s.ignoreFunction||"__ht__function"!=b.substr(0,14)){if(!s.ignoreDate&&"__ht__date"==b.substr(0,10))return new Date(Iq(b.substr(10)));if("__ht__list"===b.substr(0,10))return new pq(m.parse(b.substr(10)));if(!s.ignoreDataModel&&"__ht__dataModel"===b.substr(0,15)){var G=new sn;return G.deserialize(m.parse(b.substr(15))),G}}else{var L=b.indexOf("{")+1,d=b.lastIndexOf("}"),v=b.indexOf("(")+1,r=b.indexOf(")");if(L&&d&&v&&r)try{var p=new Function(b.substring(v,r),b.substring(L,d));return p.__ht__=b.substr(6),p}catch(c){throw console.info("=== SyntaxError ===\n",b),c}}return b})):N:N},loadJS:function(p,V){V&&p.push(V);var w=p.shift();if(bf(w))p=w.contact(p),m.loadJS(p);else if(Yo(w))w(),m.loadJS(p);else if(on(w)){var B=s.createElement("script");B.onload=function(){m.loadJS(p)},B.setAttribute("src",w),s.getElementsByTagName("head")[0].appendChild(B)}else p.length&&m.loadJS(p)},extendClass:function(P,S){var r=P.prototype;for(var V in S)Qn[V]&&Qn.hasOwnProperty(V)?Qn[V](r,S):r[V]=S[V]},toRoundedCorner:function(){function U(Y,K,k){Y.x=K.x,Y.y=K.e||k,Y.z=K.y}var b=new tb,s=new tb,y=new tb,w=new tb;return function(u,f){var K,p=0;u.getPoints&&(p=u.getElevation(),u=u.getPoints()),K=u instanceof pq?u:new pq(u);var d=K.size();if(0>=f)return{points:K};var g=new pq,z=new pq,$=K.get(0);U(b,$,p),g.add($),z.add(1);for(var x=1;d>x;x++)if(d>x+1){var j=K.get(x),L=K.get(x+1);U(s,j,p),U(y,L,p),w.subVectors(b,s).setLength(Math.min(.99*w.length(),f)).add(s),j.e!==D||$.e!==D?g.add({x:w.x,y:w.z,e:w.y}):g.add({x:w.x,y:w.z}),g.add(j),w.subVectors(y,s).setLength(Math.min(.99*w.length(),f)).add(s),j.e!==D||L.e!==D?g.add($={x:w.x,y:w.z,e:w.y}):g.add($={x:w.x,y:w.z}),b.copy(w),z.addAll([2,3])}else g.add(K.get(x)),z.add(2);return{points:g,segments:z}}}(),toColorData:Tp,setCanvas:Ek,createDiv:Ic,createDisabledDiv:Yh,createView:Qo,createCanvas:Ae,appendChild:ar,initContext:Nm,checkLoadingImage:Xp,translateAndScale:jf,layout:ne,getPosition:yq,drawPoints:bj,drawRoundRect:cs,drawBorder:to,setFocus:vb,getter:ei,setter:Tr,isEmptyObject:_k,cameraPriority:function(){var x={skybox:0,main:1e4,top:1e7,infinity:1/0};return t.seal(t.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return x.skybox},set:function(I){if(I>=x.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");x.skybox=Number(I)}},main:{configurable:!1,enumerable:!1,get:function(){return x.main},set:function(p){if(p<=x.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(p>=x.top)throw new RangeError("Main camera must have lower priority than the top camera.");x.main=Number(p)}},top:{configurable:!1,enumerable:!1,get:function(){return x.top},set:function(e){if(e<=x.main)throw new RangeError("Top camera must have higher priority than the main camera.");x.top=Number(e)}}}))}()},!0),Jg(F,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var _m=m.disabledOpacity,um=m.toolTipDelay,pi=m.devicePixelRatio,qd=m.autoMakeVisible,Re=m.autoHideScrollBar,vm=m.imageGradient,On=m.showToolTip,rn=m.hideToolTip,_o=m.dashPattern,Mi=m.lineCap,Mc=m.lineJoin,up=m.labelColor,_l=m.labelSelectColor,Dn=m.labelFont,zk=m.widgetIndent,Wi=m.widgetRowHeight,hd=m.widgetHeaderHeight,Lm=m.widgetTitleHeight,vq=m.scrollBarColor,Wq=m.scrollBarSize,fr=m.scrollBarTimeout,Xf=m.scrollBarMinLength,Tj=m.scrollBarInteractiveSize,dr=m.zoomIncrement,df=m.scrollZoomIncrement,Sj=m.pinchZoomIncrement,Uk=m.zoomMax,Kr=m.zoomMin,pg=m.createObject,Ji=m.preventDefault,Ul=m.setImage,Nd=m.getImage,Kd=m.isImageComplete,Si=m.drawCenterImage,gr=m.drawStretchImage,Fe=m.getId,Vm=m.callLater,Bb=m.cancelLater,ke=m.sortFunc,gl=m.clone,Kk=m.getClass,mk=m.startAnim,bn=m.brighter,Xn=m.darker,Se=m.drawText,Vd=m.getTextSize,Cm=m.isLeftButton,Jn=m.isMiddleButton,cq=m.isRightButton,fm=m.getTouchCount,bb=m.isDoubleClick,Fj=m.isShiftDown,hi=m.isCtrlDown,Lp=m.getClientPoint,fj=m.getPagePoint,qj=m.getDistance,Ip=m.unionPoint,je=m.unionRect,uq=m.containsPoint,Bf=m.containsRect,of=m.intersectsRect,Fh=m.intersection,Nl=m.getWindowInfo,ir=m.grow,Dg=m.getLogicalPoint,bk=m.getScreenPoint,nr=m.startDragging,Rl=m.removeHTML,lp=m.createElement,jc=m.segmentResolution,og=m.shapeResolution,om=m.shapeSide,mj=m.def,Eg=function(S,F,k){mj(X+"."+S,F,k)},Pk=function(K,n){K.childNodes.forEach(function(U){n(U),Pk(U,n)})};Jg(m,{toolTipLabelColor:up,toolTipLabelFont:Dn,toolTipBackground:l.toolTipBackground,toolTipShadowColor:Uo,debugTipLabelFont:Dn,debugTipLabelColor:up,debugTipBackground:l.toolTipBackground,drawBreakableText:fg,setDevicePixelRatio:function(K){pi=m.devicePixelRatio="number"==typeof K?K:_.screen?_.screen.deviceXDPI/_.screen.logicalXDPI:1,Pk(s.body,function(m){var k=m._ht;k&&k._canvas&&(Ek(k._canvas,k.getWidth(),k.getHeight()),k.redraw?k.redraw():k.iv())})}},!0);var sm=1e-6,oh="undefined"!=typeof Uint16Array?Uint16Array:Array,Hg="undefined"!=typeof Float32Array?Float32Array:Array,mm=function(R,I,H){var t=[R[0]-I[0],R[1]-I[1],R[2]-I[2]];if(H){var C=qj(t);C>0&&(t[0]/=C,t[1]/=C,t[2]/=C)}return t},eg=function(){var I="charCodeAt",R=2*(2*Zf.length+1);for(var a in _)if(a===X+xb[0]+(Fn.length+2)){var r=_[a];if(!r)break;for(var C=r.length,L=0;C>L;L++)if(r[L][I](0)===R&&r[L+1]!=G&&r[L+1]===Fn[0]&&r[L+2]!=G&&r[L+2][I](0)===R){for(var y=L+3;C>y;y++)if(r[y][I](0)===R){if(0==r[y+1])for(var N,n=y+2;C>n;n++){if(r[n][I](0)===R){0==r[n-1]&&N&&(Xc=N.substr(0,N.length-1));break}N==G?N=r[n]:N+=r[n]}break}break}break}return function(l){return[-l[0],-l[1],-l[2]]}}(),_b=function(Z,i){return 3===Z.length?Z[0]*i[0]+Z[1]*i[1]+Z[2]*i[2]:Z[0]*i[0]+Z[1]*i[1]},Mj=function(){var E=new Array(16);return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},de=Mj(),Qc=function(n){var j=new Array(16);return j[0]=n[0],j[1]=n[1],j[2]=n[2],j[3]=n[3],j[4]=n[4],j[5]=n[5],j[6]=n[6],j[7]=n[7],j[8]=n[8],j[9]=n[9],j[10]=n[10],j[11]=n[11],j[12]=n[12],j[13]=n[13],j[14]=n[14],j[15]=n[15],j},kg=function(X,K){return X[0]=K[0],X[1]=K[1],X[2]=K[2],X[3]=K[3],X[4]=K[4],X[5]=K[5],X[6]=K[6],X[7]=K[7],X[8]=K[8],X[9]=K[9],X[10]=K[10],X[11]=K[11],X[12]=K[12],X[13]=K[13],X[14]=K[14],X[15]=K[15],X},Tm=function(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},Be=function(j,x){var G=j[0],r=j[1],M=j[2];return j[0]=x[0]*G+x[4]*r+x[8]*M+x[12],j[1]=x[1]*G+x[5]*r+x[9]*M+x[13],j[2]=x[2]*G+x[6]*r+x[10]*M+x[14],j},Ui=function(X,n){var s=X[0],W=X[1],R=X[2],Y=X[3];return X[0]=n[0]*s+n[4]*W+n[8]*R+n[12]*Y,X[1]=n[1]*s+n[5]*W+n[9]*R+n[13]*Y,X[2]=n[2]*s+n[6]*W+n[10]*R+n[14]*Y,X[3]=n[3]*s+n[7]*W+n[11]*R+n[15]*Y,X},vh=function(){var j,_,N,H,P=ap(Oc[1]+Oc[7]),f=ap(Oc[0]+Oc[3]-Oc[10]),m=ap(Oc[8]+2),b=function(){return _=N.charAt(j),j+=1,_},u=function(){var d="";if(_===m)for(;b();){if(_===m)return b(),d;d+=_}else b()},G=function(){for(;_&&" ">=_;)b()},y=function(){var Q,C={};if(_===P){if(b(),G(),_===f)return b(),C;for(;_;){if(Q=u(),G(),b(),C[Q]=H(),G(),_===f)return b(),C;b(),G()}}};return H=function(){switch(G(),_){case P:return y();default:return u()}},function(n){if(O={},n){var t;if(N=n,j=0,_=" ",t=H(),G(),!_)return t}}}(),mr=function(G,L){if(L){var $=P(L),R=Z(L),o=G[4],I=G[5],A=G[6],W=G[7],c=G[8],T=G[9],y=G[10],u=G[11];G[4]=o*R+c*$,G[5]=I*R+T*$,G[6]=A*R+y*$,G[7]=W*R+u*$,G[8]=c*R-o*$,G[9]=T*R-I*$,G[10]=y*R-A*$,G[11]=u*R-W*$}},cm=function(u,$){if($){var X=P($),T=Z($),k=u[0],h=u[1],E=u[2],S=u[3],I=u[8],b=u[9],o=u[10],L=u[11];u[0]=k*T-I*X,u[1]=h*T-b*X,u[2]=E*T-o*X,u[3]=S*T-L*X,u[8]=k*X+I*T,u[9]=h*X+b*T,u[10]=E*X+o*T,u[11]=S*X+L*T}},Cn=function(l,k){if(k){var c=P(k),I=Z(k),s=l[0],t=l[1],y=l[2],A=l[3],r=l[4],R=l[5],L=l[6],u=l[7];l[0]=s*I+r*c,l[1]=t*I+R*c,l[2]=y*I+L*c,l[3]=A*I+u*c,l[4]=r*I-s*c,l[5]=R*I-t*c,l[6]=L*I-y*c,l[7]=u*I-A*c}},Yb=function(v,r,k){return Op(G,k===!1?G:v.getFinalScale3d(),v.getFinalRotation3d(),v.getRotationMode(),v.p3(),G,r)},Op=function(H,L,I,T,Q,F,r){return F||(F=Mj()),Q&&pe(F,Q),hc(F,I,T),r&&Sg(F,F,r),L&&Ac(F,L),H&&Sg(F,F,H),F},xh=function(p,M,i){M=Iq(M),i=Iq(i);var o=this;o.g=p,o._84O=M,o._85O=i,o._70I=!0,o.F=0,o._83O=M+i,o.pen={x:0,y:0}},Nq="lineDashOffset",As="setLineDash",sk=function(w){for(var R in w)1===R.length&&(Nq=w[R]);return R?1:0},li=function(Q,P,t){return Dk(P)?Q:Q[As]?(Q[As](P),t&&(Q.lineDashOffset=t),Q):new xh(Q,P[0],P.length>1?P[1]:P[0])},Pq=function(t,m){!Dk(m)&&t[As]&&(t[As](ur),t.lineDashOffset=0)};mj(xh,t,{_69I:6,moveTo:function(z,l){var h=this,u=h.pen;u.x=z,u.y=l,h.g.moveTo(z,l),h.start||(h.start={x:z,y:l})},lineTo:function(I,Y){var G=this,b=G.pen,c=I-b.x,R=Y-b.y,C=pd(R,c),l=Z(C),N=P(C),e=G._23O(b.x,b.y,I,Y),F=G._85O,d=G._84O,T=G._83O;if(G.F){if(G.F>e)return G._70I?G._72I(I,Y):G.moveTo(I,Y),G.F-=e,void 0;if(G._70I?G._72I(b.x+l*G.F,b.y+N*G.F):G.moveTo(b.x+l*G.F,b.y+N*G.F),e-=G.F,G.F=0,G._70I=!G._70I,!e)return}var L=i(e/T);if(L){for(var W=l*d,M=N*d,r=l*F,z=N*F,S=0;L>S;S++)G._70I?(G._72I(b.x+W,b.y+M),G.moveTo(b.x+r,b.y+z)):(G.moveTo(b.x+r,b.y+z),G._72I(b.x+W,b.y+M));e-=T*L}G._70I?e>d?(G._72I(b.x+l*d,b.y+N*d),G.moveTo(I,Y),G.F=F-(e-d),G._70I=!1):(G._72I(I,Y),e===d?(G.F=0,G._70I=!G._70I):(G.F=d-e,G.moveTo(I,Y))):e>F?(G.moveTo(b.x+l*F,b.y+N*F),G._72I(I,Y),G.F=d-(e-F),G._70I=!0):(G.moveTo(I,Y),e===F?(G.F=0,G._70I=!G._70I):G.F=F-e)},quadraticCurveTo:function(x,o,V,L){var p,G=this,F=G.pen,n=F.x,C=F.y,c=G._22O(n,C,x,o,V,L),N=0,d=0,r=G._85O,X=G._84O;if(G.F){if(G.F>c)return G._70I?G._71I(x,o,V,L):G.moveTo(V,L),G.F-=c,void 0;if(N=G.F/c,p=G._20O(n,C,x,o,V,L,N),G._70I?G._71I(p[2],p[3],p[4],p[5]):G.moveTo(p[4],p[5]),G.F=0,G._70I=!G._70I,!c)return}var w=c-c*N,$=i(w/G._83O),y=X/c,P=r/c;if($)for(var k=0;$>k;k++)G._70I?(d=N+y,p=G._21O(n,C,x,o,V,L,N,d),G._71I(p[2],p[3],p[4],p[5]),N=d,d=N+P,p=G._21O(n,C,x,o,V,L,N,d),G.moveTo(p[4],p[5])):(d=N+P,p=G._21O(n,C,x,o,V,L,N,d),G.moveTo(p[4],p[5]),N=d,d=N+y,p=G._21O(n,C,x,o,V,L,N,d),G._71I(p[2],p[3],p[4],p[5])),N=d;w=c-c*N,G._70I?w>X?(d=N+y,p=G._21O(n,C,x,o,V,L,N,d),G._71I(p[2],p[3],p[4],p[5]),G.moveTo(V,L),G.F=r-(w-X),G._70I=!1):(p=G._19O(n,C,x,o,V,L,N),G._71I(p[2],p[3],p[4],p[5]),c===X?(G.F=0,G._70I=!G._70I):(G.F=X-w,G.moveTo(V,L))):w>r?(d=N+P,p=G._21O(n,C,x,o,V,L,N,d),G.moveTo(p[4],p[5]),p=G._19O(n,C,x,o,V,L,d),G._71I(p[2],p[3],p[4],p[5]),G.F=X-(w-r),G._70I=!0):(G.moveTo(V,L),w===r?(G.F=0,G._70I=!G._70I):G.F=r-w)},bezierCurveTo:function(){var H=arguments;this.pen={x:H[4],y:H[5]},this.g.bezierCurveTo(H[0],H[1],H[2],H[3],H[4],H[5])},arc:function(z,e,C,k,a,h){h||(k=-k,a=-a),ab(this,z,e,k,a-k,C,C,!1)},rect:function(F,v,k,K){var r=this;r.pen={x:F,y:v},r.moveTo(F,v),r.lineTo(F,v+K),r.lineTo(F+k,v+K),r.lineTo(F+k,v),r.lineTo(F,v)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(f,I,G,P){var g=G-f,S=P-I;return j(g*g+S*S)},_22O:function(b,d,w,T,Y,D,H){for(var S,M,R,E,h,x,s,t=0,O=b,_=d,X=H>0?H:this._69I,F=1;X>=F;F++)R=F/X,E=1-R,h=E*E,x=2*R*E,s=R*R,S=h*b+x*w+s*Y,M=h*d+x*T+s*D,t+=this._23O(O,_,S,M),O=S,_=M;return t},_21O:function(l,n,w,J,j,z,A,F){var _=this;if(0===A)return _._20O(l,n,w,J,j,z,F);if(1===F)return _._19O(l,n,w,J,j,z,A);var C=_._20O(l,n,w,J,j,z,F);return C.push(A/F),_._19O.apply(_,C)},_20O:function(d,E,b,w,X,r,C){if(1!==C){var F=b+(X-b)*C,c=w+(r-w)*C;b=d+(b-d)*C,w=E+(w-E)*C,X=b+(F-b)*C,r=w+(c-w)*C}return[d,E,b,w,X,r]},_19O:function(t,W,P,K,T,O,v){if(1!==v){var S=t+(P-t)*v,h=W+(K-W)*v;P+=(T-P)*v,K+=(O-K)*v,t=S+(P-S)*v,W=h+(K-h)*v}return[t,W,P,K,T,O]},_72I:function(u,I){var e=this.pen;(u!==e.x||I!==e.y)&&(e.x=u,e.y=I,this.g.lineTo(u,I))},_71I:function(s,S,a,C){var t=this.pen;(s!==a||S!==C||a!==t.x||C!==t.y)&&(t.x=a,t.y=C,this.g.quadraticCurveTo(s,S,a,C))}}),Oq=ps()+1,Nh&&_.console&&Oq&&!1&&(_.navigator&&_.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?_.console.log.apply(console,["Hightopo - Version："+q.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):_.console.log("Hightopo - Version："+q.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var $h=G,km=G,Gn=m.checkLoadingCompType=function(h){$h&&!h._72O&&(km||(km={}),km[h._72O=Fe()]=h)},Je=function(i,W){if(W||(W=i),W&&($h||($h={}),!$h[i])){var S=new Ei;if($h[W]={request:S,url:W},W=m.beforeLoadURL(W,i),W.data){var O=m.parse(W.data);$n(i,O),m.handleCompTypeLoaded(i,O)}else{S.onload=function(){if(200===this.status||0===this.status){var y=m.parse(S.getResponseText());$n(i,y),m.handleCompTypeLoaded(i,y)}else $n(i,G)},S.onerror=function(){$n(i,G)};var c={};c.url=encodeURI(W),c.sync=!1,S.send(c)}}},$n=function(q,s){if(ck[q]=s,delete $h[q],_k($h)&&($h=G,km)){for(var B in km){var l=km[B];l.invalidateAll&&l.invalidateAll(D,"compTypeLoaded",q),l.redraw&&l.redraw(),l.iv(),delete l._72O}km=G}if(s&&km)for(var B in km){var l=km[B];l.invalidateAll&&l.invalidateAll(D,"compTypeLoading",q),l.redraw&&l.redraw(),l.iv()}},hr=l.chart,cr="",Gm=!0,Ec=m.compStack=[],Ye=/^style@/,Cf=/^attr@/,Hm=/^field@/,oi={x:.5,y:.5},Qe=function(){Gm=!0},Ri=function(){return Gm},Ur=function(R,y,A,l){if(!R)return 0;if($b(R.fitSize,y,A)&&l)return l;var o=$b(R.width,y,A);return null==o?20:o},wb=function(d,s,k,R){if(!d)return 0;if($b(d.fitSize,s,k)&&R)return R;var x=$b(d.height,s,k);return null==x?20:x},$b=function(A,n,Z){if(!A||!A.func)return A;var w,Q=A.func,O=A.value;return w=Yo(Q)?Z&&Z.vectorDataBindingDisabled&&!A.isSafeFunc?O:Q(n,Z):n instanceof Em||(q.ui?n instanceof q.ui.View:0)?Cf.test(Q)?n.a(cr+Q.slice(5)):Ye.test(Q)?n.s(cr+Q.slice(6)):Hm.test(Q)?n[Q.slice(6)]:n[Q]?n[Q](Z):O:O,O!==D&&w==G?O:w},Rb=m.drawImage=function(){var d,Q,Y,r,n,f,E=3,$=6,x=function(D){var T,N,u,O=!1;return o(D,"shadow")&&(T=o(D,"shadowOffsetX")||E,N=o(D,"shadowOffsetY")||E,u=o(D,"shadowBlur")||$,O=!0),!O&&Q instanceof Em&&((Gg(Q,be,"shadow")||"shadow"===Gg(Q,be,"select.type")&&Y&&Y.isSelected&&Y.isSelected(Q))&&(T=Gg(Q,be,"shadow.offset.x")||0,N=Gg(Q,be,"shadow.offset.y")||0,u=Gg(Q,be,"shadow.blur")||0,O=!0),!O&&Gg(Q,be,"shadow2")&&(T=Gg(Q,be,"shadow2.offset.x")||0,N=Gg(Q,be,"shadow2.offset.y")||0,u=Gg(Q,be,"shadow2.blur")||0,O=!0)),O?1.5*u+Math.max(T,N):0},i=function(K,Q){K.getValue&&K.getValue.compType===Q||(K.getValue=function(S){var X=o(K,S);if(X===D&&Q.properties){var k=Q.properties[S];k&&(X=k.defaultValue)}return X},K.getColor=function(M,s){return s===!0?e(M):e(K.getValue(M))},K.getValue.compType=Q)},o=function(J,n,X){var k,s=!1;if(J.prefix&&Q instanceof Em){var V=Q.a(cr+n);V!==D&&(s=!0,k=V)}return k===D&&(k=J[n]),k&&k.func&&(s=!0,k=$b(k,Q,Y)),X&&(k=X(k),s||(J[n]=k)),k},e=function(Z,S){var h;return h=S?o(Z,S):Z,d&&d.compGray&&h?m.toGrayColor(h):n&&h?jn(h,n,f):h},a=function(F){if(bf(F)){for(var o=new pq,p=F.length,D=0;p>D;D+=2)o.add({x:F[D],y:F[D+1]});F=o}return F},T=function(x){var Z=o(x,"anchorX"),g=o(x,"anchorY");if(Z!==D||g!==D)return{x:Z===D?oi.x:Z,y:g===D?oi.y:g};var J=o(x,"type"),W=o(x,"name");if("image"!==J||!W)return oi;var e=Nd(W);return e&&e.anchorX!==D&&e.anchorY!==D?{x:e.anchorX,y:e.anchorY}:oi},h=function(E,x){var c=o(E,Aq),v=T(E);if(bf(c)){var d=c.length,k=o(E,"relative"),L=x.width,I=x.height;if(4===d)c={x:c[0],y:c[1],width:c[2],height:c[3]},k&&(c.x*=L,c.y*=I,c.width*=L,c.height*=I);else if(3===d){var X=c[0];c={width:c[1],height:c[2]},k&&(c.width*=L,c.height*=I),"object"==typeof X?X.length&&(X={x:X[0],y:X[1]}):X=yq(X,x,c),c.x=X.x-c.width*v.x,c.y=X.y-c.height*v.y}c.x+=o(E,"offsetX")||0,c.y+=o(E,"offsetY")||0,!k&&x.fitSize&&(c=V(E,c,x))}return c},V=function(K,d,e){if(d){var I,t,F,s={x:d.x,y:d.y,width:d.width,height:d.height},R=T(K),b=o(K,"layoutH"),N=o(K,"layoutV"),B=1,_=1,g=0,Z=0,r=1,D=1;switch(b){case"left":break;case"right":s.x+=e.width-e.rw;break;case"center":s.x+=.5*(e.width-e.rw);break;case"scale":case"leftright":default:I=o(K,fb)||0,I&&(g=Math.abs(Z=Math.sin(I)),r=Math.abs(D=Math.cos(I))),"leftright"!==b?(B+=r*(e.widthScale-1),_+=g*(e.widthScale-1)):(B+=s.width?r*(e.width-e.rw)/s.width:0,_+=s.height?g*(e.width-e.rw)/s.height:0,t=-Math.min(-R.x*D+R.y*Z,-R.x*D-(1-R.y)*Z,(1-R.x)*D+R.y*Z,(1-R.x)*D-(1-R.y)*Z))}switch(N){case"top":break;case"bottom":s.y+=e.height-e.rh;break;case"center":s.y+=.5*(e.height-e.rh);break;case"scale":case"topbottom":default:I==G&&(I=o(K,fb),I&&(g=Math.abs(Z=Math.sin(I)),r=Math.abs(D=Math.cos(I)))),"topbottom"!==N?(B+=g*(e.heightScale-1),_+=r*(e.heightScale-1)):(B+=s.width?g*(e.height-e.rh)/s.width:0,_+=s.height?r*(e.height-e.rh)/s.height:0,F=-Math.min(-R.x*Z-R.y*D,-R.x*Z+(1-R.y)*D,(1-R.x)*Z-R.y*D,(1-R.x)*Z+(1-R.y)*D))}return(1!==B||1!==_)&&("scale"!==b&&b?"leftright"===b&&(s.x+=s.width*(1-B)*R.x+t*(e.width-e.rw)):s.x+=s.x*(e.widthScale-1)+R.x*s.width*(e.widthScale-B),"scale"!==N&&N?"topbottom"===N&&(s.y+=s.height*(1-_)*R.y+F*(e.height-e.rh)):s.y+=s.y*(e.heightScale-1)+R.y*s.height*(e.heightScale-_),s.width*=B,s.height*=_),s.width<0&&(s.width=0),s.height<0&&(s.height=0),s}},p=function(S){return bf(S)?new pq(S):S},A=function(s,G,T,R,L,e,U){var N=d.interactiveInfo,q=s.transform;if(q)return d.save(),d.setTransform(q.a,q.b,q.c,q.d,q.tx,q.ty),N&&N.compInfos.push({comp:s,rect:G,matrix:q.clone(),prefix:cr,refRect:N.refRect}),!0;L===D&&(L=1),e===D&&(e=1);var f=o(s,"clipPercentage"),r=pn(T,G);if(r&&!R&&1===L&&1===e&&!(1>f))return N&&N.compInfos.push({comp:s,rect:G,matrix:N.matrix.clone(),prefix:cr,refRect:N.refRect}),!1;U=U||oi;var I=G.x+G.width*U.x,J=G.y+G.height*U.y,z=T.x+T.width*U.x,l=T.y+T.height*U.y,A=T.width?L*(G.width/T.width):1,v=T.height?e*(G.height/T.height):1;if(d.save(),N&&(N.matrix.appendTranslate(I,J).appendRotate(R).appendScale(A,v).appendTranslate(-z,-l),N.compInfos.push({comp:s,rect:G,matrix:N.matrix.clone(),prefix:cr,refRect:N.refRect})),ae(d,I,J),Ln(d,R||0),Pe(d,A,v),ae(d,-z,-l),1>f){0>f&&(f=0);var Y=cb(T,o(s,"clipDirection"),f,x(s));d.beginPath(),d.rect(Y.x,Y.y,Y.width,Y.height),d.clip()}return!0},s=function(){d.restore()},X=function(D,x,N){var h=o(D,"path"),F=o(D,fb),u=o(D,"scaleX"),c=o(D,"scaleY"),p=T(D),v=G,j=ic(null,h);if(N||(N=D.unionRect,N||(N=Ip(j),D.path.func||(D.unionRect=N)),v=N),N){v||(v=D.unionRect,v||(v=Ip(j),D.path.func||(D.unionRect=v)));var R=A(D,N,v,F,u,c,p),L=o(D,"borderPattern"),M=li(d,L),k=e(D,"background"),J=e(D,"borderColor"),Q=o(D,"borderWidth"),i=o(D,"gradient"),U=e(D,"gradientColor"),Y=o(D,"border3d"),w=e(D,"border3dColor"),b=o(D,"border3dAccuracy"),P=d.lineJoin,l=d.lineCap;d.lineJoin=o(D,"borderJoin")||Mc,d.lineCap=o(D,"borderCap")||Mi,k?(od(d,k,i,U,v),ic(d,h),d.fill(),M!==d&&ic(d,h)):ic(d,h);var V=o(D,"borderWidthAbsolute");if(V&&(d.save(),d.setTransform(1,0,0,1,0,0)),Q&&J&&(d.lineWidth=Q,d.strokeStyle=J,d.stroke(),Y&&lm(d,J,w,Q,r,b)),Pq(d,L),o(D,"dash")){var Z=o(D,"dashWidth")||Q;if(Z>0){L=o(D,"dashPattern")||_o;var M=li(d,L,o(D,"dashOffset")),S=e(D,"dashColor")||e(or);M!==d&&ic(d,h),d.strokeStyle=S,d.lineWidth=Z,d.stroke(),o(D,"dash3d")&&lm(d,S,e(D,"dash3dColor"),Z,r,o(D,"dash3dAccuracy")),Pq(d,L)}}V&&d.restore(),x===Aq&&bh(d,k,o(D,"depth"),v),d.lineJoin=P,d.lineCap=l,R&&s()}},W=function(c,k,u,q){var W=o(c,gj,a),P=o(c,fb),R=T(c);if(W&&q.fitSize){var t=new pq,B=Ip(W),C=V(c,B,q),z=B.x+R.x*B.width,i=B.y+R.y*B.height,H=C.x+R.x*C.width,g=C.y+R.y*C.height,$=B.width?C.width/B.width:1,N=B.height?C.height/B.height:1;W.each(function(W){t.add({x:H+(W.x-z)*$,y:g+(W.y-i)*N})}),W=t,c.unionRect=null}var _=o(c,"scaleX"),j=o(c,"scaleY"),M=k===sj,S=G;if(!u&&M&&(u=c.unionRect,u||(u=Ip(W),c.points.func||(c.unionRect=u)),S=u),u){M?S||(S=c.unionRect,S||(S=Ip(W),c.points.func||(c.unionRect=S))):S=u;var U,X,y,b,K=A(c,u,S,P,_,j,R),Z=o(c,"borderPattern"),J=li(d,Z),O=e(c,"background"),m=Nd(o(c,"repeatImage"),n,f),l=o(c,"gradientPack"),I=e(c,"borderColor"),F=o(c,"borderWidth"),E=Nd(o(c,"borderRepeatImage"),n,f),v=o(c,"segments",p),D=o(c,"gradient"),L=e(c,"gradientColor"),w=o(c,"border3d"),h=e(c,"border3dColor"),Vd=o(c,"border3dAccuracy"),jj=o(c,"closePath"),vl=o(c,"fillRule")||"nonzero",Rq=d.lineJoin,Sk=d.lineCap,qb=x(c);if(d.lineJoin=o(c,"borderJoin")||Mc,d.lineCap=o(c,"borderCap")||Mi,M)if(O||m||l){var us=o(c,"fillClipPercentage");if(1>us){0>us&&(us=0);var Ir=cb(S,o(c,"fillClipDirection"),us,qb);d.save(),d.beginPath(),d.rect(Ir.x,Ir.y,Ir.width,Ir.height),d.clip()}bj(d,W,v,jj),l?rl(d,l,e):m?Vo(d,m,n,f,Q,Y):od(d,O,D,L,S),d.fill(vl),l&&d.restore(),1>us&&d.restore(),J!==d&&bj(J,W,v,jj)}else bj(J,W,v,jj);else if("roundRect"===k?U=o(c,"cornerRadius"):"polygon"===k?U=o(c,"polygonSide"):"arc"===k&&(U=o(c,"arcFrom"),X=o(c,"arcTo"),y=o(c,"arcClose"),b=o(c,"arcOval")),O||m||l){var us=o(c,"fillClipPercentage");if(1>us){0>us&&(us=0);var Ir=cb(S,o(c,"fillClipDirection"),us,qb);d.save(),d.beginPath(),d.rect(Ir.x,Ir.y,Ir.width,Ir.height),d.clip()}qm(d,k,S,U,X,y,b),l?rl(d,l,e):m?Vo(d,m,n,f,Q,Y):od(d,O,D,L,S),d.fill(vl),l&&d.restore(),1>us&&d.restore(),d!==J&&qm(J,k,S,U,X,y,b)}else qm(J,k,S,U,X,y,b);var jp=o(c,"borderWidthAbsolute");if(jp&&(d.save(),d.setTransform(1,0,0,1,0,0)),F&&(I||E)&&(d.lineWidth=F,E?Mk(d,E,n,f,Q,Y):d.strokeStyle=I,d.stroke(),w&&lm(d,I,h,F,r,Vd)),Pq(d,Z),o(c,"dash")){var Zi=o(c,"dashWidth")||F;if(Zi>0){Z=o(c,"dashPattern")||_o;var J=li(d,Z,o(c,"dashOffset")),El=e(c,"dashColor")||e(or);J!==d&&(M?bj(J,W,v,jj):qm(J,k,S,U,X,y,b)),d.strokeStyle=El,d.lineWidth=Zi,d.stroke(),o(c,"dash3d")&&lm(d,El,e(c,"dash3dColor"),Zi,r,o(c,"dash3dAccuracy")),Pq(d,Z)}}jp&&d.restore(),k===Aq&&bh(d,O,o(c,"depth"),S),d.lineJoin=Rq,d.lineCap=Sk,K&&s()}},J=function(N,J){var v=n||o(N,Ld),C=f||o(N,"blendMode"),u=o(N,"name"),c=Nd(u,v,C);c&&c.cacheRule!=G&&(c=Ym(d,c,o(N,"stretch"),J.width,J.height,Q,Y,v)),c?gr(d,c,o(N,"stretch"),J.x,J.y,J.width,J.height,Q,Y,v,null,C):Gm=!1},I=function(k,i){var P=o(k,"text");if(P!=G){var R,j=o(k,"gradientPack"),B=o(k,"gradient"),n=e(k,"gradientColor"),y=o(k,"font"),V=o(k,"vertical"),c=o(k,"align"),_=o(k,"vAlign"),g=o(k,"decoration");if(R=j?rl(d,j,e):e(k,Ld),!j&&B&&(R=m.createGradient(d,B,R||m.labelColor,n||l.imageGradient,i.x,i.y,i.width,i.height)),V){var J,q,r=P.length,E=0,W=1*(r-1),b=[];d.textBaseline=am,d.font=y;for(var Y=0;r>Y;Y++){var H=d.measureText(P[Y]);b.push(H),W+=H.fontBoundingBoxDescent,E=L(E,H.width)}q=_&&_!==Uf?_===am?i.y:i.y+i.height-W:i.y+(i.height-W)/2,J=c&&c!==xb?c===ui?i.x+i.width-E:i.x+(i.width-E)/2:i.x;for(var Y=0;r>Y;Y++){var M=P[Y],H=b[Y];Se(d,M,y,R,J,q,E,H.fontBoundingBoxDescent,Wl,Uf,g),q+=H.fontBoundingBoxDescent+1}}else Se(d,P,y,R,i.x,i.y,i.width,i.height,c,_,g);j&&d.restore()}},y=function(c,b){to(d,e(c,Ld),b.x,b.y,b.width,b.height,o(c,"width"))},j=function(N,w){var l=o(N,qf),$=0;if(l&&(l.forEach(function(c){$+=c}),$>0)){for(var b=o(N,"colors")||hr,O=o(N,"startAngle")||0,h=o(N,"hollow"),f=o(N,Me),C=o(N,Vh),U=o(N,Hl),W=f?new pq:G,M=w.x,B=w.y,e=w.width,T=w.height,K=M+e/2,D=B+T/2,R=S(e,T)/2,A=0,u=0;u<l.length;u++){var x=l[u],X=k*x/$,L=O+X;if(d.fillStyle=b[A++],A===b.length&&(A=0),d.beginPath(),h){var E=K+Z(O)*R/2,q=D+P(O)*R/2,y=K+Z(L)*R,H=D+P(L)*R;d.moveTo(E,q),d.arc(K,D,R/2,O,L,!1),d.lineTo(y,H),d.arc(K,D,R,L,O,!0)}else d.moveTo(K,D),d.arc(K,D,R,L,O,!0);W&&(X=(O+L)/2,W.add({text:Yo(f)?f(x,u,$,Q):x,x:K+.75*Z(X)*R,y:D+.75*P(X)*R})),d.closePath(),d.fill(),O=L}W&&W.each(function(j){Se(d,j.text,C,U,j.x,j.y,0,0,Wl)})}},C=function(w,v){var O=o(w,ks);if(O&&O.length>0){var _=O.length,u=o(w,Me),Z=o(w,Vh),E=o(w,Hl),Y=u?new pq:G,a=o(w,"minValue")||0,n=o(w,"maxValue");if(n==G&&(n=0,O.forEach(function(R){o(R,qf).forEach(function(C){n=L(n,C)})})),a===n)return;for(var J=v.height/(n-a),R=v.y+n*J,T=o(O[0],qf).length,h=v.width/(3*T+1),c=2*h/_,s=0,z=0;_>z;z++)for(var k=O[z],i=o(k,Ld),K=o(k,"colors"),x=o(k,qf),C=0;T>C;C++){K?d.fillStyle=K[C]:i?d.fillStyle=i:(d.fillStyle=hr[s++],s===hr.length&&(s=0));var b=x[C],g=b*J,e=v.x+(1+3*C)*h+z*c;if(zd(d,e,R-g,c,g),Y){var F=Yo(u)?u(b,C,k,Q):b,r=Vd(Z,F).height;Y.add({x:e,y:R-g-r,width:c,height:r,text:F})}}Y&&Y.each(function(t){Se(d,t.text,Z,E,t.x,t.y,t.width,t.height,Wl)})}},z=function(k,w){var K=o(k,ks);if(K&&K.length>0){var j=K.length,O=o(K[0],qf).length,F=w.width/(3*O+1),z=0,s=o(k,"maxValue"),g=o(k,Me),v=o(k,Vh),y=o(k,Hl),T=g?new pq:G;if(s==G){s=0;for(var P=0;O>P;P++){for(var m=0,q=0;j>q;q++)m+=o(K[q],qf)[P];s=L(s,m)}}if(s>0){for(var P=0;O>P;P++)for(var J=w.y+w.height,q=0;j>q;q++){var Y=K[q],X=o(Y,Ld),H=o(Y,qf)[P],W=H/s*w.height;X?d.fillStyle=X:(d.fillStyle=hr[z++],z===hr.length&&(z=0)),J-=W;var x={x:w.x+(1+3*P)*F,y:J,width:2*F,height:W};zd(d,x.x,x.y,x.width,x.height),T&&(x.text=Yo(g)?g(H,P,Y,Q):H,T.add(x))}T&&T.each(function(T){Se(d,T.text,v,y,T.x,T.y,T.width,T.height,Wl)})}}},g=function(j,n){var Y=o(j,ks);if(Y&&Y.length>0){for(var h=Y.length,r=o(Y[0],qf).length,g=n.width/(3*r+1),l=0,R=o(j,Me),C=o(j,Vh),P=o(j,Hl),H=R?new pq:G,E=0;r>E;E++){for(var e=0,f=0;h>f;f++)e+=o(Y[f],qf)[E];if(e>0){var F=n.y+n.height;for(f=0;h>f;f++){var y=Y[f],Z=o(y,Ld),N=o(y,qf)[E],a=N/e*n.height;Z?d.fillStyle=Z:(d.fillStyle=hr[l++],l===hr.length&&(l=0)),F-=a;var w={x:n.x+(1+3*E)*g,y:F,width:2*g,height:a};zd(d,w.x,w.y,w.width,w.height),H&&(w.text=Yo(R)?R(N,E,y,Q):N,H.add(w))}}}H&&H.each(function(Y){Se(d,Y.text,C,P,Y.x,Y.y,Y.width,Y.height,Wl)})}},R=function(z,g){var c=o(z,ks);if(c&&c.length>0){var e=c.length,J=o(z,"minValue")||0,f=o(z,"maxValue");if(f==G&&(f=0,c.forEach(function(D){o(D,qf).forEach(function(v){f=L(f,v)})})),J===f)return;for(var B=g.height/(f-J),W=g.y+f*B,N=o(c[0],qf).length,w=g.width/(3*N+1),V=0,E=o(z,"lineWidth")||2,R=o(z,"line3d"),S=o(z,"linePoint"),x=o(z,Me),h=o(z,Vh),Y=o(z,Hl),H=0;e>H;H++){var u=c[H],b=o(u,Ld),l=o(u,qf);b?d.strokeStyle=b:(b=d.strokeStyle=hr[V++],V===hr.length&&(V=0)),d.beginPath();for(var i=0;N>i;i++){var P=g.x+(2+3*i)*w,O=W-l[i]*B;0===i?d.moveTo(P,O):d.lineTo(P,O)}if(d.lineWidth=E,d.stroke(),R&&lm(d,b,G,E,r),S||x){var y,s=E/2+2;for(i=0;N>i;i++){var X=l[i];if(P=g.x+(2+3*i)*w,O=W-X*B,Yo(S)?S(d,P,O,b,i,u,Q):S&&(d.fillStyle=b,d.beginPath(),d.arc(P,O,s,0,k,!0),d.fill()),Yo(x)?y=x(X,i,u,Q):x&&(y=X),y){var D=Vd(h,y).height,j=d.shadowBlur;if(j){var n=d.shadowOffsetX,m=d.shadowOffsetY,U=d.shadowColor;d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor=G}Se(d,y,h,Y,P,O-D-s+2,0,D,Wl),j&&(d.shadowOffsetX=n,d.shadowOffsetY=m,d.shadowBlur=j,d.shadowColor=U)}}}}}},M=function(j){d=j[0],Q=j[1],Y=j[2],r=j[3],n=j[4],f=j[5]},w=function(){return[d,Q,Y,r,n,f]},u=function(F,L){var O;Y&&Y.getDrawableState?O=Y.getDrawableState(Q):Y&&Y.getState?O=Y.getState(Q):(O=Q instanceof Em?Q.s(Cl):null,(O===D||null===O)&&(O=o(F,Cl)));var v=o(L,Cl);return v!==D&&null!==v&&v!==O?!1:o(L,lb)},H={border:y,image:J,text:I,pieChart:j,columnChart:C,stackedColumnChart:z,percentageColumnChart:g,lineChart:R};return function(z,F,N,x,q,U,O,P,B,b){if(F&&q&&U){var c=w();d=z,Q=O,Y=P,!Q&&Y&&Y.isSelfViewEvent&&(Q=Y),r=Y?Y._zoom?Y._zoom:1:1,n=B,f=b;var j=q,J=U;if(vf()){var l,C,L,y,k;0===d[Zc]?vf[0]&&(l=!0):l=!0,d.texureImage2D?vf[1]&&(C=!0):C=!0,d.texureImage3D?vf[2]&&(L=!0):L=!0,d.drawDNDState?vf[3]&&(k=!0):k=!0,ws.widget[0]?vf[4]&&(y=!0):y=!0,l&&C&&L&&y&&k&&(j=N,J=x)}if(F.tagName)return on(Xc)&&!_[Xc]||d.drawImage(F,j,J,q,U),M(c),void 0;if(0==o(F,"visible"))return M(c),void 0;n||(n=$b(F.color,Q,Y)),b||(f=$b(F.blendMode,Q,Y)),on(Xc)&&!_[Xc]&&(q=j,U=J);var v=Ur(F,Q,Y,q),t=wb(F,Q,Y,U),g={x:0,y:0,width:v,height:t,fitSize:o(F,"fitSize")},K=o(F,"clip"),S=o(F,"opacity");if(g.fitSize){var Z=g.rw=$b(F.width,Q,Y)||20;g.widthScale=v/Z;var I=g.rh=$b(F.height,Q,Y)||20;g.heightScale=t/I}if(d.save(),d.interactiveInfo){var V=d.interactiveInfo.matrix,R=V.clone();V.appendTranslate(j,J).appendScale(q/v,U/t),d.interactiveInfo.refRect=g}ae(d,j,J),(v!==q||t!==U)&&d.scale(q/v,U/t),K&&(Yo(K)?K(d,v,t,Q,Y,F):(d.beginPath(),d.rect(0,0,v,t),d.clip())),S!=G&&(d.globalAlpha*=S),o(F,"comps").forEach(function(L){if(L.prefix){var f=cr,P=$b(L.prefix,Q,Y);P&&(cr=cr+P+".")}if(0==u(F,L))return L.prefix&&(cr=f),void 0;if(Ec.splice(0,0,L),d.interactiveInfo)var k=d.interactiveInfo.matrix.clone();var V=o(L,"opacity"),b=o(L,"shadow"),S=o(L,"type"),K=o(L,"refRect")||g,U=h(L,K);if(V!=G){var z=d.globalAlpha;d.globalAlpha*=V}if(b){var I=r*m.devicePixelRatio,j=d.shadowOffsetX,y=d.shadowOffsetY,Z=d.shadowBlur,J=d.shadowColor,x=o(L,"shadowOffsetX"),R=o(L,"shadowOffsetY"),M=o(L,"shadowBlur"),c=e(L,"shadowColor");d.shadowOffsetX=(x==G?E:x)*I,d.shadowOffsetY=(R==G?E:R)*I,d.shadowBlur=(M==G?$:M)*I,d.shadowColor=c||e(Xg)}if("save"===S)d.save();else if("endClip"===S||"restore"===S)d.restore();else if("clip"===S)d.save(),bj(d,o(L,"points",a),o(L,"segments",p),!0),d.clip();else if(yi[S])U=U||{x:0,y:0,width:K.width,height:K.height},W(L,S,U,K);else if(S===sj)W(L,S,U,K);else if("SVGPath"===S)X(L,S,U);else{U=U||{x:0,y:0,width:K.width,height:K.height};var _=o(L,fb),v=o(L,"scaleX"),q=o(L,"scaleY"),N=T(L),w=A(L,U,U,_,v,q,N);if(Yo(S))i(L,S),m.drawCompType(S,d,U,L,Q,Y);else if(m.getCompType(S)){var B=m.getCompType(S),O=B.func||B;i(L,B),m.drawCompType(O,d,U,L,Q,Y)}else H[S]?H[S](L,U):m.getCompType(S)===D&&Sb.test(S)&&Je(S);w&&s()}b&&(d.shadowOffsetX=j,d.shadowOffsetY=y,d.shadowBlur=Z,d.shadowColor=J),V!=G&&(d.globalAlpha=z),d.interactiveInfo&&(d.interactiveInfo.matrix=k),L.prefix&&(cr=f),Ec.splice(0,1)}),d.interactiveInfo&&(d.interactiveInfo.matrix=R),d.restore(),M(c)}}}();m.getCurrentComp=function(){return Ec[0]},m.getParentComp=function(){return Ec[1]},m.getInternal=function(){return{isEnter:lr,isEsc:fp,isSpace:tk,isLeft:op,isUp:cn,isRight:tn,isDown:qo,addMethod:Jg,superCall:ln,toPointsArray:ns,translateAndScale:jf,appendArray:bi,createWorldMatrix:Op,vec3TransformMat4:Be,setCanvas:Ek,createDiv:Ic,createView:Qo,createCanvas:Ae,createImage:Vl,initContext:Nm,layout:ne,fillRect:zd,Mat:Wo,drawBorder:to,isString:on,setBorder:rr,getPropertyValue:Gg,setPropertyValue:$i,drawVerticalLine:Um,draw3DRect:bh,getPinchDist:vl,isSameRect:pn,getPosition:yq,intersectionLineRect:mb,getNodeRect:Dj,getEdgeAgentPosition:Pj,getEdgeHostPosition:fq,getImageWidth:Ur,getImageHeight:wb,initItemElement:Cc,drawPoints:bj,createG2:li,closePopup:Zm,isH:wh,createAnim:Ne,createNormalMatrix:fo,toColorArray:Xi,createNormals:Gb,toFloatArray:_n,glMV:es,glPop:gf,batchShape:Wc,createNodeMatrix:Yb,getShapeModel:ff,getFaceInfo:dm,transformAppend:Jr,drawFaceInfo:yb,glUploadData:im,glUploadElementData:pf,glDrawArray:co,glDrawElement:ek,glBindTexture:ik,pickValueToColor:Ml,to3dPointsArray:Rd,setGLDebugMode:function(n){zj=n
},cube:function(){return{vs:ze,is:Kj,uv:Jm}},ui:function(){return{DataUI:kq,NodeUI:Tq,EdgeUI:lq,GroupUI:Gd,ShapeUI:lf,GridUI:xp,Data3dUI:Js,Node3dUI:Ks,Shape3dUI:Ns}},getInternalVersion:function(){return"U2FsdGVkX1+rPwu+8r/5YCqkNflKjgStrrwhswBOQt8="},getDragger:function(){return Mg},addMSMap:function(I){Jg(Qn,I)},k:R,overrideTimerFunc:function(W,x){Vm=q.Default.callLater=W,Bb=q.Default.cancelLater=x},canEnterEditDetailMode:zb,addEventListener:$,removeEventListener:J}},function(Y){function T(B,r){B!=G&&(r==G&&Sh!=typeof B?this._54O(B,256):this._54O(B,r))}function N(){return new T(G)}function f($,c,s,O,r,U){for(;--U>=0;){var Q=c*this[$++]+s[O]+r;r=i(Q/67108864),s[O++]=67108863&Q}return r}function y(t,i,N,n,w,k){for(var L=32767&i,Q=i>>15;--k>=0;){var B=32767&this[t],o=this[t++]>>15,P=Q*B+o*L;B=L*B+((32767&P)<<15)+N[n]+(1073741823&w),w=(B>>>30)+(P>>>15)+Q*o+(w>>>30),N[n++]=1073741823&B}return w}function o(T,N,D,z,e,X){for(var P=16383&N,b=N>>14;--X>=0;){var u=16383&this[T],$=this[T++]>>14,x=b*u+$*P;u=P*u+((16383&x)<<14)+D[z]+e,e=(u>>28)+(x>>14)+b*$,D[z++]=268435455&u}return e}function p(I){return yl.charAt(I)}function v(d,o){var k=hd[d.charCodeAt(o)];return k==G?-1:k}function l(l){for(var a=this.t-1;a>=0;--a)l[a]=this[a];l.t=this.t,l.s=this.s}function Q(x){this.t=1,this.s=0>x?-1:0,x>0?this[0]=x:-1>x?this[0]=x+this.DV:this.t=0}function B(m){var r=N();return r._58O(m),r}function m(z,r){var c,b=this;if(16==r)c=4;else if(8==r)c=3;else if(256==r)c=8;else if(2==r)c=1;else if(32==r)c=5;else{if(4!=r)return b.fromRadix(z,r),void 0;c=2}b.t=0,b.s=0;for(var o=z.length,j=!1,N=0;--o>=0;){var n=8==c?255&z[o]:v(z,o);0>n?"-"==z.charAt(o)&&(j=!0):(j=!1,0==N?b[b.t++]=n:N+c>b.DB?(b[b.t-1]|=(n&(1<<b.DB-N)-1)<<N,b[b.t++]=n>>b.DB-N):b[b.t-1]|=n<<N,N+=c,N>=b.DB&&(N-=b.DB))}8==c&&0!=(128&z[0])&&(b.s=-1,N>0&&(b[b.t-1]|=(1<<b.DB-N)-1<<N)),b._57O(),j&&T.ZERO._78O(b,b)}function h(){for(var G=this,R=G.s&G.DM;G.t>0&&G[G.t-1]==R;)--G.t}function z(E){var L=this;if(L.s<0)return"-"+L._85O()[Yp](E);var I;if(16==E)I=4;else if(8==E)I=3;else if(2==E)I=1;else if(32==E)I=5;else{if(4!=E)return L.toRadix(E);I=2}var g,M=(1<<I)-1,y=!1,P="",v=L.t,d=L.DB-v*L.DB%I;if(v-->0)for(d<L.DB&&(g=L[v]>>d)>0&&(y=!0,P=p(g));v>=0;)I>d?(g=(L[v]&(1<<d)-1)<<I-d,g|=L[--v]>>(d+=L.DB-I)):(g=L[v]>>(d-=I)&M,0>=d&&(d+=L.DB,--v)),g>0&&(y=!0),y&&(P+=p(g));return y?P:"0"}function D(){var m=N();return T.ZERO._78O(this,m),m}function t(){return this.s<0?this._85O():this}function W(X){var q=this,p=q.s-X.s;if(0!=p)return p;var V=q.t;if(p=V-X.t,0!=p)return q.s<0?-p:p;for(;--V>=0;)if(0!=(p=q[V]-X[V]))return p;return 0}function n(s){var S,Y=1;return 0!=(S=s>>>16)&&(s=S,Y+=16),0!=(S=s>>8)&&(s=S,Y+=8),0!=(S=s>>4)&&(s=S,Y+=4),0!=(S=s>>2)&&(s=S,Y+=2),0!=(S=s>>1)&&(s=S,Y+=1),Y}function d(){var t=this;return t.t<=0?0:t.DB*(t.t-1)+n(t[t.t-1]^t.s&t.DM)}function J(G,q){var O;for(O=this.t-1;O>=0;--O)q[O+G]=this[O];for(O=G-1;O>=0;--O)q[O]=0;q.t=this.t+G,q.s=this.s}function c(H,h){for(var T=H;T<this.t;++T)h[T-H]=this[T];h.t=L(this.t-H,0),h.s=this.s}function g(j,b){var M,K=this,e=j%K.DB,H=K.DB-e,u=(1<<H)-1,x=i(j/K.DB),G=K.s<<e&K.DM;for(M=K.t-1;M>=0;--M)b[M+x+1]=K[M]>>H|G,G=(K[M]&u)<<e;for(M=x-1;M>=0;--M)b[M]=0;b[x]=G,b.t=K.t+x+1,b.s=K.s,b._57O()}function M($,P){var g=this;P.s=g.s;var M=i($/g.DB);if(M>=g.t)return P.t=0,void 0;var d=$%g.DB,D=g.DB-d,w=(1<<d)-1;P[0]=g[M]>>d;for(var R=M+1;R<g.t;++R)P[R-M-1]|=(g[R]&w)<<D,P[R-M]=g[R]>>d;d>0&&(P[g.t-M-1]|=(g.s&w)<<D),P.t=g.t-M,P._57O()}function O(s,B){for(var U=this,v=0,m=0,j=S(s.t,U.t);j>v;)m+=U[v]-s[v],B[v++]=m&U.DM,m>>=U.DB;if(s.t<U.t){for(m-=s.s;v<U.t;)m+=U[v],B[v++]=m&U.DM,m>>=U.DB;m+=U.s}else{for(m+=U.s;v<s.t;)m-=s[v],B[v++]=m&U.DM,m>>=U.DB;m-=s.s}B.s=0>m?-1:0,-1>m?B[v++]=U.DV+m:m>0&&(B[v++]=m),B.t=v,B._57O()}function E(v,P){var z=this.abs(),U=v.abs(),J=z.t;for(P.t=J+U.t;--J>=0;)P[J]=0;for(J=0;J<U.t;++J)P[J+z.t]=z.am(0,U[J],P,J,0,z.t);P.s=0,P._57O(),this.s!=v.s&&T.ZERO._78O(P,P)}function q(R){for(var O=this.abs(),q=R.t=2*O.t;--q>=0;)R[q]=0;for(q=0;q<O.t-1;++q){var W=O.am(q,O[q],R,2*q,0,1);(R[q+O.t]+=O.am(q+1,2*O[q],R,2*q+1,W,O.t-q-1))>=O.DV&&(R[q+O.t]-=O.DV,R[q+O.t+1]=1)}R.t>0&&(R[R.t-1]+=O.am(q,O[q],R,2*q,0,1)),R.s=0,R._57O()}function C(u,r,D){var x=u.abs(),j=this;if(!(x.t<=0)){var R=j.abs();if(R.t<x.t)return r!=G&&r._58O(0),D!=G&&j._77O(D),void 0;D==G&&(D=N());var U=N(),m=j.s,S=u.s,a=j.DB-n(x[x.t-1]);a>0?(x._44O(a,U),R._44O(a,D)):(x._77O(U),R._77O(D));var E=U.t,e=U[E-1];if(0!=e){var X=e*(1<<j.F1)+(E>1?U[E-2]>>j.F2:0),v=j.FV/X,K=(1<<j.F1)/X,F=1<<j.F2,M=D.t,O=M-E,A=r==G?N():r;for(U._59O(O,A),D._52O(A)>=0&&(D[D.t++]=1,D._78O(A,D)),T.ONE._59O(E,A),A._78O(U,U);U.t<E;)U[U.t++]=0;for(;--O>=0;){var L=D[--M]==e?j.DM:i(D[M]*v+(D[M-1]+F)*K);if((D[M]+=U.am(0,L,D,O,0,E))<L)for(U._59O(O,A),D._78O(A,D);D[M]<--L;)D._78O(A,D)}r!=G&&(D._45O(E,r),m!=S&&T.ZERO._78O(r,r)),D.t=E,D._57O(),a>0&&D._46O(a,D),0>m&&T.ZERO._78O(D,D)}}}function A(R){var d=N();return this.abs()._49O(R,G,d),this.s<0&&d._52O(T.ZERO)>0&&R._78O(d,d),d}function K(h){this.m=h}function e(L){return L.s<0||L._52O(this.m)>=0?L.mod(this.m):L}function r(H){return H}function w(S){S._49O(this.m,G,S)}function V(d,X,$){d._47O(X,$),this._74O($)}function I(q,M){q._48O(M),this._74O(M)}function F(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var c=3&a;return c=15&c*(2-(15&a)*c),c=255&c*(2-(255&a)*c),c=65535&c*(2-(65535&(65535&a)*c)),c=c*(2-a*c%this.DV)%this.DV,c>0?this.DV-c:-c}function $(Y){var d=this;d.m=Y,d.mp=Y._50O(),d.mpl=32767&d.mp,d.mph=d.mp>>15,d.um=(1<<Y.DB-15)-1,d.mt2=2*Y.t}function x(n){var c=N();return n.abs()._59O(this.m.t,c),c._49O(this.m,G,c),n.s<0&&c._52O(T.ZERO)>0&&this.m._78O(c,c),c}function u(g){var q=N();return g._77O(q),this._74O(q),q}function s(p){for(var c=this;p.t<=c.mt2;)p[p.t++]=0;for(var i=0;i<c.m.t;++i){var K=32767&p[i],U=K*c.mpl+((K*c.mph+(p[i]>>15)*c.mpl&c.um)<<15)&p.DM;for(K=i+c.m.t,p[K]+=c.m.am(0,U,p,i,0,c.m.t);p[K]>=p.DV;)p[K]-=p.DV,p[++K]++}p._57O(),p._45O(c.m.t,p),p._52O(c.m)>=0&&p._78O(c.m,p)}function b(U,p){U._48O(p),this._74O(p)}function _(U,M,H){U._47O(M,H),this._74O(H)}function Pj(){return 0==(this.t>0?1&this[0]:this.s)}function Ei(X,u){if(X>4294967295||1>X)return T.ONE;var Q=N(),K=N(),R=u._73O(this),A=n(X)-1;for(R._77O(Q);--A>=0;)if(u._76O(Q,K),(X&1<<A)>0)u._75O(K,R,Q);else{var e=Q;Q=K,K=e}return u.revert(Q)}function Tq(S,Y){var X;return X=256>S||Y._51O()?new K(Y):new $(Y),this.exp(S,X)}function Ui(){var Z=this;if(Z.s<0){if(1==Z.t)return Z[0]-Z.DV;if(0==Z.t)return-1}else{if(1==Z.t)return Z[0];if(0==Z.t)return 0}return(Z[1]&(1<<32-Z.DB)-1)<<Z.DB|Z[0]}function ej(M,m){return new T(M,m)}function Zi(){var A=this;A.n=G,A.e=0,A.d=G,A.p=G,A.q=G,A.dmp1=G,A.dmq1=G,A._10A=G}function Np(e){return e._53O(this.e,this.n)}function tg(K){var o,u,n,V="",j=0;for(o=0;o<K.length&&K.charAt(o)!=Ik;++o)n=Hr.indexOf(K.charAt(o)),0>n||(0==j?(V+=p(n>>2),u=3&n,j=1):1==j?(V+=p(u<<2|n>>4),u=15&n,j=2):2==j?(V+=p(u),V+=p(n>>2),u=3&n,j=3):(V+=p(u<<2|n>>4),V+=p(15&n),j=0));return 1==j&&(V+=p(u<<2)),V}function jr(J){var I=J.split(""),D=tg(J);return I.forEach(function(g){var E=g.length;E>0&&D&&(Km+=Iq(g))}),D}function mb(E,l){var B=Mn._4O.Util._56O(E,"ss"),n={},o=0;return n.v=B==l,n.t=1,n.s=0>o?-1:0,Xl=n.v,o>0?n[0]=o:-1>o?n[0]=o+n.DV:n.t=0,[B,n]}function Qk(f){var l=38,U=f.substring(0,l);if(U&&30==U.indexOf("05000420")){var n=["ss",f.substring(l)];return n}return[]}function Vk(c,E){E=E.replace(ge,""),E=E.replace(/[ \n]+/g,"");var V=ej(E,16);if(V._55O()>this.n._55O())return 0;var $=this._37O(V),H=$[Yp](16).replace(/^1f+00/,""),v=Qk(H);if(0==v.length)return!1;for(var z,j,R,q=.5,p=om,u=[0,.5,.75,.875,.9375],o=[],r=[],U=[],Y=k/p,s=v[1],S=mb(c,s)[0],N=0,I=0;N<u.length;N++){var T=0===N%2?0:.5;for(z=0;p>=z;z++)j=(z+T)*Y,R=1-u[N],o.push(Z(j)*q*R,-q+2*u[N]*q,-P(j)*q*R),r.push((z+T)/p,R)}for(N=0;N<u.length-1;N++){var J=N*(p+1),Q=(N+1)*(p+1);for(z=0;p>z;z++)U.push(J+z,Q+z+1,Q+z,J+z,J+z+1,Q+z+1)}return U.forEach(function(K){I+=K}),s==S&&I>10}var oe,Ue=0xdeadbeefcafe,Bs=15715070==(16777215&Ue),Yp="toString",Gg="",cl="nat",Ii=function(){};H=Y["D"+11182[Yp](a(2,5))];var Dq=T.prototype;rf+=kk.substr(0,1);var On=Y.navigator?Y.navigator.appName:"";Bs&&"Microsoft Internet Explorer"==On?(Dq.am=y,oe=30):Bs&&"Netscape"!=On?(Dq.am=f,oe=26):(Dq.am=o,oe=28),Dq.DB=oe,Dq.DM=(1<<oe)-1,Dq.DV=1<<oe;var Zf=52;Dq.FV=a(2,Zf),Dq.F1=Zf-oe,Dq.F2=2*oe-Zf;var rl,Qd,yl="0123456789abcdefghijklmnopqrstuvwxyz",hd=[],Mo=function(Q){return String.fromCharCode(Q)};for(rl="0".charCodeAt(0),Qd=0;9>=Qd;++Qd)hd[rl++]=Qd;for(rl="a".charCodeAt(0),Qd=10;36>Qd;++Qd)hd[rl++]=Qd;for(rl="A".charCodeAt(0),Qd=10;36>Qd;++Qd)hd[rl++]=Qd;var Sf=K.prototype;Sf._73O=e,Sf.revert=r,Sf._74O=w,Sf._75O=V,Sf._76O=I;var wm=$.prototype;wm._73O=x,wm.revert=u,wm._74O=s,wm._75O=_,wm._76O=b,Dq._77O=l,Dq._58O=Q,Dq._54O=m,Dq._57O=h,Dq._59O=J,Dq._45O=c,Dq._44O=g,Dq._46O=M,Dq._78O=O,Dq._47O=E,Dq._48O=q,Dq._49O=C,Dq._50O=F,Dq._51O=Pj,Dq.exp=Ei,Dq.toString=z,Dq._85O=D,Dq.abs=t,Dq._52O=W,Dq._55O=d,Dq.mod=A,Dq._53O=Tq,T.ZERO=B(0),T.ONE=B(1),Dq._86O=Ui;var Pb=function(h,F){var R=this;R.isPublic=!0,typeof h!==Sh?(R.n=h,R.e=F):h!=G&&F!=G&&h.length>0&&F.length>0&&(R.n=ej(h,16),R.e=Iq(F,16))};Rq=function(){var K,y,B=jr(dg),A=B.substr(0,4),M=B.substr(4,2),C=B.substr(6,2),w=1,i=!w,x=R,Y=[],I=Eh.charAt(7);if(H&&(H[Yp]().indexOf(cl)<0||H[rf][Yp]().indexOf(cl)<0||!B?K=G:(B=new H(A-0,M-w,C-0),y=B.setHours(9),H[rf]()>y?K=bc[I]:i=!0)),B&&K&&K[0]&&K[U(.5)]&&x){var e=vh(K[0]),W=vh(K[1]);for(var l in W)Y.push(l);var v,V=0,F=e[Y[V]],z=W[Y[V++]],r=W[Y[V++]],T=W[Y[V++]],k=W[Y[V++]],q=W[Y[V++]],n=W[Y[V++]],p=e[Y[V]],c=W[Y[V++]],D=lm._27O(x);if(F===z&&D&&c){v=z+r+T+k+q+n;var s=!n||n===Xj;if(!s&&n)for(var X,Q=0,o=n.length;o>Q;Q++)n[Q]===Bd[V]?X===Xj?s=!0:X[0]===ue[5]&&Xj&&Xj.indexOf(X.substr(1))>=0?s=!0:X=G:(X==G?X=n[Q]:X+=n[Q],Q===o-1&&(X===Xj?s=!0:X[0]===ue[5]&&Xj&&Xj.indexOf(X.substr(1))>=0&&(s=!0)));v&&D._31O(v,c)&&D._31O(F,p)&&s&&(!q||H[rf]()<q)&&(i=!0)}}return i||(qm=Dk),I};var Ch=Zi.prototype;Ch._37O=Np,Ch._38O=Pb;var Hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ik="=",yn=25,ie=10,dg="ICGRU===",gn=gn||function(w,n){var F={},j=F._7A={},E=j._6A=function(){function v(){}return{_80O:function(T){v.prototype=this;var _=new v;return T&&_._5A(T),_.hasOwnProperty("_82O")||(_._82O=function(){_.$super._82O.apply(this,arguments)}),_._82O.prototype=_,_.$super=this,_},_3A:function(){var M=this._80O();return M._82O.apply(M,arguments),M},_82O:function(){},_5A:function(H){for(var v in H)H.hasOwnProperty(v)&&(this[v]=H[v]);H.hasOwnProperty(Yp)&&(this.toString=H.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),c=j._39O=E._80O({_82O:function(Z,r){Z=this._84O=Z||[],this._65O=r!=n?r:4*Z.length},toString:function(n){return(n||Q).stringify(this)},_89O:function(T){var O=this._84O,z=T._84O,u=this._65O,r=T._65O;if(this._57O(),u%4)for(var I=0;r>I;I++){var j=255&z[I>>>2]>>>24-8*(I%4);O[u+I>>>2]|=j<<24-8*((u+I)%4)}else if(z.length>65535)for(var I=0;r>I;I+=4)O[u+I>>>2]=z[I>>>2];else O.push.apply(O,z);return this._65O+=r,this},_57O:function(){var m=this._84O,J=this._65O;m[J>>>2]&=4294967295<<32-8*(J%4),m.length=U(J/4)},_88O:function(){var p=E._88O.call(this);return p._84O=this._84O.slice(0),p},_87O:function(p){for(var o=[],$=0;p>$;$+=4)o.push(0|4294967296*ps);return new c._82O(o,p)}}),y=F._2A={},Q=y._69O={stringify:function(O){var r,n=O._84O,B=O._65O,h=[];for(r=0;B>r;r++){var E=255&n[r>>>2]>>>24-8*(r%4);h.push((E>>>4).toString(16)),h.push((15&E).toString(16))}return h.join("")},_68O:function(s){for(var L=s.length,o=[],H=0;L>H;H+=2)o[H>>>3]|=Iq(s.substr(H,2),16)<<24-4*(H%8);return new c._82O(o,L/2)}},A=y._8A={stringify:function(y){var q,Z=y._84O,i=y._65O,Y=[];for(q=0;i>q;q++){var d=255&Z[q>>>2]>>>24-8*(q%4);Y.push(Mo(d))}return Y.join("")},_68O:function(a){var L,W=a.length,$=[];for(L=0;W>L;L++)$[L>>>2]|=(255&a.charCodeAt(L))<<24-8*(L%4);return new c._82O($,W)}},m=y._9A={stringify:function(Q){try{return decodeURIComponent(escape(A.stringify(Q)))}catch(f){throw new Error("")}},_68O:function(a){return A._68O(unescape(encodeURIComponent(a)))}},a=j._32O=E._80O({_1A:function(){this._83O=new c._82O,this._23O=0},_33O:function(Y){typeof Y==Sh&&(Y=m._68O(Y)),this._83O._89O(Y),this._23O+=Y._65O},_25O:function(Y){var i=this._83O,H=i._84O,f=i._65O,D=this._79O,a=4*D,l=f/a;l=Y?U(l):L((0|l)-this._22O,0);var B=l*D,r=S(4*B,f);if(B){for(var O=0;B>O;O+=D)this._20O(H,O);var F=H.splice(0,B);i._65O-=r}return new c._82O(F,r)},_88O:function(){var e=E._88O.call(this);return e._83O=this._83O._88O(),e},_22O:0});j._66O=a._80O({cfg:E._80O(),_82O:function(A){this.cfg=this.cfg._80O(A),this._1A()},_1A:function(){a._1A.call(this),this._34O()},_81O:function(S){return this._33O(S),this._25O(),this},_72O:function(S){S&&this._33O(S);var H=this._21O();return H},_79O:16,_26O:function(W){return function(X,y){return new W._82O(y)._72O(X)}},_19O:function(A){return function(J,_){return new u._71O._82O(A,_)._72O(J)}}});var u=F._67O={};return F}();!function(){var c=gn,B=c._7A,P=B._39O,Z=B._66O,E=c._67O,$=[],y=[];!function(){function W(A){for(var H=j(A),t=2;H>=t;t++)if(!(A%t))return!1;return!0}function P(D){return 0|4294967296*(D-(0|D))}for(var A=2,k=0;64>k;)W(A)&&(8>k&&($[k]=P(a(A,.5))),y[k]=P(a(A,1/3)),k++),A++}();var r=[],b=E._41O=Z._80O({_34O:function(){this._64O=new P._82O($.slice(0))},_20O:function(O,t){for(var A=this._64O._84O,W=A[0],m=A[1],V=A[2],C=A[3],H=A[4],q=A[5],v=A[6],e=A[7],Q=0;64>Q;Q++){if(16>Q)r[Q]=0|O[t+Q];else{var _=r[Q-15],Y=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,c=r[Q-2],B=(c<<15|c>>>17)^(c<<13|c>>>19)^c>>>10;r[Q]=Y+r[Q-7]+B+r[Q-16]}var z=H&q^~H&v,w=W&m^W&V^m&V,U=(W<<30|W>>>2)^(W<<19|W>>>13)^(W<<10|W>>>22),h=(H<<26|H>>>6)^(H<<21|H>>>11)^(H<<7|H>>>25),D=e+h+z+y[Q]+r[Q],G=U+w;e=v,v=q,q=H,H=0|C+D,C=V,V=m,m=W,W=0|D+G}A[0]=0|A[0]+W,A[1]=0|A[1]+m,A[2]=0|A[2]+V,A[3]=0|A[3]+C,A[4]=0|A[4]+H,A[5]=0|A[5]+q,A[6]=0|A[6]+v,A[7]=0|A[7]+e},_21O:function(){var k=this._83O,Y=k._84O,K=8*this._23O,A=8*k._65O;return Y[A>>>5]|=128<<24-A%32,Y[(A+64>>>9<<4)+14]=i(K/4294967296),Y[(A+64>>>9<<4)+15]=K,k._65O=4*Y.length,this._25O(),this._64O},_88O:function(){var q=Z._88O.call(this);return q._64O=this._64O._88O(),q}});c._41O=Z._26O(b),c._42O=Z._19O(b)}();var ge=new RegExp("");ge.compile("[^0-9a-f]","gi"),Zi._28O=-1,Zi._29O=-2,Ch._31O=Vk,Ch._63O=Vk,Zi._43O=-2;var yf=new function(){var S=this;S._5O=function(e,t){if("8"!=e.substring(t+2,t+3))return 1;var H=Iq(e.substring(t+3,t+4));return 0==H?-1:H>0&&10>H?H+1:-2},S._13O=function(Z,D){var Q=S._5O(Z,D);return 1>Q?"":Z.substring(D+2,D+2+2*Q)},S._12O=function(A,Z){var D=S._13O(A,Z);if(""==D)return-1;var n;return n=Iq(D.substring(0,1))<8?new T(D,16):new T(D.substring(2),16),n._86O()},S._6O=function(T,W){var e=S._5O(T,W);return 0>e?e:W+2*(e+1)},S._11O=function(B,u){var T=S._6O(B,u),g=S._12O(B,u);return B.substring(T,T+2*g)},S._10O=function(g,w){var W=S._6O(g,w),M=S._12O(g,w);return W+2*M},S._7O=function(f,A){var M=[],O=S._6O(f,A);M.push(O);for(var L=S._12O(f,A),E=O,a=0;;){var m=S._10O(f,E);if(m==G||m-O>=2*L)break;if(a>=200)break;M.push(m),E=m,a++}return M}};if(yf._90O=Mo(ie+24),yf._91O=X+Mo(ie*ie+8),Mn==G||!Mn)var Mn={};Mn._4O!=G&&Mn._4O||(Mn._4O={});var Qp=Mn._4O;Mn._4O.Util=new function(){var H=this;H._56O=function(j){var o=new Mn._4O._3O;return o._30O(j)},H._4A=function(l){var I=new Mn._4O._3O;return I._36O(l)},H._11A=function(u){var y=new Qp._3O;return y._30O(u)}},Mn._4O._3O=function(){var F=this;F._8O=function(t,s){if("ss"==t&&"cj"==s){try{F.md=gn._67O._41O._3A()}catch(o){Ii(Gg)}F._24O=function(X){F.md._81O(X)},F._35O=function(X){var k=gn._2A._69O._68O(X);F.md._81O(k)},F._60O=function(){var T=F.md._72O();return T[Yp](gn._2A._69O)},F._30O=function(c){return F._24O(c),F._60O()},F._36O=function(l){return F._35O(l),F._60O()}}},F._24O=function(){Ii(Gg)},F._35O=function(){Ii(Gg)},F._60O=function(){Ii(Gg)},F._30O=function(){Ii(Gg)},F._36O=function(){Ii(Gg)},F._8O("ss","cj")},Wm=function(z){var M=Bl[Jf[7]],h=1,u=!1;if(He.a!=Bl[In])return He.a;if(He.forEach(function(o){h*=o}),z>h){if(M&&M[1]&&M[0]){var T=M[0],k=M[1];k=k.split(yf._90O),T=T.split(yf._90O);var p=k[3],b=T[3],_=k[7],J=k[11],B=k[15],A=k[19],F=k[23],G=k[27],f=T[7],U=p+_+J+B+A+F,E=F?!1:!0,e=b===p;if(F){var P=F&&F.split(Tr("firefox")[3]);if(P)for(var s=0;s<P.length;s++){var l=P[s];if(l[0]===ef[8]&&(l=l.substring(1)),sb.indexOf(l)>=0){E=!0;break}}}u=e&&Fr()(b,f)&&Fr()(U,G)&&E&&(!A||A>z),u&&J.indexOf(Wg.length)>=0&&(Wm[Wg.length]=Wg),u&&J.indexOf(Wg.length+1)>=0&&(Wm[Wg.length+1]=Wg),u&&J.indexOf(Wg.length+3)>=0&&(Wm[Wg.length+3]=Wg)}u||(kq.prototype._42=dl)}else u=!0,Wm[Wg.length]=Wm[Wg.length+1]=Wm[Wg.length+3]=Wg;return He.a=u,u},yn=String.fromCharCode(yn+20);var dh=function(j){return j=j.replace(ge,Gg),j=j.replace(/[ \n]+/g,Gg)},pe="30",Gp="06",fe="02",Ec="03",Io=ej,If=/^1f+00/,lm=function(){var Z;return Z={_18O:function(m){var K=m,B=K.replace(/\s+/g,""),o=tg(B);return o},_14O:function(F){var C=this._18O(F),m=this._15O(C);return m},_15O:function(b){var E=this._17O(b);if("2a864886f70d010101"==E._61O){var G=this._16O(E.key),W=new Zi;return W._38O(G.n,G.e),W}Ii(Gg)},_16O:function(x){var b={};x.substr(0,2)!=pe&&Ii(Gg);var k=yf._7O(x,0);return 2!=k.length&&Ii(Gg),x.substr(k[0],2)!=fe&&Ii(Gg),b.n=yf._11O(x,k[0]),x.substr(k[1],2)!=fe&&Ii(Gg),b.e=yf._11O(x,k[1]),b},_17O:function(U){var p={};p._40O=G;var t=yf._7O(U,0);2!=t.length&&Ii(Gg);var y=t[0];U.substr(y,2)!=pe&&Ii(Gg);var E=yf._7O(U,y);return 2!=E.length&&Ii(Gg),U.substr(E[0],2)!=Gp&&Ii(Gg),p._61O=yf._11O(U,E[0]),U.substr(E[1],2)==Gp?p._40O=yf._11O(U,E[1]):U.substr(E[1],2)==pe&&(p._40O={},p._40O.p=yf._70O(U,E[1],[0],fe),p._40O.q=yf._70O(U,E[1],[1],fe),p._40O.g=yf._70O(U,E[1],[2],fe)),U.substr(t[1],2)!=Ec&&Ii(Gg),p.key=yf._11O(U,t[1]).substr(2),p}},Z._17O?Z:G}(),jf=lm._27O=function(w){return lm._14O(w)};Fr=function(){return function(t,T){if(t&&T){T=dh(T);var h=Io(T,a(2,4)),I=this;if(!I||!I.n||h._55O()>I.n._55O())return 0;var i=I._37O(h),U=i[Yp](a(2,4)).replace(If,""),j=Qk(U);if(0==j.length)return!1;var o=j[0],y=j[1],z=function(M){return Mn._4O.Util._56O(M,o)},e=z(t);return y==e}}.bind(jf(R))};var lf,$l;return function(){var A=Ge.length-Sm.length;if(A>0)for(var $=0;A>$;$++)lf=Qp.Util,$l=dh}(),oq=function(I,R){R=$l(R);var Z=jf(Nq),T=Fn.length,P=2*T,A=Io(R,a(T,P)),w=Z,i=!0;if(w){var t=w[Yf[0]];t&&A._55O()<=t._55O()&&(i=!1)}if(i)return 0;var b=w._37O(A),B=b[Yp](a(T,P)).replace(If,""),M=Qk(B);if(0==M.length)return!1;var E=M[0],e=M[1],p=lf._11A(I,E);return e==p},lm}(_,t),Jg(m,{load:function(){var M={},A=function(C){return C?"c_"+(C.sync?"1":"0")+"_"+(C.post?"1":"0")+"_"+(C.responseType||"H")+"_"+(C.mimeType||"H")+"_"+(C.data?JSON.stringify(C.data):"H"):""};return function(t,s,B){var C,R=M[t],W=A(B);return R&&(C=R[W])?(C.push(s),void 0):(M[t]||(R=M[t]={count:0}),C=R[W]=[s],R.count++,m.xhrLoad(t,function(x){delete R[W],R.count--,R.count||delete M[t],C.forEach(function(q){q(x)})},B),void 0)}}(),asyncEach:function(X,C,x){"function"!=typeof x&&(x=Function.prototype);var k=new Array(X.length),P=0,f=!1;X.forEach(function(i,v){C(i,function(L,o){return f?void 0:L?(f=!0,x(null)):(k[v]=o,P++,P===X.length?x(k):void 0)})})},xhrLoad:function(_,l,i){var t=!1;bf(_)||(t=!0,_=[_]),i=i||{};var A=i.sync,X=null,E=i.method||"GET";return i.post&&(E="POST"),i.method=E,m.asyncEach(_,function(T,d){var I=new Ei;T=m.beforeLoadURL(T),T.data?d(null,T.data):(i.url=encodeURI(T),i.responseType?I.setResponseType(i.responseType):I.setOverrideMimeType(i.mimeType||"text/plain"),I.onload=function(){200===this.status||0===this.status?d(null,I.getResponseText()):d(!0)},I.onerror=function(){d(!0)},I.send(i))},function(B){var I="function"==typeof l;(I||A)&&(X=t&&B?B[0]:B,I&&l(X))}),A?X:void 0}});var Vr=t.setPrototypeOf||function(U,v){return U.__proto__=v,U},Ao=t.getPrototypeOf||function(x){return x.__proto__},Fq=t.freeze;t.isFrozen;var md=function(){var A=function(l){return l};return function(W){return W&&W.length?new Function("o",["return o['",W.join("']['"),"'];"].join("")):A}}(),_f=function(){var D=function(q,_){return q=_};return function(r){return r&&r.length?new Function("o","v",["return o['",r.join("']['"),"'] = v;"].join("")):D}}();!function(){function R(T){var h=[];if(T)for(var K;(K=_.exec(T))!=D;)h.push(K[1]);return h}function d(W,e){var N=h.exec(e);this._cell=W,this._key=N[1],this._format=N[2],this._style=R(N[3])}function Z(i){for(var v=this._cellList=[],c=this._paramList=[],U=i.split(L),a=0,S=U.length;S>a;++a){var G=U[a];if("{{"!==G)for(var R=G.split(q),z=0,$=R.length;$>z;++z){var B=R[z];q.test(B)?(c.push(new d(v.length,B)),v.push(D)):B.length>0&&v.push(B)}else v.push("{")}this._formatList=this._cellList.slice(0)}var y={},H={},L=/(\{\{)/,q=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,h=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,_=/\&([\w\.]*)/g;Z.prototype._73O=function(Y){for(var n=this._paramList.length;n--;){var r=this._paramList[n],G=Y[Iq(r._key)+1],t=H[r._format];t&&(G=t(G,r._style)),this._formatList[r._cell]=G}return this._formatList.join("")},Z.prototype._map=function(R){for(var $=this._paramList.length;$--;){var v=this._paramList[$],m=R[v._key],x=H[v._format];x&&(m=x(m,v._style)),this._formatList[v._cell]=m}return this._formatList.join("")};var l=function(R){var w=y[R];return w||(y[R]=w=new Z(R)),w._73O(arguments)};return l.map=function(l,O){var x=y[l];return x||(y[l]=x=new Z(l)),x._map(O)},l.setValueFormat=function(q,l){H[q]=l},l.gc=function(){y.length=0},l.__parsed=y,l}();var xr=function(){function K(I,L,U,w){var J=I?I.path.slice(0):[];L&&J.push(L),this.desc=U,this.name=L,this.path=Fq(J),this.getter=md(J),this.setter=_f(J),this.isLeaf=w,this.parent=I,this.children=[],this.childMap={}}return K.create=function(){function r(f,J,M,$){var C=$(M),A=new K(f,J,M,C);if(!C){for(var X=A.children,v=A.childMap,B=t.keys(M),e=0,E=B.length;E>e;++e){var k=B[e],Y=r(A,k,M[k],$);X.push(Y),v[Y.name]=Y}A.children=Fq(X),A.childMap=Fq(v)}return Fq(A),A}return function(f,F){return r(D,D,f,F)}}(),K.prototype.forEach=function(z,O){for(var l=this.children,_=0,n=l.length;n>_;++_){var k=l[_];z(k,O)}},K}(),Fq=t.freeze,uj={main:{mask:1,priority:m.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:m.cameraPriority.top,ignore:!1}},Wn="main",si=uj[Wn].mask,di=function(j,U,n){if(j=j||0,!(U in uj)){if(yn>=32)throw new Error("Only 31 render layer can be defined.");uj[U]={mask:1<<yn++,priority:uj[Wn].priority}}if(n)for(var Y in n)uj[U][Y]=n[Y];return tp=bd(t.keys(uj)),yn=tp.length,j|=uj[U].mask},Li=function(C,G){return C&&G&&C&G},bd=function(l){return l.sort(function(G,L){return uj[G].priority-uj[L].priority})},tp=bd(t.keys(uj)),yn=tp.length;Jg(m,{setRenderLayerInfo:function(w,b){di(0,w,b)},getRenderLayerInfo:function(d){return uj[d]}},!0);var pq=q.List=function(){this._as=[];var e,J,B=arguments.length;if(1===B){var t=arguments[0];if(Kc(t)&&(t=t._as),bf(t))for(J=t.length,e=0;J>e;e++)this._as.push(t[e]);else t!=G&&this._as.push(t)}else if(B>1)for(e=0;B>e;e++)this._as.push(arguments[e])};Eg("List",t,{forEach:function(q,h){this.each(q,h)},push:function(){for(var r=0;r<arguments.length;r++)this.add(arguments[r])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(c,A){return A===D?this._as.push(c):this._as.splice(A,0,c)},addAll:function(n){Kc(n)&&(n=n._as),bf(n)?bi(this._as,n):this._as.push(n)},get:function(L){return this._as[L]},slice:function(G,A){return new pq(this._as.slice(G,A))},remove:function(m){var U=this._as.indexOf(m);return U>=0&&U<this._as.length&&this.removeAt(U),U},removeAt:function(E){return this._as.splice(E,1)[0]},set:function(I,r){return this._as[I]=r},clear:function(){return this._as.splice(0,this._as.length)},contains:function(B){return this._as.indexOf(B)>=0},indexOf:function(R){return this._as.indexOf(R)},each:function(P,q){for(var $=0,w=this._as.length;w>$;$++){var R=this._as[$];q?P.call(q,R,$,this):P(R,$,this)}},reverseEach:function(g,a){for(var i=this._as.length-1;i>=0;i--){var Q=this._as[i];a?g.call(a,Q):g(Q)}},getArray:function(){return this._as},toArray:function(V,A){if(V){for(var Z,k=[],N=0,b=this._as.length;b>N;N++)Z=this._as[N],A?V.call(A,Z)&&k.push(Z):V(Z)&&k.push(Z);return k}return this._as.concat()},toList:function(i,C){if(i){for(var l,A=new pq,H=0,T=this._as.length;T>H;H++)l=this._as[H],C?i.call(C,l)&&A.add(l):i(l)&&A.add(l);return A}return new pq(this)},reverse:function(){this._as.reverse()},sort:function(P){return this._as.sort(P?P:ke),this},toString:function(){return this._as.toString()}}),t.defineProperties(pq.prototype,{length:{get:function(){return this._as.length},set:function(e){this._as.length=e}}});var Vi=new pq;Jg(Vi,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Hb,each:Hb,reverseEach:Hb,toArray:function(){return[]},toList:function(){return new pq},add:Ck,addAll:Ck,set:Ck,remove:Ck,removeAt:Ck,clear:Ck});var mn=q.Notifier=function(){this._f=0};Eg("Notifier",t,{contains:function(k,y){if(this._ls)for(var _,Y=0,W=this._ls.size();W>Y;Y++)if(_=this._ls.get(Y),k===_.l&&y===_.s)return!0;return!1},add:function(v,O,U){var J=this,d={l:v,s:O,a:U};J._ls||(J._ls=new pq),J._f?(J._as||(J._as=new pq),J._as.add(d)):d.a?J._ls.add(d,0):J._ls.add(d)},remove:function(c,v){var q=this;q._ls&&(q._f?(q._rs||(q._rs=new pq),q._rs.add({l:c,s:v})):q._remove(c,v))},_remove:function(m,n){for(var x,y=this._ls,$=0,F=y.size();F>$;$++)if(x=y.get($),x.l===m&&x.s===n)return y.removeAt($),void 0},fire:function(a){var x=this,O=x._ls;if(x._b=1e4,O){++x._f;try{for(var E,r=0,T=O.size();T>r;r++)E=O.get(r),E.s?E.l.call(E.s,a):E.l(a)}catch(a){Qi(function(){throw a})}finally{if(--x._f)return;if(x._rs){for(T=x._rs.size(),r=0;T>r;r++)E=x._rs.get(r),x._remove(E.l,E.s);delete x._rs}if(x._as){for(T=x._as.size(),r=0;T>r;r++)E=x._as.get(r),E.a?O.add(E,0):O.add(E);delete x._as}}}}});var Em=q.Data=function(){this._id=Fe()};Eg("Data",t,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:G,_parent:G,_children:Vi,_childMap:G,_styleMap:G,_layer:"0",_renderLayer:Wn,_renderLayerMask:si,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||si},getRenderLayer:function(){return this._renderLayer||Wn},setRenderLayer:function(X){var h=this,R=di(0,X);h._renderLayerMask=R;var r=h._renderLayer;h._renderLayer=X,h.fp("renderLayer",r,h._renderLayer)},testRenderLayer:function(F){var f=uj[F];return f&&Li(this._renderLayerMask,uj[F].mask)},getUIClass:function(){return G},_22Q:function(){return G},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(b,a){var C=this;if(2===arguments.length)C.setStyle(b,a);else{if(!vc(b))return C.getStyle(b);for(var s in b)C.setStyle(s,b[s])}return C},fp:function(O,n,c,z,i){return this.firePropertyChange(O,n,c,z,i)},firePropertyChange:function(C,F,G,u,P){if(u){if(u(F,G))return!1}else if(F===G)return!1;var e=this,r=P||{};return r.property=C,r.oldValue=F,r.newValue=G,r.data=e,e._dataModel&&e._dataModel.handleDataPropertyChange(r),e.onPropertyChanged(r),!0},onPropertyChanged:function(E){var I=this,e=I._parent,n=E.property;if(Sc(e)){var S=I.s(Bo),B="s:ingroup"===n;(S&&Ib[n]||n===B)&&e._81I(),(S||B)&&e.fp("childChange",!0,!1)}Ze(e)&&(Ib[n]||"elevation"===n||yf[n]||"scaleTall"===n||"tall"===n)&&e.updateFromChildren(),("s:alwaysOnTop"===n||"s:shape3d.alwaysOnTop"===n)&&(E.newValue?this.setRenderLayer("top"):this.setRenderLayer(D))},_21I:function(n){var x=this;if(n&&x._dataModel)throw"Remove data from dataModel before adding";x._dataModel=n},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var C=0,F=this._children.toArray(),p=F.length;p>C;C++)F[C].removeFromDataModel()},getId:function(){return this._id},setId:function(f){this._id=f},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(k,b){return this._children.toList(k,b)},eachChild:function(X,l){this._children.each(X,l)},addChild:function(n,y){var l=this;n!==l&&(l._children===Vi&&(l._children=new pq,l._childMap={}),y>=0||(y=l._children.size()),l._childMap[n._id]||l.isDescendantOf(n)||(n._parent&&n._parent.removeChild(n),(0>y||y>l._children.size())&&(y=l._children.size()),l._children.add(n,y),l._childMap[n._id]=n,n.setParent(l),l.onChildAdded(n,y),l.fp(Uj,G,n)))},onChildAdded:function(){},removeChild:function(R){var C=this;if(C._childMap&&C._childMap[R._id]){var Z=C._children.remove(R);delete C._childMap[R._id],C.fp(Uj,R,G),R.setParent(G,Z),C.onChildRemoved(R,Z)}},onChildRemoved:function(){},getChildAt:function(A){return this._children.get(A)},clearChildren:function(){var g=this;if(!g._children.isEmpty())for(var X=0,p=g._children.toArray(),Z=p.length;Z>X;X++)g.removeChild(p[X])},getParent:function(){return this._parent},setParent:function(l,N){var k=this;if(!(k._73I||k._parent===l||k===l||l&&l.isDescendantOf(k))){var i,h=k._parent;k._parent=l,k._73I=1,h?(N==G&&(N=h.getChildren().indexOf(k)),h.removeChild(k)):k._dataModel&&N==G&&(N=k._dataModel.getRoots().indexOf(k)),l&&(l.addChild(k),i=l.getChildren().indexOf(k)),delete k._73I,k.fp("parent",h,l,D,{oldIndex:N,newIndex:i}),k.onParentChanged(h,l)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function($){return $?this.isDescendantOf($)||$.isDescendantOf(this):!1},isParentOf:function(b){return b&&this._childMap?!!this._childMap[b._id]:!1},isDescendantOf:function(S){if(!S||S.isEmpty())return!1;for(var b=this._parent;b;){if(S===b)return!0;b=b._parent}return!1},getStyle:function(E,N){N===D&&(N=1);var V=this._styleMap?this._styleMap[E]:D;return V===D&&N?e[E]:V},setStyle:function(v,T){var s=this;s._styleMap||(s._styleMap={});var o=s._styleMap[v];T===D?delete s._styleMap[v]:s._styleMap[v]=T,s.fp("s:"+v,o,T)&&s.onStyleChanged(v,o,T)},onStyleChanged:function(){},iv:function(v){this.invalidate(v)},invalidate:function(o){this.fp(o||"*",!1,!0)},toString:function(){var U=this;return U._displayName||U._name||U._tag||U._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(c,X){var D=this,f=D.s(Yc);D.beginTransaction(),f||D.s(Yc,f={}),X?f[c]=X:delete f[c],D.fp(Yc,G,f),D.endTransaction()},removeStyleIcon:function(p){var P=this.s(Yc);if(P){var d=P[p];delete P[p],this.fp(Yc,G,P)}return d},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(Q){var B=this;if(B.hasOwnProperty("_anchor")||B.hasOwnProperty("_anchorElevation")){var _=B.getAnchor3d(),d={x:_.x-.5,y:_.y-.5,z:_.z-.5};pe(Q,[-d.x,-d.y,-d.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var X,B={};for(X in this._styleMap)B[X]=1;return B},getCurrentPrefix:function(){return this._interactPrefix||cr},ca:function(v,O){var w=this.getCurrentPrefix();return v=w+v,2===arguments.length?this.a(v,O):this.a(v)}});var sn=q.DataModel=function(){var N=this;N._isDeserializing=0,N._datas=new pq,N._dataMap={},N._roots=new pq,N._rootMap={},N._fsDataMap={},N._78O={},N._reflectorMap={},N._36I=new mn,N._35I=new mn,N._serializeNotifier=new mn,N._selectionModel=new un(N);var u=N._29Q=[],Y=N._scheduleCallback=function(){for(var j=Date.now(),b=0;b<u.length;b++){var m=u[b];m.enabled&&j-m.lastTime>m.interval&&(m.beforeAction&&m.beforeAction(),m.action&&N.each(function(M){m.action(M)}),m.afterAction&&m.afterAction(),m.lastTime=j)}u.length&&(N._30Q=_.requestAnimationFrame(Y))}};Eg("DataModel",t,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:D,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:D,_init:D,_envmap:D,_cubicEnvmap:!1,_postProcessingData:D,sm:function(){return this.getSelectionModel()},mm:function(w,S,J){this.addDataModelChangeListener(w,S,J)
},umm:function(L,z){this.removeDataModelChangeListener(L,z)},md:function(p,x,c){this.addDataPropertyChangeListener(p,x,c)},umd:function($,L){this.removeDataPropertyChangeListener($,L)},mh:function(F,p,Z){this.addHierarchyChangeListener(F,p,Z)},umh:function(_,w){this.removeHierarchyChangeListener(_,w)},getAttrObject:function(){return this._attrObject},setAttrObject:function(a){return this._attrObject=a},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(l){return this._dataMap[l]},removeDataById:function(G){this.remove(this.getDataById(G))},toDatas:function(L,t){return this._datas.toList(L,t)},each:function(R,Y){this._datas.each(R,Y)},getDataByTag:function(X){return this._78O[X]},getTagMap:function(){return this._78O},removeDataByTag:function(M){this.remove(this.getDataByTag(M))},add:function(E,R,M){var H=this,x=E._id,f=E._tag,b=H._roots;if(H._dataMap[x])throw"'"+x+"' already exists";f!=G&&(H._78O[f]=E),H._dataMap[x]=E,M>=0?H._datas.add(E,M):H._datas.add(E),E._parent||(H._rootMap[x]=E,R>=0?b.add(E,R):b.add(E)),E.s("fullscreen")!==D&&(H._fsDataMap[x]=E),E.s("shape3d.reflector")&&(H._reflectorMap[x]=E),E._21I(H),H.onAdded(E),H._36I.fire({kind:"add",data:E,rootsIndex:R,datasIndex:M})},onAdded:function(){},remove:function(Z,s){if(Z){var b=this,Y=Z._id,l=s&&s.keepStructure,S=s&&s.keepChildren,j=Z.getTag();if(Z._dataModel===b){var T=Z instanceof Ep;T&&m.setIsolating(!0),this.beginTransaction(),l?b._removingData||(b._removingData=Z):b.prepareRemove(Z),S||Z.toChildren().each(function(i){b.remove(i,s)},b),l?b._removingData===Z&&(Z._parent&&Z._parent.removeChild(Z),delete b._removingData):Z._parent&&Z._parent.removeChild(Z);var V=b._datas.remove(Z);delete b._dataMap[Y],j!=G&&delete b._78O[j];var p;b._rootMap[Y]&&(delete b._rootMap[Y],p=b._roots.remove(Z)),b._fsDataMap[Y]&&delete b._fsDataMap[Y],b._reflectorMap[Y]&&delete b._reflectorMap[Y],Z._21I(G),b.onRemoved(Z),b._36I.fire({kind:ai,data:Z,rootsIndex:p,datasIndex:V}),this.endTransaction(),T&&m.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var Y=this;if(Y._datas.size()){var V=Y._historyManager?this.toJSON():D;Y._datas.toArray().forEach(function(h){h._21I(G)}),Y._datas.clear(),Y._dataMap={},Y._roots.clear(),Y._rootMap={},Y._fsDataMap={},Y._reflectorMap={},Y._78O={},Y._36I.fire({kind:$k,json:V})}},contains:function(V){return V&&V._dataModel===this},handleDataPropertyChange:function(K){var s=this,R=K.data,H=K.property;if("parent"===H){var B=R._id,I=s._rootMap,t=s._roots;R._parent?I[B]&&(delete I[B],t.remove(R)):I[B]||(I[B]=R,t.add(R))}else if("tag"===H){var S=K.oldValue,l=K.newValue,w=s._78O;S!=G&&delete w[S],l!=G&&(w[l]=R)}else if("s:fullscreen"===H){var B=R._id,r=s._fsDataMap;K.oldValue!=G&&delete r[B],K.newValue!=G&&(r[B]=R)}else if("s:shape3d.reflector"===H){var B=R._id,M=s._reflectorMap;K.oldValue&&delete M[B],K.newValue&&(M[B]=R)}this.onDataPropertyChanged(R,K),this._35I.fire(K)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(t,P,Y){this._36I.add(t,P,Y)},removeDataModelChangeListener:function(q,d){this._36I.remove(q,d)},addSerializeListener:function(W,l,u){this._serializeNotifier.add(W,l,u)},removeSerializeListener:function(G,H){this._serializeNotifier.remove(G,H)},fireSerializeEvent:function(w){this._serializeNotifier.fire(w)},addDataPropertyChangeListener:function(R,v,w){this._35I.add(R,v,w)},removeDataPropertyChangeListener:function(a,D){this._35I.remove(a,D)},_38I:function(C,S,l){this._37I&&this._37I.fire({data:C,oldIndex:S,newIndex:l})},addHierarchyChangeListener:function(A,q,i){this._37I||(this._37I=new mn),this._37I.add(A,q,i)},removeHierarchyChangeListener:function(h,H){this._37I.remove(h,H)},getSiblings:function(q){var m=q._parent;return m?m._children:this._roots},eachByHierarchical:function(V,y,d){if(y)return this._eachByHierarchical(V,y,d);for(var Z=0,K=this._roots,F=K.size();F>Z;Z++)if(this._eachByHierarchical(V,K.get(Z),d)===!1)return!1;return!0},_eachByHierarchical:function(m,e,J){if(J){if(m.call(J,e)===!1)return!1}else if(m(e)===!1)return!1;for(var q=e.size(),A=0;q>A;A++)if(this._eachByHierarchical(m,e.getChildAt(A),J)===!1)return!1;return!0},reverseEachByHierarchical:function(b,r,s){if(r)return this._reverseEachByHierarchical(b,r,s);for(var f=this._roots,$=f.size(),Q=$-1;Q>=0;Q--)if(this._reverseEachByHierarchical(b,f.get(Q),s)===!1)return!1;return!0},_reverseEachByHierarchical:function(P,U,q){for(var l=U.size(),j=l-1;j>=0;j--)if(this._reverseEachByHierarchical(P,U.getChildAt(j),q)===!1)return!1;if(q){if(P.call(q,U)===!1)return!1}else if(P(U)===!1)return!1;return!0},eachByDepthFirst:function(p,V,$){if(V)return this._11I(p,V,$);for(var o=0,k=this._roots,t=k.size();t>o;o++)if(this._11I(p,k.get(o),$)===!1)return!1;return!0},_11I:function(H,N,w){for(var k=N.size(),d=0;k>d;d++)if(this._11I(H,N.getChildAt(d),w)===!1)return!1;if(w){if(H.call(w,N)===!1)return!1}else if(H(N)===!1)return!1;return!0},eachByBreadthFirst:function(M,p,y){var z=new pq;for(p?z.add(p):this._roots.each(z.add,z);z.size()>0;)if(p=z.removeAt(0),p.eachChild(z.add,z),y){if(M.call(y,p)===!1)return!1}else if(M(p)===!1)return!1;return!0},moveTo:function(w,O){var g=this.getSiblings(w),h=g.indexOf(w);h===O||0>h||O>=0&&O<=g.size()&&(g.remove(w),O>g.size()&&O--,g.add(w,O),this._38I(w,h,O))},moveUp:function(L){this.moveTo(L,this.getSiblings(L).indexOf(L)-1)},moveDown:function(Z){this.moveTo(Z,this.getSiblings(Z).indexOf(Z)+1)},moveToTop:function(n){this.moveTo(n,0)},moveToBottom:function(l){this.moveTo(l,this.getSiblings(l).size())},moveSelectionUp:function(L){this.beginTransaction(),L||(L=this.sm());var v=new pq;Tf(L,v,this._roots),v.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(F){this.beginTransaction(),F||(F=this.sm());var L=new pq;$j(F,L,this._roots),L.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(H){this.beginTransaction(),H||(H=this.sm());var K=new pq;Mf(H,K,this._roots),K.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(j){this.beginTransaction(),j||(j=this.sm());var v=new pq;Ph(j,v,this._roots),v.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(A,V,k){var z=this.getDatas();null==k&&(k=z.indexOf(A)),k===V||0>k||V>=0&&V<=z.size()&&(z.remove(A),V>z.size()&&V--,z.add(A,V),this._76I(A,k,V))},bringForward:function(P){this.moveToIndex(P,this.getDatas().indexOf(P)+1)},bringToFront:function(r){this.moveToIndex(r,this.size())},sendBackward:function(J){this.moveToIndex(J,this.getDatas().indexOf(J)-1)},sendToBack:function(w){this.moveToIndex(w,0)},bringSelectionForward:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var e=new pq,S=this.getDatas(),b=!1,M=0;M<S.size();M++){var I=S.get(S.size()-1-M);Z.contains(I)?b&&e.add(I):b=!0}e.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(j){this.beginTransaction(),j||(j=this.sm());for(var Y=new pq,U=this.getDatas(),g=0;g<U.size();g++){var t=U.get(g);j.contains(t)&&Y.add(t)}Y.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(b){this.beginTransaction(),b||(b=this.sm());for(var V=new pq,T=this.getDatas(),e=!1,L=0;L<T.size();L++){var h=T.get(L);b.contains(h)?e&&V.add(h):e=!0}V.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(o){this.beginTransaction(),o||(o=this.sm());for(var i=new pq,Z=this.getDatas(),Q=0;Q<Z.size();Q++){var q=Z.get(Z.size()-1-Q);o.contains(q)&&i.add(q)}i.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(P){var i=this;i.removeScheduleTask(P),P.enabled==G&&(P.enabled=!0),P.interval==G&&(P.interval=10),P.lastTime=Date.now(),i._29Q.push(P),i._30Q==G&&(i._30Q=_.requestAnimationFrame(i._scheduleCallback))},removeScheduleTask:function(y){var b=this,Z=b._29Q,$=Z.indexOf(y);$>=0&&Z.splice($,1),Z.length||b._30Q==G||(_.cancelAnimationFrame(b._30Q),delete b._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(N){this._historyManager||new q.HistoryManager(this),null!=N&&this._historyManager.setMaxHistoryCount(N),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(Q){this._historyManager&&this._historyManager.undo(Q)},redo:function(Z){this._historyManager&&this._historyManager.redo(Z)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(j){this._historyManager&&this._historyManager.addHistory(j)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(f){f?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return this._cubicEnvmap},setCubicEnvmap:function(P){var J=this._cubicEnvmap;this._cubicEnvmap=P,this.fp("cubicEnvmap",J,P)},updateLayoutAttach:function(q){this.each(function($){$ instanceof yg&&$.getImage()===q&&$.updateLayoutAttaches()})}});var un=q.SelectionModel=function(J){var Q=this;Q._68O=xk,Q._map={},Q._73O=new pq,Q._74I=new mn,Q._21I(J)};Eg("SelectionModel",t,{ms_fire:1,ms_dm:1,ms:function(u,D,j){this.addSelectionChangeListener(u,D,j)},ums:function(G,W){this.removeSelectionChangeListener(G,W)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===sl},co:function(h){return this._map[h._id]!=G},ss:function(W){this.setSelection(W)},as:function(O){this.appendSelection(O)},rs:function(g){this.removeSelection(g)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(z){var J=this;if(J._68O!==z&&(z===Yf||z===sl||z===xk)){J.cs();var L=J._68O;J._68O=z,J.fp("selectionMode",L,z)}},_21I:function(U){var L=this,F=L._dataModel;F!==U&&(F&&(L.cs(),F.umm(L.handleDataModelChange,L)),L._dataModel=U,U.mm(L.handleDataModelChange,L,!0),L.fp(Bp,F,U))},dispose:function(){var F=this;F.cs(),F._dataModel.umm(F.handleDataModelChange,F)},handleDataModelChange:function(u){var h=this;if(u.kind===ai){var l=u.data;h.co(l)&&(h._73O.remove(l),delete h._map[l._id],h._75I(ai,new pq(l)))}else u.kind===$k&&h.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(N){var r=this;if(r._filterFunc!==N){r.cs();var a=r._filterFunc;r._filterFunc=N,r.fp("filterFunc",a,r._filterFunc)}},_75I:function(n,r,E,Y){E&&(this._73O.each(function(I){Y[I._id]?E.remove(I):E.add(I)}),r=E.toList()),this._74I.fire({kind:n,datas:new pq(r)})},addSelectionChangeListener:function(S,h,O){this._74I.add(S,h,O)},removeSelectionChangeListener:function(Q,w){this._74I.remove(Q,w)},_97O:function(H,M){for(var J,m=this,t=0,S=new pq(H);t<S.size();t++)J=S.get(t),(m._filterFunc&&!m._filterFunc(J)||M&&m.co(J)||!M&&!m.co(J)||!m._dataModel.contains(J))&&(S.removeAt(t),t--);return S},appendSelection:function(Z){var C=this;if(C._68O!==Yf){var U,X,w=C._73O,d=C._97O(Z,!0);d.isEmpty()||(C.sg()&&(U=new pq(w),X=C._map,w.clear(),C._map={},d=new pq(d.get(d.size()-1))),d.each(function(X){w.add(X),C._map[X._id]=X}),C._75I("append",d,U,X))}},removeSelection:function(Z){var F=this,L=F._97O(Z),v=0,s=L.size();if(0!==s){for(;s>v;v++){var g=L.get(v);F._73O.remove(g),delete F._map[g._id]}F._75I(ai,L)}},toSelection:function(I,_){return this._73O.toList(I,_)},getSelection:function(){return this._73O},each:function(E,f){this._73O.each(E,f)},setSelection:function(X){var h=this,r=h._73O;if(h._68O!==Yf&&!(r.isEmpty()&&!X||1===r.size()&&h.ld()===X)){var I=new pq(r),s=h._map;r.clear(),h._map={};var t=h._97O(X,!0);h.sg()&&t.size()>1&&(t=new pq(t.get(t.size()-1))),t.each(function(E){r.add(E),h._map[E._id]=E}),h._75I("set",G,I,s)}},clearSelection:function(){var T=this,Q=T._73O;if(Q.size()>0){var g=Q.toList();Q.clear(),T._map={},T._75I($k,g)}},selectAll:function(){var c=this;if(c._68O!==Yf){var E,g,v=c._dataModel.toDatas();if(c._filterFunc)for(E=0;E<v.size();E++)g=v.get(E),c._filterFunc(g)||(v.removeAt(E),E--);var F=c._73O,K=new pq(F),S=c._map;F.clear(),c._map={},c.sg()&&v.size()>1&&(v=new pq(v.get(v.size()-1)));var y=v.size();for(E=0;y>E;E++)g=v.get(E),F.add(g),c._map[g._id]=g;c._75I("all",G,K,S)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(s){return this._map[s._id]!=G},getLastData:function(){var M=this._73O;return M.size()>0?M.get(M.size()-1):G},getFirstData:function(){var y=this._73O;return y.size()>0?y.get(0):G},isSelectable:function(S){var E=this;return S&&E._68O!==Yf?E._filterFunc?E._filterFunc(S):!0:!1},getTopSelection:function(){var P=this,B=new pq;return P._73O.each(function(o){for(var v=o.getParent();v;){if(P.contains(v)){o=G;break}v=v.parent}o&&B.add(o)}),B}});var Dj=function(){return nf(0),function(Z,o){var u;if(af(o)){var L=Z.getDataUI(o);L&&L._88I&&(u=L._88I.rect)}return u?u:o.getRect()}}();Jg(m,{edgeGroupAgentFunc:G,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:l.rectSelectBorder,graphViewRectSelectBackground:ni,graphViewEditPointSize:yr?17:7,graphViewEditPointBorderColor:l.editPointBorder,graphViewEditPointBackground:l.editPointBackground,setEdgeType:function(f,u,h){fn[f]=u,pm[f]=h},getEdgeType:function(d){return fn[d]},getEdgeTypeMap:function(){return fn},getNodeRect:Dj},!0);var we={"layout.h":D,"layout.v":D,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":D,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:D,ingroup:!0,"body.color":D,"2d.gray":!1,fullscreen:D,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:D,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Xg,"select.width":1,"select.padding":2,"select.type":Aq,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Xg,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":D,"border.width":2,"border.padding":2,"border.type":Aq,label:D,"label.font":D,"label.color":up,"label.background":D,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":D,"label.max":D,"label.opacity":D,"label.scale":1,"label.align":D,"label.selectable":!0,label2:D,"label2.font":D,"label2.color":up,"label2.background":D,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":D,"label2.max":D,"label2.opacity":D,"label2.scale":1,"label2.align":D,"label2.selectable":!0,note:D,"note.expanded":!0,"note.font":D,"note.color":_l,"note.background":Xg,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":D,"note.toggleable":!0,"note.border.width":1,"note.border.color":D,"note.opacity":D,"note.scale":1,"note.align":D,note2:D,"note2.expanded":!0,"note2.font":D,"note2.color":_l,"note2.background":Xg,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":D,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":D,"note2.opacity":D,"note2.scale":1,"note2.align":D,"group.type":D,"group.image":D,"group.image.stretch":"fill","group.repeat.image":D,"group.border.repeat.image":D,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":D,"group.title.color":_l,"group.title.background":l.groupTitleBackground,"group.title.align":xb,"group.title.orientation":am,"group.background":l.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":D,"group.border.color":Vp,"group.border.radius":D,"group.border.cap":Mi,"group.border.join":Mc,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":G,"group.gradient.color":"#FFF",shape:D,"shape.background":Vp,"shape.repeat.image":D,"shape.border.repeat.image":D,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Vp,"shape.border.3d":!1,"shape.border.3d.color":D,"shape.border.3d.accuracy":D,"shape.border.cap":Mi,"shape.border.join":Mc,"shape.border.pattern":D,"shape.gradient":G,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":_o,"shape.dash.offset":0,"shape.dash.color":or,"shape.dash.width":D,"shape.dash.3d":!1,"shape.dash.3d.color":D,"shape.dash.3d.accuracy":D,"shape.polygon.side":6,"shape.arc.from":Y,"shape.arc.to":k,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":D,"shape.gradient.pack":D,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":D,"shape.foreground.gradient":G,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":D,"autolayout.hgap":D,"autolayout.vgap":D,"edge.type":D,"edge.points":D,"edge.segments":D,"edge.color":Vp,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":D,"edge.3d.accuracy":D,"edge.cap":Mi,"edge.join":Mc,"edge.source.position":17,"edge.source.anchor.x":D,"edge.source.anchor.y":D,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":D,"edge.target.anchor.y":D,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":D,"edge.dash":!1,"edge.dash.pattern":_o,"edge.dash.offset":0,"edge.dash.color":or,"edge.dash.width":D,"edge.dash.3d":!1,"edge.dash.3d.color":D,"edge.dash.3d.accuracy":D,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":D,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":D,"grid.column.percents":D,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":l.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":l.gridCellBorderColor,"grid.block":D,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":l.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":up,"text.gradient.pack":D,"text.font":Dn,"text.shadow":!1,"text.shadow.color":Xg,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":D,"text.gradient.color":"#FFF","text.decoration":D,"text.vertical":!1,keepPosition:!0};we[Cl]=D,Jg(e,we,!0),Jg(sn,{_76I:function(O,c,Z){this._39I&&this._39I.fire({data:O,oldIndex:c,newIndex:Z})},addIndexChangeListener:function(G,J,A){var Z=this;Z._39I||(Z._39I=new mn),Z._39I.add(G,J,A)},removeIndexChangeListener:function(d,x){this._39I.remove(d,x)},prepareRemove:function(z){Lb(z)&&(z.setSource(G),z.setTarget(G)),z._70O&&z._70O.toList().each(this.remove,this),z._69O&&z._69O.toList().each(function(T){T.setHost(G)}),z._host&&z.setHost(G)},onAdded:function(q){this.isAutoAdjustIndex()&&this.adjustIndex(q)},onDataPropertyChanged:function(M,X){ji[X.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(M)},isAdjustable:function(J){return ge(J)||Lb(J)},isAdjustedToBottom:function(G){return Sc(G)?G.isExpanded()&&Gj(G):!1},adjustIndex:function(c){var Z=this;this.isHierarchicalRendering()||(Z.isAdjustedToBottom(c)?(Z.sendToBottom(c),c.eachChild(Z.adjustIndex,Z)):Z.sendToTop(c))},sendToTop:function(F){var M=this;if(M.contains(F)&&M.isAdjustable(F)){var c=M._datas;if(F!==c.get(M.size()-1)){var z=c.indexOf(F);c.removeAt(z),c.add(F),M._76I(F,z,M.size()-1)}if(Lb(F)){var N=F._40I;N&&!M.isAdjustedToBottom(N)&&M.sendToTop(N),N=F._41I,N&&!M.isAdjustedToBottom(N)&&M.sendToTop(N)}F._69O&&F._69O.each(function(d){d.isRelatedTo(F)||ge(F)&&d.isLoopedHostOn(F)||M.sendToTop(d)}),F.ISubGraph||(!Sc(F)||F.isExpanded())&&F._adjustChildrenToTop&&F.eachChild(function(c){Lb(c)||M.sendToTop(c)})}},sendToBottom:function(W,q){var P=this;if(W!==q&&P.contains(W)&&P.isAdjustable(W)&&(!q||P.contains(q))){var y=P._datas,h=y.remove(W),U=q?P._datas.indexOf(q):0;if(y.add(W,U),h!==U){P._76I(W,h,U);var F=W._parent;!F||F.ISubGraph||Lb(F)||P.sendToBottom(W._parent,W)}}}}),Jg(Qn,{ms_edit:function(h){h._46O=function(z){var L=this,G=L.gv.dm(),h=L._index,_=L._89I,T=L._node,t=L._shape,N=L._edge,F=L._77I;T&&_?(this.fi({kind:"endEditRect",event:z,data:T,direction:_}),G.endTransaction()):t&&h>=0?(L.fi({kind:"endEditPoint",event:z,data:t,index:h}),G.endTransaction()):N&&h>=0?(L.fi({kind:"endEditPoint",event:z,data:N,index:h}),G.endTransaction()):F&&(L.fi({kind:"endEditRotation",event:z,data:F}),G.endTransaction())},h._78I=function(q){var j=this;j.autoScroll(q);var U=j.gv.lp(q),M=j._index,F=j._89I,h=j._node,f=j._shape,s=j._edge,P=j._77I;if(h&&F)j._80O(U),j.fi({kind:"betweenEditRect",event:q,data:h,direction:F});else if(f&&M>=0)U.e=f.getPoints().get(M).e,f.setPoint(M,U),j.fi({kind:"betweenEditPoint",event:q,data:f,index:M});else if(s&&M>=0){var T=s.s(Ig);U.e=T.get(M).e,T.set(M,U),s.fp(Ig,G,T),j.fi({kind:"betweenEditPoint",event:q,data:s,index:M})}else if(P){var k=P.p(),e=P.getScale(),p=Rm+pd(U.y-k.y,U.x-k.x);e.y<0&&(p+=Y),E(p)<.04&&(p=0),P.setRotation(p),j.fi({kind:"betweenEditRotation",event:q,data:P})}},h._80O=function(J){var E=this,F=E._node,H=E._rect,d=H.x,q=H.y,u=H.width,G=H.height,v=E._89I,t=E._anchor,L=E._matrix,J=L.tfi(J);"northwest"===v?H=Ip(J,{x:d+u,y:q+G}):v===Wg?H=Ip({x:d,y:J.y},{x:d+u,y:q+G}):"northeast"===v?H=Ip({x:d,y:J.y},{x:J.x,y:q+G}):v===kk?H=Ip({x:J.x,y:q},{x:d+u,y:q+G}):v===nm?H=Ip({x:d,y:q},{x:J.x,y:q+G}):"southwest"===v?H=Ip({x:J.x,y:q},{x:d+u,y:J.y}):"south"===v?H=Ip({x:d,y:q},{x:d+u,y:J.y}):"southeast"===v&&(H=Ip({x:d,y:q},J)),F.setPosition(L.tf(H.x+H.width*t.x,H.y+H.height*t.y)),F.setWidth(H.width),F.setHeight(H.height)},h._80I=function(q,c,X,E){var v=this,P=v.gv._zoom,t=(v.gv.getEditPointSize()+2)/P;return uq({x:c-t/2,y:X-t/2,width:t,height:t},q)?(v._89I!==E&&(v._89I=E),!0):!1},h._79I=function(F,Q,D){var x=this,d=x.gv,e=Q?d.getDataUI(Q):G,O=e?e._55O:G;if(O){var _,L,U,C,m=d._zoom,S=(d.getEditPointSize()+2)/m,n=d.lp(F);if(ge(Q)){if(O._56O&&ge(Q)&&(L=O._98o,uq({x:L.x-S/2,y:L.y-S/2,width:S,height:S},n)))return x._77I=Q,D&&x.fi({kind:"beginEditRotation",event:F,data:Q}),x.setCursor("crosshair"),!0;if(O._43O&&Q instanceof ej)for(U=Q.getPoints(),_=U.size()-1;_>=0;_--)if(L=U.get(_),uq({x:L.x-S/2,y:L.y-S/2,width:S,height:S},n))return x._index=_,x._shape=Q,D&&x.fi({kind:"beginEditPoint",event:F,data:Q,index:_}),x.setCursor("crosshair"),!0;if(O._42O)for(var v=Q.getEditControlPoints(),$=["northwest",-1,-1,kk,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,nm,1,0,"northeast",1,-1,Wg,0,-1],_=0,C=v.length;C>_;_++){var T=$[3*_],B=v[_];if(x._80I(n,B.x,B.y,T)){x._node=Q;var z=Q.getWidth(),b=Q.getHeight(),A=Q.getAnchor();x._rect={x:-z*A.x,y:-b*A.y,width:z,height:b},x._anchor=A,x._matrix=Q.getMatrix();var r=Q.getRotation(),H=Z(r),K=P(r),s=$[3*_+1]*ij(Q.getScale().x),X=$[3*_+2]*ij(Q.getScale().y),V=Math.atan2(-K*s-H*X,H*s-K*X),h=(Math.round(V/(Math.PI/4))+8)%8,Y=[qe,"nesw-resize",Eh,"nwse-resize",qe,"nesw-resize",Eh,"nwse-resize"][h];return x.setCursor(Y),D&&x.fi({kind:"beginEditRect",event:F,data:Q,direction:x._89I}),!0}}}if(O._43O&&Lb(Q)&&Q.s(cd)===gj&&(U=Q.s(Ig)))for(_=U.size()-1;_>=0;_--)if(L=U.get(_),uq({x:L.x-S/2,y:L.y-S/2,width:S,height:S},n))return x._index=_,x._edge=Q,D&&x.fi({kind:"beginEditPoint",event:F,data:Q,index:_}),x.setCursor("crosshair"),!0}return!1}},ms_gv:function(Q){Q._currentSubGraph=G,Q._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},Q.upSubGraph=function(){this.setCurrentSubGraph(em(this._currentSubGraph))},Q.isVisible=function(c){var L=this;if(em(c)!==L._currentSubGraph)return!1;if(Lb(c)){var J=c._40I,e=c._41I;if(!J||!e)return!1;if(!(c.s("edge.independent")||L.isVisible(J)&&L.isVisible(e)))return!1;if(c.isEdgeGroupHidden())return!1}else for(var n=c._parent;n&&!n.ISubGraph;){if(Sc(n)&&(!n.isExpanded()||!L.isVisible(n)))return!1;n=n._parent}if(c._parent instanceof Ep&&!L.isVisible(c._parent))return!1;if(c._refGraph instanceof ys&&!L.isVisible(c._refGraph))return!1;if(L instanceof Fp){if(!c.s("3d.visible"))return!1}else{var A=L.getLayersInfo();if(A){var B=A[c._layer];if(B&&B.visible===!1)return!1}if(!c.s("2d.visible"))return!1}return L._visibleFunc?L._visibleFunc(c):!0},Q.handleSelectionChange=function(A){var k=this;A.datas.each(function(H){k.invalidateData(H);var q=H._parent;Sc(q)&&ge(H)&&H.s(Bo)&&(k.invalidateData(q),q._49I&&q._49I.each(function(r){k.invalidateData(r)}))}),k.onSelectionChanged(A)},Q.onSelectionChanged=function(H){var q=this,f=q.sm();if(1===f.size()&&("set"===H.kind||"append"===H.kind)){var $=f.ld();q.isAutoMakeVisible()&&q.makeVisible($),q.adjustIndex&&q._dataModel.isAutoAdjustIndex()&&q.adjustIndex($)}},Q.makeVisible=function(i){if(i){var x=this,Z=x.getDataUI?x.getDataUI(i):x.getData3dUI(i);if(Z){var B=i,v=em(i);for(v!==x._currentSubGraph&&x.setCurrentSubGraph(v);(B=B._parent)&&B!==v;)Sc(B)&&B.setExpanded(!0);x._23I=i,x.iv()}}},Q.getLabel=function(e){var i=e.getStyle(Me);return i===D?e.getName():i},Q.getLabelBackground=function(y){return y.getStyle("label.background")},Q.getLabelColor=function(o){return o.getStyle("label.color")},Q.getLabel2=function(T){return T.getStyle("label2")},Q.getLabel2Background=function(y){return y.getStyle("label2.background")},Q.getLabel2Color=function(Z){return Z.getStyle("label2.color")},Q.getNote=function(J){return J.getStyle(uk)},Q.getNoteBackground=function(m){return m.getStyle("note.background")},Q.getNote2=function(M){return M.getStyle(Te)},Q.getNote2Background=function(d){return d.getStyle("note2.background")},Q.handleClick=function(H,f,j){var y=this;f?(y.fi({kind:"clickData",event:H,data:f,part:j}),y.onDataClicked(f,H)):(y.fi({kind:"clickBackground",event:H}),y.onBackgroundClicked(H))},Q.handleDoubleClick=function(z,L,J){var T=this;Cm(z)&&(L?(T.fi({kind:"doubleClickData",event:z,data:L,part:J}),T.onDataDoubleClicked(L,z,J),T.checkDoubleClickOnNote(z,L,J)||T.checkDoubleClickOnRotation&&T.checkDoubleClickOnRotation(z,L,J)||(Lb(L)?T.onEdgeDoubleClicked(L,z,J):L.ISubGraph?T.onSubGraphDoubleClicked(L,z,J):Sc(L)?T.onGroupDoubleClicked(L,z,J):L.IDoorWindow?T.onDoorWindowDoubleClicked(L,z,J):L.ICSGBox&&T.onCSGBoxDoubleClicked(L,z,J))):(T.fi({kind:"doubleClickBackground",event:z}),T.onBackgroundDoubleClicked(z)))},Q.onSubGraphDoubleClicked=function(U){this.setCurrentSubGraph(U)},Q.onEdgeDoubleClicked=function(n,q){this.isEditable(n)||(n.ISubGraph&&!hi(q)?this.setCurrentSubGraph(n):n.s("edge.toggleable")&&n.toggle())},Q._39Q=function(M){return this.isInteractive(M)?this.preventDefaultWhenInteractive(M):!1},Q.preventDefaultWhenInteractive=function(w){return w.s("preventDefaultWhenInteractive")},Q.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},Q.onDoorWindowDoubleClicked=function(D){D.s("dw.toggleable")&&D.toggle(!0)},Q.onCSGBoxDoubleClicked=function(d,b){var B=this;if(B instanceof Fp){var V=B.intersectObject(b,d);V&&d.s(V.part+".toggleable")&&d.toggleFace(V.part,!0)}},Q.onBackgroundClicked=function(){},Q.onBackgroundDoubleClicked=function(){this.upSubGraph()},Q.onDataClicked=function(){},Q.onDataDoubleClicked=function(){},Q.onAutoLayoutEnded=function(){},Q.onMoveEnded=function(){},Q.onPanEnded=function(){},Q.onPinchEnded=function(){},Q.onRectSelectEnded=function(){},Q.onZoomEnded=function(){},Q.serialize=function(Q){return this.dm().serialize(Q)},Q.toJSON=function(){return this.dm().toJSON()},Q.deserialize=function(M,r){var m=this;r=r instanceof Em?{rootParent:r}:Xd(r)?{setId:r}:Yo(r)?{finishFunc:r}:r||{},r.view=m;var u=m.dm();return r.__innerHandler__=function(v){if(Xd(u.a("toolTipEnable"))&&(u.a("toolTipEnable")?m.enableToolTip():m.disableToolTip()),m instanceof q.graph.GraphView&&(Xd(u.a("zoomable"))&&m.setZoomable&&m.setZoomable(u.a("zoomable")),Xd(u.a("pannable"))&&m.setPannable&&m.setPannable(u.a("pannable")),Xd(u.a("rectSelectable"))&&m.setRectSelectable&&m.setRectSelectable(u.a("rectSelectable")),u.a("fitContent")===!0&&m.fitContent&&m.fitContent(!0,0)),m instanceof q.graph3d.Graph3dView){var l=v.scene;l&&l.shadow!=G&&m.shadowMap.setShadow(l.shadow,l.shadowParams);var j=u.a("sceneContext");j?(j.eye&&m.setEye(j.eye),j.center&&m.setCenter(j.center),Lk(j.far)&&m.setFar(j.far),Lk(j.near)&&m.setNear(j.near)):(Lk(u.a("sceneNear"))&&m.setNear(u.a("sceneNear")),Lk(u.a("sceneFar"))&&m.setFar(u.a("sceneFar")),l&&(l.eye&&m.setEye(l.eye),l.center&&m.setCenter(l.center))),Xd(u.a("sceneShadowEnabled"))&&(u.a("sceneShadowEnabled")?m.enableShadow():m.disableShadow()),Lk(u.a("sceneShadowDegreeX"))&&m.setShadowDegreeX(u.a("sceneShadowDegreeX")),Lk(u.a("sceneShadowDegreeZ"))&&m.setShadowDegreeZ(u.a("sceneShadowDegreeZ")),Lk(u.a("sceneShadowIntensity"))&&m.setShadowIntensity(u.a("sceneShadowIntensity")),u.a("sceneShadowQuality")!=G&&m.setShadowQuality(u.a("sceneShadowQuality")),u.a("sceneShadowType")&&m.setShadowType(u.a("sceneShadowType")),Lk(u.a("sceneShadowRadius"))&&m.setShadowRadius(u.a("sceneShadowRadius")),Lk(u.a("sceneShadowBias"))&&m.setShadowBias(u.a("sceneShadowBias")),Xd(u.a("sceneDashEnable"))&&m.setDashDisabled(!u.a("sceneDashEnable")),on(u.a("sceneHighlightMode"))&&m.setHighlightMode(u.a("sceneHighlightMode")),Lk(u.a("sceneHighlightWidth"))&&m.setHighlightWidth(u.a("sceneHighlightWidth")),u.a("sceneHighlightColor")&&m.setHighlightColor(u.a("sceneHighlightColor")),u.a("sceneHighlightType")&&m.setHighlightType(u.a("sceneHighlightType")),u.a("sceneHighlightGlow")&&m.setHighlightGlow(u.a("sceneHighlightGlow")),u.a("sceneHighlightStrength")&&m.setHighlightStrength(u.a("sceneHighlightStrength")),Xd(u.a("sceneHeadlightEnable"))&&m.setHeadlightDisabled(!u.a("sceneHeadlightEnable")),Lk(u.a("sceneHeadlightRange"))&&m.setHeadlightRange(u.a("sceneHeadlightRange")),u.a("sceneHeadlightColor")&&m.setHeadlightColor(u.a("sceneHeadlightColor")),Lk(u.a("sceneHeadlightIntensity"))&&m.setHeadlightIntensity(u.a("sceneHeadlightIntensity")),Lk(u.a("sceneHeadlightAmbientIntensity"))&&m.setHeadlightAmbientIntensity(u.a("sceneHeadlightAmbientIntensity")),Xd(u.a("sceneFogEnable"))&&m.setFogDisabled(!u.a("sceneFogEnable")),u.a("sceneFogMode")&&m.setFogMode(u.a("sceneFogMode")),Lk(u.a("sceneFogDensity"))&&m.setFogDensity(u.a("sceneFogDensity")),u.a("sceneFogColor")&&m.setFogColor(u.a("sceneFogColor")),Lk(u.a("sceneFogNear"))&&m.setFogNear(u.a("sceneFogNear")),Lk(u.a("sceneFogFar"))&&m.setFogFar(u.a("sceneFogFar")),Xd(u.a("sceneBatchBrightnessDisabled"))&&m.setBatchBrightnessDisabled(u.a("sceneBatchBrightnessDisabled")),Xd(u.a("sceneBatchBlendDisabled"))&&m.setBatchBlendDisabled(u.a("sceneBatchBlendDisabled")),Xd(u.a("sceneBatchColorDisabled"))&&m.setBatchColorDisabled(u.a("sceneBatchColorDisabled")),u.a("sceneBatchInfoMap")&&m.setBatchInfoMap(u.a("sceneBatchInfoMap")),Lk(u.a("sceneMoveStep"))&&m.setMoveStep(u.a("sceneMoveStep")),Lk(u.a("sceneRotateStep"))&&m.setRotateStep(u.a("sceneRotateStep")),Xd(u.a("sceneSortable"))&&m.setSortable(u.a("sceneSortable")),Yo(u.a("sceneSortFunc"))&&m.setSortFunc(u.a("sceneSortFunc"));var J=u.a("sceneSkyboxType")||"sphere";if(J!=G){var R={},y=!1;if("sphere"===J){R.shape3d=J;var B=u.a("sceneSkyboxImage");B&&(R["shape3d.image"]=B,y=!0)
}else R.shape3d=D,["front","back","left","right","top","bottom"].forEach(function(H){var s=H+".image",D=H.charAt(0).toUpperCase()+H.slice(1),r=u.a("sceneSkybox"+D+"Image");r&&(R[s]=r,y=!0)});if(y){var N=new yg,p=u.a("sceneSkyboxDiameter");Lk(p)?N.s3(p,p,p):N.s3(20,20,20),R["body.color"]=u.a("sceneSkyboxBodyColor"),R.envmap=u.a("sceneSkyboxEnvmap"),R.light=!1,R["texture.wrap"]="clampToEdge",N.s(R),["X","Y","Z"].forEach(function(Q){var Y=u.a("sceneSkyboxRotation"+Q);Lk(Y)&&N["setRotation"+Q](Y)}),m.setSkybox(N)}}}},u.deserialize(M,r.rootParent,r)},Q.isDebugTipShowing=function(){return!!this._debugDiv},Q.showDebugTip=function(){var R=this,h=R._debugDiv;if(!h){h=R._debugDiv=s.createElement("div"),h.style.position="absolute",h.style.overflow="hidden",h.style.font=m.debugTipLabelFont,h.style.padding="6px",h.style.backgroundColor=m.debugTipBackground,h.style.color=m.debugTipLabelColor;var v=R.getView();R._79O?v.insertBefore(h,R._79O):v.appendChild(h);var w=function(){R.redraw();var E=R._canvas,x="FPS: "+R._fpsInfo.fps+"<br/>"+"Datas: "+R.dm().getDatas().length+(E?"<br/>Size: "+E.width+" * "+E.height:""),e=R.dm()._historyManager;e&&(x+="<br/>Undoes: "+e.getHistories().length+" index: "+e.getHistoryIndex());var p=R.getDebugTip();p&&(x+="<hr>"+p),h.innerHTML=x,R._isDebugging&&requestAnimationFrame(w)};requestAnimationFrame(w),R._isDebugging=!0}},Q.hideDebugTip=function(){var M=this,z=M._debugDiv;z&&(delete M._debugDiv,M.getView().removeChild(z),M._isDebugging=!1)},Q.updateDOMAppendMatrix=function(){var P=this.getView();P&&(P.updateAppendMatrix=!0)},Q.countFrame=function(){if(this._isDebugging){var h=Date.now(),R=this._fpsInfo;h-R.time>1e3?(R.fps=Math.round(1e5*(R.frames+1)/(h-R.time))/100,R.time=h,R.frames=0):R.frames++}}},ms_icons:function(s){s.getRotation=function(i){return i==G?0:i},s._15O=function(){var g=this,t=g.s(Yc);if(t){var i=g,S=g.data||g._data,X=g._38o={icons:t,rects:{}};for(var h in t){var m=t[h],H=$b(m.shape3d,S,i);if(!($b(m.visible,S,i)===!1||$b(m.for3d,S,i)&&!g.I3d||H&&!g.I3d)){var W=H?[H]:$b(m.names,S,i),j=W?W.length:0,x=$b(m.position,S,i)||3,k=$b(m.offsetX,S,i)||0,Q=$b(m.offsetY,S,i)||0,o=$b(m.direction,S,i)||nm,y=$b(m.gap,S,i),N=y!=G?y:1,v=$b(m.rotation,S,i),T=$b(m.keepOrien,S,i),O=$b(m.rotationFixed,S,i)?v:g.getRotation(v,T,x),q=G,r=X.rects[h]=new Array(j);r.rotation=O;for(var u=0;j>u;u++){var l,w,E,M,Z=W[u];if(H)E=0,M=0;else{var V=Nd(Z);E=$b(m.width,S,i),M=$b(m.height,S,i),E==G&&(E=Ur(V,S)),M==G&&(M=wb(V,S))}if(q?o===nm?k+=E/2:o===kk?k-=E/2:o===Wg?Q-=M/2:Q+=M/2:q={width:E,height:M},g.I3d){var a=-E/2,I=-M/2;w={width:E,height:M,mat:g._16O($b(m.autorotate,S,i),x,q,$b(m.face,S,i)||rs,$b(m.t3,S,i),$b(m.r3,S,i),$b(m.rotationMode,S,i),k,Q),vs:new Hg([a,-I,0,a,-I-M,0,a+E,-I-M,0,a+E,-I,0])}}else l=g.getPosition(x,k,Q,q,$b(m.positionFixed,S,i)),w={x:l.x-E/2,y:l.y-M/2,width:E,height:M},g._68o(w,O);r[u]=w,o===nm?k+=E/2+N:o===kk?k-=E/2+N:o===Wg?Q-=M/2+N:Q+=M/2+N}}}}}}});var Nc={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Fo={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ij={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},ji={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Ib={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},fc={"edge.type":1,"edge.group":1},yf={rotation:1,rotationX:1,rotationZ:1},Rn={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Hj={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},vg={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Bs={shape:1,thickness:1,position:1,anchor:1,scale:1},em=function(Q){if(!Q)return G;if(Lb(Q)){var U=Q._40I,N=Q._41I;if(!U||!N)return G;var p=em(U),b=em(N);return p===b?p:G}for(var S=Q._parent;Lb(S)&&!S.ISubGraph;)S=S._parent;return S?S.ISubGraph?S:em(S):G},wg=function(X,o,g,h){var m=o.getStyle(g)*h;m&&ir(X,m),m=o.getStyle(g+".left")*h,m&&(X.x-=m,X.width+=m),m=o.getStyle(g+".right")*h,m&&(X.width+=m),m=o.getStyle(g+".top")*h,m&&(X.y-=m,X.height+=m),m=o.getStyle(g+".bottom")*h,m&&(X.height+=m),X.width<0&&(X.width=-X.width,X.x-=X.width),X.height<0&&(X.height=-X.height,X.y-=X.height)},Gj=function(w){for(var x,N=0,y=w.size();y>N;N++)if(x=w.getChildAt(N),ge(x)&&Gj(x))return!0;return w.hasAgentEdges()},ih=function($){if(!$)return G;for(var R=$._parent;Sc(R);){if(!Sc(R._parent))return R.isExpanded()?$:R;R.isExpanded()||($=R),R=R._parent}return $},Xo=function(D,_){if(!D||!_)return G;var X,Y,q,T=em(D),p=em(_);if(T!==p){for(;p&&T!==p;)p=em(p);if(T===p)return D;X=new pq,X.add(D,0);for(var S=D._parent;ge(S)&&!_.isDescendantOf(S);)X.add(S,0),S=S._parent;for(q=X.size(),Y=0;q>Y;Y++){var H=X.get(Y);if(Sc(H)&&!H.isExpanded())return H;if(H.ISubGraph)return H}return D}return D},mi=function(n){if(n.isLooped())return n._source;var z=ih(n._source),h=ih(n._target);return z===h?n._source:Xo(z,h)},Rg=function(r){if(r.isLooped())return r._target;var h=ih(r._source),w=ih(r._target);return h===w?r._target:Xo(w,h)},fq=function(n,m,g){"target"!==g&&(g="source");var t="target"===g?m.getTargetAgent():m.getSourceAgent(),$="edge."+g+".";if(Lb(t)){var R=n.getDataUI(t);R._79o();var S=m.s($+"index");if(S>=0){var b=zc(R);return b[Math.max(0,Math.min(S,b.length-1))]}var s=m.s($+"percent")||0;s=Math.max(0,Math.min(s,1));var P=ti(R);return ml(P,100*s)}return Pj(n,t,m.s($+"position"),m.s($+"offset.x"),m.s($+"offset.y"),m.s($+"anchor.x"),m.s($+"anchor.y"))},Pj=function(N,S,f,u,F,O,b){if(!S)return G;var R,n=S.getRotation?S.getRotation():0;if(O!==D||b!==D){O=O===D?.5:O,b=b===D?.5:b;var Y=S.getScale();if(n&&!af(S,N)||Y.x<0||Y.y<0){var U=S.getPosition(),r=S.getWidth(),V=S.getHeight(),L=S.getAnchor(),z=new Wo(n,U.x,U.y,Y.x,Y.y);f=z.tf((O-L.x)*r,(b-L.y)*V)}else R=Dj(N,S),f={x:R.x+O*R.width,y:R.y+b*R.height}}else f=yq(f,Dj(N,S));if(n){var E=Z(n),K=P(n),A=u*E-F*K;F=u*K+F*E,u=A}return f.x+=u,f.y+=F,f},Sp=function(T,y){if(!T||!y)return G;var c,U,q,O,z,h;if(T===y){if(O=T.getLoopedEdges(),!O)return G;O=new pq(O)}else{if(z=T.getAgentEdges(),h=y.getAgentEdges(),!z||!h)return G;for(U=z.size(),c=0;U>c;c++)q=z.get(c),h.contains(q)&&(O||(O=new pq),O.add(q))}if(O)for(c=0;c<O.size();c++)q=O.get(c),q.getStyle(cd)===gj&&(q._22I(G),O.removeAt(c),c--);return O},cf=function(w,J){var l=Sp(w,J);if(l&&!l.isEmpty()){if(1===l.size())return l.get(0)._22I(G),void 0;var A=new pq,U=new pq;l.each(function(M){var j=M.s("edge.group");A.contains(j)||A.add(j)}),A.sort(),A.each(function(X){U.add(new q.EdgeGroup(l.toList(function(l){return X===l.s("edge.group")}),U))}),U.each(function(c){c.each(function(f){f._22I(c)})})}},Fm=function(Q,m,d){var u=Q._canvas;Q._zoom;var W=Dg(m,u),n=Dg(d,u);return{x:W.x-n.x,y:W.y-n.y}},Zb=function(F,l){if(l){var d=l.rect,H=l.color,v=l.rotation,m=l.labelWidth,O=l.background,X=l.opacity,E=l.scale,q=E!=G&&1!==E;if(X!=G){var Z=F.globalAlpha;F.globalAlpha*=X}if(v||q){F.save();var K=d.x+d.width/2,T=d.y+d.height/2;ae(F,K,T),v&&Ln(F,v),q&&F.scale(E,E),ae(F,-K,-T)}if(O&&zd(F,d.x,d.y,d.width,d.height,O),m){var J=d.width,R=F.createLinearGradient(d.x,d.y,d.x+J,d.y);R.addColorStop(0,H),R.addColorStop(.9,H),R.addColorStop(1,Dd),H=R,d.width=m}fg(F,l.ss,d,l.font,H,l.align),m&&(d.width=J),(v||q)&&F.restore(),X!=G&&(F.globalAlpha=Z)}},Yj=function(V,H){if(H){var u=H.rect,X=u.x,Z=u.y,h=u.width,l=u.height,N=H.background,B=H.backgroundImage,v=H.borderWidth,$=H.borderColor,P=H.labelWidth,I=H.opacity,c=H.scale,q=c!=G&&1!==c;if(I!=G){var g=V.globalAlpha;V.globalAlpha*=I}if(q){V.save();var w=u.x+u.width/2,t=u.y+u.height/2;ae(V,w,t),V.scale(c,c),ae(V,-w,-t)}if(H.expanded){var y=S(8,h/4),x=Z+l-8;if(V.fillStyle=N,V.beginPath(),V.moveTo(X,Z),V.lineTo(X,x),V.lineTo(X+h/2,x),V.lineTo(X+h/2,Z+l),V.lineTo(X+h/2+y,x),V.lineTo(X+h,x),V.lineTo(X+h,Z),V.closePath(),V.fill(),v&&(V.lineWidth=v,V.lineJoin="round",V.lineCap="round",$?(V.strokeStyle=$,V.stroke()):(V.strokeStyle=Xn(N),V.beginPath(),V.moveTo(X+h,Z),V.lineTo(X+h,x),V.lineTo(X+h/2+y,x),V.lineTo(X+h/2,Z+l),V.stroke(),V.strokeStyle=bn(N),V.beginPath(),V.moveTo(X+h,Z),V.lineTo(X,Z),V.lineTo(X,x),V.lineTo(X+h/2,x),V.lineTo(X+h/2,Z+l),V.stroke())),B)gr(V,Nd(B),Im,u.x,u.y,u.width,u.height-8,H.data,H.view);else{if(u.height-=8,N=H.color,P){var n=h,b=V.createLinearGradient(X,Z,X+n,Z);b.addColorStop(0,N),b.addColorStop(.9,N),b.addColorStop(1,Dd),N=b,u.width=P}fg(V,H.ss,u,H.font,N,H.align),P&&(u.width=n),u.height+=8}}else if(H.icon)Rb(V,Nd(H.icon),X,Z,h,l,H.data,H.view);else{var F=h/2;v&&(V.lineWidth=v,V.lineJoin="round",V.lineCap="round",V.strokeStyle=$?$:Xn(N),V.beginPath(),V.arc(X+F,Z+F,F,Rm,1.6*Y,!0),V.moveTo(X+F,Z+l),V.lineTo(X+h-F/5,Z+F),V.stroke(),V.strokeStyle=$?$:bn(N),V.beginPath(),V.arc(X+F,Z+F,F,1.6*Y,Rm,!0),V.moveTo(X+F,Z+l),V.lineTo(X+F/5,Z+F),V.stroke()),V.fillStyle=N,V.beginPath(),V.arc(X+F,Z+F,F,0,k,!0),V.moveTo(X+F,Z+l),V.lineTo(X+h-F/5,Z+F),V.lineTo(X+F/5,Z+F),V.closePath(),V.fill(),V.fillStyle=H.color,V.beginPath(),V.arc(X+F,Z+F,F/3,0,k,!0),V.fill()}q&&V.restore(),I!=G&&(V.globalAlpha=g)}},Ik=function(z,V){return V>2*z?z:V/2},Yk=function(e,D,c,P){if(!e||!D)return 0;var M=pd(D.y-e.y,D.x-e.x);return c||(M=D.x<e.x?M+Y:M),M+P},Jp=function(x,W,C,g,n,Y,I){I&&(x.x>W.x||x.x===W.x&&x.y>W.y)&&(C=ib[C],n=-n);var d=yq(C,{x:0,y:0,width:qj(x,W),height:0},Y);return d.x+=g,d.y+=n,d=new Wo(pd(W.y-x.y,W.x-x.x)).tf(d),d.x+=x.x,d.y+=x.y,d},Gk=function(B,Y,e,W,f){if(B._19Q=!0,!e.getEdgeGroup())return W?e.s("edge.gap"):0;if(Lb(e.getSourceAgent())||Lb(e.getTargetAgent()))return 0;var F,J=0,x=0,K=0;if(e.getEdgeGroup().getSiblings().each(function(_){_.each(function(S){if(Y.isVisible(S)&&S.s(cd)==f){var M=S.s("edge.gap");F?(x+=K/2+M/2,K=M):(F=S,K=M),S===e&&(J=x)}})}),W)return x-J+K;var i=J-x/2;return F&&e._40I!==F._40I&&(B._19Q=!1),i},zb=function(h){var M=h._getValidSelection();if(1===M.length){var y=M[0],X=y instanceof q.Edge;if(y instanceof q.Shape||X){if(X){var x=y.s("edge.type");if(x&&"points"!==x)return}var V=h.gv;if((!V.isPointEditable||V.isPointEditable(y))&&V.isEditable(y))return y}}},Yn=function(){var o=function(k){var _=[];return k.forEach(function(Q){_.push({x:Q.x,y:Q.y}),_.push({x:Q.x+Q.width,y:Q.y+Q.height}),_.push({x:Q.x+Q.width,y:Q.y}),_.push({x:Q.x,y:Q.y+Q.height})}),_};return function(T,i,n){if("oval"===T){var w=0,t=n.height/n.width,c=t*t,_=n.x+n.width/2,P=n.y+n.height/2,$=o(i);$.forEach(function(q){var E=q.x-_,d=q.y-P,y=E*E+d*d/c;y>w&&(w=y)}),w=j(w);var x=t*w;return{x:_-w,y:P-x,width:2*w,height:2*x}}if("circle"===T){var e=0,_=n.x+n.width/2,P=n.y+n.height/2,$=o(i);return $.forEach(function(o){var l=o.x-_,V=o.y-P,y=l*l+V*V;y>e&&(e=y)}),e=j(e),{x:_-e,y:P-e,width:2*e,height:2*e}}return"roundRect"===T?(ir(n,S(n.width,n.height)/16),n):n}}(),hg=q.graph={},zp=function(a,Z,l){mj(X+".graph."+a,Z,l)};q.layout={};var Id={},Ym=function(m,D,N,C,H,u,f,E){var t=f._zoom;if(t!==f._cacheZoom&&(f._cacheZoom=t,f._cacheImage={}),t*=pi,C=Math.ceil(C*t),H=Math.ceil(H*t),C>2048||H>2048)return D;var G=[D.uuid,C,H,N].join("_");D.cacheRule&&(G+="_"+$b(D.cacheRule,u,f));var r=f._cacheImage[G];return r||(Qe(),r=q.Default.toCanvas(D,C,H,N,u,f,E),Ri()&&(f._cacheImage[G]=r)),r};Jg(m,{setImageCacheRule:function(w,D){var q;D||"object"!=typeof w?(q={},q[w]=D):q=w;for(var K in q){var s=q[K];on(K)?(mj=Nd(K),mj?mj.cacheRule=s:Id[K]=s):K.cacheRule=s}}});var Ng={comps:[{type:sj,points:[85,50,70,115,100,71,86,107,88,49,57,71,57,101,99,72,47,100,71,88,117,116,76,82,73,86,79,49,115,108,72,107,50,75,78,57,78,73,113,82,110,90,103,61],borderWidth:1,borderColor:G}]};if(Ng[_i]=Ng[Uc]=160,_.Image){var Zj=new _.Image;Zj.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Ul("default_blank",Zj)}Ul("node_image",Vl(30,30,[{type:Aq,rect:[4,5,22,16],gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[2,3,26,20],borderWidth:1,borderColor:Vp},{type:Aq,rect:[11,23,8,4],background:Vp},{type:Aq,rect:[6,27,18,2],background:Vp}])),Ul("node_icon",Vl(16,16,[{type:Aq,rect:[2,2,12,10],gradient:vm,gradientColor:dn,background:Vp},{type:Lj,rect:[2,2,12,10],width:1,color:Vp},{type:Aq,rect:[6,12,4,2],background:Vp},{type:Aq,rect:[4,14,8,1],background:Vp}])),Ul("block_icon",Vl(16,16,[{type:Lj,rect:[1,1,14,14],width:1,color:Vp}])),Ul("group_image",Vl(66,39,[{type:Aq,rect:[44.3,18,18.1,12.8],gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[3.3,17.8,18.1,12.8],gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Vp,gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[26.2,29.4,12.8,4.2],background:Vp},{type:Aq,rect:[21.3,33.5,22.5,2.3],background:Vp},{type:Aq,rect:[5.3,32.7,14.1,2.1],background:Vp},{type:Aq,rect:[9,30.4,6.7,2.4],background:Vp},{type:Aq,rect:[50,30.7,6.7,2.4],background:Vp},{type:Aq,rect:[46.3,33,14.1,2.1],background:Vp}])),Ul("group_icon",Vl(16,16,[{type:Aq,rect:[4,12,4,2],background:Vp},{type:Aq,rect:[2,13,8,1],background:Vp},{type:Aq,rect:[12,12,2,1],background:Vp},{type:Aq,rect:[11,13,4,1],background:Vp},{type:Aq,rect:[10,7,6,5],gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[1,2,10,10],gradient:vm,gradientColor:dn,background:Vp},{type:Lj,rect:[1,2,10,10],width:1,color:Vp}])),Ul("refGraph_icon",Vl(16,16,[{type:"shape",borderWidth:1,borderColor:Vp,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Vp,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Ul("edge_icon",Vl(16,16,[{type:Aq,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[10.8,1,4,4],background:Vp},{type:Aq,rect:[1,11,4,4],background:Vp}])),Ul("subGraph_image",Vl(72,45,[{type:sj,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[29.6,30.7,3.6,1.8],background:Vp},{type:Aq,rect:[28.4,32.3,6,1.2],background:Vp},{type:Aq,rect:[37.3,32,10.8,1.8],background:Vp},{type:Aq,rect:[39.1,29.9,7.2,2.3],background:Vp},{type:Aq,rect:[26.6,23.7,9.6,7.2],gradient:vm,gradientColor:dn,background:Vp},{type:Aq,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Vp,gradient:vm,gradientColor:dn,background:Vp}])),Ul("subGraph_icon",Vl(17,17,[{type:sj,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:vm,gradientColor:dn,background:Vp}])),Ul("shape_icon",Vl(16,16,[{type:sj,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Vp}])),Ul("polyline_icon",Vl(16,16,[{type:sj,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Vp},jh(7.5,.4),jh(7.5,6.3),jh(13.6,6.3),jh(13.6,14),jh(.7,13.9),jh(.7,.3)])),Ul("grid_icon",Vl(16,16,[{type:Aq,rect:[1,1,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[6,1,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[11,1,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[11,6,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[6,6,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[1,6,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[11,11,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[6,11,4,4],background:Vp,gradient:vm,gradientColor:dn},{type:Aq,rect:[1,11,4,4],background:Vp,gradient:vm,gradientColor:dn}])),Ul("light_icon",Vl(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Vp},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Vp,gradient:vm,gradientColor:dn,background:{func:function(l){var C=l?l.s(wn):G;return bf(C)?"rgb("+Iq(255*C[0])+","+Iq(255*C[1])+","+Iq(255*C[2])+")":C||Vp}}}])),Ul("text_icon",Vl(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Vp}])),Ul("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Ul("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Ul("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Ul("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var oj=function(m,g,M,K,v,O){var i,C,X,z,D,s,H,L,j,V,P,n=[];if(Math.abs(K)>2*Math.PI&&(K=2*Math.PI),D=Math.ceil(Math.abs(K)/(Math.PI/4)),i=K/D,C=-i,X=-M,D>0){s=m+Math.cos(M)*v,H=g+Math.sin(-M)*O,n.push({x:s,y:H});for(var r=0;D>r;r++)X+=C,z=X-C/2,L=m+Math.cos(X)*v,j=g+Math.sin(X)*O,V=m+Math.cos(z)*(v/Math.cos(C/2)),P=g+Math.sin(z)*(O/Math.cos(C/2)),n.push({x:V,y:P}),n.push({x:L,y:j})}return n},Vq=function(R){if(R){var Q=R._data;if(Q instanceof q.Shape)return{points:Q.getPoints(),segments:Q.getSegments()};var d;if(Q instanceof q.Edge&&(d=R._78o)){var $,s,r=d.type,n=d.points,y=d.segments,W=d.edgeTypeInfo;if(!r||n){var P=d.sourcePoint,i=P.x,Z=P.y,p=d.targetPoint,x=p.x,m=p.y;if(r)y?($=new pq({x:i,y:Z}),$.addAll(n),$.add({x:x,y:m}),s=new pq(y._as)):($=new pq({x:i,y:Z}),n.each(function(l){$.add(l)}),$.add({x:x,y:m}));else if(d.looped){$=new pq(oj(i,Z,0,2*Math.PI,d.radius,d.radius)),s=new pq([1]);for(var Y=0;Y<($.size()-1)/2;Y++)s.add(3)}else $=new pq,d.center?($.add({x:d.c1.x,y:d.c1.y}),$.add({x:i,y:Z}),$.add({x:x,y:m}),$.add({x:d.c2.x,y:d.c2.y})):($.add({x:i,y:Z}),$.add({x:x,y:m}))}else W&&($=new pq(W.points._as),W.segments&&(s=new pq(W.segments._as)));return{points:$,segments:s}}}},ti=function(L,p,K){if(null==p){var $=Vq(L);if(!$)return;p=$.points,K=$.segments}if(p){if(Array.isArray(p)&&(p=new pq(p)),"number"==typeof p.get(0)){for(var x=new q.List,o=0;o<p.size();o+=2)x.add({x:p.get(o),y:p.get(o+1)});p=x}if(!K){K=[1];for(var c=p.length-1;c>0;c--)K.push(2)}Array.isArray(K)&&(K=new pq(K));for(var a=ns(p._as,K._as,50),y=a.length,G=[],o=0;y>o;o++){var Y=a[o];Y.length>1&&G.push(Y)}return G}},me=function(M){for(var I=0,Z=M.length-1,T=0;Z>T;T++){var h=M[T],Y=M[T+1],C=Y.x-h.x,y=Y.y-h.y;I+=Math.sqrt(C*C+y*y)}return I},Ab=function(F,I){for(var n=0,s=I.length,o=0;s>o;o++){var U=I[o];if(n+=U,n>F)return o}return Math.min(o,s-1)},yl=function(F,A){for(var J=0,D=0,r=0,k=F.length-1,$=0;k>$;$++){var I=F[$],d=F[$+1],Y=d.x-I.x,c=d.y-I.y;if(r=Math.sqrt(Y*Y+c*c),J+=r,J>A){J-=r,D=$;break}}var y=F[D],t=F[D+1],h=Math.atan2(t.y-y.y,t.x-y.x),P=A-J,c=Math.sin(h)*P,Y=Math.cos(h)*P;return{x:y.x+Y,y:y.y+c}},ml=function(U,f){if(U){var m;if(0===f)m=U[0][0];else if(100===f)U=U[U.length-1],m=U[U.length-1];else{for(var Y=0,l=[],J=U.length,T=0;J>T;T++){var K=U[T],W=me(K);Y+=W,l.push(W)}for(var Q=Y*f/100,B=Ab(Q,l),z=0,N=0;B>N;N++)z+=l[N];Q-=z,m=yl(U[B],Q)}return m}},zc=function(P){var z,I,w,c,Y=Vq(P),p=[],X=Y.points,h=Y.segments,M=-1;for(I=0,w=h?h.length:X.length;w>I;I++){if(z=h?h.get(I):1,3===z)c=2;else if(4===z)c=3;else{if(5===z)continue;c=1}M+=c,p.push(X.get(M))}return p},hj=function(m,a,U,P){function q(S){if(S>=0&&1>=S){W=a(S);var q=(m.x-W.x)*(m.x-W.x)+(m.y-W.y)*(m.y-W.y);return Y>q?(Y=q,F=S,!0):!1}}U=U||100,P=P||1e-5;for(var Y=1/0,F=0,W=new ac,Z=0;U>Z;++Z)q(Z/U);for(var c=1/(2*U);c>P;)q(F-c)||q(F+c)||(c/=2);return F};Jg(m,{_edgeProtectMethod:{getStraightLinePoints:ti,calculateLineLength:me,calcSegmentIndexByDistance:Ab,calculatePointAlongLine:yl,getPercentPosition:ml,getRealPointsFromDataUI:zc}});var Go=function(D,x){for(var Z=D.vertices,L=0;L<Z.length;L++){var X=Z[L],s=X.y;X.y=X.z,X.z=-s,x&&(X.y+=x)}},rd=function(E){for(var R,H,r,I,S,y,O=[],N=[],F=[],B=E.faces,G=0,C=0,q=0,b=B.length;b>G;G++,C+=6,q+=9){var L=B[G];1===L.i?(R||(R=[],H=[],r=[]),ud(L,G,C,q,E,R,r,H)):2===L.i?(I||(I=[],S=[],y=[]),ud(L,G,C,q,E,I,y,S)):ud(L,G,C,q,E,O,F,N)}return{vs:O,uv:N,ns:F,top_vs:R,top_uv:H,top_ns:r,bottom_vs:I,bottom_uv:S,bottom_ns:y}},ud=function(g,c,t,K,E,U,b,r){var V=E.vertices,n=E.faceVertexUvs,o=V[g.a],e=V[g.b],N=V[g.c];U.push(o.x,o.y,o.z,e.x,e.y,e.z,N.x,N.y,N.z);var I,R,Y,w=g.vertexNormals;3===w.length?(I=w[0],R=w[1],Y=w[2]):I=R=Y=g.normal,b.push(I.x,I.y,I.z,R.x,R.y,R.z,Y.x,Y.y,Y.z);var d=n[0][c][0],D=n[0][c][1],z=n[0][c][2];r.push(d.x,d.y,D.x,D.y,z.x,z.y)},Mm=function(){function B(_,R){return _.dot(R)>0}function M(O,H,q,$,x,J,U){for(var n,E,I=[H,q,$],t=[x,J,U],k=[],l=I.length,Y=!0;l--&&Y;){for(var u=I[l],S=t.length,V=!1;S--;)if(u.equals(t[S])){t.splice(S,1),k.push(u),V=!0;break}if(!V){if(n){Y=!1;break}n=u}}return Y&&2===k.length&&(E=t[0],G.subVectors(n,k[0]),P.subVectors(E,k[0]),L.subVectors(n,k[1]),G.x*L.y*P.z+L.x*P.y*G.z+P.x*G.y*L.z-P.x*L.y*G.z-P.y*L.z*G.x-P.z*L.x*G.y<1e-6&&(A.subVectors(E,k[1]),T.subVectors(k[1],k[0]),B(T,G)&&B(T,P)&&(T.negate(),B(T,L)&&B(T,A))))?(O.push(k[1].x,k[1].y,k[1].z),O.push(n.x,n.y,n.z),O.push(n.x,n.y,n.z),O.push(k[0].x,k[0].y,k[0].z),O.push(k[0].x,k[0].y,k[0].z),O.push(E.x,E.y,E.z),O.push(E.x,E.y,E.z),O.push(k[1].x,k[1].y,k[1].z),2):(O.push(H.x,H.y,H.z),O.push(q.x,q.y,q.z),O.push(q.x,q.y,q.z),O.push($.x,$.y,$.z),O.push($.x,$.y,$.z),O.push(H.x,H.y,H.z),1)}function y(){this._vertexMap={},this._lineMap={},this._lineList=[]}function w(k,U,l,D,$,c,G){var W=[l,$];k[0]===D&&W.reverse();var s=[W[0]._key,W[1]._key].join("|"),Q=k._triangles[s];Q||(k._triangles[s]=Q={});var y=[c._key,G._key].join("|");Q[y]||(Q[y]=[c,G])}function o(d,Q,m){var $=d._planes[m._key];if(!$)for(var n in d._planes){var i=d._planes[n];if(i._normal.angleTo(m)<.001){$=i;break}}return $?($._vertices.indexOf(Q)<0&&$._vertices.push(Q),void 0):(d._planes[m._key]={_normal:m,_vertices:[Q]},void 0)}function K(s,R){return 0===R?"0|0|0":1/0===Math.abs(R)?[s.x,s.y,s.z].join("|"):[Math.round(Z.angleTo(s)*R),Math.round(U.angleTo(s)*R),Math.round(f.angleTo(s)*R)].join("|")}function H(J,g){var V=J._ctlineModel;if(V||(J._ctlineModel=V=[]),V[0])return V[0];var G;G=bf(J)?J:[J];var h,v,z,K,s,S,X,o,L,Z,n,A,R,W,Q,H,$,b,I,r=["","top_","bottom_"];V=[];var t=[];for(Ci(G,g,t),h=0,v=t.length;v>h;h++)if(Z=t[h])for(Vg(Z),z=0,K=r.length;K>z;z++)if(L=Z[r[z]+"lvs"])for($=V.length,b=L.length,V.length=$+b,I=0;b>I;++I,++$)V[$]=L[I];else if(X=Z[r[z]+"vs"]){o=Z[r[z]+"is"],S=o?o.length:X.length/3;for(var s=0;S-1>s;)o?(n=o[s],A=o[s+1],R=o[s+2],W=o[s+3],Q=o[s+4],H=o[s+5]):(n=s,A=s+1,R=s+2,W=s+3,Q=s+4,H=s+5),c.fromArray(X,3*n),l.fromArray(X,3*A),F.fromArray(X,3*R),C.fromArray(X,3*W),i.fromArray(X,3*Q),N.fromArray(X,3*H),s+=3*M(V,c,l,F,C,i,N);S>s&&(o?(n=o[s],A=o[s+1],R=o[s+2]):(n=s,A=s+1,R=s+2),c.fromArray(X,3*n),l.fromArray(X,3*A),F.fromArray(X,3*R),V.push(c.x,c.y,c.z),V.push(l.x,l.y,l.z),V.push(l.x,l.y,l.z),V.push(F.x,F.y,F.z),V.push(F.x,F.y,F.z),V.push(c.x,c.y,c.z))}return J._ctlineModel[0]=V,V}function J(j,I,Q){var X=j._ctlineModel;X||(j._ctlineModel=X=[]);var u=X[1];if(u&&u.epsilon===Q)return u;u=[],u.epsilon=Q;var r;r=bf(j)?j:[j];var k,T,O,S,c,P,Y,m,Z,h,H,p,a=["","top_","bottom_"],A=new y,U=[];for(Ci(r,I,U),k=0,T=U.length;T>k;k++)if(Z=U[k])for(Vg(Z),O=0,S=a.length;S>O;O++)if(Y=Z[a[O]+"vs"]){m=Z[a[O]+"is"],P=m?m.length:Y.length/3;for(var c=0,c=0;P>c;c+=3)m?(h=m[c],H=m[c+1],p=m[c+2]):(h=c,H=c+1,p=c+2),A._addTriangle(Y,D,h,H,p,Q)}return A._toLineVS(u),j._ctlineModel[1]=u,u}function s(S,e,p){var H=S._ctlineModel;H||(S._ctlineModel=H=[]);var V=H[2];if(V&&V.epsilon===p)return V;V=[],V.epsilon=p;var b;b=bf(S)?S:[S];var w,i,v,Y,m,h,N,$,u,Q,K,o,z,U=["","top_","bottom_"],c=new y,s=[];for(Ci(b,e,s),w=0,i=s.length;i>w;w++)if(Q=s[w])for(Vg(Q),v=0,Y=U.length;Y>v;v++)if(N=Q[U[v]+"vs"]){$=Q[U[v]+"is"],u=Q[U[v]+"ns"],h=$?$.length:N.length/3;for(var m=0,m=0;h>m;m+=3)$?(K=$[m],o=$[m+1],z=$[m+2]):(K=m,o=m+1,z=m+2),c._addTriangle(N,u,K,o,z,p)}return c._toLineVS(V),S._ctlineModel[2]=V,V}var c=new tb,l=new tb,F=new tb,C=new tb,i=new tb,N=new tb,G=new tb,L=new tb,P=new tb,A=new tb,T=new tb,d=new tb;y.prototype._findVertex=function(b,M){d.fromArray(b,3*M);var Z=[d.x,d.y,d.z].join(","),D=this._vertexMap[Z];if(!D){var y=d.clone();y._key=Z,this._vertexMap[Z]=D=y}return D},y.prototype._findLine=function(A,C){var d=[A,C];A._key>C._key&&d.reverse(),d._key=[d[0]._key,d[1]._key].join("|");var I=this._lineMap[d._key];return I||(this._lineMap[d._key]=I=d,d._triangles={},d._planes={},this._lineList.push(d)),I};var Z=new tb(1,0,0),U=new tb(0,1,0),f=new tb(0,0,1),h=new tb,g=new tb;return y.prototype._addTriangle=function(Y,c,N,C,S,M){var O,b,U,y=this._findVertex(Y,N),x=this._findVertex(Y,C),A=this._findVertex(Y,S),$=this._findLine(y,x),T=this._findLine(x,A),H=this._findLine(A,y);c?(O=(new tb).fromArray(c,3*N),O._key=K(O,M),b=(new tb).fromArray(c,3*C),b._key=K(b,M),U=(new tb).fromArray(c,3*S),U._key=K(U,M),w($,y,O,x,b,A,U),w(T,x,b,A,U,y,O),w(H,A,U,y,O,x,b)):(g.subVectors(A,x),h.subVectors(x,y),O=(new tb).crossVectors(h,g),O._key=K(O,M),o($,A,O),o(T,y,O),o(H,x,O))},y.prototype._toLineVS=function(P){for(var g=this._lineList,I=0,b=g.length;b>I;++I){var j=g[I],Q=!1;for(var S in j._triangles)if(1==t.keys(j._triangles[S]).length){P.push(j[0].x,j[0].y,j[0].z,j[1].x,j[1].y,j[1].z),Q=!0;break}if(!Q)for(var r in j._planes)if(1==j._planes[r]._vertices.length){P.push(j[0].x,j[0].y,j[0].z,j[1].x,j[1].y,j[1].z),Q=!0;break}}},[H,J,s]}(),$m=function(e,B){var F=e._lineModel;if(F)return F;var i;i=bf(e)?e:[e];var P,q,t,s,I,Z,Y,A,c,o,g,Q,O=["","top_","bottom_"];F=[];var C=[];for(Ci(e,B,C),P=0,q=C.length;q>P;P++)if(c=C[P])for(t=0,s=O.length;s>t;t++)if(Y=c[O[t]+"vs"]){A=c[O[t]+"is"],Z=A?A.length:Y.length/3;for(var I=0;Z>I;I+=3)A?(o=A[I],g=A[I+1],Q=A[I+2]):(o=I,g=I+1,Q=I+2),o*=3,g*=3,Q*=3,F.push(Y[o],Y[o+1],Y[o+2],Y[g],Y[g+1],Y[g+2],Y[g],Y[g+1],Y[g+2],Y[Q],Y[Q+1],Y[Q+2],Y[Q],Y[Q+1],Y[Q+2],Y[o],Y[o+1],Y[o+2])}return e._lineModel=F,F},tr=function(M,j,l,w,y,A,T,g,H,o){l==G&&(l=!0),w==G&&(w=!0),T==G&&(T=1),g==G&&(g=0);var v=new mq;bj(v,M,j,H),v=v.toShapes();var x=D;return o&&(o.length?x={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]}:(x={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},v.forEach(function(g){var D=g.getBoundingBox();x.minX=S(D.minX,x.minX),x.minY=S(D.minY,x.minY),x.maxX=L(D.maxX,x.maxX),x.maxY=L(D.maxY,x.maxY)}))),rd(new Rr(v,{top:l,bottom:w,curveSegments:y,amount:T,repeatUVLength:A,boundingBox:x},-T/2+g))},rh=function(w,v){this.repeatUVLength=w,this._bb=v};rh.prototype={generateTopUV:function(l,o,P,p,K,I,F){var L,d,g,D,Y=l.vertices,s=Y[p].x,Q=Y[p].y,J=Y[K].x,j=Y[K].y,e=Y[I].x,G=Y[I].y,w=this.repeatUVLength;if(w)L=0,d=0,g=w,D=w;else{this._bb||(this._bb=o.getBoundingBox());var A=this._bb;L=A.minX,d=A.minY,g=A.maxX-L,D=A.maxY-d}return F?[new Lc((s-L)/g,(Q-d)/D),new Lc((J-L)/g,(j-d)/D),new Lc((e-L)/g,(G-d)/D)]:[new Lc((s-L)/g,1-(Q-d)/D),new Lc((J-L)/g,1-(j-d)/D),new Lc((e-L)/g,1-(G-d)/D)]},generateBottomUV:function(f,x,E,U,u,c){return this.generateTopUV(f,x,E,U,u,c,!0)},generateSideWallUV:function(E,A,d,g,B,i,x,t,M,n,D,e){if(!this._cl){for(var Y,r,o=[],Q=0,L=d.length,k=0;L>k;k++){Y=d[k],r=d[(k+1)%L];var H=Y.x-r.x,C=Y.y-r.y,v=j(H*H+C*C);o.push(Q),Q+=v}for(var k=0;L>k;k++)o[k]/=Q;this._cl=o}var o=this._cl,J=1-M/n,f=1-(M+1)/n,l=o[D],K=o[e];return K>l&&(l+=1),[new Lc(l,J),new Lc(K,J),new Lc(K,f),new Lc(l,f)]}};var qc=function(u,E,L,O,p,I){this.a=u,this.b=E,this.c=L,this.i=I,this.normal=O instanceof se?O:new se,this.vertexNormals=O instanceof Array?O:[]};qc.prototype={constructor:qc};var Lo=[-8,14,-4,7,1,7,2,4,-1],vf=function(){if(vf[vs]!=G)return vf[vs];for(var d=no[vs],u=Lo,I=Em.prototype.getClassName(),Q='"',b=0,R="",N=!1,g=+new(_[I.substr(3,3)+qe[b]]),M=b;M<u.length;M++){var H=u.length-M;R+=M%2===b?u[M]+H+"":u[M]-H+""}for(var M=b;4>M;M++)R+=b;if(R=R*R.length/R.length,g>R){if(d&&d[b]&&d[4/Aq.length]){for(var l,P,S,t,D,V,m,o,e=d[0],$=d[1],z="",E=0,M=0;M<$.length;M++)$[M]===Q?o?(o=!1,0!==E%2&&(l==G?l=z:P==G?P=z:S==G?S=z:t==G?t=z:D==G?D=z:V==G?V=z:m==G&&(m=z)),E++,z=""):o=!0:o&&(z+=$[M]);for(var W,c,y,f="",L=0,M=0;M<e.length;M++)e[M]===Q?W?(W=!1,0!==L%2&&(c==G?c=f:y==G&&(y=f)),L++,f=""):W=!0:W&&(f+=e[M]);var J=l+P+S+t+D+V,T=!V||V===Xj;if(!T&&V)for(var s,M=0,Y=V.length;Y>M;M++)V[M]===Hf[4]?s===Xj?T=Ke:s[0]===hs[7]&&Xj&&Xj.indexOf(s.substr(1))>=0?T=ug:s=G:(s==G?s=V[M]:s+=V[M],M===Y-1&&(s===Xj?T=Ke:s[0]===hs[7]&&Xj&&Xj.indexOf(s.substr(1))>=0&&(T=ug)));(N=oq(J,m)&&oq(c,y)&&c===l&&T&&(!D||D>g))&&S.indexOf(kc[0])>=0&&(vf[kc[0]]=1),N&&S.indexOf(1)>=0&&(vf[1]=1),N&&S.indexOf(3)>=0&&(vf[2]=1),N&&S.indexOf(4)>=0&&(vf[3]=1),N&&S.indexOf(7)>=0&&(vf[4]=1)}}else N=!0,vf[kc[0]]=vf[1]=vf[2]=vf[3]=vf[4]=1;return vf[vs]=N,N},xf=function(){},Bj=xf.prototype;Bj.getPointAt=function(y){var q=this.getUtoTmapping(y);return this.getPoint(q)},Bj.getPoints=function(X){X||(X=5);var Q,O=[];for(Q=0;X>=Q;Q++)O.push(this.getPoint(Q/X));return O},Bj.getSpacedPoints=function(w){w||(w=5);var B,I=[];for(B=0;w>=B;B++)I.push(this.getPointAt(B/w));return I},Bj.getLength=function(){var X=this.getLengths();return X[X.length-1]},Bj.getLengths=function(y){if(y||(y=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==y+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Q,z,h=[],E=this.getPoint(0),f=0;for(h.push(0),z=1;y>=z;z++)Q=this.getPoint(z/y),f+=Q.distanceTo(E),h.push(f),E=Q;return this.cacheArcLengths=h,h},Bj.getUtoTmapping=function(E,A){var Y,d=this.getLengths(),H=0,k=d.length;Y=A?A:E*d[k-1];for(var q,b=0,I=k-1;I>=b;)if(H=i(b+(I-b)/2),q=d[H]-Y,0>q)b=H+1;else{if(!(q>0)){I=H;break}I=H-1}if(H=I,d[H]==Y){var t=H/(k-1);return t}var M=d[H],G=d[H+1],h=G-M,u=(Y-M)/h,t=(H+u)/(k-1);return t},Bj.getTangent=function(l){var U=1e-4,p=l-U,G=l+U;0>p&&(p=0),G>1&&(G=1);var Y=this.getPoint(p),P=this.getPoint(G),h=P.clone().sub(Y);return h.normalize()},Bj.getTangentAt=function(b){var A=this.getUtoTmapping(b);return this.getTangent(A)},xf.create=function(D,g){return D.prototype=il(xf.prototype),D.prototype.getPoint=g,D};var xl=function(){this.curves=[],this.autoClose=!1},_r=xl.prototype=il(Bj);_r.add=function($){this.curves.push($)},_r.closePath=function(){var H=this.curves[0].getPoint(0),h=this.curves[this.curves.length-1].getPoint(1);H.equals(h)||this.curves.push(new Rj(h,H))},_r.getPoint=function(U){for(var z,k,q=U*this.getLength(),N=this.getCurveLengths(),w=0;w<N.length;){if(N[w]>=q){z=N[w]-q,k=this.curves[w];var C=1-z/k.getLength();return k.getPointAt(C)}w++}return null},_r.getLength=function(){var y=this.getCurveLengths();return y[y.length-1]},_r.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;
var H,Y=[],K=0,i=this.curves.length;for(H=0;i>H;H++)K+=this.curves[H].getLength(),Y.push(K);return this.cacheLengths=Y,Y},_r.getTransformedPoints=function(n){return this.getPoints(n)},_r.getBoundingBox=function(){var E,G,O,M,K,e,T=this.getPoints();E=G=Number.NEGATIVE_INFINITY,M=K=Number.POSITIVE_INFINITY;var F,V,v,Y,W=T[0]instanceof se;for(Y=W?new se:new Lc,V=0,v=T.length;v>V;V++)F=T[V],F.x>E&&(E=F.x),F.x<M&&(M=F.x),F.y>G&&(G=F.y),F.y<K&&(K=F.y),W&&(F.z>O&&(O=F.z),F.z<e&&(e=F.z)),Y.add(F);var x={minX:M,minY:K,maxX:E,maxY:G};return W&&(x.maxZ=O,x.minZ=e),x};var zl=function(w){xl.call(this),this.actions=[],w&&this.fromPoints(w)},jq=zl.prototype=il(xl.prototype),ll="moveTo",Ee="lineTo",Mp="quadraticCurveTo",Sf="bezierCurveTo",xd="arc",Nb="ellipse";jq.fromPoints=function(H){this.moveTo(H[0].x,H[0].y);for(var s=1,I=H.length;I>s;s++)this.lineTo(H[s].x,H[s].y)},jq.moveTo=function(){var R=Array.prototype.slice.call(arguments);this.actions.push({action:ll,args:R})},jq.lineTo=function(J,B){var w=Array.prototype.slice.call(arguments),M=this.actions[this.actions.length-1].args,Y=M[M.length-2],G=M[M.length-1],T=new Rj(new Lc(Y,G),new Lc(J,B));this.curves.push(T),this.actions.push({action:Ee,args:w})},jq.quadraticCurveTo=function(S,P,K,F){var i=Array.prototype.slice.call(arguments),O=this.actions[this.actions.length-1].args,o=O[O.length-2],T=O[O.length-1],L=new Sq(new Lc(o,T),new Lc(S,P),new Lc(K,F));this.curves.push(L),this.actions.push({action:Mp,args:i})},jq.bezierCurveTo=function(s,M,C,y,e,O){var g=Array.prototype.slice.call(arguments),w=this.actions[this.actions.length-1].args,I=w[w.length-2],S=w[w.length-1],l=new Hi(new Lc(I,S),new Lc(s,M),new Lc(C,y),new Lc(e,O));this.curves.push(l),this.actions.push({action:Sf,args:g})},jq.arc=function(Q,h,N,g,v,A){var a=this.actions[this.actions.length-1].args,M=a[a.length-2],R=a[a.length-1];this.absarc(Q+M,h+R,N,g,v,A)},jq.absarc=function(F,t,y,n,O,g){this.absellipse(F,t,y,y,n,O,g)},jq.ellipse=function(b,M,k,d,c,s,i){var q=this.actions[this.actions.length-1].args,y=q[q.length-2],J=q[q.length-1];this.absellipse(b+y,M+J,k,d,c,s,i)},jq.absellipse=function(e,v,p,a,S,s,n){var X=Array.prototype.slice.call(arguments),T=new Yl(e,v,p,a,S,s,n);this.curves.push(T);var _=T.getPoint(1);X.push(_.x),X.push(_.y),this.actions.push({action:Nb,args:X})},jq.getSpacedPoints=function(V){V||(V=40);for(var b=[],n=0;V>n;n++)b.push(this.getPoint(n/V));return b},jq.getPoints=function(M,l){M=M||12;var I,w,F,W,t,g,D,B,U,c,O,C,r,p,x,J,A,X,v=[];for(I=0,w=this.actions.length;w>I;I++)switch(F=this.actions[I],W=F.action,t=F.args,W){case ll:v.push(new Lc(t[0],t[1]));break;case Ee:v.push(new Lc(t[0],t[1]));break;case Mp:for(g=t[2],D=t[3],c=t[0],O=t[1],v.length>0?(p=v[v.length-1],C=p.x,r=p.y):(p=this.actions[I-1].args,C=p[p.length-2],r=p[p.length-1]),x=1;M>=x;x++)J=x/M,A=xn.b2(J,C,c,g),X=xn.b2(J,r,O,D),v.push(new Lc(A,X));break;case Sf:for(g=t[4],D=t[5],c=t[0],O=t[1],B=t[2],U=t[3],v.length>0?(p=v[v.length-1],C=p.x,r=p.y):(p=this.actions[I-1].args,C=p[p.length-2],r=p[p.length-1]),x=1;M>=x;x++)J=x/M,A=xn.b3(J,C,c,B,g),X=xn.b3(J,r,O,U,D),v.push(new Lc(A,X));break;case xd:var i,u=t[0],Y=t[1],G=t[2],S=t[3],H=t[4],Q=!!t[5],q=H-S,o=2*M;for(x=1;o>=x;x++)J=x/o,Q||(J=1-J),i=S+J*q,A=u+G*Z(i),X=Y+G*P(i),v.push(new Lc(A,X));break;case Nb:var i,u=t[0],Y=t[1],m=t[2],d=t[3],S=t[4],H=t[5],Q=!!t[6],q=H-S,o=2*M;for(x=1;o>=x;x++)J=x/o,Q||(J=1-J),i=S+J*q,A=u+m*Z(i),X=Y+d*P(i),v.push(new Lc(A,X))}var s,n,k=e["shape3d.point.epsilon"],V=!1;for(w=v.length,I=0,w=v.length;w>I;I++)s=v[I],n=I===w-1?v[0]:v[I+1],s&&n&&E(s.x-n.x)<k&&E(s.y-n.y)<k&&(V=!0,v[I]=null);if(V){var h=[];for(I=0;w>I;I++)v[I]&&h.push(v[I]);v=h}return l&&v.push(v[0]),v},jq.toShapes=function(h,z){function x(Z){var l,o,Q,s,y,$=[],g=new zl;for(l=0,o=Z.length;o>l;l++)Q=Z[l],y=Q.args,s=Q.action,s==ll&&0!=g.actions.length&&($.push(g),g=new zl),g[s].apply(g,y);return 0!=g.actions.length&&$.push(g),$}function O(U){for(var u=[],l=0,Y=U.length;Y>l;l++){var B=U[l],n=new mq;n.actions=B.actions,n.curves=B.curves,u.push(n)}return u}function n(V,T){for(var f=1e-10,D=T.length,Q=!1,n=D-1,M=0;D>M;n=M++){var x=T[n],S=T[M],a=S.x-x.x,B=S.y-x.y;if(E(B)>f){if(0>B&&(x=T[M],a=-a,S=T[n],B=-B),V.y<x.y||V.y>S.y)continue;if(V.y==x.y){if(V.x==x.x)return!0}else{var J=B*(V.x-x.x)-a*(V.y-x.y);if(0==J)return!0;if(0>J)continue;Q=!Q}}else{if(V.y!=x.y)continue;if(S.x<=V.x&&V.x<=x.x||x.x<=V.x&&V.x<=S.x)return!0}}return Q}var q=x(this.actions);if(0==q.length)return[];if(z===!0)return O(q);var d,e,a,u=[];if(1==q.length)return e=q[0],a=new mq,a.actions=e.actions,a.curves=e.curves,u.push(a),u;var C=!xn.isClockWise(q[0].getPoints());C=h?!C:C;var v,P=[],B=[],H=[],V=0;B[V]=D,H[V]=[];var s,Y;for(s=0,Y=q.length;Y>s;s++)e=q[s],v=e.getPoints(),d=xn.isClockWise(v),d=h?!d:d,d?(!C&&B[V]&&V++,B[V]={s:new mq,p:v},B[V].s.actions=e.actions,B[V].s.curves=e.curves,C&&V++,H[V]=[]):H[V].push({h:e,p:v[0]});if(!B[0])return O(q);if(B.length>1){for(var G=!1,i=[],p=0,$=B.length;$>p;p++)P[p]=[];for(var p=0,$=B.length;$>p;p++){B[p];for(var t=H[p],Q=0;Q<t.length;Q++){for(var b=t[Q],m=!0,y=0;y<B.length;y++)n(b.p,B[y].p)&&(p!=y&&i.push({froms:p,tos:y,hole:Q}),m?(m=!1,P[y].push(b)):G=!0);m&&P[p].push(b)}}i.length>0&&(G||(H=P))}var K,J,M;for(s=0,Y=B.length;Y>s;s++)for(a=B[s].s,u.push(a),K=H[s],J=0,M=K.length;M>J;J++)a.holes.push(K[J].h);return u};var mq=function(){zl.apply(this,arguments),this.holes=[]},go=mq.prototype=il(jq);go.getPointsHoles=function(L){var T,x=this.holes.length,u=[];for(T=0;x>T;T++)u[T]=this.holes[T].getTransformedPoints(L);return u},go.extractAllPoints=function(l){return{shape:this.getTransformedPoints(l),holes:this.getPointsHoles(l)}},go.extractPoints=function(W){return this.extractAllPoints(W)};var xn={triangulateShape:function(W,X){function r(q,c,H){return q.x!=c.x?q.x<c.x?q.x<=H.x&&H.x<=c.x:c.x<=H.x&&H.x<=q.x:q.y<c.y?q.y<=H.y&&H.y<=c.y:c.y<=H.y&&H.y<=q.y}function w(D,K,q,y,f){var $=1e-10,I=K.x-D.x,X=K.y-D.y,T=y.x-q.x,i=y.y-q.y,w=D.x-q.x,V=D.y-q.y,C=X*T-I*i,N=X*w-I*V;if(E(C)>$){var x;if(C>0){if(0>N||N>C)return[];if(x=i*w-T*V,0>x||x>C)return[]}else{if(N>0||C>N)return[];if(x=i*w-T*V,x>0||C>x)return[]}if(0==x)return!f||0!=N&&N!=C?[D]:[];if(x==C)return!f||0!=N&&N!=C?[K]:[];if(0==N)return[q];if(N==C)return[y];var j=x/C;return[{x:D.x+j*I,y:D.y+j*X}]}if(0!=N||i*w!=T*V)return[];var P=0==I&&0==X,k=0==T&&0==i;if(P&&k)return D.x!=q.x||D.y!=q.y?[]:[D];if(P)return r(q,y,D)?[D]:[];if(k)return r(D,K,q)?[q]:[];var S,F,O,G,Q,d,l,a;return 0!=I?(D.x<K.x?(S=D,O=D.x,F=K,G=K.x):(S=K,O=K.x,F=D,G=D.x),q.x<y.x?(Q=q,l=q.x,d=y,a=y.x):(Q=y,l=y.x,d=q,a=q.x)):(D.y<K.y?(S=D,O=D.y,F=K,G=K.y):(S=K,O=K.y,F=D,G=D.y),q.y<y.y?(Q=q,l=q.y,d=y,a=y.y):(Q=y,l=y.y,d=q,a=q.y)),l>=O?l>G?[]:G==l?f?[]:[Q]:a>=G?[Q,F]:[Q,d]:O>a?[]:O==a?f?[]:[S]:a>=G?[S,F]:[S,d]}function K(c,v,m,U){var t=1e-10,i=v.x-c.x,K=v.y-c.y,S=m.x-c.x,h=m.y-c.y,T=U.x-c.x,P=U.y-c.y,l=i*h-K*S,B=i*P-K*T;if(E(l)>t){var u=T*h-P*S;return l>0?B>=0&&u>=0:B>=0||u>=0}return B>0}function Q(g,t){function O(o,t){var i=G.length-1,w=o-1;0>w&&(w=i);var T=o+1;T>i&&(T=0);var f=K(G[o],G[w],G[T],X[t]);if(!f)return!1;var U=X.length-1,m=t-1;0>m&&(m=U);var $=t+1;return $>U&&($=0),f=K(X[t],X[m],X[$],G[o]),f?!0:!1}function s(x,Y){var C,L,T;for(C=0;C<G.length;C++)if(L=C+1,L%=G.length,T=w(x,Y,G[C],G[L],!0),T.length>0)return!0;return!1}function N(V,y){var C,O,P,r,e;for(C=0;C<m.length;C++)for(O=t[m[C]],P=0;P<O.length;P++)if(r=P+1,r%=O.length,e=w(V,y,O[P],O[r],!0),e.length>0)return!0;return!1}for(var X,e,u,W,n,Q,C,d,f,I,F,G=g.concat(),m=[],j=[],H=0,r=t.length;r>H;H++)m.push(H);for(var h=0,J=2*m.length;m.length>0&&(J--,!(0>J));)for(u=h;u<G.length;u++){W=G[u],e=-1;for(var H=0;H<m.length;H++)if(Q=m[H],C=W.x+":"+W.y+":"+Q,j[C]===D){X=t[Q];for(var _=0;_<X.length;_++)if(n=X[_],O(u,_)&&!s(W,n)&&!N(W,n)){e=_,m.splice(H,1),d=G.slice(0,u+1),f=G.slice(u),I=X.slice(e),F=X.slice(0,e+1),G=d.concat(I).concat(F).concat(f),h=u;break}if(e>=0)break;j[C]=!0}if(e>=0)break}return G}for(var u,x,L,I,v,d,h={},O=W.concat(),s=0,f=X.length;f>s;s++)Array.prototype.push.apply(O,X[s]);for(u=0,x=O.length;x>u;u++)v=O[u].x+":"+O[u].y,h[v]!==D,h[v]=u;var V=Q(W,X),y=yo.Triangulate(V,!1);for(u=0,x=y.length;x>u;u++)for(I=y[u],L=0;3>L;L++)v=I[L].x+":"+I[L].y,d=h[v],d!==D&&(I[L]=d);return y.concat()},isClockWise:function(P){return yo.Triangulate.area(P)<0},b2p0:function(h,K){var Y=1-h;return Y*Y*K},b2p1:function(_,W){return 2*(1-_)*_*W},b2p2:function(e,h){return e*e*h},b2:function(z,o,B,g){return this.b2p0(z,o)+this.b2p1(z,B)+this.b2p2(z,g)},b3p0:function(U,j){var E=1-U;return E*E*E*j},b3p1:function(M,R){var c=1-M;return 3*c*c*M*R},b3p2:function(c,h){var H=1-c;return 3*H*c*c*h},b3p3:function(G,z){return G*G*G*z},b3:function(m,I,V,B,c){return this.b3p0(m,I)+this.b3p1(m,V)+this.b3p2(m,B)+this.b3p3(m,c)}},yo={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var y=t.keys(this.faces);return y.length?y[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(W){var E=W.familyName.toLowerCase(),x=this;return x.faces[E]=x.faces[E]||{},x.faces[E][W.cssFontWeight]=x.faces[E][W.cssFontWeight]||{},x.faces[E][W.cssFontWeight][W.cssFontStyle]=W,W},drawText:function(N){var b,F=this.getFace(),P=this.size/F.resolution,O=0,U=String(N).split(""),T=U.length,D=[];for(b=0;T>b;b++){var t=new zl,J=this.extractGlyphPoints(U[b],F,P,O,t);J&&(O+=J.offset*this.spacing,D.push(J.path))}var K=O/2;return{paths:D,offset:K}},extractGlyphPoints:function(Y,G,m,H,N){var u,n,M,c,F,o,V,y,r,Q,K,R,j,d,l,B,k,$,e,s=[],P=G.glyphs[Y]||G.glyphs["?"];if(P){if(P.o)for(c=P._cachedOutline||(P._cachedOutline=P.o.split(" ")),o=c.length,V=m,y=m,u=0;o>u;)switch(F=c[u++]){case"m":r=c[u++]*V+H,Q=c[u++]*y,N.moveTo(r,Q);break;case"l":r=c[u++]*V+H,Q=c[u++]*y,N.lineTo(r,Q);break;case"q":if(K=c[u++]*V+H,R=c[u++]*y,l=c[u++]*V+H,B=c[u++]*y,N.quadraticCurveTo(l,B,K,R),e=s[s.length-1])for(j=e.x,d=e.y,n=1,M=this.divisions;M>=n;n++){var x=n/M;xn.b2(x,j,l,K),xn.b2(x,d,B,R)}break;case"b":if(K=c[u++]*V+H,R=c[u++]*y,l=c[u++]*V+H,B=c[u++]*y,k=c[u++]*V+H,$=c[u++]*y,N.bezierCurveTo(l,B,k,$,K,R),e=s[s.length-1])for(j=e.x,d=e.y,n=1,M=this.divisions;M>=n;n++){var x=n/M;xn.b3(x,j,l,k,K),xn.b3(x,d,B,$,R)}}return{offset:P.ha*m,path:N}}}};yo.generateShapes=function(K,j){j=j||{};var G=j.font;if(G===D&&(G=yo.getDefaultFont(),!G))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var c=j.size!==D?j.size:1,e=j.curveSegments!==D?j.curveSegments:4,p=j.spacing!==D?j.spacing:1,y=j.weight!==D?j.weight:"normal",v=j.style!==D?j.style:"normal";yo.size=c,yo.divisions=e,yo.face=G,yo.weight=y,yo.style=v,yo.spacing=p;for(var Z=yo.drawText(K),s=Z.paths,d=[],F=0,i=s.length;i>F;F++)Array.prototype.push.apply(d,s[F].toShapes());return d},function(k){var I=1e-10,Q=function(x,p){var K=x.length;if(3>K)return null;var w,f,b,o=[],R=[],T=[];if(t(x)>0)for(f=0;K>f;f++)R[f]=f;else for(f=0;K>f;f++)R[f]=K-1-f;var B=K,Y=2*B;for(f=B-1;B>2;){if(Y--<=0)return p?T:o;if(w=f,w>=B&&(w=0),f=w+1,f>=B&&(f=0),b=f+1,b>=B&&(b=0),E(x,w,f,b,B,R)){var J,a,C,W,l;for(J=R[w],a=R[f],C=R[b],o.push([x[J],x[a],x[C]]),T.push([R[w],R[f],R[b]]),W=f,l=f+1;B>l;W++,l++)R[W]=R[l];B--,Y=2*B}}return p?T:o},t=function(R){for(var m=R.length,C=0,k=m-1,O=0;m>O;k=O++)C+=R[k].x*R[O].y-R[O].x*R[k].y;return.5*C},E=function(b,B,r,d,i,x){var h,L,o,C,S,q,N,J,m;if(L=b[x[B]].x,o=b[x[B]].y,C=b[x[r]].x,S=b[x[r]].y,q=b[x[d]].x,N=b[x[d]].y,I>(C-L)*(N-o)-(S-o)*(q-L))return!1;var G,O,W,E,c,y,D,t,Q,F,Y,e,j,g,p;for(G=q-C,O=N-S,W=L-q,E=o-N,c=C-L,y=S-o,h=0;i>h;h++)if(J=b[x[h]].x,m=b[x[h]].y,!(J===L&&m===o||J===C&&m===S||J===q&&m===N)&&(D=J-L,t=m-o,Q=J-C,F=m-S,Y=J-q,e=m-N,p=G*F-O*Q,j=c*t-y*D,g=W*e-E*Y,p>=-I&&g>=-I&&j>=-I))return!1;return!0};return k.Triangulate=Q,k.Triangulate.area=t,k}(yo),_._typeface_js={faces:yo.faces,loadFace:yo.loadFace};var Zg=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Vj=Zg.prototype={constructor:Zg,computeFaceNormals:function(){for(var p=new se,L=new se,s=0,f=this.faces.length;f>s;s++){var i=this.faces[s],g=this.vertices[i.a],l=this.vertices[i.b],w=this.vertices[i.c];p.subVectors(w,l),L.subVectors(g,l),p.cross(L),p.normalize(),i.normal.copy(p)}},computeVertexNormals:function(o){var H,q,y,T,Q,_;for(_=new Array(this.vertices.length),H=0,q=this.vertices.length;q>H;H++)_[H]=new se;if(o){var O,d,b,P=new se,v=new se;for(y=0,T=this.faces.length;T>y;y++)Q=this.faces[y],O=this.vertices[Q.a],d=this.vertices[Q.b],b=this.vertices[Q.c],P.subVectors(b,d),v.subVectors(O,d),P.cross(v),_[Q.a].add(P),_[Q.b].add(P),_[Q.c].add(P)}else for(y=0,T=this.faces.length;T>y;y++)Q=this.faces[y],_[Q.a].add(Q.normal),_[Q.b].add(Q.normal),_[Q.c].add(Q.normal);for(H=0,q=this.vertices.length;q>H;H++)_[H].normalize();for(y=0,T=this.faces.length;T>y;y++)Q=this.faces[y],Q.vertexNormals[0]=_[Q.a].clone(),Q.vertexNormals[1]=_[Q.b].clone(),Q.vertexNormals[2]=_[Q.c].clone()},mergeVertices:function(){var g,t,M,h,Y,S,F,u,R={},K=[],H=[],J=4,y=a(10,J);for(M=0,h=this.vertices.length;h>M;M++)g=this.vertices[M],t=A(g.x*y)+"_"+A(g.y*y)+"_"+A(g.z*y),R[t]===D?(R[t]=M,K.push(this.vertices[M]),H[M]=K.length-1):H[M]=H[R[t]];var x=[];for(M=0,h=this.faces.length;h>M;M++){Y=this.faces[M],Y.a=H[Y.a],Y.b=H[Y.b],Y.c=H[Y.c],S=[Y.a,Y.b,Y.c];for(var p=0;3>p;p++)if(S[p]==S[(p+1)%3]){x.push(M);break}}for(M=x.length-1;M>=0;M--){var v=x[M];for(this.faces.splice(v,1),F=0,u=this.faceVertexUvs.length;u>F;F++)this.faceVertexUvs[F].splice(v,1)}var W=this.vertices.length-K.length;return this.vertices=K,W}},Yl=function(k,r,y,L,D,c,E){this.aX=k,this.aY=r,this.xRadius=y,this.yRadius=L,this.aStartAngle=D,this.aEndAngle=c,this.aClockwise=E};Yl.prototype=il(Bj),Yl.prototype.getPoint=function(O){var S,v=this.aEndAngle-this.aStartAngle;0>v&&(v+=k),v>k&&(v-=k),S=this.aClockwise===!0?this.aEndAngle+(1-O)*(k-v):this.aStartAngle+O*v;var f=this.aX+this.xRadius*Z(S),G=this.aY+this.yRadius*P(S);return new Lc(f,G)};var Rj=function(b,D){this.v1=b,this.v2=D},Pl=Rj.prototype=il(Bj);Pl.getPoint=function(A){var V=this.v2.clone().sub(this.v1);return V.multiplyScalar(A).add(this.v1),V},Pl.getPointAt=function(y){return this.getPoint(y)},Pl.getTangent=function(){var V=this.v2.clone().sub(this.v1);return V.normalize()};var Sq=function(v,J,c){this.v0=v,this.v1=J,this.v2=c};Sq.prototype=il(Bj),Sq.prototype.getPoint=function(S){var Q,B;return Q=xn.b2(S,this.v0.x,this.v1.x,this.v2.x),B=xn.b2(S,this.v0.y,this.v1.y,this.v2.y),new Lc(Q,B)};var Hi=function(P,i,w,O){this.v0=P,this.v1=i,this.v2=w,this.v3=O};Hi.prototype=il(Bj),Hi.prototype.getPoint=function(P){var L,R;return L=xn.b3(P,this.v0.x,this.v1.x,this.v2.x,this.v3.x),R=xn.b3(P,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Lc(L,R)},xf.create(function(m,G){this.v1=m,this.v2=G},function(p){var o=new se;return o.subVectors(this.v2,this.v1),o.multiplyScalar(p),o.add(this.v1),o});var Ol=xf.create(function(C,D,$){this.v0=C,this.v1=D,this.v2=$},function(P){var q,p,z;return q=xn.b2(P,this.v0.x,this.v1.x,this.v2.x),p=xn.b2(P,this.v0.y,this.v1.y,this.v2.y),z=xn.b2(P,this.v0.z,this.v1.z,this.v2.z),new se(q,p,z)}),Oj=xf.create(function(G,N,B,W){this.v0=G,this.v1=N,this.v2=B,this.v3=W},function(G){var T,x,V;return T=xn.b3(G,this.v0.x,this.v1.x,this.v2.x,this.v3.x),x=xn.b3(G,this.v0.y,this.v1.y,this.v2.y,this.v3.y),V=xn.b3(G,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new se(T,x,V)}),Kf=function(L,T,z,U,y,W,R,l){Zg.call(this),U=U!==D?U:.5,y=y!==D?y:.5,l=l!==D?l:1,L=L||8,W=W||0,R=R||k;var g,Q,A=1,C=l/2,S=[],J=[],H=this.vertices,h=this.faces,M=this.faceVertexUvs;for(Q=0;A>=Q;Q++){var o=[],r=[],a=Q/A,w=a*(y-U)+U;for(g=0;L>=g;g++){var O=g/L,f=new se,I=-(O*R+W);f.z=w*P(I),f.y=-a*l+C,f.x=w*Z(I),H.push(f),o.push(H.length-1),r.push(new Lc(O,a))}S.push(o),J.push(r)}var N,E,i=(y-U)/l;for(g=0;L>g;g++)for(0!==U?(N=H[S[0][g]].clone(),E=H[S[0][g+1]].clone()):(N=H[S[1][g]].clone(),E=H[S[1][g+1]].clone()),N.setY(j(N.x*N.x+N.z*N.z)*i).normalize(),E.setY(j(E.x*E.x+E.z*E.z)*i).normalize(),Q=0;A>Q;Q++){var p=S[Q][g],d=S[Q+1][g],V=S[Q+1][g+1],m=S[Q][g+1],F=N.clone(),e=N.clone(),s=E.clone(),u=E.clone(),_=J[Q][g].clone(),Y=J[Q+1][g].clone(),X=J[Q+1][g+1].clone(),v=J[Q][g+1].clone();h.push(new qc(p,d,m,[F,e,u])),M[0].push([_,Y,v]),h.push(new qc(d,V,m,[e.clone(),s,u.clone()])),M[0].push([Y.clone(),X,v.clone()])}if(T&&U>0)for(this.vertices.push(new se(0,C,0)),g=0;L>g;g++){var p=S[0][g],d=S[0][g+1],V=this.vertices.length-1,F=new se(0,1,0),e=new se(0,1,0),s=new se(0,1,0),_=J[0][g].clone(),Y=J[0][g+1].clone(),X=new Lc(Y.x,0);h.push(new qc(p,d,V,[F,e,s],null,1));var n=g/L*k,G=Z(n),K=P(n),$=(g+1)/L*k,b=Z($),B=P($);M[0].push([new Lc(.5+.5*G,.5+.5*K),new Lc(.5+.5*b,.5+.5*B),new Lc(.5,.5)])}if(z&&y>0)for(this.vertices.push(new se(0,-C,0)),g=0;L>g;g++){var p=S[Q][g+1],d=S[Q][g],V=H.length-1,F=new se(0,-1,0),e=new se(0,-1,0),s=new se(0,-1,0),_=J[Q][g+1].clone(),Y=J[Q][g].clone();h.push(new qc(p,d,V,[F,e,s],null,2));var n=g/L*k,G=Z(n),K=P(n),$=(g+1)/L*k,b=Z($),B=P($);M[0].push([new Lc(.5+.5*b,.5-.5*B),new Lc(.5+.5*G,.5-.5*K),new Lc(.5,.5)])}};Kf.prototype=il(Vj);var oc=function(z,m,I,w,H,A,y){Zg.call(this),y=y||.5,z=z||16,m=m||16,I=(I!==D?I:0)-Y,w=w!==D?w:k,H=H!==D?H:0,A=A!==D?A:Y;var J,V,S=[],i=[],U=this.vertices,K=this.faces,M=this.faceVertexUvs;for(V=0;m>=V;V++){var v=[],N=[];for(J=0;z>=J;J++){var o=J/z,W=V/m,g=new se;g.x=-y*Z(I+o*w)*P(H+W*A),g.y=y*Z(H+W*A),g.z=y*P(I+o*w)*P(H+W*A),U.push(g),v.push(U.length-1),N.push(new Lc(o,W))}S.push(v),i.push(N)}for(V=0;m>V;V++)for(J=0;z>J;J++){var p=S[V][J+1],T=S[V][J],u=S[V+1][J],F=S[V+1][J+1],r=U[p].clone().normalize(),n=U[T].clone().normalize(),q=U[u].clone().normalize(),h=U[F].clone().normalize(),f=i[V][J+1].clone(),_=i[V][J].clone(),b=i[V+1][J].clone(),O=i[V+1][J+1].clone();E(U[p].y)===y?(f.x=(f.x+_.x)/2,K.push(new qc(p,u,F,[r,q,h])),M[0].push([f,b,O])):E(U[u].y)===y?(b.x=(b.x+O.x)/2,K.push(new qc(p,T,u,[r,n,q])),M[0].push([f,_,b])):(K.push(new qc(p,T,F,[r,n,h])),M[0].push([f,_,O]),K.push(new qc(T,u,F,[n.clone(),q,h.clone()])),M[0].push([_.clone(),b,O.clone()]))}};oc.prototype=il(Vj);var Fd=function(I,q,N,$,b,H){Zg.call(this),I=I||.33,q=q||.17,$=$||8,N=N||6,b=b||0,H=H||k;for(var s=new se,w=[],o=[],g=0;$>=g;g++)for(var F=g/$*k+Y,h=0;N>=h;h++){var c=h/N*H+b;s.x=I*Z(c),s.z=-I*P(c);var E=new se,l=I+q*Z(F);E.x=l*Z(c),E.z=-l*P(c),E.y=q*P(F),this.vertices.push(E),w.push(new Lc(h/N,1-g/$)),o.push(E.clone().sub(s).normalize())}for(var g=1;$>=g;g++)for(var h=1;N>=h;h++){var y=(N+1)*g+h-1,z=(N+1)*(g-1)+h-1,M=(N+1)*(g-1)+h,d=(N+1)*g+h,J=new qc(y,z,d,[o[y].clone(),o[z].clone(),o[d].clone()]);this.faces.push(J),this.faceVertexUvs[0].push([w[y].clone(),w[z].clone(),w[d].clone()]),J=new qc(z,M,d,[o[z].clone(),o[M].clone(),o[d].clone()]),this.faces.push(J),this.faceVertexUvs[0].push([w[z].clone(),w[M].clone(),w[d].clone()])}this.computeFaceNormals()};Fd.prototype=il(Vj);var Rr=function(F,q,N){return F?(Zg.call(this),F=F instanceof Array?F:[F],this.addShapeList(F,q),q.convertYZ!==!1&&Go(this,N),this.computeFaceNormals(),void 0):(F=[],void 0)},tg=Rr.prototype=il(Zg.prototype);tg.addShapeList=function(L,Y){for(var p=L.length,O=0;p>O;O++){var G=L[O];this.addShape(G,Y)}},tg.addShape=function(d,k){function r(){if(k.bottom)for(var C=0;Y>C;C++)Q=q[C],h(Q[2],Q[1],Q[0],!0);if(k.top)for(C=0;Y>C;C++)Q=q[C],h(Q[0]+v*b,Q[1]+v*b,Q[2]+v*b,!1)}function A(){var T=0;for(X(E,T),T+=E.length,U=0,s=$.length;s>U;U++)L=$[U],X(L,T),T+=L.length}function X(o,h){for(var t,x,d=o.length;--d>=0;){t=d,x=d-1,0>x&&(x=o.length-1);var L=0,S=b;for(L=0;S>L;L++){var $=v*L,l=v*(L+1),a=h+t+$,V=h+x+$,N=h+x+l,j=h+t+l;I(a,V,N,j,o,L,S,t,x)}}}function V(g,w,b){Z.vertices.push(new se(g,w,b))}function h(O,x,P,f){O+=F,x+=F,P+=F,Z.faces.push(new qc(O,x,P,null,null,f?2:1));var B=f?m.generateBottomUV(Z,d,k,O,x,P):m.generateTopUV(Z,d,k,O,x,P);Z.faceVertexUvs[0].push(B)}function I(O,W,H,B,p,V,y,T,f){O+=F,W+=F,H+=F,B+=F,Z.faces.push(new qc(O,W,B)),Z.faces.push(new qc(W,H,B));var Q=m.generateSideWallUV(Z,d,p,k,O,W,H,B,V,y,T,f);Z.faceVertexUvs[0].push([Q[0],Q[1],Q[3]]),Z.faceVertexUvs[0].push([Q[1],Q[2],Q[3]])}var y,i,x,C,t,S=k.amount,T=k.curveSegments||og,b=k.steps||1,f=k.extrudePath,n=!1,m=new rh(k.repeatUVLength,k.boundingBox);f&&(y=f.getSpacedPoints(b),n=!0,i=k.frames!==D?k.frames:new po.FrenetFrames(f,b,!1),x=new se,C=new se,t=new se);var L,U,s,Z=this,F=this.vertices.length,c=d.extractPoints(T),z=c.shape,$=c.holes,g=!xn.isClockWise(z);if(g){for(z=z.reverse(),U=0,s=$.length;s>U;U++)L=$[U],xn.isClockWise(L)&&($[U]=L.reverse());g=!1}var q=xn.triangulateShape(z,$),E=z;for(U=0,s=$.length;s>U;U++)L=$[U],z=z.concat(L);for(var W,Q,v=z.length,Y=q.length,K=0;v>K;K++)W=z[K],n?(C.copy(i.normals[0]).multiplyScalar(W.x),x.copy(i.binormals[0]).multiplyScalar(W.y),t.copy(y[0]).add(C).add(x),V(t.x,t.y,t.z)):V(W.x,W.y,0);var P;for(P=1;b>=P;P++)for(K=0;v>K;K++)W=z[K],n?(C.copy(i.normals[P]).multiplyScalar(W.x),x.copy(i.binormals[P]).multiplyScalar(W.y),t.copy(y[P]).add(C).add(x),V(t.x,t.y,t.z)):V(W.x,W.y,S/b*P);r(),A()};var po=function(w,t,Y,i,T){function z(T,U,e){return c.vertices.push(new se(T,U,e))-1}Zg.call(this),t=t||64,Y=Y||1,i=i||8,T=T||!1;var r,D,R,g,j,s,u,d,h,U,M,A,x,a,C,F,m,$,E,S,Q=[],c=this,_=t+1,n=new se,f=new po.FrenetFrames(w,t,T),K=f.tangents,N=f.normals,O=f.binormals;for(this.tangents=K,this.normals=N,this.binormals=O,h=0;_>h;h++)for(Q[h]=[],g=h/(_-1),d=w.getPointAt(g),r=K[h],D=N[h],R=O[h],U=0;i>U;U++)j=U/i*k,s=-Y*Z(j),u=Y*P(j),n.copy(d),n.x+=s*D.x+u*R.x,n.y+=s*D.y+u*R.y,n.z+=s*D.z+u*R.z,Q[h][U]=z(n.x,n.y,n.z);for(h=0;t>h;h++)for(U=0;i>U;U++)M=T?(h+1)%t:h+1,A=(U+1)%i,x=Q[h][U],a=Q[M][U],C=Q[M][A],F=Q[h][A],m=new Lc(h/t,U/i),$=new Lc((h+1)/t,U/i),E=new Lc((h+1)/t,(U+1)/i),S=new Lc(h/t,(U+1)/i),this.faces.push(new qc(x,a,F)),this.faceVertexUvs[0].push([m,$,S]),this.faces.push(new qc(a,C,F)),this.faceVertexUvs[0].push([$.clone(),E,S.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};po.prototype=il(Vj),po.FrenetFrames=function(O,Z,w){function i(){p[0]=new se,v[0]=new se,T=Number.MAX_VALUE,m=E(F[0].x),A=E(F[0].y),s=E(F[0].z),T>=m&&(T=m,q.set(1,0,0)),T>=A&&(T=A,q.set(0,1,0)),T>=s&&q.set(0,0,1),a.crossVectors(F[0],q).normalize(),p[0].crossVectors(F[0],a),v[0].crossVectors(F[0],p[0])}var x,T,m,A,s,d,$,q=new se,F=[],p=[],v=[],a=new se,n=new ds,g=Z+1,S=1e-4;for(this.tangents=F,this.normals=p,this.binormals=v,d=0;g>d;d++)$=d/(g-1),F[d]=O.getTangentAt($),F[d].normalize();for(i(),d=1;g>d;d++)p[d]=p[d-1].clone(),v[d]=v[d-1].clone(),a.crossVectors(F[d-1],F[d]),a.length()>S&&(a.normalize(),x=M(Ki(F[d-1].dot(F[d]),-1,1)),p[d].applyMatrix4(n.makeRotationAxis(a,x))),v[d].crossVectors(F[d],p[d]);if(w)for(x=M(Ki(p[0].dot(p[g-1]),-1,1)),x/=g-1,F[0].dot(a.crossVectors(p[0],p[g-1]))>0&&(x=-x),d=1;g>d;d++)p[d].applyMatrix4(n.makeRotationAxis(F[d],x*d)),v[d].crossVectors(F[d],p[d])};var Yd=function(r,j,w,e){Zg.call(this),j=j||18,w=w||0,e=e==G?k:e;for(var B=1/(r.length-1),$=1/j,J=0,S=j;S>=J;J++)for(var W=w+J*$*e,d=Z(W),N=P(W),q=0,O=r.length;O>q;q++){var R=r[q],H=new se;H.x=d*R.x-N*R.y,H.y=N*R.x+d*R.y,H.z=R.z,this.vertices.push(H)}for(var n=r.length,J=0,S=j;S>J;J++)for(var q=0,O=r.length-1;O>q;q++){var l=q+n*J,t=l,u=l+n,d=l+1+n,C=l+1,M=J*$,K=q*B,b=M+$,a=K+B;this.faces.push(new qc(t,C,u)),this.faceVertexUvs[0].push([new Lc(M,K),new Lc(M,a),new Lc(b,K)]),this.faces.push(new qc(u,C,d)),this.faceVertexUvs[0].push([new Lc(b,K),new Lc(M,a),new Lc(b,a)])}this.mergeVertices(),Go(this),this.computeFaceNormals(),this.computeVertexNormals()};Yd.prototype=il(Vj);var Np=function(l,P){P=P||{};var t=yo.generateShapes(l,P);P.amount=P.amount!==D?P.amount:.5,P.convertYZ=!1,P.fill!==!1&&(P.bottom=!0,P.top=!0),Rr.call(this,t,P)};Np.prototype=il(tg);var yg=q.Node=function(){ln(yg,this)},lc={X:mr,Y:cm,Z:Cn},_q={X:0,Y:1,Z:2},Rc={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},qs="xzy",hc=function(Y,P,C){if(P){var R=P[0],H=P[1],q=P[2];"xzy"===C?(cm(Y,H),Cn(Y,q),mr(Y,R)):"xyz"===C?(Cn(Y,q),cm(Y,H),mr(Y,R)):"yxz"===C?(Cn(Y,q),mr(Y,R),cm(Y,H)):"yzx"===C?(mr(Y,R),Cn(Y,q),cm(Y,H)):"zxy"===C?(cm(Y,H),mr(Y,R),Cn(Y,q)):"zyx"===C?(mr(Y,R),cm(Y,H),Cn(Y,q)):(cm(Y,H),Cn(Y,q),mr(Y,R))}};Eg("Node",Em,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:qs,_64O:0,_rotationX:0,_53O:0,_host:G,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Tq},_22Q:function(){return Ks},getX:function(){return this.p().x},setX:function(G){this.p(G,this.p().y)},getY:function(){return this.p().y},setY:function(V){this.p(this.p().x,V)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(y){this.setAnchor(y,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(C){this.setAnchor(this.getAnchor().x,C)},getScaleX:function(){return this.getScale().x},setScaleX:function(r){this.setScale(r,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(C){this.setScale(this.getScale().x,C)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(H){var G=(new lh).setFromQuaternion(H,lh.ReverseOrder(this.getRotationMode()));return this.r3(G.x,G.y,G.z)},getQuaternion:function(){var o=new lh,s=new lh,v=new sq;return function(k){return k||(k=new sq),this.getEuler(o),o.equals(s)?k.copy(v):k.copy(v.setFromEuler(s.copy(o)))}}(),getEuler:function(u){var x=this.r3();return u||(u=new lh),u.set(x[0],x[1],x[2],lh.ReverseOrder(this.getRotationMode()))},setEuler:function(M){return M=M.clone().reorder(lh.ReverseOrder(this.getRotationMode())),this.r3(M.x,M.y,M.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(m,t){Be(m,Op(G,G,this.r3(),this.getRotationMode())),this.translate3d(m[0]*t,m[1]*t,m[2]*t)},translateFront:function(j){this.translate3dBy([0,0,1],j)},translateBack:function(e){this.translate3dBy([0,0,-1],e)},translateLeft:function(Z){this.translate3dBy([-1,0,0],Z)},translateRight:function(r){this.translate3dBy([1,0,0],r)},translateTop:function(V){this.translate3dBy([0,1,0],V)},translateBottom:function(n){this.translate3dBy([0,-1,0],n)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(V,q,C){1===arguments.length&&(q=V[1],C=V[2],V=V[0]),this.p(V,C),this.setElevation(q)},translate3d:function(Y,r,w){1===arguments.length&&(r=Y[1],w=Y[2],Y=Y[0]),this.translate(Y,w),this.setElevation(this._54O+r)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(Y,m,G){1===arguments.length&&(m=Y[1],G=Y[2],Y=Y[0]),this.setSize(Y,G),this.setTall(m)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(j,W,E){1===arguments.length&&(W=j[1],E=j[2],j=j[0]),this.setRotationX(j),this.setRotation(-W),this.setRotationZ(E)},setRotationY:function(W){this.setRotation(-W)},getRotationY:function(){return-this._64O},lookAtDirection:function(B,z){z=z||rs;var Z=this,O=qj(B);z===rs?(Z.r3([-C(B[1]/O),-pd(B[2],B[0])+Rm,0]),Z.setRotationMode("xzy")):z===ui?(Z.r3(0,-pd(B[2],B[0]),C(B[1]/O)),Z.setRotationMode("zyx")):z===xb?(Z.r3(0,-pd(B[2],B[0])+Y,-C(B[1]/O)),Z.setRotationMode("zyx")):z===am?(Z.r3([-C(B[1]/O)+Rm,-pd(B[2],B[0])+Rm,0]),Z.setRotationMode("xzy")):z===ye&&(Z.r3([-C(B[1]/O)-Rm,-pd(B[2],B[0])+Rm,0]),Z.setRotationMode("xzy")),z===hb&&(Z.r3([-C(B[1]/O)+Y,-pd(B[2],B[0])+Rm,Y]),Z.setRotationMode("zxy"))},lookAt:function(M,P){return this.lookAtDirection(mm(M,this.p3()),P)},lookAtX:function(){var F=new tb,J=new tb,G=new tb,j=new ds,_=new ds,A=new lh;return function(z,l){var u=Yb(this);if(j.fromArray(u),G.copy(this.p3()),F.copy(z).sub(G),!(F.lengthSq()<1e-6)){F.normalize(),l===rs?J.set(0,0,1):l===hb?J.set(0,0,-1):l===xb?J.set(-1,0,0):l===ui?J.set(1,0,0):l===am?J.set(0,1,0):l===ye&&J.set(0,-1,0),J.applyMatrix4(j).sub(G).normalize();var g=Math.acos(F.dot(J));if(g){var k=F.clone().cross(J);k.lengthSq()<1e-6&&(l===am||l===ye?k.set(0,0,1).applyMatrix4(j).sub(G):k.set(0,1,0).applyMatrix4(j).sub(G)),k.normalize(),A.set(this.r3(),this.getRotationMode(),!0),j.makeRotationFromEuler(A),_.makeRotationAxis(k,-g),A.setFromRotationMatrix(_.multiply(j)),this.r3([A.x,A.y,A.z])}}}}(),getHost:function(){return this._host},setHost:function(x){var h=this;if(h!==x&&h._host!==x){var d=h._host;d&&(d._removeAttach(h),d.updateLayoutAttaches()),h._host=x,h._host&&(h._host._addAttach(h),h._host.updateLayoutAttaches()),h.fp("host",d,x),h.onHostChanged(d,x)}},getAttaches:function(){return this._69O},_addAttach:function(_){var T=this;T._69O||(T._69O=new pq),T._69O.add(_),T.fp("attaches",G,_)},_removeAttach:function(Y){var r=this;r._69O.remove(Y),r._69O.isEmpty()&&delete r._69O,r.fp("attaches",Y,G)},getImage:function(){if(this._pendingCheckImageJSON){var i=m.getImage(this._image);i&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof ys&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(U){var o=this,G=o._image,J=o.getWidth(),Q=o.getHeight();o._image=U,o.fp("image",G,U)&&(null!=U&&(vc(U)||on(U)&&/\.json$/i.test(U))&&(this._pendingCheckImageJSON=!0),o.fp(_i,J,o.getWidth()),o.fp(Uc,Q,o.getHeight()))},getElevation:function(){return this._54O},setElevation:function(A){var c=this;if(!c._50O){c._50O=1;var E=c._54O;c._54O=A,c.fp(en,E,A),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(l){var U=this;if(!U._49O){U._49O=1;var E=U._64O;U._64O=l,U.fp(fb,E,l),delete U._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(t){var R=this;if(!R._51O){R._51O=1;var G=R._rotationX;R._rotationX=t,R.fp("rotationX",G,t),delete R._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(E){var X=this;if(!X._52O){X._52O=1;var e=X._53O;X._53O=E,X.fp("rotationZ",e,E),delete X._52O}},getPosition:function(){return this._position},setPosition:function(z,W){var e=this;if(!e._50I){e._50I=1;var v;if(v=2===arguments.length?{x:z,y:W}:z,v.x!==e._position.x||v.y!==e._position.y){var B=e._position;e._position=v,e.fp(Bm,B,v)}delete e._50I}},translate:function(H,v){var X=this._position;this.p(X.x+H,X.y+v)},getWidth:function(){var E=this;if(E._width>=0)return E._width;var g=E.getStyle("shape3d");if(g){var L=Cr(g);if(L&&L.rawS3)return L.rawS3[0];if("billboard"===g||"plane"===g){var W=Nd(E.getStyle("shape3d.image"));return W?Ur(W,E):20}}var W=Nd(E._image);return W?Ur(W,E):20},setWidth:function(Z){var s=this,E=s._width;s._width=Z,s.fp(_i,E,Z)},getHeight:function(){var N=this;if(N._height>=0)return N._height;var g=N.getStyle("shape3d");if(g){var M=Cr(g);if(M&&M.rawS3)return M.rawS3[2];if("plane"===g){var r=Nd(N.getStyle("shape3d.image"));return r?wb(r,N):20}if("billboard"===g)return 2}var r=Nd(N._image);return r?wb(r,N):20},setHeight:function(H){var y=this,g=y._height;y._height=H,y.fp(Uc,g,H)},getTall:function(){var _=this;if(_._tall>=0)return _._tall;var p=_.getStyle("shape3d");if(p){var k=Cr(p);if(k&&k.rawS3)return k.rawS3[1];if("billboard"===p){var C=Nd(_.getStyle("shape3d.image"));return C?wb(C,_):20}if("plane"===p)return 2}return 20},setTall:function(d){var U=this,P=U._tall;U._tall=d,U.fp("tall",P,d)},setSize:function(A,n){var L=this;2===arguments.length?(L.setWidth(A),L.setHeight(n)):(L.setWidth(A.width),L.setHeight(A.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(A,r,_,z,i){var d=this,k=d.getAnchor(),O=d.getScale();arguments.length<=2&&(i=r,r=A.y,_=A.width,z=A.height,A=A.x);var M=i&&O.x<0?1-k.x:k.x,y=i&&O.y<0?1-k.y:k.y;d.p(A+_*M,r+z*y),i&&(_/=Math.abs(O.x),z/=Math.abs(O.y)),d.setWidth(_),d.setHeight(z)},getMatrix:function(){var s=this,V=s._64O,O=s._position,W=s.getScale();return new Wo(V,O.x,O.y,W.x,W.y)
},getMatrix4:function(){var V=new tb,C=new sq,K=new tb;return function(G){return this.getQuaternion(C),V.copy(this.p3()),K.copy(this.getFinalScale3d()),G||(G=new ds),G.compose(V,C,K)}}(),getAnchorRect:function(){var q=this,c=q.getWidth(),K=q.getHeight(),G=q.getAnchor();return{x:-c*G.x,y:-K*G.y,width:c,height:K}},toLocal:function(p){return this.getMatrix().tfi(p)},toGlobal:function(O){return this.getMatrix().tf(O)},getAttachPosition:function(){var l=new Wo;return function(W,g,c,d){c=c||0,d=d||0;var M=this,H=M.getAnchor(),j=M._64O,p=M._position,n=M.getScale();return l.setFromTransform(j,p.x,p.y).tf({x:c+n.x*M.getWidth()*(W-H.x),y:d+n.y*M.getHeight()*(g-H.y)})}}(),isInRect:function(Q){Q=this.toLocal(Q);var x=this.getWidth(),u=this.getHeight();return Q.x+=x*this.getAnchorX(),Q.y+=u*this.getAnchorY(),!(Q.x<0||Q.y<0||Q.x>x||Q.y>u)},getRect:function(){var I=this,U=I.getWidth(),Y=I.getHeight(),$=I.getAnchor(),a={x:-U*$.x,y:-Y*$.y,width:U,height:Y},g=I.getMatrix();return a=Ip([g.tf(a.x,a.y),g.tf(a.x+a.width,a.y),g.tf(a.x+a.width,a.y+a.height),g.tf(a.x,a.y+a.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var h=this,U=h.getAnchor(),H=h._anchorElevation;return{x:U.x,y:H,z:U.y}},setAnchorElevation:function(l){var q=this,W=q._anchorElevation;return W!==l?(q._anchorElevation=l,q.fp("anchorElevation",W,l),!0):!1},setAnchor3d:function(n,M,G,T){var h,k=this;"number"==typeof n?h={x:n,y:M,z:G}:(h=n.length?{x:n[0],y:n[1],z:n[2]}:n,T=M);var R=k.getDataModel();R&&R.beginTransaction();var Y=k.getAnchor3d(),u=k.setAnchor(h.x,h.z);if(k.setAnchorElevation(h.y)&&(u=!0),u&&T&&!Lh){k.getAnchor3d();var w=Yb(k),K=Be([h.x-Y.x,h.y-Y.y,h.z-Y.z],w);k.p3(K)}return R&&R.endTransaction(),u},getAnchor:function(){var Z=this;if(Z.hasOwnProperty("_anchor"))return Z._anchor;var Q=Nd(Z._image);return Q&&Q.anchorX!==D?{x:Q.anchorX,y:Q.anchorY}:Z._anchor},setAnchor:function(F,$,c){var B,W=this;"number"==typeof F?B={x:F,y:$}:(B=F.length?{x:F[0],y:F[1]}:F,c=$);var D=W.getAnchor();if(D.x!==B.x||D.y!==B.y){var f=W.getDataModel();if(f&&f.beginTransaction(),W._anchor=B,W.fp("anchor",D,B),c&&!Lh){var q=W.getPosition(),Q=W.getSize(),l=W.getRotation(),V=W.getScale(),_=-Q.width*(D.x-B.x)*V.x,A=-Q.height*(D.y-B.y)*V.y,s=P(l),n=Z(l);W.setPosition(q.x+n*_-s*A,q.y+s*_+n*A)}return f&&f.endTransaction(),!0}return!1},getLocalQuaternion:function(t){var y=this,h=y.getHost();if(!h)return y.getQuaternion(t);var r=h.getQuaternion(),I=y.getQuaternion();return t||(t=new sq),t.copy(r).inverse().multiply(I)},setLocalQuaternion:function(_){var h=this,y=h.getHost();if(!y)return h.setQuaternion(_);var g=y.getQuaternion();h.setQuaternion(g.clone().multiply(_))},getLocalEuler:function(){var i=new sq;return function(X){var W=this,B=W.getHost();return B?(W.getLocalQuaternion(i),X||(X=new lh),X.setFromQuaternion(i,lh.ReverseOrder(this.getRotationMode()))):W.getEuler(X)}}(),setLocalEuler:function(){var O=new sq;return function(r){var J=this,D=J.getHost();return D?(O.setFromEuler(r),J.setLocalQuaternion(O)):J.setEuler(r)}}(),getLocalPosition3d:function(y){var D=this;y||(y=new tb),y.copy(D.p3());var r=D.getHost();if(!r)return y;var s=r.getMatrix4();return y.applyMatrix4(s.getInverse(s))},setLocalPosition3d:function(V){var l=this,H=l.getHost();if(!H)return V.x!==D?l.p3(V.x,V.y,V.z):l.p3(V),void 0;var J=H.getMatrix4(),W=new tb(V);W.applyMatrix4(J),l.p3(W.x,W.y,W.z)},getScale:function(){return this._scale},setScale:function(U,F){var M,Y=this;M=2===arguments.length?{x:U,y:F}:U;var I=Y.getScale();(I.x!==M.x||I.y!==M.y)&&(Y._scale=M,Y.fp("scale",I,M))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var A=this,r=A._scaleTall,c=A.getScale();return[c.x,r,c.y]},getFinalScale3d:function(){var N=this,K=N.s3(),U=N._dynamicScale3d,r=N.getScale3d();return K&&(r[0]*=K[0],r[1]*=K[1],r[2]*=K[2]),U&&(r[0]*=U[0],r[1]*=U[1],r[2]*=U[2]),r},getFinalRotation3d:function(){var d=this;return d._dynamicRotation||d.r3()},setScaleTall:function(w){var V=this,W=V._scaleTall;W!==w&&(V._scaleTall=w,V.fp("scaleTall",W,w))},setScale3d:function(V,S,h){var n,N=this;n="number"==typeof V?{x:V,y:S,z:h}:V.length?{x:V[0],y:V[1],z:V[2]}:V,N.setScaleTall(n.y),N.setScale(n.x,n.z)},getCorners:function(Y,s){Y==G&&(Y=0),s==G&&(s=Y);var f=this,E=f.getAnchor(),F=f.getWidth(),a=f.getHeight(),Q=-F*E.x-Y,M=-a*E.y-s,L=F+2*Y,n=a+2*s,p=f.getMatrix();return[p.tf(Q,M),p.tf(Q,M+n),p.tf(Q+L,M+n),p.tf(Q+L,M)]},getEditControlPoints:function(q,P,W){P==G&&(P=0),W==G&&(W=P);var Q=this,g=Q.getAnchor(),F=Q.getWidth(),C=Q.getHeight(),Y=-F*g.x-P,J=-C*g.y-W,d=F+2*P,T=C+2*W;if(q)return[{x:Y,y:J},{x:Y,y:0},{x:Y,y:J+T},{x:0,y:J+T},{x:Y+d,y:J+T},{x:Y+d,y:0},{x:Y+d,y:J},{x:0,y:J}];var b=Q.getMatrix();return[b.tf(Y,J),b.tf(Y,0),b.tf(Y,J+T),b.tf(0,J+T),b.tf(Y+d,J+T),b.tf(Y+d,0),b.tf(Y+d,J),b.tf(0,J)]},rotateAt:function(R,G,F){var E=this,M=E._position,y=E._64O,h=new Wo(y,M.x,M.y).tf(R,G),O=j(R*R+G*G),$=pd(M.y-h.y,M.x-h.x)+F;E.setRotation(y+F),E.p(h.x+O*Z($),h.y+O*P($))},onParentChanged:function(){yg.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var q={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(a){q[a]=!0}),function(n){var X=this;if(yg.superClass.onPropertyChanged.call(X,n),q[n.property]&&!X._layoutUpdating&&X.updateLayoutParameters(null,n.property),X._69O&&X._69O.each(function(o){o.handleHostPropertyChange(n)}),X._49I&&X._49I.each(function(q){q.fp("agentChange",!0,!1)}),Rn[n.property]&&this.updateLayoutAttaches(),"a:layout"===n.property.substring(0,8)){this.updateLayoutAttaches();var Q=X._host;Q&&Q.updateLayoutAttaches()}}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(Q){this.updateAttach(Q)},onStyleChanged:function(H){yg.superClass.onStyleChanged.apply(this,arguments),vg[H]&&this.updateAttach()},updateLayoutAttaches:function(){var d,R,B=this;return d=Nd(B.getImage()),d&&d.layoutAttach&&(R=d.layoutAttach,R&&R(B))?!0:void 0},updateAttach:function(Q){var C=this;return Lh?(C.updateLayoutParameters(),void 0):(C._51I||(C._51I=1,C._71O(Q),delete C._51I),void 0)},_71O:function(D){var h,t,Q,u,y,l,U=this,x=U._host,P=D?D.property:G,v=D?D.oldValue:G,j=D?D.newValue:G;if(x instanceof yg&&(!D||Rn[P])){var V;if(V=Nd(x.getImage()),V&&V.layoutAttach)return}if(x instanceof q.Grid){if(P===en)U.setElevation(U._54O+j-v);else if(!D||Hj[P]){if(h=U.s("attach.row.index"),t=U.s("attach.column.index"),Q=x.getCellRect(h,t),!Q)return;u=U.s("attach.row.span"),y=U.s("attach.column.span"),(1!==u||1!==y)&&(Q=je(Q,x.getCellRect(h+u-1,t+y-1))),wg(Q,U,"attach.padding",1),U.setRect(Q)}}else if(x instanceof ej&&(l=U.s("attach.index"))>=0&&(!D||Bs[P])){var $=U.s("attach.thickness"),r=x.getScale(),T=Math.max(r.x,r.y);$>0&&U.setHeight(x.getThickness()*$*T);var O=U.s("attach.offset"),s=x.getPoints(),L=s.size();if(L>l){var K=x.getPointsMatrix2d(),n=s.get(l),Y=L===l+1?s.get(0):s.get(l+1);n=K.apply(n),Y=K.apply(Y);var J=[Y.x-n.x,Y.y-n.y],N=qj(J);if(N){U.s("attach.offset.relative")&&(O*=N),U.s("attach.offset.opposite")&&(O=N-O);var H={x:n.x+J[0]/N*O,y:n.y+J[1]/N*O},S=U.s("attach.gap");S&&(U.s("attach.gap.relative")&&(S*=x.getThickness()*T),H=Qk(G,H,Y,S)),U.p(H),U.setRotation(pd(J[1],J[0]))}}}else D&&(P===Bm?U.translate(j.x-v.x,j.y-v.y):P===en?U.setElevation(U._54O+j-v):yf[P]?U._11Q(x,P,j-v):("anchor"===P||"width"===P||"height"===P||"scale"===P)&&U.layout(x))},_11Q:function(){var R=new q.Math.Euler,t=q.Math.Euler.ReverseOrder,p=new q.Math.Vector2,z=new q.Math.Vector2;return function(m,T,M){var S=this,Q=m.p3(),i=m.r3(),_=S.p3(),A=S.r3();if(T===fb&&(T="rotationY",M=-M),(T===fb||"rotationY"===T)&&0===A[0]&&0===A[2]&&0===i[0]&&0===i[2]&&0===_[1]&&0===Q[1])return S.setRotation(-A[1]-M),p.set(_[0],_[2]).rotateAround(z.set(Q[0],Q[2]),-M),S.p(p.x,p.y),void 0;var P=Rc[m.getRotationMode()],l=P[0],D=P[1],u=P[2],w=lc[l],Y=lc[D],K=lc[u],d=Mj();T===fb+l?(K(d,i[_q[u]]),Y(d,i[_q[D]]),w(d,M),Y(d,-i[_q[D]]),K(d,-i[_q[u]])):T===fb+D?(K(d,i[_q[u]]),Y(d,M),K(d,-i[_q[u]])):T===fb+u&&K(d,M);var r=mm(_,Q);Be(r,d),S.p3(Q[0]+r[0],Q[1]+r[1],Q[2]+r[2]);var V=S.getRotationMode();hc(d,S.r3(),V),R.setFromRotationMatrix(d,t(V)),S.r3([R.x,R.y,R.z])}}(),isHostOn:function(a){var v=this;if(v._host&&a&&a._69O)for(var d={},Y=v._host;Y&&Y!==v&&!d[Y._id];){if(Y===a)return!0;d[Y._id]=Y,Y=Y._host}return!1},isLoopedHostOn:function(K){return this.isHostOn(K)&&K.isHostOn(this)},getScaledSize:function(){var n=this.getSize(),G=this.getScale();return n.width*=Math.abs(G.x),n.height*=Math.abs(G.y),n},layout:function(o){if(o=o||this.getHost()){var n=this,r=n.s("layout.h")||"center",t=n.s("layout.v")||"center";if("center"!==r||"center"!==t){var s=new q.Math.Vector2,j=o.getPosition(),e=o.getAnchor(),c=o.getScaledSize();n.getPosition();var F,k,Z,A,y,x=1,B=1;switch(n._layoutUpdating=!0,r){case"left":s.setX(n._layoutHValue-e.x*c.width);break;case"right":s.setX((1-e.x)*c.width-n._layoutHValue);break;case"leftright":F=c.width-n._layoutHValue[2],Z=n.getRotation()-o.getRotation(),A=Math.abs(Math.sin(Z)),y=Math.abs(Math.cos(Z)),x+=y*F/n._layoutHValue[3],B+=A*F/n._layoutHValue[4],s.setX(n._layoutHValue[1]+(n._layoutHValue[5]-e.x)*c.width);break;case"center":s.setX((.5-e.x)*c.width-n._layoutHValue);break;case"scale":Z=n.getRotation()-o.getRotation(),A=Math.abs(Math.sin(Z)),y=Math.abs(Math.cos(Z)),s.setX((.5-e.x)*c.width-n._layoutHValue[1]*c.width/n._layoutHValue[0]),k=c.width/n._layoutHValue[2]-1,x+=y*k,B+=A*k}switch(t){case"top":s.setY(n._layoutVValue-e.y*c.height);break;case"bottom":s.setY((1-e.y)*c.height-n._layoutVValue);break;case"topbottom":Z||(Z=n.getRotation()-o.getRotation(),A=Math.abs(Math.sin(Z)),y=Math.abs(Math.cos(Z))),F=c.height-n._layoutVValue[2],x+=A*F/n._layoutVValue[3],B+=y*F/n._layoutVValue[4],s.setY(n._layoutVValue[1]+(n._layoutVValue[5]-e.y)*c.height);break;case"center":s.setY((.5-e.y)*c.height-n._layoutVValue);break;case"scale":Z||(Z=n.getRotation()-o.getRotation(),A=Math.abs(Math.sin(Z)),y=Math.abs(Math.cos(Z))),s.setY((.5-e.y)*c.height-n._layoutVValue[1]*c.height/n._layoutVValue[0]),k=c.height/n._layoutVValue[2]-1,x+=A*k,B+=y*k}if("leftright"===r||"scale"===r||"topbottom"===t||"scale"===t){var l=this.getScale(),S=Math.abs(l.x),u=Math.abs(l.y);"leftright"===r||"scale"===r?n.setSize(n._layoutHValue[3]*x/S,n._layoutHValue[4]*B/u):n.setSize(n._layoutVValue[3]*x/S,n._layoutVValue[4]*B/u)}s.rotateAround(null,o.getRotation()),this.setPosition(s.x+j.x,s.y+j.y),n._layoutUpdating=D}}},updateLayoutParameters:function(V,L){if(V=V||this.getHost()){var d=this,e=d.s("layout.h"),P=d.s("layout.v");if(e||P){var I,r,B,b,E,O,S=new q.Math.Vector2,o=V.getPosition(),N=V.getAnchor(),j=V.getScaledSize(),y=d.getPosition(),m=d.getScaledSize();switch(S.set(y.x-o.x,y.y-o.y),S.rotateAround(null,-V.getRotation()),e){case"left":d._layoutHValue=S.x+N.x*j.width;break;case"right":d._layoutHValue=-S.x+(1-N.x)*j.width;break;case"center":d._layoutHValue=-S.x+(.5-N.x)*j.width;break;case"leftright":case"scale":"scale"===e?I=-S.x+(.5-N.x)*j.width:(r=d.getAnchor(),B=d.getRotation()-V.getRotation(),b=Math.cos(B),E=Math.sin(B),O=-Math.min(-r.x*b+r.y*E,-r.x*b-(1-r.y)*E,(1-r.x)*b+r.y*E,(1-r.x)*b-(1-r.y)*E),I=S.x-(O-N.x)*j.width),"position"===L&&"object"==typeof d._layoutHValue?(d._layoutHValue[0]=j.width,d._layoutHValue[1]=I):d._layoutHValue=[j.width,I,j.width,m.width,m.height,O]}switch(P){case"top":d._layoutVValue=S.y+N.y*j.height;break;case"bottom":d._layoutVValue=-S.y+(1-N.y)*j.height;break;case"center":d._layoutVValue=-S.y+(.5-N.y)*j.height;break;case"topbottom":case"scale":"scale"===P?I=-S.y+(.5-N.y)*j.height:(B||(r=d.getAnchor(),B=d.getRotation()-V.getRotation(),b=Math.cos(B),E=Math.sin(B)),O=-Math.min(-r.x*E-r.y*b,-r.x*E+(1-r.y)*b,(1-r.x)*E-r.y*b,(1-r.x)*E+(1-r.y)*b),I=S.y-(O-N.y)*j.height),"position"===L&&"object"==typeof d._layoutVValue?(d._layoutVValue[0]=j.height,d._layoutVValue[1]=I):d._layoutVValue=[j.height,I,j.height,m.width,m.height,O]}}}},getSerializableProperties:function(){var O=yg.superClass.getSerializableProperties.call(this);return Jg(O,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),O}});var kd=q.Edge=function(L,F){var O=this;ln(kd,O),O.setSource(L),O.setTarget(F)};Eg("Edge",Em,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return lq},_22Q:function(){return Ms},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(A){if(A===this)return!1;if(ge(A))return!0;for(var r,w,e,R,u,U=[this],l=-1,d=0;d>l;)if(l++,r=U[l],w=r._44I)for(w=w.getArray(),R=0,u=w.length;u>R;R++)if(e=w[R],Lb(e)&&!(U.indexOf(e)>=0)){if(e===A)return!1;U.push(e),d++}return!0},setSource:function(c){var b=this;if(b._source!==c&&b.canSetSourceTarget(c)){var L=b._source;b._source=c,L&&L._16I(b),c&&c._2I(b),b._7I(),b.fp("source",L,c)}},setTarget:function(I){var M=this;if(M._target!==I&&M.canSetSourceTarget(I)){var o=M._target;M._target=I,o&&o._18I(M),I&&I._4I(M),M._7I(),M.fp("target",o,I)}},isLooped:function(){var i=this;return i._source===i._target&&ge(i._source)&&ge(i._target)},onPropertyChanged:function(){var J=this;J._49I&&J._49I.each(function(P){P.fp("agentChange",!0,!1)})},_7I:function(){var N,T=this,v=mi(T);T._40I!==v&&(N=this._40I,N&&N._15I(T),T._40I=v,v&&v._1I(T),T.fp("sourceAgent",N,v),cf(N,T._41I),cf(v,T._41I));var Z=Rg(T);T._41I!==Z&&(N=T._41I,N&&N._17I(T),T._41I=Z,Z&&Z._3I(T),T.fp("targetAgent",N,Z),cf(N,T._40I),cf(Z,T._40I))},_22I:function(A){this._52I=A,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var n=this;return n._52I&&n._52I.get(0)!==n&&!n.getStyle(_j)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var A=this,D=A._52I;return D&&!A.getStyle(_j)&&D.size()>1&&A===D.get(0)},toggle:function(){this.beginTransaction();var D=this._52I,v=!this.s(_j);D&&D.size()>1&&(D.each(function(G){G.s(_j,v)}),D.getSiblings().each(function(j){j!==D&&j.each(function(z){z.fp("edgeGroup",G,j)})})),this.endTransaction()},setStyle:function(o,W){(o===Ig||"edge.segments"===o)&&(W=Uq(W)),kd.superClass.setStyle.call(this,o,W)},onStyleChanged:function(C){kd.superClass.onStyleChanged.apply(this,arguments),fc[C]&&cf(this._41I,this._40I)},getSerializableProperties:function(){var f=kd.superClass.getSerializableProperties.call(this);return Jg(f,{source:1,target:1}),f}});var Gq=q.Group=function(){ln(Gq,this)};Eg("Group",yg,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Gd},onChildAdded:function(){Gq.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Gq.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var g=this;if(!g._54I&&!Lh){var v=g.getChildrenRect();v&&(g._53I=1,g.p(yq(g.s("group.position"),v,g.getSize())),delete g._53I)}},getChildrenRect:function(){var h,l=this;return l.eachChild(function(r){ge(r)&&(h=je(h,l.getChildRect(r)))}),h},getChildRect:function(j){var _;return ge(j)&&j.s(Bo)&&(Sc(j)&&j.isExpanded()&&j.eachChild(function(z){_=je(_,j.getChildRect(z))}),!_&&j.getRect&&(_=j.getRect())),_},setPosition:function(e,r){var E=this;if(!E._54I){var _;_=2===arguments.length?{x:e,y:r}:e,Lh||E._53I||(E._54I=1,uh(E._children,_.x-E._position.x,_.y-E._position.y),delete E._54I),Gq.superClass.setPosition.call(this,_)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(p){var G=this;if(G._57O!==p){var N=G._57O;G._57O=p,G.fp("expanded",N,G._57O),G._fireInvalidateDeep(),G._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(M){Sc(M)?M._fireInvalidateDeep():M.iv()})},_8I:function(){Gq.superClass._8I.call(this),this.eachChild(function(o){ge(o)&&o._8I()})},onStyleChanged:function(w){Gq.superClass.onStyleChanged.apply(this,arguments),"group.position"===w&&this._81I()},getSerializableProperties:function(){var f=Gq.superClass.getSerializableProperties.call(this);return f.expanded=1,f}});var Ep=q.Block=function(){ln(Ep,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Eg("Block",yg,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Of},_22Q:function(){return Ls},onChildAdded:function(){Ep.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ep.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function B(g,z,l){n.fromArray(Yb(z));var x=z.getAnchor3d();g.push((new tb).set(0-x.x,0-x.y,0-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(0-x.x,0-x.y,1-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(0-x.x,1-x.y,0-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(0-x.x,1-x.y,1-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(1-x.x,0-x.y,0-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(1-x.x,0-x.y,1-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(1-x.x,1-x.y,0-x.z).applyMatrix4(n).applyMatrix4(l)),g.push((new tb).set(1-x.x,1-x.y,1-x.z).applyMatrix4(n).applyMatrix4(l))}function j(q,i){var a=(new ds).makeRotationFromEuler(this.getEuler()).setPosition((new tb).fromArray(this.p3()));a.getInverse(a),q.forEach(function(X){ge(X)&&B(i,X,a)})}var n=new ds;return function(Y,$){if(Y instanceof yg&&(Y=[Y]),!Y||0===Y.length)return G;var $=[];j.call(this,Y,$);var n=[1/0,1/0,1/0],K=[-1/0,-1/0,-1/0];return $.forEach(function(I){n[0]=Math.min(I.x,n[0]),n[1]=Math.min(I.y,n[1]),n[2]=Math.min(I.z,n[2]),K[0]=Math.max(I.x,K[0]),K[1]=Math.max(I.y,K[1]),K[2]=Math.max(I.z,K[2])}),{min:n,max:K}}}(),updateFromChildren:function(){var l=this;if(!Lh&&!l._updatingToChildren&&l._syncSize&&0!==l.size()&&!l._freezeSyncFromChildren){var b=this._getBoundingBox(l.toChildren(ge));if(b){l._updatingFromChildren=1;var x=(new tb).fromArray(this.getScale3d()),R=(new tb).fromArray(b.min),z=(new tb).fromArray(b.max),n=m.blockMinSize,P=new tb,D=z.clone().sub(R);0===D.x&&P.setX(.5),0===D.y&&P.setY(.5),0===D.z&&P.setZ(.5);var S=this._width==G||-1===this._width,C=new tb(this.getAnchor3d()),j=x.clone().multiply((new tb).fromArray(this.s3())),k=D.clone();0===k.x&&k.setX(n),0===k.y&&k.setY(n),0===k.z&&k.setZ(n);var N=C.clone().multiply(j),u=N.clone().multiplyScalar(-1).sub(R).divide(k).add(N.divide(k)).add(P),B=this.s("keepPosition");if(S||this._anchorChanged||this._scaleChanged||!B){!S&&B&&(C=u);var H=C.clone().multiply(D).add(R).applyEuler(this.getEuler()).add((new tb).fromArray(this.p3()));this.p3([H.x,H.y,H.z])}else this.setAnchor3d(u.x,u.y,u.z);var W=new tb(1,1,1).divide(x).multiply(D);this.s3(Math.abs(W.x),Math.abs(W.y),Math.abs(W.z)),delete l._updatingFromChildren}}},setPosition:function(m,H){var B=this;if(!B._updatingToChildren){var N;N=2===arguments.length?{x:m,y:H}:m,Lh||B._updatingFromChildren||(B._updatingToChildren=1,uh(B._children,N.x-B._position.x,N.y-B._position.y),delete B._updatingToChildren),Ep.superClass.setPosition.call(this,N)}},setSize3d:function(){this.beginTransaction(),Ep.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(b){var p=this;if(!p._updatingToChildren){this.beginTransaction(),b=L(b,m.blockMinSize);var d=p.getTall();if(b!==d&&Ep.superClass.setTall.call(p,b),!Lh&&!p._updatingFromChildren){p._updatingToChildren=1;var M=b/d;p._adjustChildTallOrScale(M,"size"),delete p._updatingToChildren,p.updateFromChildren()}this.endTransaction()}},setWidth:function(J){return this.setSize(J,this.getHeight())},setHeight:function(B){return this.setSize(this.getWidth(),B)},setSize:function(l,C){var N=m.blockMinSize;l=L(l,N),C=L(C,N);var V=this;if(!V._updatingToChildren){2!==arguments.length&&(C=l.height,l=l.width),this.beginTransaction();var v=V.getWidth(),c=V.getHeight();if(l!==v&&Ep.superClass.setWidth.call(V,l),C!==c&&Ep.superClass.setHeight.call(V,C),!Lh&&!V._updatingFromChildren){V._updatingToChildren=1;var t=l/v,y=C/c;V._adjustChildScaleOrSize(t,y,"size"),delete V._updatingToChildren,V.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(C,F,d){var R=this;if(R._syncSize){var m=R.getPosition(),c=R.getRotation();R.eachChild(function(S){if(ge(S)){var v=S.getPosition(),h=S.getRotation(),K=S.getWidth(),O=S.getHeight(),W=S.getScale(),Y=W.x*K,s=W.y*O;if(0!==Y&&0!==s){0>C*F&&S.setRotation(-1*h);var p=new Wo(h,v.x,v.y,Y,s);p.translate(-m.x,-m.y),p.rotate(-c),h=pd(p.b*Math.sign(Y),p.a*Math.sign(Y)),p.scale(C,F);var D,V,f,R=Z(h);if(Math.abs(R)<.001?(D=P(h),V=p.b/D,f=-p.c/D):(V=p.a/R,f=p.d/R),"scale"===d)S.setScale(V/K,f/O);else if("size"===d){var z=V/W.x,L=f/W.y;S.setScale(ij(V)*Math.abs(W.x),ij(f)*Math.abs(W.y)),S instanceof q.Shape?(S.setWidthForce(Math.max(Math.abs(z),1e-5)),S.setHeightForce(Math.max(Math.abs(L),1e-5))):S.setSize(Math.max(.01,Math.abs(z)),Math.max(.01,Math.abs(L)))}p.rotate(c),p.translate(m.x,m.y),S.setPosition(p.tx,p.ty)}}})}},_calcChangeFactor:function(Y,R,Z,j){var A,t,q,U;return A=E(Y),t=E(Z),q=A>t?A/t:t/A,A=E(R),t=E(j),U=A>t?A/t:t/A,L(q,U)},setElevation:function(j){var e=this;if(!e._updatingToChildren){var J=e.getElevation(),N=j-J;0!==N&&(Lh||e._updatingFromChildren||(e._updatingToChildren=1,uh(e._children,0,N,0),delete e._updatingToChildren),Ep.superClass.setElevation.apply(e,arguments))}},setScaleTall:function(C){var p=this;if(!p._updatingToChildren){var P=p.getScaleTall();if(E(C)<.01&&(C=.01*(ij(C)||ij(P))),Ep.superClass.setScaleTall.call(p,C),!Lh&&!p._updatingFromChildren){p._updatingToChildren=1;var T=C/P;p._adjustChildTallOrScale(T,"size"),delete p._updatingToChildren,p._scaleChanged=1,this.updateFromChildren(),delete p._scaleChanged}}},_adjustChildTallOrScale:function(A,n){var o=this;if(o._syncSize){var u=o.getElevation();o.eachChild(function(K){if(ge(K))if("size"===n){var L=K.getTall();0>A&&K.setScaleTall(-1*K.getScaleTall()),K.setTall(Math.max(.01,Math.abs(L*A))),K.setElevation(u+(K.getElevation()-u)*A)}else{var N=K.getScaleTall();K.setScaleTall(N*A)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var g=Ep.superClass.setAnchor3d.apply(this,arguments);return g&&!Lh&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),g}},setAnchor:function(){var s=this;if(!s._updatingToChildren){var X=s.getAnchor(),M=Ep.superClass.setAnchor.apply(s,arguments);if(Lh||s._updatingFromChildren||!s._syncSize)return M;s._updatingToChildren=1;var A=s.getAnchor();s.getPosition();var q=s.getSize(),H=s.getScale(),z=s.getRotation(),k=-q.width*H.x*(X.x-A.x),R=-q.height*H.y*(X.y-A.y),O=P(z),n=Z(z),S=n*k-O*R,d=O*k+n*R;return s.eachChild(function(c){if(ge(c)){var G=c.getPosition();c.setPosition(G.x-S,G.y-d)}}),delete s._updatingToChildren,M}},setAnchorElevation:function(){var F=this;if(!F._updatingToChildren){var N=F.getAnchorElevation(),E=Ep.superClass.setAnchorElevation.apply(F,arguments);if(Lh||F._updatingFromChildren||!F._syncSize)return E;F._updatingToChildren=1;var o=F.getAnchorElevation(),$=F.getTall(),Y=F.getScaleTall(),e=-$*Y*(N-o);return F.eachChild(function(D){if(ge(D)){var y=D.getElevation();D.setElevation(y-e)}}),delete F._updatingToChildren,E}},setRotation:function(M){this._updateChildrenRotation3d("rotation",M)},setRotationX:function(J){this._updateChildrenRotation3d("rotationX",J)},setRotationZ:function(m){this._updateChildrenRotation3d("rotationZ",m)},_updateChildrenRotation3d:function(G,c){var H=this;if(!H._updatingToChildren){var e=H[ei(G)]();if(Ep.superClass[Tr(G)].call(H,c),!Lh&&!H._updatingFromChildren){H._updatingToChildren=1;var N=c-e;H.eachChild(function(K){ge(K)&&K._11Q(H,G,N)}),delete H._updatingToChildren}}},setScale:function(d,k){var D=this;if(!D._updatingToChildren){null==k&&(k=d.y,d=d.x);var h=D.getScale();if(E(d)<.01&&(d=.01*(ij(d)||ij(h.x))),E(k)<.01&&(k=.01*(ij(k)||ij(h.y))),Ep.superClass.setScale.call(D,d,k),!Lh&&!D._updatingFromChildren){D._updatingToChildren=1;var $=d/h.x,J=k/h.y;D._adjustChildScaleOrSize($,J,"size"),delete D._updatingToChildren,D._scaleChanged=1,D.updateFromChildren(),delete D._scaleChanged}}},onPropertyChanged:function(c){Ep.superClass.onPropertyChanged.call(this,c),"s:3d.visible"===c.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(Z){(Z.s("batch")||Z.s("wf.geometry")||Z.s("wf.visible"))&&Z.iv(),Z instanceof Ep&&Z._invalidateChildrenBatch()})},getSerializableProperties:function(){var r=Ep.superClass.getSerializableProperties.call(this);return r.clickThroughEnabled=1,r.syncSize=1,r}});var nj=q.Grid=function(){ln(q.Grid,this)};Eg("Grid",yg,{IRotatable:!1,_icon:"grid_icon",_image:G,getUIClass:function(){return xp},setRotation:function(){},getCellRect:function(U,t){var Q=this,o=Q.s("grid.row.count"),e=Q.s("grid.column.count");if(0>=o||0>=e||0>U||U>=o||0>t||t>=e)return G;var p,K,r,D=Q.getRect(),q=Q.s("grid.row.percents"),s=Q.s("grid.column.percents");if(wg(D,Q,"grid.border",-1),q&&q._as&&(q=q._as),s&&s._as&&(s=s._as),q&&q.length===o){for(r=0,p=0;U>p;p++)r+=D.height*q[p];D.y+=r,D.height=D.height*q[U]}else D.height=D.height/o,D.y+=D.height*U;if(s&&s.length===e){for(K=0,p=0;t>p;p++)K+=D.width*s[p];D.x+=K,D.width=D.width*s[t]}else D.width=D.width/e,D.x+=D.width*t;return ir(D,-Q.s("grid.gap")),D}});var Df=q.Text=function(){ln(Df,this),this.setSize(100,50),this.s("text","TEXT")};Eg("Text",yg,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return kh},setWidth:function(X){X||(X=.001),Df.superClass.setWidth.call(this,X)},setHeight:function(Z){Z||(Z=.001),Df.superClass.setHeight.call(this,Z)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Ul("__text__",{width:{value:100,isSafeFunc:!0,func:function(S){return S?S._width:100}},height:{value:50,isSafeFunc:!0,func:function(B){return B?B._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"}}]});var ej=q.Shape=function(){ln(ej,this),this._59O=new pq};ej.__de__=Ng,Eg("Shape",yg,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return lf},_22Q:function(){return Ns},getLength:function(r){return Vc(ns(this._59O,this._58O,r,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var H=this._58O;return H?new pq(H._as.slice(0)):H},setSegments:function(E){var x=this._58O;E=E?bf(E)?new pq(E.slice(0)):new pq(E._as.slice(0)):null,(x&&E&&x._as.join(",")!==E._as.join(",")||x!==E)&&(this._58O=E,this.fp("segments",x,E))},getPoints:function(){return this._59O},toPoints:function(){var Y=this._59O;return new pq(Y._as.slice(0))},getPointsMatrix2d:function(){var l=this,k=new pj.Matrix2d,a=l.getPosition(),Q=l.getScale(),Z=l.getRotation();return k.translate(-a.x,-a.y).scale(Q.x,Q.y).rotate(Z).translate(a.x,a.y),k},getPointsMatrix3d:function(){return function(){var k=this,B=new pj.Matrix4,u=B.getElements(),w=k.p3();pe(u,w),hc(u,k.getFinalRotation3d(),k.getRotationMode());var T=k.getScale3d(),t=k._dynamicScale3d;return t&&(T[0]*=t[0],T[1]*=t[1],T[2]*=t[2]),Ac(u,T),pe(u,eg(w)),B}}(),setPoints:function(A,I){var X=this,i=X._59O;A=A?bf(A)?new pq(A.slice(0)):new pq(A._as.slice(0)):new pq;var U,O,H,V,W,G;I&&(U=X.getPosition(),G=new Wo(X.getRotation(),0,0,X.getScale().x,X.getScale().y)),(i&&A&&i._as.join(",")!==A._as.join(",")||i!==A)&&(X._59O=A,X.fs(),X.fp("points",i,A)),I&&(O=X.getPosition(),H=O.x-U.x,V=O.y-U.y,W=G.tf(H,V),X.setPosition(O.x-H+W.x,O.y-V+W.y))},addPoint:function(g,x,k){var m=this.toPoints();m.add(g,x),this.setPoints(m,k)},setPoint:function(X,b,w){var N=this.toPoints();N.set(X,b),this.setPoints(N,w)},removePointAt:function(u){var G=this.toPoints();G.removeAt(u),this.setPoints(G)},setWidthForce:function(m){var n=this;if(!n._55I&&!Lh&&n.getWidth()){n._55I=1;var I=n._position.x,o=m/n.getWidth(),t=n.toPoints(),r=new pq;1!==o&&(t.each(function(R){r.add({x:(R.x-I)*o+I,y:R.y,e:R.e})}),n.setPoints(r),bc(n,[o,0,0,1,I*(1-o),0]),n.fs()),delete n._55I}ej.superClass.setWidth.call(n,m)},setWidth:function(q){return this.setWidthForce(sm>q?sm:q)},setHeightForce:function(c){var M=this;if(!M._55I&&!Lh&&M.getHeight()){M._55I=1;var E=M._position.y,C=c/M.getHeight(),h=M.toPoints(),N=new pq;1!==C&&(h.each(function(c){N.add({x:c.x,y:(c.y-E)*C+E,e:c.e})}),M.setPoints(N),bc(M,[1,0,0,C,0,E*(1-C)]),M.fs()),delete M._55I}ej.superClass.setHeight.call(M,c)},setHeight:function(o){return this.setHeightForce(sm>o?sm:o)},setAnchorElevation:function(k){var W=this;W._55I=!0;var m=W._updatingAnchor3d,J=!Lh&&!m;if(J){var $,q=k,f=W.getAnchorElevation(),r=W.getTall();$=r*(f-q),0!==$&&W.shiftPointsElevation($)}var A=ej.superClass.setAnchorElevation.apply(W,arguments);return m||delete W._55I,A},getShapeElevation:function(){var s=this,X=s._54O;return X-(s.getTall()||0)*(s._anchorElevation-.5)},setAnchor3d:function(V,u,d,D){var O,S=this;"number"==typeof V?O={x:V,y:u,z:d}:(O=V.length?{x:V[0],y:V[1],z:V[2]}:V,D=u),S._55I=!0,S._updatingAnchor3d=!0;var b=S.getDataModel();if(b&&b.beginTransaction(),!Lh){var f=S.getAnchor3d(),M=S.getSize(),j=S.getTall(),P=M.width*(f.x-O.x),X=M.height*(f.z-O.z),h=j*(f.y-O.y);D||S.shiftPoints(P,X,h);var a=S.p3()}var s=ej.superClass.setAnchor3d.apply(S,arguments);if(!Lh&&D){var v=S.p3();S.shiftPoints(v[0]-a[0]+P,v[2]-a[2]+X,v[1]-a[1]+h)}return b&&b.endTransaction(),delete S._updatingAnchor3d,delete S._55I,s},setAnchor:function(z,L,x){var r=this;r._55I=!0;var e=r._updatingAnchor3d,A=!Lh&&!e;if(A){var K,g,k;"number"==typeof z?k={x:z,y:L}:(k=z.length?{x:z[0],y:z[1]}:z,x=L);var l=r.getAnchor(),v=r.getSize();K=v.width*(l.x-k.x),g=v.height*(l.y-k.y),x||r.shiftPoints(K,g);var P=r.getPosition()}var B=ej.superClass.setAnchor.apply(r,arguments);if(A){var s=r.getPosition();x&&r.shiftPoints(s.x-P.x+K,s.y-P.y+g)}return e||delete r._55I,B},shiftPoints:function(M,Y,k){if(M||Y||k){var N=this,E=N.getElevation()||0,a=N.toPoints(),O=new pq;a.each(function(A){var c=A.e;k&&(c=(c==G?E:c)+k),O.add({x:A.x+M,y:A.y+Y,e:c})}),N.setPoints(O),N.fs()}},shiftPointsElevation:function(F){return this.shiftPoints(0,0,F)},setPosition:function(o,m){var u,p=this;if(!p._28Q){if(p._28Q=1,!p._55I&&!Lh){u=2===arguments.length?{x:o,y:m}:o;var w=u.x-p._position.x,V=u.y-p._position.y;if(0===w&&0===V)return delete p._28Q,void 0;p._55I=1,p.shiftPoints(w,V),bc(p,[1,0,0,1,w,V]),delete p._55I}ej.superClass.setPosition.apply(p,arguments),delete p._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var P=this;if(2!==P._59O.size())return!1;var f=P._58O;return f?2===f.size()&&1===f.get(0)&&2===f.get(1)?!0:!1:!0},fireShapeChange:function(){var M=this;if(!M._55I&&!Lh){var k=Ip(M._59O);k&&(M._55I=1,M.setRect(k),delete M._55I)}M.fp(sj,!1,!0)},getSerializableProperties:function(){var O=ej.superClass.getSerializableProperties.call(this);return O.segments=1,O.points=1,O.thickness=1,O.closePath=1,O}});var gs=q.Points=function(){ln(gs,this)};Eg("Points",yg,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return Os},getPoints:function(){return this._59O},setPoints:function(H){var I=this._59O;H=H?H.slice(0):[],this._59O=H,this._pointsDirty=!0,this.fp("points",I,this._59O)},setPoint:function(K,X){var R=this._59O.slice(0);R[K]=X,this.setPoints(R)},addPoint:function(G){this.setPoint(this._59O.length,G)},getColors:function(){return this._colors
},setColors:function(F){var q=this._colors;F=F?F.slice(0):[],this._colors=F,this._colorsDirty=!0,this.fp("colors",q,F)},setPointColor:function(K,D){var C=this._colors.slice(0);C[K]=D,this.setColors(C)},getSizes:function(){return this._sizes},setSizes:function(B){var K=this._sizes;B=B?B.slice(0):[],this._sizes=B,this._sizesDirty=!0,this.fp("sizes",K,this._sizes)},setPointSize:function(j,N){var b=this._sizes.slice(0);b[j]=N,this.setSizes(b)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(n){var $=this._uvoffsets;n=n?n.slice(0):[],this._uvoffsets=n,this._offsetsDirty=!0,this.fp("uvoffsets",$,this._uvoffsets)},setPointUvoffset:function(C,n,e){var j;"object"==typeof n?(j=n[0],e=n[1]):j=n;var S=this._uvoffsets.slice(0);S[2*C+0]=j,S[2*C+1]=e,this.setUvoffsets(S)},getPointInfo:function(N){var y=this.getPoints();if(!y||y[N]==G)return G;var L=y[N],d=[L.x,L.e,L.y],P=this.mat||Yb(this),D=[d[0],d[1],d[2]];Be(D,P);var t=this.getColors(),u=t[N]||this.s("points.color"),c=this.getSizes(),m=c[N];return{size:m==G?this.s("points.size"):m,color:u,local:d,world:D}},getSerializableProperties:function(){var E=gs.superClass.getSerializableProperties.call(this);return E.points=1,E.colors=1,E.sizes=1,E.uvoffsets=1,E},onPropertyChanged:function(J){gs.superClass.onPropertyChanged.call(this,J);var w=J.property;"s:points.color"===w?this._colorsDirty=!0:"s:points.size"===w?this._sizesDirty=!0:"s:points.model"===w&&(this._modelDirty=!0)},getWidth:function(){var M=this;if(M._width>=0)return M._width;var J=M.getStyle("points.model");if(J){var x=Cr(J);if(x&&x.rawS3)return x.rawS3[0]}return 1},getHeight:function(){var l=this;if(l._height>=0)return l._height;var X=l.getStyle("points.model");if(X){var p=Cr(X);if(p&&p.rawS3)return p.rawS3[2]}return 1},getTall:function(){var L=this;if(L._tall>=0)return L._tall;var x=L.getStyle("points.model");if(x){var g=Cr(x);if(g&&g.rawS3)return g.rawS3[1]}return 1}});var Bg=q.Polyline=function(){ln(Bg,this),this.s({"shape.background":null,"shape.border.width":2})};Eg("Polyline",ej,{_icon:"polyline_icon",_22Q:function(){return Rs},getUIClass:function(){return Kq},setClosePath:function(){},setTall:function(A){var l=this,t=l.getDataModel();if(t&&t.beginTransaction(),!l._55I&&!l._24Q&&!Lh&&l.getTall()){l._24Q=1;var z=l._54O,D=A/l.getTall();if(1!==D){var f=l.toPoints(),n=new pq;f.each(function(O){n.add({x:O.x,y:O.y,e:O.e==G?O.e:(O.e-z)*D+z})}),l.setPoints(n),l.fs()}delete l._24Q}Bg.superClass.setTall.call(l,A),t&&t.endTransaction()},setElevation:function(_){var N=this,P=N.getDataModel();if(P&&P.beginTransaction(),!N._55I&&!N._24Q&&!Lh){N._24Q=1;var h=_-N._54O;0!==h&&N.shiftPointsElevation(h),delete N._24Q}Bg.superClass.setElevation.apply(N,arguments),P&&P.endTransaction()},fireShapeChange:function(){var u=this,f=u._59O;if(!u._55I&&!u._24Q&&!Lh){var o=f.size();if(o){var h=1,H=f.get(0),m=u._54O;H.e==G&&(H.e=m);for(var R=H.e,q=0;o>h;h++){H=f.get(h),H.e==G&&(H.e=m);var p=S(R,H.e),C=L(R+q,H.e);R=p,q=C-p}u._24Q=1,u.setTall(q),u.setElevation(R+q*u._anchorElevation),delete u._24Q}}Bg.superClass.fireShapeChange.apply(u,arguments)}});var Ub=q.SubGraph=function(){ln(Ub,this)};Eg("SubGraph",yg,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Ub.superClass._8I.call(this),this.eachChild(function(d){ge(d)&&d._8I()})}}),m.loadingRefGraph=0;var ys=q.RefGraph=function(){ln(ys,this)};Eg("RefGraph",Ep,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(x){var h=this._ref;this._ref=x,this.fp("ref",h,x),this.updateRef()},_21I:function(){ys.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var i=this;if(m.loadingRefGraph++,i.clearChildrenFromDataModel(),m.loadingRefGraph--,i._ref&&i._dataModel){i._xhrLoadHandler&&(i._xhrLoadHandler.cancel=!0);var A=Lh,F=i._xhrLoadHandler=function(B){if(B&&i._dataModel){m.loadingRefGraph++;var Z=i._pendingUpdateInfo={needToRestore:A};A&&(Z.p3=i.p3(),Z.s3=i.s3(),Z.r3=i.r3(),Z.anchor3d=i.getAnchor3d(),Z.scale3d=i.getScale3d()),i.r3(0,0,0),i.setScale3d(1,1,1),i.setAnchor3d(.5,.5,.5),i.p3(0,0,0);var E=m.parse(B),U=i._dataModel.deserialize(E,i,{justDatas:!0});U.each(function(w){w._refGraph=i}),i.checkPendingUpdateInfo(),m.loadingRefGraph--,m.handleRefGraphLoaded(i,U,E)}};F.xhrLoadCalled=!1,m.load(i._ref,function(l){F.cancel||(F.xhrLoadCalled?F(l):Vm(function(){F(l)}))}),F.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var R=this,q=R._pendingUpdateInfo;if(!q)return R.onPendingUpdated&&(m.loadingRefGraph++,R.onPendingUpdated(),m.loadingRefGraph--),void 0;var k=!0;this.eachChild(function(N){(N._pendingCheckImageJSON||N._pendingUpdateInfo)&&(k=!1)}),k&&(m.loadingRefGraph++,R._pendingUpdateInfo=null,R.updateFromChildren(),q.needToRestore&&(R.setAnchor3d(q.anchor3d),R.setScale3d(q.scale3d),R.r3(q.r3),R.p3(q.p3)),this.getParent()instanceof ys&&this.getParent().checkPendingUpdateInfo(),R.onPendingUpdated&&R.onPendingUpdated(),m.loadingRefGraph--)},getSerializableProperties:function(){var E=ys.superClass.getSerializableProperties.call(this);return E.ref=1,E}}),q.EdgeGroup=function(Z,k){this._70O=Z,this._siblings=k;for(var U,j,B=0,M=Z.size(),z=e[_j];M>B;B++)if(U=Z.get(B).getStyle(_j,!1),U!=G){z=U;break}z==G&&(z=!0);var X=m.edgeGroupAgentFunc;for(X&&(j=X(Z),j&&j!==Z.get(0)&&(Z.remove(j),Z.add(j,0))),B=0;M>B;B++)Z.get(B).s(_j,z)},Eg("EdgeGroup",t,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(t){return this._70O.get(t)},indexOf:function(I){return this._70O.indexOf(I)},each:function(N,Y){this._70O.each(N,Y)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(r,A){this._siblings.each(function(B){B._70O.each(r,A)})}});var Hk=function(O,X,E){var x=bm[O]={type:O,action:X};if(E)for(var n in E)x[n]=E[n]};Jg(m,{setConnectAction:Hk,getConnectAction:function(b,A){if(!A){if(!b)return null;A=b.getCurrentConnectActionType()}return bm[A]},doConnectAction:function(g,y,d,T){T=T||g.getCurrentConnectActionType();var W=bm[T];if(!W)return!1;var q=W.action;return q?(y instanceof gk.Group?g.sm().getSelection().each(function(x){q.call(null,g,x,d)}):q.call(null,g,y,d),!0):!1},doDeleteConnectionAction:function(c,E,W){W=W||c.getCurrentConnectActionType();var I=bm[W];if(!I||!I.delete)return!1;var P=I.delete.action;return P?(E instanceof gk.Group?c.sm().getSelection().each(function(r){P.call(null,c,r)}):P.call(null,c,E),!0):!1}});var uf=q.JSONSerializer=function(k,B){this.dm=this._dataModel=k,this._hierarchical=m.forceHierarchicalSerialization?!0:B==G?k.isHierarchicalRendering():B};Eg("JSONSerializer",t,{ms_ac:["hierarchical"],serialize:function(I){return m.stringify(this.toJSON(),I)},toJSON:function(){var s=this,C=s.dm,F=C.getRoots(),K=s.json={v:m.getVersion(),p:{},a:{},d:[]},d=C.getSerializableAttrs();C.getInit()&&(K.init=C.getInit()),C.getName()&&(K.p.name=C.getName()),C.getBackground()&&(K.p.background=C.getBackground()),C.getLayers()&&(K.p.layers=C.getLayers()),C.getEnvmap()&&(K.p.envmap=C.getEnvmap()),C.isCubicEnvmap()&&(K.p.cubicEnvmap=C.isCubicEnvmap()),K.p.autoAdjustIndex=C.isAutoAdjustIndex(),K.p.hierarchicalRendering=C.isHierarchicalRendering();for(var J in d){var Q=C.a(J);Q!==D&&s[Jf](J,Q,K.a)}return _k(K.a)&&delete K.a,s._hierarchical?F.each(s.serializeData,this):C.each(function(w){s.serializeData(w)}),C.fireSerializeEvent({type:"serialize",json:K}),C.getPostProcessingData()&&(K.p.postProcessingData=C.getPostProcessingData()),K},isSerializable:function(){return!0},getProperties:function(T){return T.getSerializableProperties()},getStyles:function(h){return h.getSerializableStyles()},getAttrs:function(S){return S.getSerializableAttrs()},serializeData:function(i){var j=this;if(j.isSerializable(i)&&!i._refGraph){var T,a,E,d,s=Kk(i.getClassName())||i.getClass(),f=new s,p={c:i.getClassName(),i:i.getId(),p:{},s:{},a:{}};j.json.d.push(p),T=j.getProperties(i);for(a in T)if(/^_/.test(a)){if(E=i[a],!("_width"!==a&&"_height"!==a||E!=G&&-1!==E)){var B;((i.s("layout.h")||i.s("layout.v"))&&i.getHost()||i instanceof q.Node&&(B=i.getParent())&&B instanceof q.Block||i.s("fullscreen"))&&(E=i[a]="_width"===a?i.getWidth():i.getHeight())}E!==f[a]&&j[Jf](a.substr(1),E,p.p)}else d=ei(a),i[d]&&(E=i[d](),E!==f[d]()&&j[Jf](a,E,p.p));T=j.getStyles(i);for(a in T)E=i.s(a),E!==f.s(a)&&j[Jf](a,E,p.s);T=j.getAttrs(i);for(a in T)E=i.a(a),E!==f.a(a)&&j[Jf](a,E,p.a);_k(p.p)&&delete p.p,_k(p.s)&&delete p.s,_k(p.a)&&delete p.a}j._hierarchical&&i.getChildren().each(j.serializeData,j)},serializeValue:function(k,b,o){Kc(b)?b={__a:b._as}:b instanceof Em?b={__i:b.getId()}:b instanceof sn&&(b={__dm:b.serialize(0)}),o[k]=b},deserialize:function(j,g,b){var u=this;return on(j)&&/.json$/.test(j)?(m.xhrLoad(j,function(x){u.deserializeImpl(x,g,b)}),void 0):u.deserializeImpl(j,g,b)},deserializeImpl:function(c,Q,k){var w=this,p=w.dm;p.setDeserializing(!0),k=Xd(k)?{setId:k}:Yo(k)?{finishFunc:k}:k||{},c=w.json=on(c)?m.parse(c):c,!k.justDatas&&c.a&&c.a.onPreDeserialize&&!k.disableOnPreDeserialize&&c.a.onPreDeserialize(c,p,k.view),p.beginTransaction(),Lh++,w._82I={};var C=new pq,_=new pq,i=0,j=c.d.length;if(k.justDatas||(!k.disableInit&&Yo(c.init)&&c.init(p),p.setInit(c.init)),!k.justDatas){for(var o in c.a)p.a(o,w[vp](c.a[o]));for(var M in c.p)p[Tr(M)](c.p[M])}for(;j>i;i++){var J=c.d[i],d=Kk(J.c),n=new d,X=J.i;k.setId&&X!=G&&(n._id=X),w._82I[X]=n,C.add(n),_.add(J)}for(i=0;j>i;i++)w.deserializeData(C.get(i),_.get(i));return C.each(function(J){Q&&!J.getParent()&&J.setParent(Q),p.add(J)}),k.__innerHandler__&&k.__innerHandler__(c,p,k.view,C),p.fireSerializeEvent({type:"deserialize",json:c}),Lh--,p.endTransaction(),!k.justDatas&&c.a&&c.a.onPostDeserialize&&!k.disableOnPostDeserialize&&c.a.onPostDeserialize(c,p,k.view,C),k.finishFunc&&k.finishFunc(c,p,k.view,C),p.setDeserializing(!1),C},deserializeData:function(b,p){for(var q in p.p)b[Tr(q)](this[vp](p.p[q]));for(q in p.s)b.s(q,this[vp](p.s[q]));for(q in p.a)b.a(q,this[vp](p.a[q]))},deserializeValue:function(H){if(vc(H)){var W=H.__i;if(W!=G)return this._82I[W];if(W=H.__dm,W!=G){var v=new q.DataModel;return v.deserialize(W),v}if(W=H.__a,bf(W))return new pq(W)}return H}}),Jg(sn,{serialize:function(Z,E){return new uf(this,E).serialize(Z)},toJSON:function(W){return new uf(this,W).toJSON()},deserialize:function(C,q,u){return new uf(this).deserialize(C,q,u)}});var jm=q.OverlappingBox=function(L){this.gv=L,this.boxes={}};Eg("OverlappingBox",t,{clear:function(){var F,t,e=this.boxes;for(F in e)t=e[F],t.length=0},isOverlapping:function(q,z){var a,o,D=this,j=D.boxes,d=j[q];d?(a=d.rects,o=d.length):d=j[q]={rects:a=[],length:o=0};var m,t,z;for(m=0;o>m;m++)if(t=a[m],t.x<z.x+z.w&&t.x+t.w>z.x&&t.y<z.y+z.h&&t.h+t.y>z.y)return!0;return a.length<=o?(a.push(z),d.length++):a[d.length++]=z,!1}}),Jg(m,{fetch:function(W,C){var y="GET",R=!1,r=null,Z="";C&&(y=C.method||"GET",R=C.sync,Z=C.url,r=C.data||null),W.open(y,Z,!R),C.responseType?W.responseType=C.responseType:C.overrideMimeType&&W.overrideMimeType&&W.overrideMimeType(C.overrideMimeType),W.send(r)},convertImageSrc:function(A,G){G&&"function"==typeof G||(G=function(){}),G(A)}});var Ei=q.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Eg("Request",t,{_responseType:null,_overrideMimeType:"text/plain",send:function(f){var V=this._xhr,x=this.onload,K=this.onerror;this.getResponseType()?f.responseType=this.getResponseType():this.getOverrideMimeType()&&(f.overrideMimeType=this.getOverrideMimeType()),V.onload=x,V.onerror=K,m.fetch(V,f)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(u){this._responseType=u},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(v){this._overrideMimeType=v},getResponseText:function(){var L=this._xhr;return L.response||L.responseText}}),hg.GraphView=function(y){var G=this;G._24I={},G._34I=new pq,G._25I={},G._56I={},G._view=Qo(1,G),G._canvas=Ae(G._view),G.dm(y?y:new sn),this._coreInteractor=new Oo(this),G.setEditable(!1),G.setScrollBarVisible(m.graphViewScrollBarVisible),G._initView()},zp("GraphView",t,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Cb,To,qg,ef,"resettable","editInteractor",hs,"zoomable","pannable","rectSelectable","autoScrollZone",Bd,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:m.graphViewZoomable,_resettable:m.graphViewResettable,_pannable:m.graphViewPannable,_rectSelectable:m.graphViewRectSelectable,_autoScrollZone:m.graphViewAutoScrollZone,_rectSelectBackground:m.graphViewRectSelectBackground,_rectSelectBorderColor:m.graphViewRectSelectBorderColor,_editPointSize:m.graphViewEditPointSize,_editPointBorderColor:m.graphViewEditPointBorderColor,_editPointBackground:m.graphViewEditPointBackground,_scrollBarColor:vq,_scrollBarSize:Wq,_autoHideScrollBar:Re,_autoMakeVisible:qd,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(v){this._dataModel.setLayers(v)},setEditable:function(J){var w=this,F=w.__interactorMap__;if(!F){var m=hg.XEditInteractor;F=w.__interactorMap__={scrollBar:new fs(w),select:new Zq(w),edit:m?new m(w):new Zo(w),text:new Rk(w),move:new Ir(w),"default":new Yi(w),touch:new wl(w,{editable:!1})}}J?(w._uieditable=!0,w.setInteractors([F.scrollBar,F.select,F.edit,F.text,F.move,F.default,F.touch])):(w._uieditable=!1,w.setInteractors([F.scrollBar,F.select,F.move,F.default,F.touch]))},getCanvas:function(){return this._canvas},_33I:function(e){var S=e.getUIClass();return S?new S(this,e):G},getDataUI:function(r){var w=this,B=w._25I[r._id];return B===D&&(B=w._33I(r),w._25I[r._id]=B),B},getNodeRect:function(K){return m.getNodeRect(this,K)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(d){var c=this.getDataUI(d);return c?(c._79o(),c._78o):null},getEdgeSourcePosition:function(W){var m=this,n=m.getDataUI(W),s=n.s,P=n._data._40I;return Pj(m,P,s("edge.source.position"),s("edge.source.offset.x"),s("edge.source.offset.y"),s("edge.source.anchor.x"),s("edge.source.anchor.y"))},getEdgeTargetPosition:function(c){var Q=this,t=Q.getDataUI(c),D=t.s,w=t._data._41I;return Pj(Q,w,D("edge.target.position"),D("edge.target.offset.x"),D("edge.target.offset.y"),D("edge.target.anchor.x"),D("edge.target.anchor.y"))},invalidateAll:function(y){var v=this;if(y){for(var E in v._25I){var V=v._25I[E];V&&V.dispose()}v._25I={},v._56I={},v._24I={},v._34I.clear(),v.redraw()}else v.dm().each(function(N){v.invalidateData(N)})},invalidateSelection:function(){var r=this;r.sm().each(function(f){r.invalidateData(f)})},invalidateData:function(E){var i=this;i._24I[E._id]=E,i._21Q(E),i.iv()},_21Q:function(W){var e=this,c=e._24I;if(Lb(W)&&pm[W.s(cd)]){var I=W.getSourceAgent();I&&I.getAgentEdges().each(function(R){c[R._id]=R}),I=W.getTargetAgent(),I&&I.getAgentEdges().each(function(P){c[P._id]=P}),e.iv()}},redraw:function(M){var F=this;F._32I||(M?F._34I.add(M):(F._32I=1,F._34I.clear()),F.iv())},each:function(Y,z){var B,u,n,M=0,X=this.getLayers(),x=this._dataModel,c=x._datas._as,O=c.length;if(X){for(var D=X.length;D>M;M++)if(n=X[M],vc(n)&&(n=n.name),x.isHierarchicalRendering()){var b=function(T){return T._layer===n?z?Y.call(z,T):Y(T):void 0};if(this._dataModel.eachByHierarchical(b)===!1)return}else for(var y=0;O>y;y++)if(B=c[y],B._layer===n&&(u=z?Y.call(z,B):Y(B),u===!1))return}else if(x.isHierarchicalRendering())this._dataModel.eachByHierarchical(Y,null,z);else for(;O>M;M++)if(B=c[M],u=z?Y.call(z,B):Y(B),u===!1)return},reverseEach:function(c,J){var C,a,U,G,F=this._dataModel,e=F._layers,Z=F._datas._as,V=Z.length;if(e){for(C=e.length-1;C>=0;C--)if(G=e[C],vc(G)&&(G=G.name),F.isHierarchicalRendering()){var B=function(j){return j._layer===G?J?c.call(J,j):c(j):void 0};if(F.reverseEachByHierarchical(B)===!1)return}else for(var Y=V-1;Y>=0;Y--)if(a=Z[Y],a._layer===G&&(U=J?c.call(J,a):c(a),U===!1))return}else if(F.isHierarchicalRendering())F.reverseEachByHierarchical(c,null,J);else for(C=V-1;C>=0;C--)if(a=Z[C],U=J?c.call(J,a):c(a),U===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var P=this,T=P._84I;if(!T){var E=this.dm().a("width"),U=this.dm().a("height");E>0&&U>0?P._84I={x:0,y:0,width:E,height:U}:(P.each(function(g){P.isVisible(g)&&(T=je(T,P.getDataUIBounds(g)))}),P._84I=T?T:rg)}return P._84I},getScrollRect:function(){return je(this.getContentRect(),this._29I)},makeCenter:function(q,a,Z){var T=this;if(!T.getWidth()||!T.getHeight())return Z||Vm(T.makeCenter,T,[q,a,!0],500),void 0;T.makeVisible(q),T.validate();var G=T.getDataUIBounds(q);if(G){var F=T.getWidth(),J=T.getHeight(),N=G.x+G.width/2,U=G.y+G.height/2,c=-N*T._zoom+F/2,K=-U*T._zoom+J/2;T.setTranslate(c,K,a)}},fitData:function(x,N,B,k,e){var w=this;if(!w.getWidth()||!w.getHeight())return e||Vm(w.fitData,w,[x,N,B,k,!0],500),void 0;var f=function(){w.makeVisible(x),w.validate();var j=w.getDataUIBounds(x);j&&(j=gl(j),ir(j,B==G?20:B),w.fitRect(j,N,k))};N?m.callWhenLoaded(f):f()},fitContent:function(h,M,v,C){var n=this;if(!n.getWidth()||!n.getHeight())return C||Vm(n.fitContent,n,[h,M,v,!0],500),void 0;var w=function(){n.validate();var D=gl(n.getContentRect());ir(D,M==G?20:M),n.fitRect(D,h,v)};h?m.callWhenLoaded(w):w()},fitRect:function(l,c,s){var h=this,C=h.getWidth(),r=h.getHeight(),V=l.x+l.width/2,y=l.y+l.height/2,T=S(C/l.width,r/l.height),i=h._zoom,D=-V*i+C/2,u=-y*i+r/2;0===T||isNaN(T)||(s&&(T=S(1,T)),c?(h._65I&&(delete h._65I.finishFunc,h._65I.stop(!0)),h._14o&&h._14o.stop(!0),h.setTranslate(D,u,{finishFunc:function(){h.setZoom(T,c)}})):(h.setTranslate(D,u),h.setZoom(T)))},fitSelection:function(g,j,O){var H=this,i=H.sm(),J=null;i.size()&&(i.each(function(g){J=je(H.getDataUIBounds(g),J)}),g&&ir(J,g),H.fitRect(J,j,O))},toCanvas:function(L,C,Z){C=C||this._zoom,this.validateImpl();var f=this,m=f.getContentRect();Z&&ir(m,Z),m.width||(m.width=10),m.height||(m.height=10);var E=Ae(),v=m.x*C,D=m.y*C,W=Math.ceil(m.width*C),j=Math.ceil(m.height*C);Ek(E,W,j,1);var U=Nm(E);return L=L||this._dataModel.getBackground(),L&&zd(U,0,0,W,j,L),ae(U,-v,-D),U.scale(C,C),f._42(U),U.restore(),E},toDataURL:function(S,K,C,P){return this.toCanvas(S,C,P).toDataURL(K||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(T,O){var n=this,m=n.dm().getBackground();if(m){var D=n.dm().a("width"),s=n.dm().a("height");D>0&&s>0&&zd(T,0,0,D,s,m)}var A=n.__htmlOrderList,d=[],w=n._forcedLayoutHTML;if(n._93db(T,O),n.each(function(s){var I=n.getDataUI(s);if(I){var K=n._56I[s._id],X=I._htmlView;if(K){var Z=I._79o();if(X=I._htmlView,q.HtmlNode&&s instanceof q.HtmlNode)I._42(T);else{var $=n.getViewRect(),y=X&&X.layoutHTML;!O||of(O,Z)?(y&&(X.layoutHTML(),I.__outerLayout&&delete I.__outerLayout),I._42(T)):of($,Z)||!y||I.__outerLayout&&!w||(X.layoutHTML(),I.__outerLayout=!0)}}X&&(d.push(X),X.getView&&(X=X.getView()),X.style.display=K?"block":Yf)}}),A&&d.length>0){var F=!1;if(A.length!==d.length)F=!0;else for(var t=0;t<d.length;t++)if(d[t]!==A[t]){F=!0;break}F&&(d.forEach(function(j){j.autoAdjustIndex!==!1&&n.appendHTML(j,!0)}),this.__htmlOrderList=d)}else this.__htmlOrderList=d;n._92db(T,O)},validateImpl:function(){this.tryUpdateRootData();var j,C,d,I,k,v=this,A=v.tx(),J=v.ty(),F=v._zoom,Q=v._canvas,z=this.getWidth(),Z=this.getHeight(),R=v._29I,M={x:-A/F,y:-J/F,width:z/F,height:Z/F},E={},G=v._34I,V=v._24I,p=v._32I,h=v._23I;v._24I={},(z!==Q.clientWidth||Z!==Q.clientHeight)&&(Ek(Q,z,Z),p=1,v._forcedLayoutHTML=1),p||pn(M,R)||(p=1,v._forcedLayoutHTML=1),v._29I=M,v.each(function(w){C=w._id;var P=E[C]=v.isVisible(w);P!==v._56I[C]&&(V[C]=w,d=v.getDataUI(V[C]),d&&d._84o(P),v._84o(w,P))},v);for(C in V)d=v.getDataUI(V[C]),d&&(!p&&v._56I[C]&&(k=d._79o(),k&&G.add(k)),d.invalidate()),v._83I=1;if(v._56I=E,!p)for(C in V)E[C]&&(d=v.getDataUI(V[C]),d&&(k=d._79o(),k&&G.add(k)));if(p?I=M:(G.each(function(g){of(M,g)&&(I=je(I,g))}),I&&(ir(I,L(1,1/F)),I.x=i(I.x*F)/F,I.y=i(I.y*F)/F,I.width=U(I.width*F)/F,I.height=U(I.height*F)/F,I=Fh(M,I))),v._74O=I,I&&0!==I.width&&0!==I.height){j=Nm(Q);var _=I.x,g=I.y,T=I.width,O=I.height;_=Math.floor((_*F+A)*pi),g=Math.floor((g*F+J)*pi),T=Math.ceil(T*F*pi)+1,O=Math.ceil(O*F*pi)+1,p||(I.x=(_/pi-A)/F,I.y=(g/pi-J)/F,I.width=T/pi/F,I.height=O/pi/F),j.beginPath(),j.rect(_,g,T,O),j.clip(),j.clearRect(_,g,T,O),jf(j,A,J,F),v._42(j,I),j.restore(),delete v._74O}if(G.clear(),delete v._32I,delete v._forcedLayoutHTML,h&&z>0&&Z>0){var d=v.getDataUI(h);if(d){var k=d._79o(),t=v._29I,o=t.x,X=t.y,y=t.width,m=t.height,F=v._zoom;k&&!of(k,t)&&(k.x+k.width<o&&v.tx(-k.x*F),k.x>o+y&&v.tx(-(k.x+k.width-y)*F),k.y+k.height<X&&v.ty(-k.y*F),k.y>X+m&&v.ty(-(k.y+k.height-m)*F))}delete v._23I}v._83I&&(delete v._83I,delete v._84I),v._98O(),v.countFrame(),_k(v._24I)||Vm(v.iv,v)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var o,G=this.getFullscreenDatas();for(var O in G)o=G[O],this.scaleRootData(o);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(u){var Z=u.s("fullscreen");if("uniform"===Z||"fill"===Z){u.getRotation()&&u.setRotation(0);var P=u.s("fullscreen.gap")||0,l=this.getWidth(),X=this.getHeight();if(l&&X){var k,G,T,C=l-2*P,Y=X-2*P,A=u.getAnchor(),y=u.getScaledSize(),z=y.width,V=y.height,O=u.s("fullscreen.lock");if(O)return"uniform"===Z?C/Y>z/V?(k=Y/V,z=V*C/Y):(k=C/z,V=z*Y/C):"v"===O?(k=Y/V,z=C/k,u.getWidth()!==z&&u.setWidth(z)):(k=C/z,V=Y/k,u.getHeight()!==V&&u.setHeight(V)),this.setZoom(k),G=P-(u.getX()-A.x*z)*k,T=P-(u.getY()-A.y*V)*k,G!==this.tx()&&this.tx(G),T!==this.ty()&&this.ty(T),void 0;G=this.tx(),T=this.ty(),k=this._zoom;var o={x:(-G+P)/k,y:(-T+P)/k,width:C/k,height:Y/k};if("uniform"===Z){var K=z/V,R=Math.min(o.width,o.height*K),B=R/K;o.x+=.5*(o.width-R),o.y+=.5*(o.height-B),o.width=R,o.height=B}C=o.width/u.getScaleX(),Y=o.height/u.getScaleY(),(u.getWidth()!=C||u.getHeight()!==Y)&&u.setSize(C,Y);var h=o.x+A.x*o.width,f=o.y+A.y*o.height,t=u.getPosition();(h!==t.x||f!==t.y)&&u.setPosition(h,f)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(O){var $=this;O!==$.isScrollBarVisible()&&(O?(ar($._view,$._79O=Ic()),ar($._79O,$._27I=Ic()),ar($._79O,$._28I=Ic())):(Rl($._79O),delete $._79O,delete $._27I,delete $._28I),$.fp("scrollBarVisible",!O,O))},getDebugTip:function(){return""},showScrollBar:function(){var c=this;c._79O&&(c._85I||(Qi(function(){c._86I()},fr),c.iv()),c._85I=new Date)},_86I:function(){var S=this;if(S._85I){var v=new Date,e=v.getTime();e-S._85I.getTime()>=fr?(delete S._85I,S.iv()):Qi(function(){S._86I()},fr)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var j=this,A=this._27I,e=this._28I;if(j._79O){if(j._autoHideScrollBar&&!j._85I)return A.style.visibility=Bc,e.style.visibility=Bc,void 0;var L=j.getScrollBarColor(),N=j._zoom,i=j.getScrollBarSize(),W=j.getViewRect(),I=j.getScrollRect(),K=W.height*N,B=I.height*N,t=W.width*N-i-2,d=K*((W.y-I.y)*N/B),J=K*(K/B),R=A.style;B-.5>K?(Xf>J&&(d=d+J/2-Xf/2,0>d&&(d=0),d+Xf>K&&(d=K-Xf),J=Xf),ne(A,t,d,i,J),R.visibility=lb,R.background=L,R.borderRadius=i/2+Fn):R.visibility=Bc;var z=W.width*N,D=I.width*N,d=W.height*N-i-2,t=z*((W.x-I.x)*N/D),G=z*(z/D),R=e.style;D-.5>z?(Xf>G&&(t=t+G/2-Xf/2,0>t&&(t=0),t+Xf>z&&(t=z-Xf),G=Xf),ne(e,t,d,G,i),R.visibility=lb,R.background=L,R.borderRadius=i/2+Fn):R.visibility=Bc}},setDataModel:function(m){var y=this,h=y._dataModel,d=y._selectionModel;h!==m&&(h&&(h.ump(y.handleDataModelPropertyChange,y),h.umm(y.handleDataModelChange,y),h.umd(y.handleDataPropertyChange,y),h.removeIndexChangeListener(y._75O,y),h.removeHierarchyChangeListener(y.handleHierarchyChange,y),d||h.sm().ums(y.handleSelectionChange,y)),y._dataModel=m,m.mp(y.handleDataModelPropertyChange,y),m.mm(y.handleDataModelChange,y),m.md(y.handleDataPropertyChange,y),m.addIndexChangeListener(y._75O,y),m.addHierarchyChangeListener(y.handleHierarchyChange,y),d?d._21I(m):m.sm().ms(y.handleSelectionChange,y),y.invalidateAll(!0),y.fp(Bp,h,m),y.updateBackground())},getLayersInfo:function(){if(this._layersInfo===D){var P=this.getLayers();P?(this._layersInfo={},P.forEach(function(e){var c=vc(e)?e.name:e;this._layersInfo[c]=e},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(C,l,W){var N,T,g=this,X=g.getDataUI(C),m=ti(X),Y=hj(l,function($){return ml(m,100*$)},100,.001),M=ml(m,100*Y);if(!W){var P=zc(X),p=new ac(M.x,M.y),R=49/(g._zoom*g._zoom);for(N=0,T=P.length;T>N;N++)if(p.distanceToSquared(P[N])<R)return{index:N,point:P[N],distance:Math.sqrt((P[N].x-l.x)*(P[N].x-l.x)+(P[N].y-l.y)*(P[N].y-l.y))}}return{percent:Y,point:M,distance:Math.sqrt((M.x-l.x)*(M.x-l.x)+(M.y-l.y)*(M.y-l.y))}},calculateAttachPoint:function(){var q=new ac,t=new ac,z=new ac;return function(h,S){var U=this.getAttachPoints(h);if(!U||!U.length)return null;z.set(S.x,S.y);for(var y,F,v,D,b,X=1/0,p=0,O=U.length;O>p;p++)v=U[p],t.x=v.x,t.y=v.y,q.x=v.offsetX||0,q.y=v.offsetY||0,D=Pj(this,h,0,q.x,q.y,t.x,t.y),F=z.distanceToSquared(D),X>F&&(y=p,X=F,b=D);X=Math.sqrt(X);var I=this.getAttachStyle(h);if("close"===I){var $=h.s("attach.close.threshold")/this._zoom;if(X>$)return null}return{index:y,distance:X,info:U[y],point:b}}}(),getAttachPoints:function(A){var W=A.s("attach.points");if(W)return W;var H=Nd(A._image);return H?$b(H.attachPoints,A,this)||null:void 0},getAttachStyle:function(z){var E=z.s("attach.style");if(E)return E;var j=Nd(z._image);return j?$b(j.attachStyle,z,this)||"close":void 0},updateLayers:function(){this._layersInfo=D,this.invalidateSelection(),this.redraw()},updateBackground:function(){var d=this.dm().a("width"),T=this.dm().a("height");this._canvas.style.background=d>0&&T>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(s){if("background"===s.property){var m=this._canvas.style.background,d=s.newValue||"";this.updateBackground(),this.fp("canvasBackground",m,d),this.redraw()}else"a:width"===s.property||"a:height"===s.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===s.property?this.updateLayers():"hierarchicalRendering"===s.property&&this.redraw()},handleDataPropertyChange:function(L){this.dm().isHierarchicalRendering()&&"parent"===L.property&&L.data.hasChildren()&&this.redraw(),this.invalidateData(L.data)},onPropertyChanged:function(o){var f=this,d=o.property;if(f.redraw(),"zoom"===d){var _=f.sm().getSelection();_.size()&&_.each(function(A){A.invalidate()})}else"dataModel"===d&&(f._83I=1);Ij[d]?f.showScrollBar():d===hs&&f.onCurrentSubGraphChanged(o)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(b){var W=this,t=b.kind,w=b.data;if(W._83I=1,"add"===t)W.invalidateData(w),Lb(w)&&w.getEdgeGroup()&&w.getEdgeGroup().eachSiblingEdge(W.invalidateData,W),w.getHost&&w.getHost()&&w.getHost().updateLayoutAttaches();else if(t===ai){W._21Q(w);var v=w._id,Q=W._25I[v];if(Q){if(W._56I[v]){var e=Q._79o();e&&W.redraw(e)}Q.dispose(),delete W._25I[v],delete W._24I[v],delete W._56I[v]}w===W._currentSubGraph&&W.setCurrentSubGraph(G)}else t===$k&&(W.invalidateAll(!0),W.setCurrentSubGraph(G))},_75O:function(R){this.invalidateData(R.data)},handleHierarchyChange:function(J){this.dm().isHierarchicalRendering()&&J.data.hasChildren()&&this.redraw(),this.invalidateData(J.data)},adjustIndex:function(G){var f=this;if(f.isVisible(G)){f.dm().beginTransaction();for(var E=G;E._parent&&f.isVisible(E._parent);)E=E._parent;E&&E!==G&&f._dataModel.adjustIndex(E),f._dataModel.adjustIndex(G),f.dm().endTransaction()}},getImage:function(x){return x.getImage?x.getImage():D},getSelectWidth:function(h){var q=Nd(this.getImage(h));return q&&$b(q.disableSelectedBorder,h,this)?0:h.s("select.width")},getSelectColor:function(n){return n.s("select.color")},isSelectable:function(K,r){if(this.isSelected(K))return!0;if(!r&&K.getParent()instanceof Ep&&this.isSelectable(K.getParent(),!0)&&K.getParent().isSyncSize())return!1;var M=this.getLayersInfo();if(M){var w=M[K._layer];if(w&&w.selectable===!1)return!1}return K.s("2d.selectable")&&this.sm().isSelectable(K)},isMovable:function(U){var z=this;if(Lb(U)&&U.getStyle(cd)!==gj)return!1;var w=this.getLayersInfo();if(w){var j=w[U._layer];if(j&&j.movable===!1)return!1}return U.s("2d.movable")?z._movableFunc?z._movableFunc(U):!0:!1},isEditable:function(d){var c=this;if(q._uiSerializing)return c._uieditable;if(!c._editInteractor||!c.isSelected(d))return!1;if(Sc(d)){var W=c.getDataUI(d);if(!W||W._88I)return!1}if(Lb(d)&&d.getStyle(cd)!==gj)return!1;var H=this.getLayersInfo();if(H){var G=H[d._layer];if(G&&G.editable===!1)return!1}return d.s("2d.editable")?c._editableFunc?c._editableFunc(d):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(s){return ge(s)&&0!==s.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(s):!0},isRectEditable:function(a){return this._rectEditableFunc?this._rectEditableFunc(a):!0},isAnchorEditable:function(J){return this._anchorEditableFunc?this._anchorEditableFunc(J):!0},isRotationEditable:function(t){return t.setRotation&&t.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(t):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(J){var M=J.getAnchor(),A=J.getScale(),a=this._zoom,D=Pi(J.getRotation(),0,-J.getHeight()*A.y*M.y-(A.y<0?-1:1)*(yr?32:16)/a),P=J.p();return D.x+=P.x,D.y+=P.y,D},getLogicalPoint:function(G){var Y=this;return Dg(G,Y._canvas,Y.tx(),Y.ty(),Y._zoom,Y._zoom)},getScreenPoint:function(q,w){var a,G=this;return"object"==typeof q?q.x!==D?(a=q.x,w=q.y):(a=q[0],w=q[1]):a=q,bk(a,w,G._canvas,G.tx(),G.ty(),G._zoom,G._zoom)},getSelectedDataAt:function(t){var u=this;return this.getDataAt(t,function(s){return u.isSelected(s)})},getDataInfoAt:function(V,y,i){var n,C=this.lp(V),e=this.getDataAt(C,y,i);if(e){var r=this.getDataUI(e);n={data:e,ui:r,point:C};var W=r._38o;if(W){var N=W.icons;for(var o in N){var w=N[o],K=W.rects[o];if(K)for(var $=$b(w.names,e,this),s=$?$.length:0,Q=K.rotation,L=s-1;L>=0;L--){var l=$[L],M=K[L];if(uq(M,C,Q))return n.part="icons",n.name=o,n.icon=l,n.rect=M,n.index=L,n.rotation=Q,n}}}if(this.isNoteVisible(e)){if(r.note2Info&&uq(r.note2Info.clickRect,C,G,r.note2Info.scale))return n.part="note2",n;if(r.noteInfo&&uq(r.noteInfo.clickRect,C,G,r.noteInfo.scale))return n.part="note",n}if(this.isLabelVisible(e)){if(r.label2Info&&uq(r.label2Info.rect,C,r.label2Info.rotation,r.label2Info.scale))return n.part="label2",n;if(r.labelInfo&&uq(r.labelInfo.rect,C,r.labelInfo.rotation,r.labelInfo.scale))return n.part="label",n}if(e.isInRect&&e.isInRect(C))return n.part="body",n}return n},getDataAt:function(k,g,F){k.target&&(k=this.lp(k));var C,a=this._zoom;return this.reverseEach(function($){return(g?g($):this.isSelectable($))&&this.rectIntersects($,Lr(k.x,k.y,F,a))?(C=$,!1):void 0},this),C},getIconInfoAt:function(J,Z){var c=this;if(J.target&&(J=c.lp(J)),Z||(Z=c.getDataAt(J)),Z){var $=c.getDataUI(Z);if($&&$._38o){var R,A=$._38o,j=new pq;for(R in A.icons)j.add(R);for(var M=j.size()-1;M>=0;M--){R=j.get(M);for(var W=A.rects[R],g=W.rotation,Q=W.length-1;Q>=0;Q--){var F=W[Q],U=F.width,e=F.height,m={x:J.x-F.x-U/2,y:J.y-F.y-e/2};g!=G&&(m=Pi(-g,m.x,m.y));var F={x:-U/2,y:-e/2,width:U,height:e};if(uq(F,m))return{key:R,index:Q,name:A.icons[R].names[Q],rect:W[Q],point:J,rotation:g,relativeRect:F,relativePoint:m,data:Z}}}}}return G},getDatasInRect:function(t,C,h){h===D&&(h=1);var B=this,M=new pq;return B.reverseEach(function(H){h&&!B.isSelectable(H)||(C?B.rectIntersects(H,t):B.rectContains(H,t))&&M.add(H)}),M},moveSelection:function(W,L){var m=this;m.dm().beginTransaction(),uh(m.sm().toSelection(m.isMovable,m),W,L),m.dm().endTransaction()},moveDatas:function(T,x,f){var C=this;C.dm().beginTransaction(),T instanceof pq||(T=new pq(T)),uh(T,x,f),C.dm().endTransaction()
},getDataUIBounds:function(P){var M=this.getDataUI(P);return M?M._79o():G},drawData:function(G,E,J){var F=this.getDataUI(E);if(F){var H=F._79o();(!J||of(J,H))&&(F._42(G),E instanceof q.Block&&E.eachChild(function(H){this.isVisible(H)&&this.drawData(G,H,J)},this))}},getBoundsForGroup:function(H){return H.s(Bo)?this.getDataUIBounds(H):G},isPixelPerfect:function(r){return r.s("pixelPerfect")},rectIntersects:function(E,r){this.validate();var i=G;if(this._56I[E._id]){var U=this._25I[E._id];if(U){var Q=U._79o();if(Bf(r,Q))i=!0;else if((r=Fh(r,Q))&&(U.rectIntersects&&(i=U.rectIntersects(r)),i==G)){if(!this.isPixelPerfect(E))return!0;var c=r.x,F=r.y,p=r.width,w=r.height,M=this._zoom,N=m.hitMaxArea,x=p*w*M*M;if(x>N){var $=Math.sqrt(N/x);M*=$}p*=M,w*=M,2>p&&(p=2),2>w&&(w=2),c*=M,F*=M;var V=ri(p,w);ae(V,-c,-F),V.scale(M,M),this._drawForChecking=!0,this.drawData(V,E,r),this._drawForChecking=!1;try{for(var P=0,I=V.getImageData(0,0,p,w).data;P<I.length;P+=4)if(0!==I[P+3]){i=!0;break}V.restore()}catch(R){el=G,i=!1}}}}return i?!0:!1},rectContains:function(R,H){if(this._56I[R._id]){var D=this._25I[R._id];if(D)return Bf(H,D._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(f){if(!m.isInput(f.target)){var u=this,t=u._focusData,v=t&&u._25I[t._id],T=0,J=u._dataModel._datas;if(!(t&&t._enabled&&t._editable&&v&&v.onKeyDown&&v.onKeyDown(f)===!0))if(9===f.keyCode&&(t&&(T=J.indexOf(t),Fj(f)?-1===--T&&(T=0):++T===J.size()&&(T=0)),u._focusData=t=J.get(T),u.sm().setSelection(t)),Xe(f)?u.selectAll():tk(f)&&u.isResettable()&&u.reset(),u.sm().isEmpty()){if(u._editing)return;var $=u.tx(),b=u.ty(),Y=!1,I=Fj()?100:10;op(f)&&($-=I,Y=!0),cn(f)&&(b-=I,Y=!0),tn(f)&&($+=I,Y=!0),qo(f)&&(b+=I,Y=!0),Y&&u.setTranslate($,b)}else{ls(f)&&u.handleDelete(f);var B=Fj()?10:1;op(f)&&(u.moveSelection(-B,0),u.fi({kind:"moveLeft"})),cn(f)&&(u.moveSelection(0,-B),u.fi({kind:"moveUp"})),tn(f)&&(u.moveSelection(B,0),u.fi({kind:"moveRight"})),qo(f)&&(u.moveSelection(0,B),u.fi({kind:"moveDown"}))}}},handleScroll:function(S,h){if(Ji(S),this.isZoomable()){if(!this.getEditInteractor()){var b=this.getDataAt(S);if(b){var R=Nd(this.getImage(b));if(R&&$b(R.scrollable,b,this))return}}var T=this.lp(S);h>0?this.scrollZoomIn(T):0>h&&this.scrollZoomOut(T)}},handlePinch:function(r,z,n){this.isZoomable()&&(Math.abs(z-n)<m.pinchZoomThreshold||(z>n?this.pinchZoomIn(r):this.pinchZoomOut(r)))},checkDoubleClickOnNote:function(L,k){var $=this,Q=$.lp(L),V=$.getDataUI(k),p=V.note2Info;return p&&k.s("note2.toggleable")&&uq(p.clickRect,Q)?(k.s(Vk,!k.s(Vk)),$.fi({kind:"toggleNote2",event:L,data:k}),!0):(p=V.noteInfo,p&&k.s("note.toggleable")&&uq(p.clickRect,Q)?(k.s(oe,!k.s(oe)),$.fi({kind:"toggleNote",event:L,data:k}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(E,M){var k=this,p=k.getAutoScrollZone(),e=p/k.getZoom(),O=p/4,a=k._29I,i=k.lp(E),b={x:k.tx(),y:k.ty()};return i&&p>0&&a&&(i.x-a.x<e?k.translate(O,0):a.x+a.width-i.x<e&&k.translate(-O,0),i.y-a.y<e?k.translate(0,O):a.y+a.height-i.y<e&&k.translate(0,-O)),b.x=k.tx()-b.x,b.y=k.ty()-b.y,M&&(M.x+=b.x,M.y+=b.y),b},getMoveMode:function(P,Y){var y=Y.s("2d.move.mode");return y?y:zh["88"]?"x":zh["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(Y,h,A){var R=this;return"currentSubGraph"===h?{__i:Y.getId()}:A.serializeProperty(Y,h,R)},deserializeProperty:function(F,n,W){var O=this;if("currentSubGraph"===n){var N=O.dm(),c=N.__idMap;return c[F.__i]}return W.deserializeProperty(F,n,O)},setDefaultCursor:function(j,_){this._defaultCursor=j,_!==!1&&this.setCursor(j)},setCursor:function(G){"default"===G&&(G=this._defaultCursor||G);var h=this.getView().style;h.cursor=G,h.cursor="-webkit-"+G,h.cursor="-moz-"+G},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(c){return c===G||m.getConnectAction(null,c)?(this._currentActionType=c,this.redraw(),!0):!1},getEditStyle:function(f){var O=this.getEditInteractor();return O?O.getStyle(f):D},setEditStyle:function(S,B,g){var p=this.getEditInteractor();return p?(p.setStyle(S,B,g),!0):!1},isConnectActionVisible:function(D){var W=m.getConnectAction(this);if(!W)return!1;var y=W.visible;return Yo(y)&&(y=y(this,D)),y},isInteractive:function(H){if(this._drawForChecking)return!1;var I=Nd(this.getImage(H));return I&&$b(I.interactive,H,this)?!0:H.s("interactive")},appendHTML:function(F,v){var q=this.getView();if(!(v||F&&F.parentNode!==q))return!1;var I=F.getView&&F.getView(),l=F.beforeCanvas;if(!v&&I&&I.parentNode===q)return!1;(F.getView||F.isSelfViewEvent)&&(F=F.getView());var c=this.getEditInteractor();return l?q.insertBefore(F,this.getCanvas()):c&&c._canvas?q.insertBefore(F,c._canvas):this.isScrollBarVisible()?q.insertBefore(F,this.getView().lastChild):ar(q,F),!0},_layoutHTMLImpl:function(b,f,Q){if(arguments.length>1){var d,u=this,C=u._zoom;if(f.getView&&(d=f,f=f.getView()),f.style.position="absolute",Q){var g=b.getRect();ne(d||f,u.tx()+g.x*C,u.ty()+g.y*C,g.width*C,g.height*C)}else{var E=new Qh,g=b.getAnchorRect(),S=b.getPosition(),H=b.getScale(),q=f.style;ne(d||f,g),E.appendTranslate(u.tx(),u.ty()),E.appendScale(C,C),E.append(new Qh(b.getRotation(),S.x,S.y,H.x,H.y)),id(q,"transform","matrix("+E.a.toFixed(5)+", "+E.b.toFixed(5)+", "+E.c.toFixed(5)+",\n    "+E.d.toFixed(5)+", "+E.tx.toFixed(5)+", "+E.ty.toFixed(5)+")"),id(q,"transformOrigin",(-g.x).toFixed(5)+"px "+(-g.y).toFixed(5)+"px"),f.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(n){return n instanceof Df?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(o){var t="state",S=o.s(t);if(S)return S;var K=Nd(o._image);return K?$b(K[t],o,this)||null:void 0},getShape:function(s){return s.getStyle(sj)}}),t.defineProperties(hg.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(k){this._layoutHTML=k}}});var kq=function(D,E){var W=this;W.gv=D,W.s=function(N){return E.getStyle(N)},W._data=E,W._87I=new pq};mj(kq,t,{_6I:G,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var j=this,Z=j.gv.isSelected(j._data);return!Z||j.isShadowed()?0:j.gv.getSelectWidth(j._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(j){var A=this._data,e=this.gv.getBodyColor(A);return e?e:j?A.getStyle(j):G},_2Q:function(L){return this.s(L)},_1Q:function(i,p,s,M){var t=this.s,X=t("2d.gray"),u=t(p+".dash.color");if(X&&(u=m.toGrayColor(u)),i.strokeStyle=u,i.lineWidth=s,i.stroke(),t(p+".dash.3d")){var A=t(p+".dash.3d.color");lm(i,u,X?m.toGrayColor(A):A,s,this.gv._zoom,t(p+".dash.3d.accuracy"))}Pq(i,M)},invalidate:function(){this._6I=G},_79o:function(){var Z=this;if(!Z._6I){var h=Z._data,S=Z.gv;Z.labelInfo=Z.label2Info=Z.noteInfo=Z.note2Info=Z._38o=G,Z._87I.clear(),Z.interactiveInfo=S.isInteractive(h)?{}:G,Z._3O(),Z._55O=S.isEditable(h)?{_42O:S.isRectEditable(h),_43O:S.isPointEditable(h),_56O:S.isRotationEditable(h)}:G,Z._6I=Z._81o()}return Z._6I},_3O:function(){},getPosition:function(){return rg},_68o:function(l,X){l&&this._87I.add(ve(l,X))},_81o:function(){var N=this,S=N.s;N._24O(Me,"getLabel"),N._24O(Am,"getLabel2"),N._26O(uk,"getNote"),N._26O(Te,"getNote2"),N._15O(),N._55O&&N._48O();var f;if(N._87I.each(function(t){f=je(f,t)}),f){var t=N.isShadowed(),V=S("shadow2"),v=gl(f);V?(v.x+=S("shadow2.offset.x"),v.y+=S("shadow2.offset.y"),ir(v,S("shadow2.blur"))):t&&(v.x+=S("shadow.offset.x"),v.y+=S("shadow.offset.y"),ir(v,S("shadow.blur"))),f=je(f,v)}return N._87I.clear(),f},_42:function(P){var $=this,E=$._data,z=$.gv,r=$.s,X=r("opacity"),W=this.isShadowed(),u=r("shadow2");if(W||u){var C=P.shadowOffsetX,t=P.shadowOffsetY,N=P.shadowBlur,x=P.shadowColor,j=z.getZoom()*m.devicePixelRatio,Z=W?"shadow":"shadow2";P.shadowOffsetX=r(Z+".offset.x")*j,P.shadowOffsetY=r(Z+".offset.y")*j,P.shadowBlur=r(Z+".blur")*j,P.shadowColor=W?$.getSelectColor():r(Z+".color")}if(X!=G){var w=P.globalAlpha;P.globalAlpha=X}$._80o(P),z.isLabelVisible(E)&&((!z._drawForChecking||r("label.selectable"))&&Zb(P,$.labelInfo),(!z._drawForChecking||r("label2.selectable"))&&Zb(P,$.label2Info)),z.isNoteVisible(E)&&(Yj(P,$.noteInfo),Yj(P,$.note2Info)),$._99O(P),X!=G&&(P.globalAlpha=w),(W||u)&&(P.shadowOffsetX=C,P.shadowOffsetY=t,P.shadowBlur=N,P.shadowColor=x)},_80o:function(){},_47O:function(){},_24O:function(v,Z){var s=this,T=s._data,M=s.gv,h=s.s,L=M[Z](T);if(L!=G){var f=h(v+".scale"),D=h(v+".max"),r=h(v+".position"),K=s[v+"Info"]={label:L,scale:f,color:M[Z+"Color"](T),font:h(v+".font"),opacity:h(v+".opacity"),align:h(v+".align"),rotation:s.getRotation(h(v+".rotation"),!1,r),background:M[Z+"Background"](T)},x=Dm(K,L);D>0&&D<x.width&&(K.labelWidth=x.width,x.width=D),1!==f&&(x.width*=f,x.height*=f);var b=s.getPosition(r,h(v+".offset.x"),h(v+".offset.y"),x,h(v+".position.fixed"));if(x.x=b.x-x.width/2,x.y=b.y-x.height/2,s._68o(K.rect=x,K.rotation),1!==f){var B=x.width/f,J=x.height/f;K.rect={x:b.x-B/2,y:b.y-J/2,width:B,height:J}}}},_26O:function(D,x){var C=this,S=C.gv,R=C._data,J=C.s,Z=S[x](R);if(Z!=G){var r,i,b=J(D+".scale"),N=C[D+"Info"]={note:Z,scale:b,data:R,view:S,expanded:J(D+".expanded"),font:J(D+".font"),color:J(D+".color"),opacity:J(D+".opacity"),align:J(D+".align"),icon:J(D+".icon"),backgroundImage:J(D+".backgroundImage"),borderWidth:J(D+".border.width"),borderColor:J(D+".border.color"),background:S[x+"Background"](R)},d=C.getPosition(J(D+".position"),J(D+".offset.x"),J(D+".offset.y")),h=d.x,s=d.y;if(N.expanded){var M,o=J(D+".max"),B=J(D+".backgroundImage");B?(B=Nd(B),M={width:Ur(B,R),height:wb(B,R)}):M=Dm(N,Z),M.width+=6,M.height+=2,o>0&&o<M.width&&(N.labelWidth=M.width,M.width=o),r=M.width,i=M.height+8,N.clickRect={x:h-r*b/2,y:s-i*b,width:r*b,height:i*b*M.height/i}}else{var m=J(D+".icon");m?(m=Nd(m),r=Ur(m,R),i=wb(m,R)):(r=12,i=18),N.clickRect={x:h-r*b/2,y:s-i*b,width:r*b,height:i*b}}N.rect={x:h-r/2,y:s-i*b/2-i/2,width:r,height:i};var f=U(N.borderWidth/2)*b;C._68o({x:h-r*b/2-f,y:s-i*b-f,width:r*b+2*f,height:i*b+2*f})}},_48O:function(){},_99O:function(S){var Q=this,P=Q._38o;if(P){var i=Q.gv,h=Q._data,M=P.icons,W=Q.interactiveInfo;W&&(W._38o={});for(var w in M){var q=M[w],d=P.rects[w];if(d){W&&(W._38o[w]=[]);var b=$b(q.opacity,h,i),K=$b(q.names,h,i),H=K?K.length:0,R=d.rotation;if(b!=G){var j=S.globalAlpha;S.globalAlpha*=b}for(var T=0;H>T;T++){var r=K[T],B=Nd(r),X=d[T];if(R){var m=X.x+X.width/2,y=X.y+X.height/2;S.save(),ae(S,m,y),Ln(S,R),ae(S,-m,-y)}W&&W._38o[w].push(S.interactiveInfo={compInfos:[],matrix:R?new Qh(R,m,y).appendTranslate(-m,-y):new Qh}),gr(S,B,$b(q.stretch,h,i),X.x,X.y,X.width,X.height,Q._data,Q.gv),S.interactiveInfo=G,R&&S.restore()}b!=G&&(S.globalAlpha=j)}}}}});var Tq=function(E,D){ln(Tq,this,[E,D])};mj(Tq,kq,{_checkEmptyRect:!0,_40O:function(K,S){var $=this,z=$.s,U=K.rect;(K.borderColor=$.gv.getBorderColor($._data))&&(K.borderType=z("border.type"),K.borderWidth=z("border.width"),K.borderPadding=z("border.padding"),S=L(S,K.borderPadding+K.borderWidth/2));var V=$._data.getScale(),Q=L(1,L(E(V.x),E(V.y)));if(K.selectWidth=$.getSelectWidth()){var l=$.gv._zoom;K.selectType=z("select.type"),K._97o=$.getSelectColor(),K.selectPadding=z("select.padding"),S=L(S,(K.selectPadding+K.selectWidth/2/l)/Q)}S>0&&(S*=Q,U=gl(U),ir(U,S)),$._68o(U)},_39O:function(u,i){var W,$=this,a=i.rect;if(i.borderWidth>0&&(W=i.borderPadding,u.strokeStyle=i.borderColor,u.lineWidth=i.borderWidth,qm(u,i.borderType,{x:a.x-W,y:a.y-W,width:a.width+2*W,height:a.height+2*W}),u.stroke()),i.selectWidth>0){var O=$.gv._zoom;if(W=i.selectPadding,u.strokeStyle=i._97o,u.lineWidth=i.selectWidth/O,i.rotation!=G){u.save(),u.translate(i.position.x,i.position.y),u.rotate(i.rotation);var p=$._data,z=p.getWidth(),m=p.getHeight(),M=i.scale,e=i.anchor;a={x:M.x*-z*e.x,y:M.y*-m*e.y,width:M.x*z,height:M.y*m}}qm(u,i.selectType,{x:a.x-W,y:a.y-W,width:a.width+2*W,height:a.height+2*W}),i.rotation!=G&&u.restore(),u.stroke()}},dispose:function(){var w=this,n=w._htmlView;Tq.superClass._3O.call(w),n&&(n.onHTMLRemoved&&n.onHTMLRemoved(),Rl(n))},_3O:function(){var u,w=this,p=w.s,j=w._data,o=w.gv,P=o.getShape(j),N=w.getBodyColor(),U=p("shape.border.color"),i=w._83o=P?{shape:P,_53o:w.getBodyColor("shape.background"),_27Q:Nd(p("shape.repeat.image"),N),shapeGradientPack:p("shape.gradient.pack"),_54o:p("shape.border.width"),_55o:U,shapeBorderRepeatImage:Nd(p("shape.border.repeat.image"),U),_56o:p("shape.border.3d"),_57o:p("shape.border.3d.color"),_58o:p("shape.border.3d.accuracy"),shapeGradient:p("shape.gradient"),_59o:p("shape.gradient.color"),_60o:p("shape.border.pattern"),_61o:p("shape.border.cap"),_62o:p("shape.border.join"),shapeForeground:p("shape.foreground"),bodyColor:N,gray:p("2d.gray")}:{img:Nd(o.getImage(j),N),bodyColor:N,gray:p("2d.gray"),stretch:p("image.stretch")},Q=i.img;Q&&Q.renderHTML?(w._htmlInfo&&w._htmlInfo.img!==Q&&(w._htmlInfo=G),w._htmlInfo||(w._htmlInfo={img:Q,cache:{}}),u=Q.renderHTML(j,o,w._htmlInfo.cache)):w._htmlInfo=G,w._htmlView&&w._htmlView!==u&&(w._htmlView.onHTMLRemoved&&w._htmlView.onHTMLRemoved(),Rl(w._htmlView.getView?w._htmlView.getView():w._htmlView)),(w._htmlView=u)&&o.appendHTML(u)&&(u.onHTMLAddedSync&&u.onHTMLAddedSync(),u.onHTMLAdded&&Vm(u.onHTMLAdded)),i.rect=j.getRect(),i.position=j.p(),i.scale=j.getScale(),i.anchor=j.getAnchor(),i.rotation=j.getRotation(),P===Aq&&(i._63o=p("shape.depth"));var O=0;if(P)O=no(G,i._54o/2,i._62o),w.s("shape.dash")&&(O=L(O,(w.s("shape.dash.width")||i._54o)/2));else if(Q&&Q.boundExtend)if(O=$b(Q.boundExtend,j,o),Q.boundExtendAbsolute){var A=j.getScale();O/=o._zoom*L(1,L(E(A.x),E(A.y)))}else if(!$b(Q.fitSize,j,o)){var F=$b(Q.width,j,o),Y=$b(Q.height,j,o);O*=L(j.getWidth()/F,j.getHeight()/Y)}w._40O(i,O);var _=If(j,o.isSelected(j)),T=p("clip.percentage");if(1>T&&(0>T&&(T=0),i.clipRect=cb(j.getAnchorRect(),p("clip.direction"),T,_)),P){var e=p("shape.fill.clip.percentage");1>e&&(0>e&&(e=0),i.shapeClipRect=cb(j.getAnchorRect(),p("shape.fill.clip.direction"),e,_));var H=p("shape.foreground.clip.percentage");1>H&&(0>H&&(H=0),i.shapeForegroundClipRect=cb(j.getAnchorRect(),p("shape.foreground.clip.direction"),H,_))}},getPosition:function(Y,R,u,E){var N=yq(Y,this._83o.rect,E);return N.x+=R,N.y+=u,N},_80o:function(p){var R=this,e=R.s,o=R.gv,c=R._data,O=R._83o,r=O.rect,w=O.position,J=O.rotation,E=O.anchor,L=O.scale,d=O.shape,l=O.clipRect;if(!R._checkEmptyRect||r.width>0&&r.height>0){var S=c.getSize();if(S.x=-S.width*E.x,S.y=-S.height*E.y,Ko&&!cj&&ae(p,S.width,S.height),p.save(),ae(p,w.x,w.y),Ln(p,J),Pe(p,L.x,L.y),l&&(p.beginPath(),p.rect(l.x,l.y,l.width,l.height),p.clip()),o._drawForChecking&&O.img&&$b(O.img.pixelPerfect,c,o)===!1)zd(p,S.x,S.y,S.width,S.height,"#888888");else if(R.freeDraw)R.freeDraw(p,S,O);else if(d){var X,F,h,v,Q=O._60o,j=li(p,Q),A=O._27Q,i=O._54o,B=O.shapeGradientPack,H=O.gray,K=p.lineJoin,C=p.lineCap,g=function(b){return H?m.toGrayColor(b):b};"roundRect"===d?X=e("shape.corner.radius"):"polygon"===d?X=e("shape.polygon.side"):"arc"===d&&(X=e("shape.arc.from"),F=e("shape.arc.to"),h=e("shape.arc.close"),v=e("shape.arc.oval")),p.lineJoin=O._62o,p.lineCap=O._61o;var V=g(O._53o);if(V||A||B){var Z=O.shapeClipRect;Z&&(p.save(),p.beginPath(),p.rect(Z.x,Z.y,Z.width,Z.height),p.clip()),qm(p,d,S,X,F,h,v),B?rl(p,B,function(N){return jn(N,O.bodyColor)}):A?Vo(p,A,g(O.bodyColor),null,c,o):od(p,V,O.shapeGradient,g(O._59o),S),p.fill(),B&&p.restore(),Z&&p.restore(),p!==j&&qm(j,d,S,X,F,h,v)}else qm(j,d,S,X,F,h,v);var n=O.shapeForeground;if(n){p.save();var s=O.shapeForegroundClipRect;s&&(p.beginPath(),p.rect(s.x,s.y,s.width,s.height),p.clip()),qm(p,d,S,X,F,h,v),od(p,n,e("shape.foreground.gradient"),g(e("shape.foreground.gradient.color")),S),p.fill(),p.restore()}if(i>0){var y=e("shape.border.width.absolute");y&&(p.save(),p.setTransform(1,0,0,1,0,0)),p.lineWidth=i;var T=g(O._55o);O.shapeBorderRepeatImage?Mk(p,O.shapeBorderRepeatImage,T,null,c,o):p.strokeStyle=T,p.stroke(),y&&p.restore(),O._56o&&lm(p,T,g(O._57o),i,o._zoom,O._58o)}if(Pq(p,Q),e("shape.dash")){var D=e("shape.dash.width")||i;if(D>0){Q=e("shape.dash.pattern");var j=li(p,Q,R._2Q("shape.dash.offset"));j!==p&&qm(j,d,S,X,F,h,v),R._1Q(p,"shape",D,Q)}}bh(p,V,O._63o,S),p.lineJoin=K,p.lineCap=C}else{var N=R.interactiveInfo;N&&(p.interactiveInfo=N.bodyInfo={compInfos:[],matrix:new Qh(J,w.x,w.y,L.x,L.y)}),O.gray&&(p.compGray=!0);var I=O.img;I&&I.cacheRule!=G&&(I=Ym(p,I,O.stretch,S.width,S.height,c,o,O.bodyColor)),gr(p,I,O.stretch,S.x,S.y,S.width,S.height,c,o,O.bodyColor),p.compGray=!1,p.interactiveInfo=G}p.restore()}R._39O(p,O)},_48O:function(){},_47O:function(){}});var lq=function(t,k){ln(lq,this,[t,k])},Al=function(C,g,q,k){var i=qj(C,g);return q=k?S(q,i):Ik(q,i),i?q/=i:q=0,{x:C.x+(g.x-C.x)*q,y:C.y+(g.y-C.y)*q}};mj(lq,kq,{_3O:function(){var M,u=this,n=u._data,T=u.gv,B=u.s,w=B(cd),s=n.isLooped(),J=B("edge.width"),W=u.getBodyColor("edge.color"),N=B("edge.center"),i=B("edge.offset"),t=T.getBorderColor(n),g=t?B("border.width"):0,f=u.getSelectWidth(),h=n._40I,C=n._41I,_=u._78o=h&&C?{looped:s,type:w,width:J,center:N,color:W,repeatImage:Nd(B("edge.repeat.image"),W),borderColor:t,borderWidth:g,_97o:f?u.getSelectColor():G,selectWidth:f,pattern:B("edge.pattern"),cap:B("edge.cap"),join:B("edge.join"),is3d:B("edge.3d"),_67o:B("edge.3d.color"),_66o:B("edge.3d.accuracy"),gray:B("2d.gray")}:G;if(_){var y=m.getEdgeType(w);if(y){var V=y(n,Gk(u,T,n,s,w),T,u._19Q);V.points&&V.points.size()>1?(_.edgeTypeInfo=V,M=Ip(_.edgeTypeInfo.points)):V[Zn]&&V.rect&&(_.edgeTypeInfo=V,M=V.rect)}else{var R=B("edge.source.anchor.x"),S=B("edge.source.anchor.y"),p=B("edge.target.anchor.x"),r=B("edge.target.anchor.y"),j=fq(T,n,"source"),I=fq(T,n,"target");if(w===gj){var Z=_.points=B(Ig)||Vi,Q=Z.size();_.segments=B("edge.segments");var E=R!==D||S!==D||Lb(h),O=p!==D||r!==D||Lb(C);if(!N)if(i)E||(j=Al(j,Q?Z.get(0):I,i,Q)),O||(I=Al(I,Q?Z.get(Q-1):j,i,Q));else{var k;E||(k=mb(j,Q?Z.get(0):I,Dj(T,h)),k&&(j={x:k[0],y:k[1]})),O||(k=mb(Q?Z.get(Q-1):j,I,Dj(T,C)),k&&(I={x:k[0],y:k[1]}))}M=je(Ip(_.points),Ip(j,I))}else{var q=Gk(u,T,n,s,w);if(u._19Q||(q=-q),s)j=gl(j),j.x=T.getNodeRect(h).x,_.radius=q,M={x:j.x-q,y:j.y-q,width:2*q,height:2*q};else{var K=qj(j,I),c=Ik(i,K),e={x:c,y:q},z={x:K-c,y:q},A=pd(I.y-j.y,I.x-j.x),b=_.mat=new Wo(A);if(_.orienAngle=A,_.angle=I.x<j.x?A+Y:A,_.rect={x:e.x,y:e.y,width:z.x-e.x,height:0},_.origin=j,e=b.tf(e),e.x+=j.x,e.y+=j.y,z=b.tf(z),z.x+=j.x,z.y+=j.y,N){var d={x:K,y:0};d=b.tf(d),d.x+=j.x,d.y+=j.y,M=Ip([j,e,z,d]),_.c1=j,_.c2=d}else M=Ip(e,z);j=e,I=z}}_.sourcePoint=j,_.targetPoint=I,n._lastSourcePoint=j,n._lastTargetPoint=I}var a=0;B("edge.dash")&&(a=B("edge.dash.width")||J);var x="square"===_.cap?.71:.5;no(M,L(a*x,J*x+g+f),_.join),u._68o(M)}},getRotation:function(L,q,X){L=L||0;var E=this._78o;if(E){var A,I=E.angle,Y=E.points,P=E.edgeTypeInfo;if(I!=G)return q?E.orienAngle+L:I+L;if(P&&P[Zn])return P.getRotation?P.getRotation(this,L,q,X):0;if(P&&P.points){var p=P.points;return A=p.size(),Fo[X]?A&&0===A%2?Yk(p.get(A/2-1),p.get(A/2),q,L):L:Nc[X]?Yk(p.get(0),p.get(1),q,L):Yk(p.get(A-2),p.get(A-1),q,L)}if(Y)return A=Y.size(),Fo[X]?A&&0===A%2?Yk(Y.get(A/2-1),Y.get(A/2),q,L):L:Nc[X]?Yk(E.sourcePoint,A?Y.get(0):E.targetPoint,q,L):Yk(A?Y.get(A-1):E.sourcePoint,E.targetPoint,q,L)}return L},getPosition:function(s,g,L,c,l){var z=this._78o;if(z){var q,f=z.type,H=z.points,E=z.edgeTypeInfo,S=z.sourcePoint,K=z.targetPoint;if(!f)return z.looped?{x:S.x-z.radius+g,y:S.y+L}:(l&&S&&K&&(S.x>K.x||S.x===K.x&&S.y>K.y)&&(s=ib[s],L=-L),q=yq(s,z.rect,c),q.x+=g,q.y+=L,q=z.mat.tf(q),q.x+=z.origin.x,q.y+=z.origin.y,q);if(E&&E[Zn])return E.getPosition?E.getPosition(this,s,g,L,c,l):{x:(S.x+K.x)/2,y:(S.y+K.y)/2};if(H){var q,T=H.size();if(Fo[s]){if(T){var N=T%2;if(0===N)return Jp(H.get(T/2-1),H.get(T/2),s,g,L,c,l);q=H.get((T-N)/2)}else q={x:(S.x+K.x)/2,y:(S.y+K.y)/2};return q=yq(s,{x:q.x,y:q.y,width:0,height:0},c),q.x+=g,q.y+=L,q}return Nc[s]?Jp(S,T?H.get(0):K,s,g,L,c,l):Jp(T?H.get(T-1):S,K,s,g,L,c,l)}if(E){var k=E.points,T=k.size();if(Fo[s]){var N=T%2;return 0===N?Jp(k.get(T/2-1),k.get(T/2),s,g,L,c,l):(q=k.get((T-N)/2),q=yq(s,{x:q.x,y:q.y,width:0,height:0},c),q.x+=g,q.y+=L,q)}return Nc[s]?Jp(k.get(0),k.get(1),s,g,L,c,l):Jp(k.get(T-2),k.get(T-1),s,g,L,c,l)}}return rg},_42:function(b){this._78o&&lq.superClass._42.call(this,b)},drawPath:function(R,l){R.beginPath();var q=l.type,c=l.points,B=l.segments,f=l.edgeTypeInfo;if(!q||c){var S=l.sourcePoint,T=S.x,e=S.y,b=l.targetPoint,Q=b.x,y=b.y;if(q)if(B){var h=new pq({x:T,y:e});h.addAll(c),h.add({x:Q,y:y}),bj(R,h,B)}else R.moveTo(T,e),c.each(function(z){R.lineTo(z.x,z.y)}),R.lineTo(Q,y);else l.looped?R.arc(T,e,l.radius,0,k,!0):l.center?(R.moveTo(l.c1.x,l.c1.y),R.lineTo(T,e),R.lineTo(Q,y),R.lineTo(l.c2.x,l.c2.y)):(R.moveTo(T,e),R.lineTo(Q,y))}else f&&(f.points?bj(R,f.points,f.segments):f[Zn]&&f[Zn](R,f))},_80o:function(t){var f=this,F=f.s,e=f._78o,d=e.width,B=e.selectWidth,h=e.borderWidth,q=e.repeatImage,P=t.lineJoin,E=t.lineCap,V=e.gray,R=e.pattern;t.lineJoin=e.join,t.lineCap=e.cap,f.drawPath(li(t,R),e);var y=F("edge.width.absolute");y&&(t.save(),t.setTransform(1,0,0,1,0,0)),B&&(t.strokeStyle=e._97o,t.lineWidth=d+2*(h+B),t.stroke()),h&&(t.strokeStyle=V?m.toGrayColor(e.borderColor):e.borderColor,t.lineWidth=d+2*h,t.stroke());var v=V?m.toGrayColor(e.color):e.color;if(q?Mk(t,q,v,null,f._data,f.gv):t.strokeStyle=v,t.lineWidth=d,t.stroke(),e.is3d){var I=V?m.toGrayColor(e._67o):e._67o;lm(t,v,I,d,f.gv._zoom,e._66o)}if(Pq(t,R),F("edge.dash")){R=F("edge.dash.pattern");var n=li(t,R,f._2Q("edge.dash.offset"));n!==t&&f.drawPath(n,e),f._1Q(t,"edge",F("edge.dash.width")||d,R)}y&&t.restore(),t.lineJoin=P,t.lineCap=E},_48O:function(){},_47O:function(){}});var Gd=function(Q,e){ln(Gd,this,[Q,e])};mj(Gd,Tq,{_3O:function(){var t,X,Y=this,U=Y.s,j=Y._data,_=Y.gv;if(Y._88I=G,j.isExpanded()&&j.eachChild(function(R){if(ge(R)){var T=_.getBoundsForGroup(R);T&&(X||(X=[]),X.push(T),t=je(t,T))}}),t){var C=_.getLabel(j),O=U("group.type"),E=U("group.border.width")||0,n=U("group.border.width.absolute"),Q=E/2;n&&(E/=_._zoom),t=Yn(O,X,t),wg(t,j,"group.padding",1),ir(t,E);var P=Y._88I={type:O,rect:t,_64o:t};if(!O&&C!=G){var u,J=Y.labelInfo={label:C,color:U("group.title.color"),font:U("group.title.font"),align:U("group.title.align")},m=Dm(J,C),T=m.width+E,d=m.height+E,H=U("group.title.align"),y=U("group.title.orientation");if(y===am||y===ye?(t.height+=E,T>t.width&&(t.width=T)):(y===xb||y===ui)&&(t.width+=E,T>t.height&&(t.height=T)),u=H===xb?t.x:H===ui?t.x+t.width-T:t.x+t.width/2-T/2,y===ye)P.titleRect={x:t.x,y:t.y+t.height,width:t.width,height:d},P.rect={x:t.x,y:t.y,width:t.width,height:t.height+d},J.rect={x:u,y:t.y+t.height,width:T,height:d};else if(y===xb){var W=P.titleRect={x:t.x-d,y:t.y,width:d,height:t.height};P.rect={x:t.x-d,y:t.y,width:t.width+d,height:t.height},J.rect={x:W.x+d/2-t.height/2,y:W.y+t.height/2-d/2,width:t.height,height:d},J.rotation=-Math.PI/2}else if(y===ui){var W=P.titleRect={x:t.x+t.width,y:t.y,width:d,height:t.height};P.rect={x:t.x,y:t.y,width:t.width+d,height:t.height},J.rect={x:W.x+d/2-t.height/2,y:W.y+t.height/2-d/2,width:t.height,height:d},J.rotation=Math.PI/2}else P.titleRect={x:t.x,y:t.y-d,width:t.width,height:d},P.rect={x:t.x,y:t.y-d,width:t.width,height:t.height+d},J.rect={x:u,y:t.y-d-Q,width:T,height:d+E}}Y._40O(P,U("group.border.width")/2)}else Gd.superClass._3O.call(Y)},getPosition:function(f,J,u,V){var z=this._88I;if(z){var P=yq(f,z.rect,V);return P.x+=J,P.y+=u,P}return Gd.superClass.getPosition.apply(this,arguments)},_24O:function(l,A){var g=this._88I;(!g||g.type||"label2"===l)&&Gd.superClass._24O.call(this,l,A)},_80o:function(I){var $=this,t=$._88I;if(t){var X=$._data,i=$.s,o=$.gv,L=t.type,q=t.rect,K=t._64o,N=t.titleRect,M=$.getBodyColor(),D=Nd(i("group.image"),M),P=i("group.image.stretch"),w=$.getBodyColor("group.background"),_=Nd(i("group.repeat.image"),M),F=i("group.gradient.pack"),e=i("group.gradient"),c=i("group.gradient.color"),h=i("group.border.width"),u=i("group.border.color"),U=i("group.border.pattern"),v=i("group.title.orientation"),R=i("group.depth"),l=i("group.border.radius"),A=i("group.border.join"),Q=i("group.border.cap"),r=i("group.border.width.absolute");r&&(h/=o._zoom);var s=u,z=i("group.border.repeat.image");if(z&&(z=Nd(z,u))&&(s=bo(I,z,u,null,X,o)),L){var J=I.lineJoin,a=I.lineCap;if(I.lineJoin=A,I.lineCap=Q,D){if(I.save(),qm(I,L,q,l),I.clip(),gr(I,D,P,q.x,q.y,q.width,q.height,X,o,M),I.restore(),h>0){var x=li(I,U);qm(x,L,q,l),I.lineWidth=h,I.strokeStyle=s,I.stroke(),Pq(I,U)}}else{var x=li(I,U);w||_||F?(qm(I,L,q,l),F?rl(I,F,function(u){return jn(u,M)}):_?Vo(I,_,M,null,X,o):od(I,w,e,c,q),I.fill(),F&&I.restore(),I!==x&&qm(x,L,q,l)):qm(x,L,q,l),h>0&&(I.lineWidth=h,I.strokeStyle=s,I.stroke()),Pq(I,U),L===Aq&&bh(I,w,R,q)}I.lineJoin=J,I.lineCap=a}else{var G=i("group.title.background");if((!l||0>l)&&(l=0),D)gr(I,D,P,K.x,K.y,K.width,K.height,X,o,$.getBodyColor());else if(w||_)if(_?Vo(I,_,M,null,X,o):od(I,w,e,c,K),0===h)qm(I,Aq,K),I.fill(),bh(I,w,R,K);else{switch(I.beginPath(),v){case ye:cs(I,K.x,K.y,K.width,K.height,l,l,0,0);break;case xb:cs(I,K.x,K.y,K.width,K.height,0,l,0,l);break;case ui:cs(I,K.x,K.y,K.width,K.height,l,0,l,0);break;case am:cs(I,K.x,K.y,K.width,K.height,0,0,l,l)}I.fill()}if(N&&G)if(0===h)zd(I,N.x,N.y,N.width,N.height,G),bh(I,G,R,N);else{switch(I.beginPath(),I.fillStyle=G,v){case ye:cs(I,N.x,N.y,N.width,N.height,0,0,l,l);break;case xb:cs(I,N.x,N.y,N.width,N.height,l,0,l,0);break;case ui:cs(I,N.x,N.y,N.width,N.height,0,l,0,l);break;case am:cs(I,N.x,N.y,N.width,N.height,l,l,0,0)}I.fill()}if(h>0){var x=li(I,U);if(qm(x,"roundRect",q,l),I.save(),I.lineWidth=h,I.strokeStyle=s,I.lineJoin=A,I.lineCap=Q,I.closePath(),I.stroke(),N&&i("group.splitLine")){var k=N.x,O=N.y,T=N.width,E=N.height;I.beginPath(),v===ye?(I.moveTo(k,O),I.lineTo(k+T,O)):v===xb?(I.moveTo(k+T,O),I.lineTo(k+T,O+E)):v===ui?(I.moveTo(k,O),I.lineTo(k,O+E)):(I.moveTo(k,O+E),I.lineTo(k+T,O+E))}I.stroke(),I.restore(),Pq(x,U)}}$._39O(I,t)}else Gd.superClass._80o.call($,I)}});var Of=function(j,K){ln(Of,this,[j,K])};mj(Of,Tq,{_80o:function(N){this._39O(N,this._83o)}});var lf=function(P,h){ln(lf,this,[P,h])};mj(lf,Tq,{_3O:function(){var u=this,g=u._data,q=u.s,h=u.gv,R=g.getPoints(),p=h.getBorderColor(g),S=p?q("border.width"):0,J=u.getSelectWidth(),m=q("shape.border.width"),s=g.getRect(),Y=g.getAnchorRect(),Q=h.getBodyColor(g),l=q("shape.border.color"),k=u._99o=R.isEmpty()?G:{rect:s,rotation:g.getRotation(),fillRule:q("shape.fill.rule"),scale:g.getScale(),position:g.p(),points:R,segments:g.getSegments(),bodyColor:Q,borderColor:p,borderWidth:S,_94o:q("shape.border.3d"),_95o:q("shape.border.3d.color"),_96o:q("shape.border.3d.accuracy"),_97o:J?u.getSelectColor():G,selectWidth:J,_53o:q("shape.background"),_27Q:Nd(q("shape.repeat.image"),Q),shapeGradientPack:q("shape.gradient.pack"),_54o:m,_55o:l,shapeBorderRepeatImage:Nd(q("shape.border.repeat.image"),l),shapeGradient:q("shape.gradient"),_59o:q("shape.gradient.color"),_60o:q("shape.border.pattern"),_61o:q("shape.border.cap"),_62o:q("shape.border.join"),shapeForeground:q("shape.foreground"),gray:q("2d.gray")};if(k){Y.x+=k.position.x,Y.y+=k.position.y,k.gradientRect=Y;var I=g.getScale(),H=L(1,L(E(I.x),E(I.y)));q("shape.dash")&&q("shape.dash.width")>m&&(m=q("shape.dash.width"));var t,C=q("shape.border.width.absolute");t=C?(m+S+J)/u.gv._zoom/H:m*("square"===k._61o?.71:.5)+S+J/u.gv._zoom/H,t&&(t*=H,s=gl(s),no(s,t,k._62o)),u._68o(s);var $=If(g,h.isSelected(g)),W=q("clip.percentage");1>W&&(0>W&&(W=0),k.clipRect=cb(g.getAnchorRect(),q("clip.direction"),W,$));var V=q("shape.fill.clip.percentage");1>V&&(0>V&&(V=0),k.shapeClipRect=cb(g.getAnchorRect(),q("shape.fill.clip.direction"),V,$));var Z=q("shape.foreground.clip.percentage");1>Z&&(0>Z&&(Z=0),k.shapeForegroundClipRect=cb(g.getAnchorRect(),q("shape.foreground.clip.direction"),Z,$))}},getPosition:function(B,Q,x,I){var A=this._99o;if(A){var H=yq(B,A.rect,I);return H.x+=Q,H.y+=x,H}return rg},_42:function(R){this._99o&&lf.superClass._42.call(this,R)},_80o:function(e){var s,R=this,Y=R.s,n=R._99o,i=n.position,o=n.scale,M=n.rotation,w=n.borderWidth,E=n.selectWidth/R.gv._zoom,K=n._27Q,F=n.shapeGradientPack,T=n._54o,C=n.clipRect,X=n.shapeClipRect,h=n.points,J=n.segments,H=R._data.isClosePath(),U=n.fillRule,G=n.gray,g=function(_){return G?m.toGrayColor(_):_},k=g(n._53o),f=k||K||F;e.save(),ae(e,i.x,i.y),Ln(e,M),Pe(e,o.x,o.y),C&&(e.beginPath(),e.rect(C.x,C.y,C.width,C.height),e.clip()),f&&X&&(e.save(),e.beginPath(),e.rect(X.x,X.y,X.width,X.height),e.clip()),ae(e,-i.x,-i.y);var O=n._60o,j=li(e,O),t=e.lineJoin,I=e.lineCap;e.lineJoin=n._62o,e.lineCap=n._61o;var y=g(n.bodyColor);f?(bj(e,h,J,H),F?rl(e,F,function(c){return jn(c,n.bodyColor)}):K?Vo(e,K,y,null,R._data,R.gv):(s=y?y:k,od(e,s,n.shapeGradient,g(n._59o),n.gradientRect)),e.fill(U),F&&e.restore(),X&&(e.restore(),ae(e,-i.x,-i.y)),j!==e&&bj(j,h,J,H)):bj(j,h,J,H);var l=n.shapeForeground;if(l){e.save();var c=n.shapeForegroundClipRect;c&&(ae(e,i.x,i.y),e.beginPath(),e.rect(c.x,c.y,c.width,c.height),e.clip(),ae(e,-i.x,-i.y)),bj(e,h,J,H),od(e,l,Y("shape.foreground.gradient"),g(Y("shape.foreground.gradient.color")),n.gradientRect),e.fill(U),e.restore()}var a=Y("shape.border.width.absolute");if(a&&(e.save(),e.setTransform(1,0,0,1,0,0)),E&&(e.strokeStyle=n._97o,e.lineWidth=T+2*(w+E),e.stroke()),w&&(e.strokeStyle=g(n.borderColor),e.lineWidth=T+2*w,e.stroke()),T&&(s=g(n._55o),n.shapeBorderRepeatImage?Mk(e,n.shapeBorderRepeatImage,s,null,R._data,R.gv):(!k&&y&&(s=y),e.strokeStyle=s),e.lineWidth=T,e.stroke(),n._94o&&lm(e,s,g(n._95o),T,R.gv._zoom,n._96o)),Pq(e,O),Y("shape.dash")){var S=Y("shape.dash.width")||T;if(S>0){O=Y("shape.dash.pattern");var j=li(e,O,R._2Q("shape.dash.offset"));j!==e&&bj(j,h,J,H),R._1Q(e,"shape",S,O)}}a&&e.restore(),e.lineJoin=t,e.lineCap=I,e.restore()},_48O:function(){},_47O:function(){}});var Kq=function(K,D){ln(Kq,this,[K,D])};mj(Kq,lf,{getRotation:function($,W,s){$=$||0;var k=this._data.getPoints(),j=k.size();return j>1?Fo[s]?j&&0===j%2?Yk(k.get(j/2-1),k.get(j/2),W,$):$:Nc[s]?Yk(k.get(0),k.get(1),W,$):Yk(k.get(j-2),k.get(j-1),W,$):$},getPosition:function(s,B,d,f,o){var R=this._data.getPoints(),A=R.size();if(A>1){if(Fo[s]){var p=A%2;if(0===p)return Jp(R.get(A/2-1),R.get(A/2),s,B,d,f,o);var j=R.get((A-p)/2),a={x:j.x,y:j.y,width:0,height:0};return j=yq(s,a,f),j.x+=B,j.y+=d,j}return Nc[s]?Jp(R.get(0),R.get(1),s,B,d,f,o):Jp(R.get(A-2),R.get(A-1),s,B,d,f,o)}return rg}});var xp=function($,N){ln(xp,this,[$,N])};mj(xp,Tq,{_3O:function(){var S=this;xp.superClass._3O.call(S);var y=S.s,z=S._83o;S._82o=z.img||z.shape?G:{background:S.getBodyColor("grid.background"),depth:y("grid.depth"),rect:z.rect,_88o:y("grid.cell.depth"),cellBorderColor:y("grid.cell.border.color"),_89o:y("grid.row.count"),_90o:y("grid.column.count"),block:y("grid.block"),_91o:y("grid.block.color"),_92o:y("grid.block.padding"),_93o:y("grid.block.width")}},_80o:function(d){var $=this,u=$._82o;if(!u)return xp.superClass._80o.call($,d),void 0;var w,R,a=$._data,F=u.background,N=u.rect,W=u.block,e=u._91o,T=u._92o,g=u._93o,s=u._88o,C=u.cellBorderColor,b=u._89o,K=u._90o;if(F)if(zd(d,N.x,N.y,N.width,N.height,F),bh(d,F,u.depth,N),s)for(w=0;b>w;w++)for(R=0;K>R;R++)N=a.getCellRect(w,R),N&&bh(d,F,s,N);else if(C){for(d.beginPath(),w=0;b>w;w++)for(R=0;K>R;R++)N=a.getCellRect(w,R),N&&d.rect(N.x,N.y,N.width,N.height);d.strokeStyle=C,d.lineWidth=1,d.stroke()
}if("h"===W)for(w=0;b>w;w++)N=je(a.getCellRect(w,0),a.getCellRect(w,K-1)),ir(N,T),to(d,e,N.x,N.y,N.width,N.height,g);else if("v"===W)for(R=0;K>R;R++)N=je(a.getCellRect(0,R),a.getCellRect(b-1,R)),ir(N,T),to(d,e,N.x,N.y,N.width,N.height,g);$._39O(d,$._83o)}});var kh=function(C,h){ln(kh,this,[C,h])};mj(kh,Tq,{_checkEmptyRect:!1,_81o:function(){var q=this._data,B=kh.superClass._81o.call(this),F=q.s("text");if(F!=G){var n,i,y=q.s("text.font"),Q=q.s("text.align"),V=q.s("text.vAlign"),U=Vd(y,F),N=U.width,j=U.height,R=q.getAnchor(),M=q.getWidth(),u=q.getHeight();"left"===Q?n=-M*R.x:"center"===Q?n=-M*R.x+(M-N)/2:"right"===Q&&(n=M*(1-R.x)-U.width),"top"===V?i=-u*R.y:"middle"===V?i=-u*R.y+(u-j)/2:"bottom"===V&&(i=u*(1-R.y)-U.height);var p,A=q.getMatrix();if(p=Ip([A.tf(n,i),A.tf(n+N,i),A.tf(n+N,i+j),A.tf(n,i+j)]),B=je(B,p),B&&q.s("text.shadow")){var t=gl(B);t.x+=q.s("text.shadow.offset.x"),t.y+=q.s("text.shadow.offset.y"),ir(t,q.s("text.shadow.blur")),B=je(B,t)}}return B}});var Ql=hg.Interactor=function(Y){this.gv=this._graphView=Y};zp("Interactor",t,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(d){this.gv.fi(d)},setCursor:function(f){yr||this.gv.setCursor(f)},startDragging:function(g){var z=this;z._lastClientPoint=Lp(g),z._lastLogicalPoint=z.gv.lp(g),nr(z,g)},clearDragging:function(){var $=this;$._lastClientPoint=$._lastLogicalPoint=$._logicalPoint=G},autoScroll:function(b){return this.gv.autoScroll(b,this._lastClientPoint)}});var cp=G,eh=function(K){cp.handleWindowTouchMove(K)},fk=function(C){cp.handleWindowTouchEnd(C),J(_,Cg,eh),J(_,Er,fk),cp=G},Bk=function(w){cp.handleWindowMouseMove(w)},Eo=function($){cp.handleWindowMouseUp($),J(_,Gr,Bk),J(_,Fb,Eo),cp=G},mp=function(q,K){if(q!==cp){var b=Jo(K);cp?b?cp.handleWindowTouchEnd(K):cp.handleWindowMouseUp(K):b?($(_,Cg,eh),$(_,Er,fk)):($(_,Gr,Bk),$(_,Fb,Eo)),cp=q}},Oo=function(X){var Z=this;Z.gv=X,Z._is2d=X instanceof hg.GraphView,Z._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",$q,"wheel"].forEach(function(Y){Z.addListener(Y)}),Z.initImageResource()};mj(Oo,Ql,{enableVR:function(u){var Y=this;!!Y._vrEnable!==u&&(Y._vrEnable=u,u?Y.gv.vr.mp(Y.onVRControllerChange,Y):Y.gv.vr.ump(Y.onVRControllerChange,Y))},onVRControllerChange:function(T){var p=this,x=T.property,K=T.newValue,w=K.id,M=p.gv.vr.getController(w),o=M.getRay();if(o){o.controllerId=w;var v=p.gv.vr.getRayEventType(o,x,K._62O);switch(v){case"down":p.handle_mousedown(o);break;case"up":cp&&Eo(o);break;case"move":p.handle_mousemove(o),cp&&p.handleWindowMouseMove(o)}}},setPreventEventDefault:function(c,j){var T=this,O=T._eventListeners[c];O?O._prevent=j:T._eventListeners[c]=O={_removal:D,_prevent:j}},removeListener:function(W){var U=this,m=U._eventListeners[W];m&&m._removal&&(m._removal(),m._removal=D)},addListener:function(F){var V=this,G=V._eventListeners[F];if(G||(V._eventListeners[F]=G={_removal:D,_prevent:!0}),!G||!G._removal){var h=function(M){G._prevent&&m.preventDefault(M),V.disabled||("wheel"===F?kb(V,M):V["handle_"+F](M))};$(V.gv.getView(),F,h),G._removal=function(){J(V.gv.getView(),F,h)}}},handleWindowTouchMove:function(h){this.handleWindowMouseMove(h)},handleWindowMouseMove:function(i){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",i):(this.handleDownInfo("onBeginDrag",i),this.isDragging=!0))},handleWindowTouchEnd:function(u){this.handleWindowMouseUp(u)},handleWindowMouseUp:function(I){if(this.isDragging&&(this.handleDownInfo("onEndDrag",I),this.isDragging=!1),this.downInfo){var C=this.handle("onUp",I);if(C&&C.data===this.downInfo.data){this.handleMissingUp(I);var T=this,S=2===I.button?"onContextMenu":"onClick";if(!T._dbclickTimer)return T._dbclickTimer=Qi(function(){delete T._dbclickTimer,T.handleClick(I,S,C),this.downInfo=G},m.clickDelay),void 0;ii(T._dbclickTimer),delete T._dbclickTimer,S="onDoubleClick",T.handleClick(I,S,C)}else this.handleDownInfo("onUp",I);this.downInfo=G,this.downComps=G}},handle_mouseleave:function(y){var P=this,a=P.gv;P._hoverTimer&&(ii(P._hoverTimer),delete P._hoverTimer);var v=P.currentInfo?P.currentInfo.data:G;if(v){v.s("onLeave")&&v.s("onLeave")(y,v,a),P.fire("data","onLeave",y,v);var d=P.currentInfo?P.currentInfo.hits:G;if(d)for(var I in d)P.handleLeave(y,I);P.currentInfo=G}},handle_mousewheel:function(S){S.scrollDelta=S.wheelDelta/40,this.handle("onScroll",S)},handle_DOMMouseScroll:function(z){z.scrollDelta=2===z.axis?-z.detail:0,this.handle("onScroll",z)},handle_touchstart:function(N){this.handle_mousedown(N)},handle_touchmove:function(Z){this.handle("onMove",Z)},handle_mousedown:function(y){this.isDragging&&(this.handleDownInfo("onEndDrag",y),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",y),this.downInfo&&mp(this,y)},handle_mousemove:function(X){var o=this,P=o.gv;if(o._hoverTimer&&(ii(o._hoverTimer),delete o._hoverTimer),!P._panning&&!P._moving){var M,S,k,x=o.handle("onMove",X),b=this.currentInfo?this.currentInfo.data:G,f=this.currentInfo?this.currentInfo.hits:G;if(x&&(S=x.data,k=x.hits,o._hoverTimer=Qi(function(){ii(o._hoverTimer),delete o._hoverTimer,o.handle("onHover",X,x)},P.getHoverDelay()||m.hoverDelay)),S!==b){if(b&&(b.s("onLeave")&&b.s("onLeave")(X,b,P),this.fire("data","onLeave",X,b)),S&&(S.s("onEnter")&&S.s("onEnter")(X,S,P),this.fire("data","onEnter",X,S)),f)for(M in f)this.handleLeave(X,M);if(k)for(M in k){var W=k[M],q=S._interactPrefix=W.prefix,u=q&&S.a(q+"onEnter")||W.target.onEnter;u&&u.call(W.target,X,S,P,W.point,W.width,W.height),this.fire(W.type,"onEnter",W.event,W.data,W.image,W.comp,W.point,W),S._interactPrefix=null}}else{if(f)for(M in f)k&&k[M]||this.handleLeave(X,M);if(k)for(M in k)if(!f||!f[M]){var W=k[M],q=S._interactPrefix=W.prefix,u=q&&S.a(q+"onEnter")||W.target.onEnter;u&&u.call(W.target,X,S,P,W.point,W.width,W.height),this.fire(W.type,"onEnter",W.event,W.data,W.image,W.comp,W.point,W),S._interactPrefix=null}}this.currentInfo=x}},handle:function(r,D,Q){var Y,T=this,p=T.gv;if(T._is2d){if(Q=Q||p.getDataInfoAt(D),!Q||!p.isInteractive(Q.data))return;if(Y=Q.ui.interactiveInfo){var y,w=Q.data;if(w.s(r)&&w.s(r)(D,w,p),this.fire("data",r,D,w),"body"===Q.part&&Y.bodyInfo)y="body",Q.hits=this.handleImage(y,p.getImage(w),r,D,w,Q.point,Y.bodyInfo);else if("icons"===Q.part&&Y._38o){var l=Y._38o[Q.name];l&&l[Q.index]&&(y="icons|"+Q.name+"|"+Q.index,Q.hits=this.handleImage(y,Q.icon,r,D,w,Q.point,l[Q.index]))}}return Q}var w,R;if(!Q)if(D&&D instanceof q.Math.Ray&&p.isVREnabled()){var x=p.vr.intersectWorld(D);if(w=x.data,R=x.intersect,p.vr.renderRayDuringInteraction(D,w,R),!w)return;var $=p.getData3dUI(w);if(Y=$.interactiveInfo,!Y)return;Q={data:w,part:R.part,ui:$}}else{if(Q=p.getDataInfoAt(D),!Q)return;Q&&(Q={data:Q.data,part:Q.part})}if(p.isInteractive(Q.data)){if(!R){w=Q.data;var $=p.getData3dUI(w);if(Q.ui=$,Y=$.interactiveInfo,!Y)return Q;if(R=p.intersectObject(D,w),!R)return}w.s(r)&&w.s(r)(D,w,p),this.fire("data",r,D,w);var s,F=R.part;return"body"!==F&&(s=w.s(F+".image")||w.s("shape3d."+F+".image")),s||(s=w.s("all.image")||w.s("shape3d.image")),s?(Y="object"==typeof s?Y[s.uuid]:Y[s],Y&&Y.bodyInfo?(Q.part="body",Q.interactiveInfo=Y,Q.point=this._convertUVToPoint(R.uv,Y),Q.image=s,Q.hits=this.handleImage("body",s,r,D,w,Q.point,Y.bodyInfo),Q):Q):Q}},_handleLeaveOrMissing:function(X,H,P){var G="leave"===X?this.currentInfo:this.downInfo;if(G){var m=G.interactiveInfo||G.ui.interactiveInfo;if(m){var I,u,t=G.data;if(this._is2d){if(u=this.gv.lp(H),"body"===G.part&&m.bodyInfo)I="body","leave"===X?this.handleLeaveImage(P,I,this.gv.getImage(t),H,t,u,m.bodyInfo):this.handleMissingUpImage(I,this.gv.getImage(t),H,t,u,m.bodyInfo);else if("icons"===G.part&&m._38o){var n=m._38o[G.name];n&&n[G.index]&&(I="icons|"+G.name+"|"+G.index,"leave"===X?this.handleLeaveImage(P,I,G.icon,H,t,u,n[G.index]):this.handleMissingUpImage(I,G.icon,H,t,u,n[G.index]))}}else{if(!m.bodyInfo)return;var b=this.gv.intersectObject(H,t);u=b&&b.uv?this._convertUVToPoint(b.uv,m):{x:1/0,y:1/0},"leave"===X?this.handleLeaveImage(P,"body",G.image,H,t,u,m.bodyInfo):this.handleMissingUpImage("body",G.image,H,t,u,m.bodyInfo)}}}},handleClick:function(q,l,J){var R=this,N=this.downInfo;if(N&&J){var _,V=J.interactiveInfo||J.ui.interactiveInfo,s=J.data,o=this.gv;if(s.s(l)&&s.s(l)(q,s,o),R.fire("data",l,q,s),V)if(this._is2d){if(N.part===J.part){var h=o.lp(q);"body"===J.part&&V.bodyInfo&&(_="body",this.handleClickImage(_,o.getImage(s),l,q,s,h,V.bodyInfo,J))}}else{if(!V.bodyInfo)return;var K=o.intersectObject(q,s);if(!K)return;h=this._convertUVToPoint(K.uv,V),this.handleClickImage("body",N.image,l,q,s,h,V.bodyInfo,J)}}},handleDownInfo:function(i,e){if(this.downInfo){var W=this.downInfo,g=this.gv,w=W.interactiveInfo||W.ui.interactiveInfo;if(w){var A,u=W.data;if(u.s(i)&&u.s(i)(e,u,g),this.fire("data",i,e,u),this._is2d){var Q=g.lp(e);if("body"===W.part&&w.bodyInfo)A="body",this.handleDownInfoImage(A,g.getImage(u),i,e,u,Q,w.bodyInfo);else if("icons"===W.part&&w._38o){var Z=w._38o[W.name];Z&&Z[W.index]&&(A="icons|"+W.name+"|"+W.index,this.handleDownInfoImage(A,W.icon,i,e,u,Q,Z[W.index]))}}else{if(!w.bodyInfo)return;var c=g.intersectObject(e,u);if(!c)return;Q=this._convertUVToPoint(c.uv,w),this.handleDownInfoImage("body",W.image,i,e,u,Q,w.bodyInfo)}}}},fire:function(M,x,r,y,q,o,v,z){this.gv.fi({kind:x,type:M,event:r,data:y,image:q,comp:o,view:this.gv,point:v,width:z?z.width:D,height:z?z.height:D})},handleImage:function(c,T,u,j,o,q,r){var I={};if(T&&(T=Nd(T))){var K=this.gv,i=r.rect,U=this.convertPoint(q,r);U.inRect&&(T[u]&&T[u](j,o,K,U,i.width,i.height),this.fire("image",u,j,o,T,D,U,i),I[c+"|image"]={target:T,type:"image",image:T,data:o,event:j,point:U,width:i.width,height:i.height});for(var V,R=r.compInfos,y=T,h=R.length-1;h>=0;h--){var W=R[h],M=W.comp;if(U=this.convertPoint(q,W,y,M,K,o),U.inRect){i=W.rect;var L=o._interactPrefix=W.prefix,B=L&&o.a(L+u)||M[u];if(B&&(V=B.call(M,j,o,K,U,i.width,i.height)),this.fire("comp",u,j,o,T,M,U,i),V!==!0&&(T=i.image)&&(T[u]&&(V=T[u](j,o,K,U,i.width,i.height)),this.fire("image",u,j,o,T,D,U,i)),o._interactPrefix=null,I[c+"|"+h]={target:M,type:"comp",comp:M,image:T,data:o,event:j,point:U,width:i.width,height:i.height,prefix:L},this.downComps&&this.downComps.push(M),T&&(I[c+"|"+h+"|image"]={target:T,type:"image",image:T,data:o,event:j,point:U,width:i.width,height:i.height,prefix:L}),V===!0)break}}}return I},handleLeave:function(O,s){return this._handleLeaveOrMissing("leave",O,s)},handleMissingUp:function(D){return this._handleLeaveOrMissing("missing",D)},handleLeaveImage:function(f,x,z,L,l,h,V){if(z&&(z=Nd(z))){var _=this.gv,W=V.rect,p=this.convertPoint(h,V);f===x+"|image"&&(z.onLeave&&z.onLeave(L,l,_,p,W.width,W.height),this.fire("image","onLeave",L,l,z,D,p,W));for(var C,K=V.compInfos,b=z,S=K.length-1;S>=0;S--){var o=K[S],n=o.comp;p=this.convertPoint(h,o,b,n,_,l),W=o.rect;var m=l._interactPrefix=o.prefix;if(f===x+"|"+S){var j=m&&l.a(m+"onLeave")||n.onLeave;j&&(C=j.call(n,L,l,_,p,W.width,W.height)),this.fire("comp","onLeave",L,l,z,n,p,W)}if(C!==!0&&(z=W.image)&&f===x+"|"+S+"|image"&&(z.onLeave&&(C=z.onLeave(L,l,_,p,W.width,W.height)),this.fire("image","onLeave",L,l,z,D,p,W)),l._interactPrefix=null,C===!0)break}}},handleMissingUpImage:function(G,X,R,N,q,u){var V="onUp",K=this.downInfo.hits;if(K&&X&&(X=Nd(X))){var M=this.gv,o=u.rect,Q=this.convertPoint(q,u);!Q.inRect&&K[G+"|image"]&&(X[V]&&X[V](R,N,M,Q,o.width,o.height),this.fire("image",V,R,N,X,D,Q,o));for(var f,S=u.compInfos,h=X,T=S.length-1;T>=0;T--){var I=S[T],Y=I.comp;if(Q=this.convertPoint(q,I,h,Y,M,N),!Q.inRect){o=I.rect;var p=N._interactPrefix=I.prefix;if(K[G+"|"+T]){var E=p&&N.a(p+V)||Y[V];E&&(f=E.call(Y,R,N,M,Q,o.width,o.height)),this.fire("comp",V,R,N,X,Y,Q,o)}if(f!==!0&&(X=o.image)&&K[G+"|"+T+"|image"]&&(X[V]&&(f=X[V](R,N,M,Q,o.width,o.height)),this.fire("image",V,R,N,X,D,Q,o)),N._interactPrefix=null,f===!0)break}}}},handleDownInfoImage:function(g,O,Y,P,U,t,F){var x=this.downInfo.hits;if(x&&O&&(O=Nd(O))){var p=this.gv,M=F.rect,Q=this.convertPoint(t,F);x[g+"|image"]&&(O[Y]&&O[Y](P,U,p,Q,M.width,M.height),this.fire("image",Y,P,U,O,D,Q,M));for(var G,d=F.compInfos,I=O,e=d.length-1;e>=0;e--){var l=d[e],f=l.comp;Q=this.convertPoint(t,l,I,f,p,U),M=l.rect;var C=U._interactPrefix=l.prefix,q=["onDrag","onEndDrag"].indexOf(Y)>=0;if(!q&&x[g+"|"+e]||q&&this.downComps&&this.downComps.indexOf(f)>=0){var V=C&&U.a(C+Y)||f[Y];V&&(G=V.call(f,P,U,p,Q,M.width,M.height)),this.fire("comp",Y,P,U,O,f,Q,M)}if(G!==!0&&(O=M.image)&&x[g+"|"+e+"|image"]&&(O[Y]&&(G=O[Y](P,U,p,Q,M.width,M.height)),this.fire("image",Y,P,U,O,D,Q,M)),U._interactPrefix=null,G===!0)break}}},handleClickImage:function(x,O,n,e,r,V,g,S){var z=this.downInfo.hits,Y=S.hits;if(z&&O&&(O=Nd(O))){var y=this.gv,R=g.rect,u=this.convertPoint(V,g);z[x+"|image"]&&(O[n]&&O[n](e,r,y,u,R.width,R.height),this.fire("image",n,e,r,O,D,u,R));for(var a,f=g.compInfos,H=O,L=f.length-1;L>=0;L--){var d=f[L],q=d.comp;u=this.convertPoint(V,d,H,q,y,r),R=d.rect;var o=r._interactPrefix=d.prefix;if(z[x+"|"+L]&&Y[x+"|"+L]){var T=o&&r.a(o+n)||q[n];T&&(a=T.call(q,e,r,y,u,R.width,R.height)),this.fire("comp",n,e,r,O,q,u,R)}if(a!==!0&&(O=R.image)&&z[x+"|"+L+"|image"]&&(O[n]&&(a=O[n](e,r,y,u,R.width,R.height)),this.fire("image",n,e,r,O,D,u,R)),r._interactPrefix=null,a===!0)break}}},initImageResource:function(){m.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(i,L){if(!i)return{x:1/0,y:1/0};var H=L.bodyInfo.rect,P=i.clone(),e=i.multiply({x:H.width,y:H.height});return e.local=P,e},convertPoint:function(p,y,T,_,B,I){var n=y.rect,P=y.matrix.applyInverse(p).sub(n),H=P.x>=0&&P.y>=0&&P.x<=n.width&&P.y<=n.height;if(!H)return P;if(_&&$b(_.pixelPerfect,I,B)){var n,A=1;this._is2d?(A=B.getZoom(),n=Lr(p.x,p.y,D,A)):n=Lr(p.x,p.y);var S=!1,N=n.x,u=n.y,l=n.width,O=n.height,g=m.hitMaxArea,f=l*O*A*A;if(f>g){var w=Math.sqrt(g/f);A*=w}l*=A,O*=A,2>l&&(l=2),2>O&&(O=2),N*=A,u*=A;var z=ri(l,O),e=new Qh(0,-N,-u,A,A);e.append(y.matrix),B._drawForChecking=!0,_.transform=e,y.refRect&&y.refRect.fitSize&&(_.refRect=y.refRect);var q=T.comps;T.comps=[_],Rb(z,T,0,0,l,O,I,self),T.comps=q,delete _.refRect,delete _.transform,B._drawForChecking=!1;try{for(var E=0,s=z.getImageData(0,0,l,O).data;E<s.length;E+=4)if(0!==s[E+3]){S=!0;break}z.restore()}catch(J){el=G,S=!1}P.inRect=S}else P.inRect=!0;return P}});var Yi=hg.DefaultInteractor=function(Z){ln(Yi,this,[Z])};zp("DefaultInteractor",Ql,{handle_mousedown:function(K){Ji(K);var W=this,M=W.gv,U=M.getDataAt(K);if(M.setFocus(K)&&!M._editing&&!M._scrolling){bb(K)?M.handleDoubleClick(K,U):M.handleClick(K,U);var T=Jn(K);!tk()&&!T&&U&&(M.isMovable(U)||M._39Q(U))||!M.isPannable()||!Cm(K)&&!T||hi(K)||(W._tx=M.tx(),W._ty=M.ty(),W.startDragging(K))}},handleWindowMouseUp:function(d){var o=this,l=o.gv;l._panning&&(delete l._panning,l.onPanEnded(),o.fi({kind:"endPan",event:d})),delete o._tx,delete o._ty,o.clearDragging()},handle_mousemove:function(z){var L=this,i=L.gv;L._hoverTimer&&(ii(L._hoverTimer),delete L._hoverTimer),L._hoverTimer=Qi(function(){L.fi({kind:"hover",event:z}),ii(L._hoverTimer),delete L._hoverTimer},i.getHoverDelay()||m.hoverDelay)},handle_mouseleave:function(){var z=this;z._hoverTimer&&(ii(z._hoverTimer),delete z._hoverTimer)},handle_touchmove:function(z){this.handle_mousemove(z)},handleWindowMouseMove:function(m){var y=this,b=y.gv;y.fi({kind:b._panning?"betweenPan":"beginPan",event:m}),b._panning=1;var x=Fm(b,m,y._lastClientPoint);b.setTranslate(y._tx+x.x,y._ty+x.y)},handle_mousewheel:function(b){this.gv.handleScroll(b,b.wheelDelta)},handle_DOMMouseScroll:function(g){2===g.axis&&this.gv.handleScroll(g,-g.detail)},handle_keydown:function(h){this.gv.handleKeyDown(h)}});var Zq=hg.SelectInteractor=function(W){ln(Zq,this,[W])};zp("SelectInteractor",Ql,{_42:function(){var w=this,B=w.gv,D=B.getZoom(),j=w.mark,A=w.div;A||(A=w.div=Ic(),ar(w.getView(),A));var Z={};Z.x=j.x*D+B.tx(),Z.y=j.y*D+B.ty(),Z.width=j.width*D,Z.height=j.height*D,ne(A,Z),this.intersects()?(A.style.border="",A.style.background=B.getRectSelectBackground()):(A.style.background="",A.style.border="1px solid "+B.getRectSelectBorderColor())},handle_mousedown:function(b){var u=this,s=u.gv;if(u._57I=G,u.pendingClickThrough=G,!(s._editing||s._scrolling||tk()||Jn(b))){var r=s.getDataAt(b),H=s.sm();r?hi(b)?H.co(r)?H.rs(r):H.as(r):H.co(r)?r instanceof Ep&&r.isClickThroughEnabled()&&Cm(b)&&(u.pendingClickThrough=Lp(b)):H.ss(r):hi(b)||!s.isPannable()?Cm(b)&&(hi(b)||H.cs(),s.isRectSelectable()&&(u.startDragging(b),s._77O=1)):Cm(b)&&(u._57I=Lp(b))}},handle_mouseup:function(k){var Z=this,D=Z.gv,v=Z._57I;if(v&&(qj(v,Lp(k))<=1&&D.sm().cs(),Z._57I=G),Z.pendingClickThrough){if(qj(Z.pendingClickThrough,Lp(k))<=1){var r=D.getDataAt(k);if(r instanceof Ep&&r.isClickThroughEnabled()){var j=D.getDataAt(k,function(z){var W=z.getParent()===r&&D.isSelectable(z,!0);return W});j&&(k.clickThrough=!0,D.sm().ss(j))}}Z.pendingClickThrough=G}},handleWindowMouseUp:function(Y){this.clear(Y)},handleWindowMouseMove:function(y){var l=this,C=l.gv;l._logicalPoint=C.lp(y),l.mark?(l.fi({kind:"betweenRectSelect",event:y}),C.isPannable()&&l.autoScroll(y),l.redraw()):l.fi({kind:"beginRectSelect",event:y}),l.mark=Ip(l._lastLogicalPoint,l._logicalPoint),l.redraw()},intersects:function(){var S=this,f=S._lastLogicalPoint,G=S._logicalPoint;return f.x>G.x||f.y>G.y},clear:function(U){var Q=this,C=Q.gv,J=Q.mark;if(Q._57I=G,Q.pendingClickThrough=G,Q._lastLogicalPoint){if(J){if(0!==J.width&&0!==J.height){var x=C.getDatasInRect(J,Q.intersects());if(!x.isEmpty()){var N=C.sm(),l=N.toSelection();x.each(function(f){N.co(f)?l.remove(f):l.add(f)}),N.ss(l)}}Rl(Q.div),delete Q.div,delete Q.mark,Q.redraw(),Q.fi({kind:"endRectSelect",event:U}),C.onRectSelectEnded()}Q.clearDragging(),delete C._77O}},redraw:function(){var z=this;z._draw||(z._draw=1,Qi(function(){z.mark&&z._42(),delete z._draw},16))}});var Ir=hg.MoveInteractor=function(t){ln(Ir,this,[t])};zp("MoveInteractor",Ql,{handle_mousedown:function(q){var d=this,c=d.gv;if(Cm(q)&&!c._editing&&!c._scrolling&&!tk()){var j=c.getSelectedDataAt(q);!j||c._39Q(j)&&!c.isMovable(j)?c._focusData=G:(d._data=j,c.handleMouseDown&&c.handleMouseDown(q,j),d.startDragging(q),c.isMovable(j)&&(c._moving=1))}},handleWindowMouseUp:function(c){var C=this,X=C.gv;X.handleMouseUp&&X.handleMouseUp(c,C._data),C.clear(c)},handleWindowMouseMove:function(h){var U=this,m=U._data,J=U.gv;if((!J._93O||!J._93O(h,m))&&J._moving){U._logicalPoint||U.fi({kind:"prepareMove",event:h});var i=U._logicalPoint?"betweenMove":"beginMove",t={kind:i,event:h},T=U._logicalPoint=J.lp(h);"beginMove"!==i||U._alreadyBeginTransaction||(U._alreadyBeginTransaction=!0,J.getDataModel().beginTransaction());var K=U._calcShift(i,h),W=K.x,q=K.y,y=U.gv.getMoveMode(h,m);y&&("x"===y?q=0:"y"===y?W=0:"xy"!==y&&(W=q=0)),J.moveSelection(W,q),U._lastLogicalPoint=T,U.autoScroll(h),U.fi(t)}},_calcShift:function(){var d=this,R=d._logicalPoint,i=d._lastLogicalPoint,e=R.x-i.x,W=R.y-i.y;return{x:e,y:W}},clear:function(b){var Y=this,h=Y.gv;Y._lastLogicalPoint&&(Y._lastLogicalPoint=Y._data=h._moving=G,Y._logicalPoint&&(Y.fi({kind:"endMove",event:b}),h.onMoveEnded()),Y.clearDragging()),Y._alreadyBeginTransaction&&(Y._alreadyBeginTransaction=!1,h.getDataModel().endTransaction())}});var Rk=hg.TextEditInteractor=function(g){ln(Rk,this,[g]),this.init()};zp("TextEditInteractor",Ql,{init:function(){var S=this,m=this.input=s.createElement("input"),e=m.style;m.text="text",e.border="1px solid #d8d8d8",e.position="absolute",e.padding="2px 3px",e.outline="none",e.marginLeft="-90px",e.marginTop="-16px",e.backgroundColor="rgba(255,255,255, 0.9)",e.fontSize="14px",e.width="180px",e.height="32px",e.boxShadow="0 0 13px rgba(16,142,233, 0.5)",e.textAlign="center",e.boxSizing="border-box",$(m,"keyup",function(r){lr(r)&&S.endTextEdit()}),$(m,"focus",function(){m.select()});var L=this.textarea=s.createElement("textarea"),u=this.wrap=s.createElement("div");u.appendChild(L),e=L.style,e.margin=0,e.padding="4px",e.overflow="hidden",e.boxSizing="border-box",e.position="absolute",e.outline="none",e.backgroundColor="transparent",e.resize="none",e.textAlign="center",e.fontSize="14px",e.border="none",e.borderWidth=0,e.width="100%",e.top="50%",e=u.style,e.boxSizing="border-box",e.margin=0,e.padding=0,e.position="absolute",e.boxShadow="0 0 13px rgba(16,142,233, 0.5)",e.border="1px solid #d8d8d8",e.backgroundColor="rgba(255,255,255, 0.9)",e.width="180px",e.marginLeft="-90px",$(L,"keydown",function(s){return(Fj()||hi())&&lr(s)?(S.endTextEdit(),void 0):(S.calculateTextareaHeight(String.fromCharCode(s.keyCode)),void 0)}),$(L,"focus",function(){L.select()});var l=function(J){J.stopPropagation()};$(m,"mousedown",l),$(m,"touchstart",l),$(L,"mousedown",l),$(L,"touchstart",l),S.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],S.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",S.handleWindowClick=function(v){var M=S._editingDOM;if(M){var O=M.getBoundingClientRect(),I=Lp(v);uq(O,I)||S.endTextEdit()}}},handle_mousedown:function(_){var h=this,E=h.gv;if(bb(_)&&!E._editing){var g=E.getDataAt(_);if(g){var o=E.getTextEditInfo(g);o&&(this._editInfo=o,this._editTarget=g,E._editing=!0,o.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var j=this,S=j.gv,Q=j._editTarget,R=j.getTargetValue(),o=j.textarea,M=j.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===R||R===D)&&(R=""),o.value=R,j._editingDOM=o,S.getView().appendChild(M),this.layoutHTML(M,Q),this.calculateTextareaHeight(),Qi(function(){o.focus(),$(_,"mousedown",j.handleWindowClick),$(_,"touchstart",j.handleWindowClick)},10)},handleTextEdit:function(){var k=this,r=k.gv,R=k._editTarget,A=k.getTargetValue(),v=k.input;(null===A||A===D)&&(A=""),v.value=A,k._editingDOM=v,r.getView().appendChild(v),this.layoutHTML(v,R),Qi(function(){v.focus(),$(_,"mousedown",k.handleWindowClick),$(_,"touchstart",k.handleWindowClick)},10)},layoutHTML:function(t,m){var $=this.gv,k=$.getZoom();if(m instanceof q.Node){var R=m.getRect();t.style.left=(R.x+R.width/2)*k+$.tx()+"px",t.style.top=(R.y+R.height/2)*k+$.ty()+"px"}else if(m instanceof q.Edge){var l=$.getDataUI(m),R=l._6I;t.style.left=(R.x+R.width/2)*k+$.tx()+"px",t.style.top=(R.y+R.height/2)*k+$.ty()+"px"}},endTextEdit:function(){var f=this,t=f._editInfo.isMultiline?f.wrap:f.input,x=f._editInfo.isMultiline?f.textarea:f.input;f.setTargetValue(x.value),f.gv.getView().removeChild(t),f.gv._editing=!1,delete f._editingDOM,J(_,"mousedown",f.handlelick),J(_,"touchstart",f.handleWindowClick)},setTargetValue:function(Q){var d=this,n=d._editTarget,U=d._editInfo,f=U.accessType,t=U.name;if(t&&f||(f="p",t="name"),"p"===f){var F=q.Default.setter(t);n[F](Q)}else"a"===f?n.a(t,Q):n.s(t,Q)},getTargetValue:function(){var p=this,o=p._editTarget,i=p._editInfo,j=i.accessType,w=i.name;if(w&&j||(j="p",w="name"),"p"===j){var g=q.Default.getter(w);return o[g]()}return"a"===j?o.a(w):o.s(w)},createHiddenTextarea:function(){this.hiddenTextarea=s.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(V,h){if(h&&this.computedStyleCache)return this.computedStyleCache;var u=this,W=_.getComputedStyle(V),N=W.getPropertyValue("box-sizing")||W.getPropertyValue("-moz-box-sizing")||W.getPropertyValue("-webkit-box-sizing"),X=parseFloat(W.getPropertyValue("padding-bottom"))+parseFloat(W.getPropertyValue("padding-top")),Q=parseFloat(W.getPropertyValue("border-bottom-width"))+parseFloat(W.getPropertyValue("border-top-width")),i=u.SIZING_STYLE.map(function(p){return p+":"+W.getPropertyValue(p)}).join(";"),f={sizingStyle:i,paddingSize:X,borderSize:Q,boxSizing:N};return h&&(this.computedStyleCache=f),f},calculateTextareaHeight:function(J){J=J||"";var s=this,B=s.textarea,m=s.hiddenTextarea,k=s.wrap,l=32,u=s.calculateHTMLStyle(B,!1),W=u.paddingSize,i=u.borderSize,V=u.boxSizing,O=u.sizingStyle;m.setAttribute("style",O+";"+s.HIDDEN_TEXTAREA_STYLE),m.value=B.value+J;var c=m.scrollHeight;"border-box"===V?c+=i:"content-box"===V&&(c-=W),B.style.height=c+"px",B.style.marginTop=0-.5*c+"px",k.style.height=Math.max(c,l)+"px",k.style.marginTop=c*-.5+"px"}});var fs=hg.ScrollBarInteractor=function(z){ln(fs,this,[z])};zp("ScrollBarInteractor",Ql,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(n){var Z=this.gv.getViewRect();return this._41o()&&(Z.x+Z.width-this.gv.lp(n).x)*this.gv.getZoom()<Tj},isH:function(m){var z=this.gv.getViewRect();return this._40o()&&(z.y+z.height-this.gv.lp(m).y)*this.gv.getZoom()<Tj},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(s){if(!Mg&&Cm(s)&&this.gv.isScrollBarVisible()){var q=this,C=q.isV(s),b=q.isH(s);(C||b)&&q.gv.showScrollBar(),q.gv._scrolling=C||b}},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(q){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=G,this.fi({kind:"endScroll",event:q})},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function($){var k=this;if(k.gv.setFocus($),Ji($),k.handle_touchmove($),!(fm($)>1)&&k.gv._scrolling&&k.gv.isScrollBarVisible()){k._cp=Lp($),k._tx=k.gv.tx(),k._ty=k.gv.ty();var h=k.isV($);k._state=h?"vScroll":"hScroll",nr(k,$),k.fi({kind:"beginScroll",event:$})}},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(B){var M=Lp(B),w=this.gv.getViewRect(),h=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-M.y)*h.height/w.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-M.x)*h.width/w.width),this.fi({kind:"betweenScroll",event:B})}});var wl=hg.TouchInteractor=function(k,C){C=C||{},C.selectable===D&&(C.selectable=!0),C.movable===D&&(C.movable=!0),C.pannable===D&&(C.pannable=!0),C.pinchable===D&&(C.pinchable=!0),C.editable===D&&(C.editable=!0),this.params=C,ln(wl,this,[k])};zp("TouchInteractor",Ql,{ms_edit:1,setUp:function(){var _=this;wl.superClass.setUp.call(_),yr&&_.params.editable&&_.gv.setEditInteractor(_)},tearDown:function(){var L=this;wl.superClass.tearDown.call(L),yr&&L.params.editable&&L.gv.setEditInteractor(G)},clear:function(j){var A=this,w=A.gv;w._moving&&(A.fi({kind:"endMove",event:j}),delete w._moving,w.onMoveEnded(),w.dm().endTransaction()),w._panning&&(A.fi({kind:"endPan",event:j}),delete w._panning,w.onPanEnded()),w._pinching&&(A.fi({kind:"endPinch",event:j}),delete w._pinching,w.onPinchEnded()),w._editing&&(A._46O(j),A._77I=A._node=A._edge=A._shape=A._rect=A._89I=A._index=w._editing=G),A.pendingClickThrough=A._moving=A._panning=A._pinching=A._editing=A._57I=A._data=A._beginHistory=G,A.clearDragging()},handle_touchstart:function(_){var c=this;if(!c.gv._editing){Ji(_),c._57I=G,c.pendingClickThrough=G;var d=c.params,U=c.gv,T=U.sm(),O=U.getDataAt(_),W=fm(_);if(1===W){if(bb(_))return U.handleDoubleClick(_,O),void 0;U.handleClick(_,O),O&&(U.handleMouseDown&&U.handleMouseDown(_,O),c._data=O),d.selectable||(O=G),O&&(T.co(O)?O instanceof Ep&&O.isClickThroughEnabled()&&(c.pendingClickThrough=Lp(_)):T.ss(O),d.editable&&U.isEditable(O)&&c._79I(_,O,!0)?(c._editing=1,c.startDragging(_)):d.movable&&U.isMovable(O)&&(c._moving=1,c.startDragging(_))),O&&U.isMovable(O)||(c._57I=Lp(_),d.pannable&&U.isPannable()&&(c._panning=1,c.startDragging(_),c._translate={x:U.tx(),y:U.ty()}))}else if(d.pinchable&&2===W){if(O&&U._39Q(O))return;c._pinching=1,c.startDragging(_);var b=U.getView(),w=U.getZoom(),Y=b.getBoundingClientRect(),M=_.touches[0],C=_.touches[1],F={x:(M.clientX+C.clientX)/2-Y.left,y:(M.clientY+C.clientY)/2-Y.top};F.x-=U.tx(),F.y-=U.ty(),F.x/=w,F.y/=w,c._p=F,c._d=vl(_)}}},handle_touchend:function(c){var P=this,z=P.gv,X=P._57I,H=P._data;if(X&&(qj(X,Lp(c))<=1&&!z.getDataAt(c)&&z.sm().cs(),P._57I=G),H&&z.handleMouseUp&&z.handleMouseUp(c,H),P.pendingClickThrough){if(qj(P.pendingClickThrough,Lp(c))<=1){var H=z.getDataAt(c);if(H instanceof Ep&&H.isClickThroughEnabled()){var o=z.getDataAt(c,function(h){var p=h.getParent()===H&&z.isSelectable(h,!0);return p});o&&(c.clickThrough=!0,z.sm().ss(o))}}P.pendingClickThrough=G}},handleWindowTouchEnd:function(U){this.clear(U)},handleWindowTouchMove:function(k){var V=this,B=V.gv,d=fm(k);if(1===d){var I=Lp(k),H=Fm(B,I,V._lastClientPoint),u=qj({x:0,y:0},H);if(V._editing&&(V._beginHistory||(V._beginHistory=1,B.dm().beginTransaction()),B._editing=1,V._78I(k)),V._moving){if(!B._moving&&u<m.touchMoveThreshold)return;V._beginHistory||(V._beginHistory=1,B.dm().beginTransaction()),V.handleMove(k)}else if(V._panning){if(!B._panning&&u<m.touchMoveThreshold)return;B.setTranslate(V._translate.x+H.x,V._translate.y+H.y),V.fi({kind:B._panning?"betweenPan":"beginPan",event:k}),B._panning=1}}else if(2===d&&V._pinching){var Z=vl(k);B.handlePinch(V._p,Z,V._d),V._d=Z,V.fi({kind:B._pinching?"betweenPinch":"beginPinch",event:k}),B._pinching=1}},handleMove:function(h){var D=this,X=D.gv,m=X.lp(h);X._93O&&X._93O(h,D._data)||(X.moveSelection(m.x-D._lastLogicalPoint.x,m.y-D._lastLogicalPoint.y),D._lastLogicalPoint=m,D.autoScroll(h),D.fi({kind:X._moving?"betweenMove":"beginMove",event:h}),X._moving=1)}});var q=_.ht,gk=q.graph._editor={Math:q.Math,Guide:{}};gk.getStyle=function(k){var x,h=gk.StyleMap;return h&&(x=h[k],x!==D)?x:gk.DefaultStyleMap[k]},gk.setStyle=function(i,c){var N=gk.StyleMap;N||(N=gk.StyleMap={}),N[i]=c},gk.inEdit=function(f){return f._inXEdit===!0},gk.startEdit=function(t){t._inXEdit=!0,gk.Inject.doInject(t)},gk._46O=function(m){m._inXEdit=!1,gk.Inject.undoInject(m)},gk.toScreenPosition=function(A,V){var a=A.tx(),j=A.ty(),i=A._zoom;return new gk.Math.Vector2(V.x*i+a,V.y*i+j)},gk.checkHit=function(m,Q,q){return m.distanceTo(Q)<q?!0:!1},gk.toWorldPosition=function(v,B){var q=v.tx(),J=v.ty(),_=v._zoom;return{x:(B.x-q)/_,y:(B.y-J)/_}},gk.setAntialias=function(e,m){for(var S,j=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],K=0,r=j.length;r>K&&(S=j[K],!(S in e));K++);e[S],e[S]=m},gk.getTargetCornersOnScreen=function(k,Y){if(!Y)return null;var H,E=[];if(af(Y,k)){var T=Dj(k,Y);H=[{x:T.x,y:T.y},{x:T.x+T.width,y:T.y},{x:T.x+T.width,y:T.y+T.height},{x:T.x,y:T.y+T.height}]}else{if(!Y.getCorners)return null;H=Y.getCorners()}return H.forEach(function(o){var S=gk.toScreenPosition(k,o);E.push(S.x,S.y)}),E},gk.log=function(){};var Il=gk.Inject={_modules:[]};Il.registAsModule=function(i,s){var v={},d={};for(var B in i){var N=s.prototype[B];v[B]=N}i.getBackup=function(N){return v[N]},i.getBackups=function(){return v},d.doInject=function(){for(var Y in i)"getBackup"!==Y&&(s.prototype[Y]=i[Y])},d.undoInject=function(){for(var M in i)"getBackup"!==M&&(s.prototype[M]=v[M])},Il._modules.push(d)},Il.doInject=function(T){for(var l,Y=Il._modules,G=0,b=Y.length;b>G;G++)l=Y[G],l.doInject(T)},Il.undoInject=function(_){for(var k,x=Il._modules,t=0,f=x.length;f>t;t++)k=x[t],k.undoInject(_)};var Ql=q.graph.EditInteractor=function(O){var F=this,u=s.createElement("canvas");u.className="editCanvas",u.style.position="absolute",F._uuid=q.Math.generateUUID(),F._styleMap={},F._canvas=u,F._context=u.getContext("2d"),Ql.superClass.constructor.call(F,O),this._editDetail=!1,gk.setAntialias(F._context,!1),F._subModules=[new gk.Anchor(F),new gk.RotateX(F),new gk.MoveDummy(F),new gk.Rect(F),new gk.Curve(F),new gk.MoveHelper(F)],F._gridGuide=new gk.Guide.Grid(F),F._rectGuide=new gk.Guide.Rect(F),F._hoverGuide=new gk.Guide.Hover(F)
},Zo=Ql;q.Default.def(Ql,q.graph.Interactor,{ms_edit:1,ms_fire:1}),t.defineProperties(Ql.prototype,{editDetail:{get:function(){var F=!!this._editDetail;return F},set:function(J){var T=this,l=T._editDetail;l!==J&&(T._editDetail=J,T.gv._editing=J,T.fp("editDetail",l,J),T.fp("pointsEditingMode",l,J),T.fi({kind:J?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(s){(!this._editDetail||s)&&(this.gv._editing=s,s||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(x){this._editing=x,this.gvEditing=x}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(J){var I=this;I.editDetail!==J&&(J?I._tryEnterEditDetailMode():I._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var O=this._gridEnabled;if(!O)return!1;var u=this.gv;return u?!0:!0},set:function(v){v!==this._gridEnabled&&(this._gridEnabled=v,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(h){h!==this._agEnabled&&(this._agEnabled=h,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Ql.prototype.getSubModule=function(G){var D,h,e,y=this._subModules;for(h=0,e=y.length;e>h;h++)if(D=y[h],D.catalog===G)return D},Ql.prototype.invokeSubModule=function(a,c){for(var E,z,U,N=this,i=N._subModules,j=Array.prototype.slice.call(arguments,2),$=0,n=i.length;n>$;$++)if(E=i[$],z=E[a],z&&(U=z.apply(E,j),U!=D&&c))return E},Ql.prototype.invokeSubModuleInverse=function(z,j){var V=this,Z=V._subModules;if(Z)for(var g,t,u,M=Array.prototype.slice.call(arguments,2),l=Z.length-1;l>=0;l--)if(g=Z[l],t=g[z],t&&(u=t.apply(g,M),u!=D&&j))return g},Ql.prototype.setUp=function(){gk.log("setUp");var r=this,W=r.gv,B=W.getView(),z=r._canvas;Ql.superClass.setUp.call(r),W.setEditInteractor(r),W._79O?B.insertBefore(z,W._79O):B.appendChild(z),gk.startEdit(W),r.invokeSubModule("setUp"),W.dm().mm(r._onDataModelChanged,r),W.dm().md(r._onDataPropertyChanged,r)},Ql.prototype.tearDown=function(){gk.log("tearDown");var _=this,P=_.gv,N=P.getView();_._resetCustomCursorStyle(),Ql.superClass.tearDown.call(_),P.dm().umm(_._onDataModelChanged,_),P.dm().umd(_._onDataPropertyChanged,_),P.setEditInteractor(null),N.removeChild(_._canvas),_._drawTimer&&(ii(_._drawTimer),_._drawTimer=null),gk._46O(P),_.invokeSubModule("tearDown")},Ql.prototype._onDataModelChanged=function(h){var c=this;("clear"===h.kind||"remove"===h.kind&&c.editDetail&&h.data===c.getSubModule("Curve").target)&&(c.editDetail=!1,c._42())},Ql.prototype._onDataPropertyChanged=function(p){var D=this;if(D.editDetail){var e=D.getSubModule("Curve"),K=p.data;K===e.target&&(K._writing||e._handleDataChanged(p))}},Ql.prototype.clear=function(){gk.log("clear")},Ql.prototype.redraw=function(){this._42()},Ql.prototype._42=function(){var i=this;i._drawTimer||(i._drawTimer=Qi(function(){i._drawTimer=null,i.drawImpl()},0))},Ql.prototype.drawImpl=function(){var a;for(a in{_42:!0})break;return function(){var U=this,N=U._canvas,Z=U.gv,w=Z.getWidth(),g=Z.getHeight(),H=U._context,L=q.Default.getInternal(),O=m.devicePixelRatio;(N.width!==w||N.height!==g)&&L.setCanvas(N,w,g,O),H.clearRect(0,0,N.width,N.height);var u=U._getValidSelection();H.save(),H.scale(O,O),U._gridGuide._42(),U.invokeSubModuleInverse(a,!1,H,Z,u),U._rectGuide._42(),U._hoverGuide._42(),H.restore()}}(),Ql.prototype._getValidSelection=function(){var R=this,E=R.gv,_=E.sm().getSelection(),f=[];return _.each(function(V){E.isVisible(V)&&E.isEditable(V)&&f.push(V)}),f},Ql.prototype.handle_touchmove=function(k){return this.handle_mousemove(k)},Ql.prototype.handle_mousemove=function(h){if(!q.Default.isDragging()){var k=this;if((k.editDetail||!tk()&&!Jn(h))&&!k.gv._externalEditing)if(k.gvEditing=!1,k._checkEdit(h))k.gvEditing=!0;else{if(!k.getStyle("hoverGuideVisible"))return;k.hoverData=k.gv.getDataAt(h),k._42()}}},Ql.prototype.handle_touchstart=function(L){return this.handle_mousedown(L)},Ql.prototype.handle_mousedown=function(R){Ji(R);var h=this;if((h.editDetail||!tk()&&!Jn(R))&&!h.gv._externalEditing){if(bb(R)&&!R.clickThrough){if(h.editDetail){if(h._tryQuitEditDetailMode(R))return}else if(h._tryEnterEditDetailMode())return;h.gv.dm().beginTransaction();var J=h.invokeSubModule("handleDoubleClick",!0,R);if(h.gv.dm().endTransaction(),J)return}var t=h._checkEdit(R);t&&(h._downPosition=h._getLogicalPoint(R),h.gv.dm().beginTransaction(),t.startEdit(h,R),h.editing=!0)}},Ql.prototype._checkEdit=function(Q){var J=this,m=J.gv,e=J._getLogicalPoint(Q),u=J.invokeSubModule("check",!0,m,Q,e)||null;return J._editMod=u,u},Ql.prototype.handleWindowTouchMove=function(r){return this.handleWindowMouseMove(r)},Ql.prototype.handleWindowMouseMove=function(n){var i=this,Q=i._downPosition;if(Q){var W=i._getLogicalPoint(n);if(W.distanceTo(Q)<i.getStyle("moveSensitivity"))return;delete i._downPosition}var G=i._editMod;G&&G.handleEdit(i.gv,n)},Ql.prototype._getLogicalPoint=function(y){var E=this,X=q.Default.getLogicalPoint(y,E._canvas);return new gk.Math.Vector2(X)},Ql.prototype.handleWindowTouchEnd=function(j){return this.handleWindowMouseUp(j)},Ql.prototype.handleWindowMouseUp=function(){var g;for(g in{_46O:!0})break;return function(H){var e=this;e.editing=!1,e.setCursor("default"),e.invokeSubModule(g,!1,H),e._42(),e.gv.dm().endTransaction()}}(),Ql.prototype.handle_mousewheel=function(M){var E=this;Ji(M),E.invokeSubModule("preHandleScroll",!0)||E.gv.handleScroll(M,M.wheelDelta)},Ql.prototype.handleDelete=function(){var L=this;if(!L.editDetail){L.gv.dm().beginTransaction();var k=L.invokeSubModule("handleNormalStateDelete",!0);return L.gv.dm().endTransaction(),k||L.gv.removeSelection(),void 0}L.gv.dm().beginTransaction(),L.invokeSubModule("handleDelete",!0),L.gv.dm().endTransaction(),L._42()},Ql.prototype.handle_keydown=function(b){var w=this;if((b.metaKey||b.ctrlKey)&&w._42(),tk(b)&&!w.editing)return w.gvEditing=!1,w.setCursor("default"),w._42(),void 0;var q=lr(b);return w.editDetail?((q||fp(b))&&(w.editDetail=!1,w._42()),w.gv.dm().beginTransaction(),w.invokeSubModule("handle_keydown",!0,b),w.gv.dm().endTransaction(),void 0):(w.gv.dm().beginTransaction(),w.invokeSubModule("handleNormalStateKeyDown",!0,b),w.gv.dm().endTransaction(),q&&w._tryEnterEditDetailMode(),void 0)},Ql.prototype.handle_keyup=function(f){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,f),this.gv.dm().endTransaction()},Ql.prototype._tryEnterEditDetailMode=function(){var F=this;return!F.editDetail&&F.invokeSubModule("canEnterEditDetailMode",!0)&&1===F._getValidSelection().length?(F.editDetail=!0,F._42(),!0):void 0},Ql.prototype._tryQuitEditDetailMode=function(o){var T=this;return T.editDetail?!o||T.invokeSubModule("canQuitEditDetailMode",!0,o)?(T.editDetail=!1,T._42(),!0):!1:!1},Ql.prototype.setStyle=function(W,w,J){var P=this;J?gk.setStyle(W,w):P._styleMap[W]=w,"baseColor"===W&&(Kb=w),P.fp("styleChanged",null,{key:W,value:w,base:J}),P._42()},Ql.prototype.getStyle=function(Q){var R=this,A=R._styleMap[Q];return A!==D?A:gk.getStyle(Q)},Ql.prototype.setCursor=function(C){this._resetCustomCursorStyle(),q.graph.EditInteractor.superClass.setCursor.call(this,C)},Ql.prototype._drawHostGuide=function(v){var u=this,s=u._context,S=u.gv;gk.Icons.DrawIcon(u,s,gk.Icons.NodeHoverGuide,v.corners);var o=v.host;if(o){var r=S.getAttachPoints(o);if(r&&r.length)for(var $=0,t=r.length;t>$;$++){var j=r[$],q=Pj(S,o,0,j.offsetX||0,j.offsetY||0,j.x,j.y);q=gk.toScreenPosition(S,q),q.isAttach=v.attach===$,gk.Icons.DrawIcon(u,s,gk.Icons.AttachPoint,q)}}},Ql.prototype._resetCustomCursorStyle=function(){var d=this;if(d._customStyle){var h=this.gv.getView();h.classList&&h.classList.remove&&h.classList.remove(d._customStyle),d._customStyle=null}},Ql.prototype._setRotateCursor=function(d){var n=this,g=n._cursorFactory;g||(g=n._cursorFactory=new gk.CursorFactory(n));var A=g.getRotateCursor(d),z=n.gv.getView();n._resetCustomCursorStyle(),n._customStyle=A,z.classList&&z.classList.add&&z.classList.add(A)};var pc=gk.Group=function(m){var x=this;x._entities=m,x._64O=0,x._position={x:0,y:0},x._scale={x:1,y:1},x._anchor={x:.5,y:.5},x._anchor2={x:.5,y:.5}};pc.prototype={},pc.prototype.constructor=pc;var fe=null,Lg=null;pc.findOrCreateGroup=function(O,m){if(Lg===m&&fe&&fe.checkIsMe(O))return fe;Lg=m;var x=new gk.Group(O);return x.getKeyOb()?(fe=x,x):void 0},pc.prototype.checkIsMe=function(T){var P=this._entities;if(P.length!==T.length)return!1;var I,d={},K=T.length;for(I=0;K>I;I++)d[T[I]._id]=!0;for(I=0;K>I;I++)if(!d[P[I]._id])return!1;return!0},pc.prototype.getRotation=function(){return this._64O},pc.prototype.getPosition=function(){return this._position},pc.prototype.getAnchor=function(){return this._anchor},pc.prototype.getWidth=function(){return this._width},pc.prototype.getScale=function(){return this._scale},pc.prototype.getSize=function(){return{width:this._width,height:this._height}},pc.prototype.getHeight=function(){return this._height},pc.prototype.getKeyOb=function(){for(var _=this._entities,p=_.length-1;p>=0;p--){var j=_[p];if(this.isNode(j))return j}},pc.prototype.getAnchor2=function(){var X=this,P=X.rotateCenter;if(P)return P;var J=X.getKeyOb();if(!J)return X._anchor;var l=X._anchor2,A=J.getMatrix();return A.tf({x:J.getWidth()*(l.x-J.getAnchor().x),y:J.getHeight()*(l.y-J.getAnchor().y)})},pc.prototype.setAnchor2=function(l,M){var N=this,u=N.getKeyOb();if(u){var e,q=u.getMatrix();e="number"==typeof l?{x:l,y:M}:l;var Z=q.tfi(e);N._anchor2={x:u.getAnchor().x+Z.x/u.getWidth(),y:u.getAnchor().y+Z.y/u.getHeight()}}},pc.prototype.setRotation=function(){},pc.prototype.beginRotate=function(V){this.rotateCenter=V.pos,this.rotateMode=V.groupRotateMode},pc.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},pc.prototype.addRotation=function(v,T,_){return"batch"===T?this._addRotationInBatchMode(v,_):"block"===T?this._addRotationInBlockMode(v,_):void 0},pc.prototype._addRotationInBlockMode=function(G,u){var j=this,Z=j.rotateCenter||j.getPosition();j._entities.forEach(function(f){if(j.isNode(f)&&(!u||u(f))){var $=f.getMatrix();$.translate(-Z.x,-Z.y),$.rotate(G),$.translate(Z.x,Z.y);var C=Math.sign(f.getScale().x);f.setRotation(pd($.b*C,$.a*C)),f.setPosition($.tx,$.ty)}})},pc.prototype._addRotationInBatchMode=function(i,C){var J=this,T=J._anchor2;J._entities.forEach(function(v){if(J.isNode(v)&&(!C||C(v))){var L=v.getAnchor(),R=v.getMatrix(),B=R.tf({x:v.getWidth()*(T.x-L.x),y:v.getHeight()*(T.y-L.y)}),S=new gk.Math.Matrix2d;S.set(R.a,R.b,R.c,R.d,R.tx,R.ty),S.translate(-B.x,-B.y),S.rotate(i),S.translate(B.x,B.y);var M=Math.sign(v.getScale().x);v.setRotation(pd(S.b*M,S.a*M)),v.setPosition(S.tx,S.ty)}})},pc.prototype.setPosition=function(t){var c,Q,M,s,w=this,q=w._position,r=t.x-q.x,o=t.y-q.y,v=w._entities;for(Q=0,M=v.length;M>Q;Q++)c=v[Q],ge(c)&&(s=c.getPosition(),c.setPosition(s.x+r,s.y+o));w._position=t},pc.prototype.setScale=function(e,W){var M=this,w=e/M._scale.x,G=W/M._scale.y;M._adjustChildScaleOrSize(w,G,"size"),M._scale={x:e,y:W}},pc.prototype.getRect=function(){var f=this,c=f._position,R=f._width,t=f._height;return{x:c.x-R/2,y:c.y-t/2,width:R,height:t}},pc.prototype.setSize=function(C,M){var j=this,C=Math.max(1,C),M=Math.max(1,M),_=C/j._width,k=M/j._height;j._adjustChildScaleOrSize(_,k,"size"),j._width=C,j._height=M},pc.prototype._adjustChildScaleOrSize=function(F,c,L){var T,M,B,p,n,N,a,O,y,W,I,h,v,J,j=this,l=j._position,m=j._entities,G=new gk.Math.Matrix2d;for(M=0,B=m.length;B>M;M++)if(T=m[M],j.isNode(T)){if(p=T.getPosition(),n=T.getRotation(),N=T.getWidth(),a=T.getHeight(),O=T.getScale(),I=O.x*N,h=O.y*a,G.identity().scale(I,h).rotate(n).translate(p.x,p.y).translate(-l.x,-l.y).rotate(-j._64O),n=pd(G.b*Math.sign(I),G.a*Math.sign(I)),G.scale(F,c),y=Math.cos(n),W=Math.sin(n),Math.abs(y)<.001?(v=G.b/W,J=-G.c/W):(v=G.a/y,J=G.d/y),"scale"===L)T.setScale(v/N,J/a);else if("size"===L){var C=v/O.x,Z=J/O.y;T.setScale(ij(v)*Math.abs(O.x),ij(J)*Math.abs(O.y)),T.setSize(Math.max(.1,Math.abs(C)),Math.max(.1,Math.abs(Z)))}G.rotate(j._64O).translate(l.x,l.y),T.setPosition(G.tx,G.ty)}},pc.prototype.getMatrix=function(){var I=this,Q=I._position,d=q.Default.getInternal(),w=I._scale;return new d.Mat(I._64O,Q.x,Q.y,w.x,w.y)},pc.prototype.toGlobal=function(d){return this.getMatrix().tf(d)},pc.prototype.getCorners=function(){var Z=this,o=Z._width,_=Z._height,J=Z._anchor,w=-o*J.x,n=-_*J.y,X=Z.getMatrix();return[X.tf(w,n),X.tf(w,n+_),X.tf(w+o,n+_),X.tf(w+o,n)]},pc.prototype.calcInfo=function(){var Q,W,S,n,o,X,w=this,R=[],M=w._entities,i=w._64O;for(n=0,o=M.length;o>n;n++)X=M[n],w.isNode(X)&&X.getCorners&&R.push.apply(R,X.getCorners());if(R.length){var e=Math.cos(-i),F=Math.sin(-i),Z=1/0,z=-1/0,N=1/0,G=-1/0;for(n=0,o=R.length;o>n;n++)S=R[n],Q=S.x,W=S.y,S.x=e*Q-F*W,S.y=F*Q+e*W,Z=Math.min(Z,S.x),z=Math.max(z,S.x),N=Math.min(N,S.y),G=Math.max(G,S.y);w._width=(z-Z)/w._scale.x,w._height=(G-N)/w._scale.y,e=Math.cos(i),F=Math.sin(i);var p=w._anchor;Q=Z+(z-Z)*p.x,W=N+(G-N)*p.y,w._position={x:e*Q-F*W,y:F*Q+e*W}}},pc.prototype.isNode=function(q){return ge(q)?af(q)?q.size()?!1:!0:!0:!1},pc.prototype._42=function(u,c,j){var T,Q,B,W,h,n,J,t,k=this,Y=k._entities,g=k.rotateMode;for("batch"===g&&(t=k.getKeyOb()),T=0,Q=Y.length;Q>T;T++)B=Y[T],k.isNode(B)&&(n=B.getRect(),W=gk.toScreenPosition(j,{x:n.x,y:n.y}),h=gk.toScreenPosition(j,{x:n.x+n.width,y:n.y+n.height}),J={min:W,max:h},B===t&&(J.isKeyOb=!0),gk.Icons.DrawIcon(u,c,gk.Icons.GroupSubEntityRect,J))};var Cq=gk.CurveActiving=function(Y,T){this._curve=Y,this._interactor=Y._interactor,this.silent=!0;for(var R in T)this[R]=T[R];delete this.silent};Cq.prototype={},Cq.prototype.constructor=Cq,t.defineProperties(Cq.prototype,{point:{get:function(){return this._point},set:function(r){var A=this;A._point=r,A.editingCtrl||A.silent||A._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(n){var K=this;K._pairs=n,K.editingCtrl&&!K.silent&&K._firePointChange()}}}),Cq.prototype._firePointChange=function(){var b=this,d=b.getCurrentEditingPoint(),J=b._interactor;if(!d)return J.fi({kind:"selectPoint"}),void 0;var k=this._curve.target;if(k){var R=gk.getDataMatrix(k).invert(),v=d.e;d=R.apply(gk.toWorldPosition(J.gv,d)),d.e=v;var X=b._lastFirePoint;X&&Math.abs(d.x-X.x)<1e-5&&Math.abs(d.y-X.y)<1e-5&&(d.e==D&&X.e==D||Math.abs(d.e-X.e)<1e-5)||(b._lastFirePoint=d,J.fi({kind:"selectPoint",x:d.x,y:d.y,e:d.e}))}},Cq.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Cq.prototype.getCurrentEditingPoint=function(){var p=this,u=p.editingCtrl;if(u){var G=p.pairs;if(G){var E=G[u.pairId];if(E){var N=E[u.type];if(N)return N}}}return p._point};var dq=gk.CursorFactory=function(z){var $=this;$._interactor=z,$._rotateCursorStyles={}};dq.prototype={},dq.prototype.constructor=dq,dq.prototype.getRotateCursor=function(L){var T=this;0>L&&(L+=2*Math.PI);var i=T._interactor,R=i.getStyle("rotateCursorSize"),l=i.getStyle("rotateCursorRound"),j=Math.round(180*(L/Math.PI)/l);j*l>=360&&(j=0);var X=T._rotateCursorStyles,M="htCustomRotateStyle_"+R+"_"+l+"_"+j;return X[M]||(T._produceRotateCursor(M,R,l,j),X[M]=!0),M},dq.prototype._produceRotateCursor=function(T,O,d,r){var g=this;g._interactor;var B=g._canvas;B||(B=g._canvas=s.createElement("canvas"));var w=m.devicePixelRatio;B.width=B.height=O*w,B.style.width=B.style.height=O+" px";var E=B.getContext("2d");gk.setAntialias(E,!1),E.scale(w,w);var c,p,$,n,S,h=Math.round(O/2),N=""+h+" "+h+",auto !important;",v=4;c=Math.PI/180*r*d,E.clearRect(0,0,O,O),E.save(),E.scale(O/32,O/32),E.translate(16,15),E.rotate(c+Math.PI/2),E.beginPath(),E.moveTo(-8,0),E.lineTo(-8,v),E.lineTo(-8+v,v),E.moveTo(8,0),E.lineTo(8,v),E.lineTo(8-v,v),E.moveTo(-8,v),E.quadraticCurveTo(0,-6,8,v),E.restore(),E.lineCap="round",E.lineJoin="miter",E.strokeStyle="white",E.lineWidth=4,E.stroke(),E.strokeStyle="black",E.lineWidth=2,E.stroke(),p=JSON.stringify(B.toDataURL()),n="cursor:url("+p+")"+N,1!==w&&($='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+O+'px" height="'+O+'px"><image xlink:href='+p+' width="'+O+'" height="'+O+'"/></svg>',n+="cursor:url(data:image/svg+xml;base64,"+btoa($)+")"+N,n+="cursor:-webkit-image-set(url("+p+")"+w+"x,url("+p+")1x)"+N),S=s.createElement("style"),S.textContent="body."+T+" *, ."+T+"{"+n+"}",s.head.appendChild(S)};var nj=gk.Guide.Grid=function(M){var K=this;K._interactor=M,K._alignmentGuideId=0,K._xAlignmentGuide=[],K._yAlignmentGuide=[]};nj.prototype={},nj.prototype.constructor=nj,t.defineProperties(nj.prototype,{gridBlockSize:{get:function(){var j=this;return j._gridBlockSize||j._interactor.getStyle("gridBlockSize")},set:function(Z){this._gridBlockSize=Z,this._interactor._42()}},gridThickLinesEvery:{get:function(){var t=this;return t._gridThickLinesEvery||t._interactor.getStyle("gridThickLinesEvery")},set:function(q){this._gridThickLinesEvery=q,this._interactor._42()}},gridEnabled:{get:function(){var e=this,C=e._interactor;return C.gridEnabled&&e.isValidGrid()}}}),nj.prototype._42=function(){var t=this,T=t._interactor;t.gridEnabled&&t.drawGrid(),T.alignmentGuideEnabled&&t.drawAlignmentGuide()},nj.prototype.makeMatrix=function(){var M=this,O=M._interactor.getStyle("gridAngle"),G=M._interactor.getStyle("gridRotation"),Q=new gk.Math.Matrix2d,P=Math.sin(O),j=Math.cos(O);return Q.set(1,0,j,P,0,0),Q.rotate(G),Q},nj.prototype.isValidGrid=function(){var c=this,x=Math.PI,P=c._interactor,u=P.gv;if(u._zoom<P.getStyle("gridZoomThreshold"))return!1;var g=P.getStyle("gridAngle"),o=Math.abs(180*(g%x/x)),K=1-1e-8;return K>o||o>180-K?!1:!0},nj.prototype.drawAlignmentGuide=function(){var e=this,l=e._interactor,A=l.gv,$=l._canvas,y=l._context,H=$.width,J=$.height,D=A.tx(),j=A.ty(),E=A._zoom;y.beginPath(),y.strokeStyle=l.getStyle("gridAlignmentGuideColor"),y.lineWidth=1,e._xAlignmentGuide.forEach(function(s){var _=s.p*E+D;y.moveTo(_,0),y.lineTo(_,J)}),e._yAlignmentGuide.forEach(function(U){var Y=U.p*E+j;y.moveTo(0,Y),y.lineTo(H,Y)}),y.stroke()},nj.prototype.drawGrid=function(){function p(t,e,f,c){var B=gk.toScreenPosition(b,H.apply({x:t,y:e})),x=gk.toScreenPosition(b,H.apply({x:f,y:c}));Z.moveTo(B.x,B.y),Z.lineTo(x.x,x.y)}var X=this,r=X._interactor,i=X.gridBlockSize,W=X.gridThickLinesEvery,n=r.getStyle("gridThickColor"),J=r.getStyle("gridLightColor"),b=r.gv,T=r._canvas,Z=r._context,q=T.width,g=T.height,H=X.makeMatrix(),u=H.applyInverse(gk.toWorldPosition(b,{x:0,y:0})),d=H.applyInverse(gk.toWorldPosition(b,{x:q,y:0})),o=H.applyInverse(gk.toWorldPosition(b,{x:0,y:g})),Y=H.applyInverse(gk.toWorldPosition(b,{x:q,y:g})),V=Math.min(u.x,d.x,o.x,Y.x),I=Math.max(u.x,d.x,o.x,Y.x),O=Math.min(u.y,d.y,o.y,Y.y),$=Math.max(u.y,d.y,o.y,Y.y);q=I-V,g=$-O;var j=Math.ceil(V/i),S=Math.floor(I/i),L=Math.ceil(O/i),R=Math.floor($/i);b.tx(),b.ty(),b._zoom;var B,N,C;for(Z.save(),Z.lineWidth=1,Z.beginPath(),Z.strokeStyle=n,C=Math.ceil(j/W)*W;S>=C;C+=W)B=C*i,p(B,O,B,$);for(C=Math.ceil(L/W)*W;R>=C;C+=W)N=C*i,p(V,N,I,N);for(Z.stroke(),Z.beginPath(),Z.strokeStyle=J,C=j;S>=C;C++)0!==C%W&&(B=C*i,p(B,O,B,$));for(C=L;R>=C;C++)0!==C%W&&(N=C*i,p(V,N,I,N));Z.stroke(),Z.restore()},nj.prototype.getAlignmentGuides=function(){var s=this;return{x:s._xAlignmentGuide,y:s._yAlignmentGuide}},nj.prototype.addAlignmentGuide=function(d,i,g){var q=this,u="x"===d?q._xAlignmentGuide:q._yAlignmentGuide,g=g?g:++q._alignmentGuideId,e={p:i,id:g};if(u.length){var M=q._findClosestAlignmentGuide(e.p,u);M.dis<0?u.splice(M.index+1,0,e):u.splice(M.index,0,e)}else u.push(e);return q._interactor._42(),g},nj.prototype.findClosest=function(N,c,C){var S=this,b=S._interactor,K=b.gv;C&&(N=gk.toWorldPosition(K,N));var s,p,h,W=1/0,R=1/0,v=N.x,g=N.y;if(S.gridEnabled){var z=S.gridBlockSize,D=S.makeMatrix(),F=D.applyInverse(N);F=D.apply({x:Math.round(F.x/z)*z,y:Math.round(F.y/z)*z}),W=F.x-v,R=F.y-g,h=!0}if(b.alignmentGuideEnabled&&(s=S._findClosestAlignmentGuide(v,S._xAlignmentGuide).dis,p=S._findClosestAlignmentGuide(g,S._yAlignmentGuide).dis,Math.abs(s)<Math.abs(W)&&(W=s,h=!0),Math.abs(p)<Math.abs(R)&&(R=p,h=!0)),h){h=!1;var G=K._zoom,Z=b.getStyle("smartGuideThreshold")/G,M={};if(Math.abs(W)<Z&&"y"!==c&&(M.x=C?W*G:W,h=!0),Math.abs(R)<Z&&"x"!==c&&(M.y=C?R*G:R,h=!0),h)return M}},nj.prototype._findClosestAlignmentGuide=function(z,r){if(!r.length)return{dis:1/0};for(var V,C=0,H=r.length-1;H-C>1;)V=Math.floor((C+H)/2),r[V].p<z?C=V:H=V;var Q=r[C].p-z,t=r[H].p-z;return Math.abs(Q)<=Math.abs(t)?{line:r[C],dis:Q,index:C}:{line:r[H],dis:t,index:H}},nj.prototype.removeAllAlignmentGuide=function(W){var X=this;"y"!==W&&(X._xAlignmentGuide=[]),"x"!==W&&(X._yAlignmentGuide=[]),X._interactor._42()},nj.prototype.removeAlignmentGuide=function(J){for(var O,o,Q,n=this,f=n._xAlignmentGuide,E=0;2>E;E++)for(f=0===E?n._xAlignmentGuide:n._yAlignmentGuide,O=0,o=f.length;o>O;O++)if(Q=f[O],Q.id===J)return f.splice(O,1),n._interactor._42(),{axis:0===E?"x":"y",position:Q.p};return!1},nj.prototype.adjustAlignmentGuide=function(f,U){var c=this,Y=c.removeAlignmentGuide(f);return Y?(c.addAlignmentGuide(Y.axis,U,f),!0):!1};var wr=gk.Guide.Rect=function(i){var A=this;A._interactor=i};wr.prototype={},wr.prototype.constructor=wr,wr.prototype.gatherRects=function(){var y,w,j,d,B=this,l=B._interactor.gv,x=[],X=[],c={x:x,y:X},i={},L=l.getDataModel(),Z=L.a("width"),K=L.a("height");Z&&K&&(y=0,w=0,j=Z,d=K,x.push({node:L,type:0,p:y},{node:L,type:1,p:y+j/2},{node:L,type:2,p:y+j}),X.push({node:L,type:0,p:w},{node:L,type:1,p:w+d/2},{node:L,type:2,p:w+d}),i[L._id||0]={x:y,y:w,width:j,height:d}),L.each(function(a){if(ge(a)&&!l.isSelected(a)&&l.isVisible(a)&&l.isValidGuideLineSource(a)){var D=!1;if(l.sm().getSelection().each(function(Q){D||(a.isHostOn(Q)?D=!0:a.isDescendantOf(Q)&&(D=!0))}),!D){var L=a.getRect();y=L.x,w=L.y,j=L.width,d=L.height,x.push({node:a,type:0,p:y},{node:a,type:1,p:y+j/2},{node:a,type:2,p:y+j}),X.push({node:a,type:0,p:w},{node:a,type:1,p:w+d/2},{node:a,type:2,p:w+d}),i[a._id]=L}}}),x.sort(function(w,q){return w.p-q.p}),X.sort(function(C,H){return C.p-H.p}),B._grid=c,B._87I=i},wr.prototype.gatherLines=function(f,F,U){var w,e,K,N,D,i,I,B,s,d,u,h,H=this,b=[H.findClosest({x:f.x,y:f.y},F),H.findClosest({x:f.x+f.w/2,y:f.y+f.h/2},F),H.findClosest({x:f.x+f.w,y:f.y+f.h},F)],m={},T=H._87I;U=U||255;var Q,q;for(H._guideLine=[],w=0;2>w;w++)for(m={},0===w?(N="y",B=f.x,s=B+f.w):(N="x",B=f.y,s=B+f.h),e=0;3>e;e++)D=b[e],D&&isFinite(D[N])&&(Q=1<<3*w+e,U&Q&&(i=D[N+"Line"],I=i.node,q=I._id||0,m[q]||(m[q]=!0,h=T[q],"y"===N?(d=h.x,u=h.x+h.width):(d=h.y,u=h.y+h.height),K=i.p,H._guideLine.push({type:N,a:B,b:s,c:d,d:u,p:K,center:1===i.type}))))},wr.prototype._binarySearchClosest=function(w,X){if(!X.length)return{dis:1/0};for(var x,p=0,$=X.length-1;$-p>1;)x=Math.floor((p+$)/2),X[x].p<w?p=x:$=x;var M=X[p].p-w,g=X[$].p-w;return Math.abs(M)<=Math.abs(g)?{line:X[p],dis:M}:{line:X[$],dis:g}},wr.prototype.findClosest=function(b,l,f){var n=this,q=n._interactor,m=q.gv,j=n._grid;f&&(b=gk.toWorldPosition(m,b));var S,U=n._binarySearchClosest(b.x,j.x),u=n._binarySearchClosest(b.y,j.y),M=U.dis,s=u.dis,C=m._zoom,W=q.getStyle("smartGuideThreshold")/C,I={};return Math.abs(M)<W&&"y"!==l&&(I.x=f?M*C:M,I.xLine=U.line,S=!0),Math.abs(s)<W&&"x"!==l&&(I.y=f?s*C:s,I.yLine=u.line,S=!0),S?I:void 0},wr.prototype._42=function(){var r=this,d=r._guideLine;if(d&&!q.Default.isCtrlDown()){var U=r._interactor;if(U.getStyle("guideLineVisible")){var N,S,$,b,l,R,F,T,E,C,y,P,f,x,K,Y,O,o=U.gv,u=U._context,D=o.tx(),h=o.ty(),v=o._zoom,a=U.getStyle("guideLineTextSpacing");for(N=0,S=d.length;S>N;N++)$=d[N],T=$.type,E=$.p,C=$.a,y=$.b,P=$.c,f=$.d,x=Math.min(C,P),K=Math.max(y,f),"x"===T?(b=E*v+D,l=x*v+h,R=b,F=K*v+h):(b=x*v+D,l=E*v+h,R=K*v+D,F=l),gk.Icons.DrawIcon(U,u,gk.Icons.MoveLineGuide,{rect:[b,l,R,F],center:$.center}),f>=C&&y>=P||(x=C>f?f:y,K=C>f?C:P,O=K-x,"x"===T?($.center2center||(b-=a,R=b),l=x*v+h,F=K*v+h,Y=gk.Icons.MoveLineGuideDistanceV):"y"===T&&($.center2center||(l-=a,F=l),b=x*v+D,R=K*v+D,Y=gk.Icons.MoveLineGuideDistanceH),gk.Icons.DrawIcon(U,u,Y,{x0:b,y0:l,x1:R,y1:F,dis:O}))}}},wr.prototype.clear=function(){this._guideLine=null};var Zk=gk.Guide.Hover=function(j){var e=this;e._interactor=j};Zk.prototype={},Zk.prototype.constructor=Zk,t.defineProperties(Zk.prototype,{}),Zk.prototype._42=function(){var g=this._interactor;if(g.getStyle("hoverGuideVisible")&&!g.gvEditing){var n=g.hoverData,I=g.gv;if(!ge(n)||I.isSelected(n))return g.hoverData=null,void 0;var Y=Dj(I,n),O=gk.toScreenPosition(I,{x:Y.x,y:Y.y}),U=gk.toScreenPosition(I,{x:Y.x+Y.width,y:Y.y+Y.height});gk.Icons.DrawIcon(g,g._context,gk.Icons.HoverDataRect,{min:O,max:U,color:g.getStyle("hoverGuideColor")||g.getStyle("baseColor")})}},gk.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var hm=gk.Icons={},Nf=1e4,Sl=null,Kb=gk.DefaultStyleMap.baseColor,Hq="rgb(183,232,135)",Ob="rgb(255,204,153)",tq=6;q.Default.setImage("Icons.RectPoint",{width:tq,height:tq,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Kb}},rect:[0,0,tq,tq]}]}),hm.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var I=hm.GroupSubEntityRect.data;if(!I)return[];var U=I.min,x=I.max;return[U.x,U.y,U.x,x.y,x.x,x.y,x.x,U.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return hm.GroupSubEntityRect.data.isKeyOb?Kb:Kb}}}]};var Ai=4;hm.HoverDataRect={comps:[{type:"shape",points:{func:function(){var X=hm.HoverDataRect.data;if(!X)return[];var q=X.min,L=X.max,A=Ai;return q.x-=A,q.y-=A,L.x+=A,L.y+=A,[q.x,q.y,q.x,L.y,L.x,L.y,L.x,q.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return hm.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},hm.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[hm.Line.data.P1.x,hm.Line.data.P1.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[hm.Line.data.P2.x,hm.Line.data.P2.y],tq,tq]}}}]},hm.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return hm.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},hm.Rect={comps:[{type:"shape",points:{func:function(){var N=hm.Rect.data;if(!N)return[];var L=N.LT,z=N.LB,F=N.RB,A=N.RT;return[L.x,L.y,z.x,z.y,F.x,F.y,A.x,A.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Kb}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},rect:{func:function(){return[[hm.Rect.data.LT.x,hm.Rect.data.LT.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},rect:{func:function(){return[[hm.Rect.data.LB.x,hm.Rect.data.LB.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},rect:{func:function(){return[[hm.Rect.data.RB.x,hm.Rect.data.RB.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},rect:{func:function(){return[[hm.Rect.data.RT.x,hm.Rect.data.RT.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},visible:{func:function(){return hm.Rect.data.L?!0:!1}},rect:{func:function(){return[[hm.Rect.data.L.x,hm.Rect.data.L.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},visible:{func:function(){return hm.Rect.data.R?!0:!1}},rect:{func:function(){return[[hm.Rect.data.R.x,hm.Rect.data.R.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},visible:{func:function(){return hm.Rect.data.T?!0:!1}},rect:{func:function(){return[[hm.Rect.data.T.x,hm.Rect.data.T.y],tq,tq]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return hm.Rect.data.rotation}},visible:{func:function(){return hm.Rect.data.B?!0:!1}},rect:{func:function(){return[[hm.Rect.data.B.x,hm.Rect.data.B.y],tq,tq]}}}]};var Fl=16;q.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Kb}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Kb}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),hm.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[hm.Anchor.data.POS.x,hm.Anchor.data.POS.y],Fl,Fl]}}}]},hm.TipShiftX=12,hm.TipShiftY=12;var Pf=[8,28];hm.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[hm.TipHelper.data.helperPos.x,hm.TipHelper.data.helperPos.y,Pf[0]*hm.TipHelper.data.size,Pf[1]]}},background:{func:function(){return Sl.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return hm.TipHelper.data.text}},rect:{func:function(){return[hm.TipHelper.data.helperPos.x,hm.TipHelper.data.helperPos.y,Pf[0]*hm.TipHelper.data.size,Pf[1]]}},color:{func:function(){return Sl.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var ql=7;hm.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!hm.ShapePoint.data.dynamicVisible}},rect:{func:function(){var v=hm.ShapePoint.data.point,I=hm.ShapePoint.data.size||ql;return[v,I+10,I+10]}},background:{func:function(){var m=Date.now(),a=hm.ShapePoint.data.dynamicPeriod||1500,U=Math.sin(m%a/a*Math.PI);return"rgba(27,124,22,"+.5*U+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var x=hm.ShapePoint.data.point,c=hm.ShapePoint.data.size||ql;return[x,c,c]}},background:{func:function(){var z=hm.ShapePoint.data.isEnd;return z?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return hm.ShapePoint.data.color||Kb}}},{type:"rect",visible:{func:function(){return!!hm.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Kb}},rect:{func:function(){var x=5;return[hm.ShapePoint.data.point,x,x]}}}]},hm.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!hm.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return hm.ShapeBgCurve.data.P}},segments:{func:function(){return hm.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var Z=Date.now(),z=hm.ShapeBgCurve.data.dynamicPeriod||1500,j=Math.sin(Z%z/z*Math.PI);return"rgba(27,124,22,"+.3*j+")"
}}},{type:"shape",points:{func:function(){return hm.ShapeBgCurve.data.P}},segments:{func:function(){return hm.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return hm.ShapeBgCurve.data.color||Kb}}}]};var Ej=8;hm.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var K=hm.ShapeHighlighPoint.data;return[[K.x,K.y],Ej,Ej]}},background:{func:function(){return Sl.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var jp=10;hm.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var r=hm.ShapeHighlighRealPoint.data;return[[r.x,r.y],jp,jp]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Kb}}}]};var wk=8;hm.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var y=hm.ShapeHighlighCtrlPoint.data,$=y.x,k=y.y,o=wk/2;return[$-o,k-o,$-o,k+o,$+o,k+o,$+o,k-o]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Sl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Sl.getStyle("shapeCtrlPointBorderColor")||Kb}}}]};var er=3;hm.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return hm.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:er,borderColor:{func:function(){return Sl.getStyle("curveHighlightColor")}}}]},hm.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return hm.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},hm.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return hm.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return hm.MoveLineGuide.data.center?Hq:Ob}}}]};var ub=5;hm.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var $=hm.MoveLineGuideDistanceH.data,L=$.x0,R=$.y0;return[L,R-ub,L,R+ub]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ob},{type:"shape",points:{func:function(){var w=hm.MoveLineGuideDistanceH.data,F=w.x1,g=w.y1;return[F,g-ub,F,g+ub]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ob},{type:"text",text:{func:function(){return Math.round(hm.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var s=hm.MoveLineGuideDistanceH.data;return[[(s.x0+s.x1)/2,s.y0-10],20,20]}},color:Ob,font:"12px Arial",align:"center"}]},hm.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var K=hm.MoveLineGuideDistanceV.data,Y=K.x0,k=K.y0;return[Y-ub,k,Y+ub,k]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ob},{type:"shape",points:{func:function(){var q=hm.MoveLineGuideDistanceV.data,$=q.x1,N=q.y1;return[$-ub,N,$+ub,N]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ob},{type:"text",text:{func:function(){return Math.round(hm.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var T=hm.MoveLineGuideDistanceV.data;return[[T.x0-10,(T.y0+T.y1)/2],20,20]}},color:Ob,font:"12px Arial",align:"center"}]},q.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),hm.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var V=hm.EdgeElevationGuide.data,J=V.x,_=V.y,R=Sl.getStyle("curveElevationIntersectSize"),C=Sl.getStyle("curveElevationGuideShift");return J+=C[0],_+=C[1],[J-R,_-R,2*R,2*R]}}}]},q.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),q.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),hm.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return hm.ConnectGuide.data.rotation}},rect:{func:function(){var b=hm.ConnectGuide.data.connect;b.x,b.y;var N=Sl.getStyle("connectGuideIntersectSize");return[[b.x,b.y],2*N,2*N]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var O=hm.ConnectGuide.data.cursorPos||hm.ConnectGuide.data.connect,q=Sl.getStyle("connectGuideIntersectSize");return[[O.x,O.y],2*q-2,2*q-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var c=hm.ConnectGuide.data.connect,j=hm.ConnectGuide.data.cursorPos||c;return[c.x,c.y,c.x+.5*(j.x-c.x),c.y,j.x+.5*(c.x-j.x),j.y,j.x,j.y]}}}]},q.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),q.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),hm.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var n=hm.ConnectGuideGarbage.data.hover;return n?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var D=hm.ConnectGuideGarbage.data,V=Sl.getStyle("connectGuideGarbageIntersectsize");return D.hover&&(V+=5),[[D.x,D.y],2*V,2*V]}}}]};var Pc=6;hm.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return hm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var e=hm.ShapeActivingCtrl.data;return[e.point.x,e.point.y,e.c1.x,e.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Kb}}},{type:"shape",visible:{func:function(){return hm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var d=hm.ShapeActivingCtrl.data;return[d.point.x,d.point.y,d.c2.x,d.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Kb}}},{type:"shape",visible:{func:function(){return hm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var f=hm.ShapeActivingCtrl.data.c1,F=f.x,v=f.y,L=Pc/2;return"c1"===hm.ShapeActivingCtrl.data.hl&&(L+=.5),[F-L,v-L,F-L,v+L,F+L,v+L,F+L,v-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Sl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===hm.ShapeActivingCtrl.data.hl?Sl.getStyle("shapeCtrlPointHighlightBorder")||Kb:Sl.getStyle("shapeCtrlPointBorderColor")||Kb}}},{type:"shape",visible:{func:function(){return hm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var X=hm.ShapeActivingCtrl.data.c2,S=X.x,U=X.y,i=Pc/2;return"c2"===hm.ShapeActivingCtrl.data.hl&&(i+=.5),[S-i,U-i,S-i,U+i,S+i,U+i,S+i,U-i]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Sl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===hm.ShapeActivingCtrl.data.hl?Sl.getStyle("shapeCtrlPointHighlightBorder")||Kb:Sl.getStyle("shapeCtrlPointBorderColor")||Kb}}}]},hm.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Kb}},rect:{func:function(){return[[hm.RoundPoint.data.x,hm.RoundPoint.data.y],tq,tq]}}}]},hm.AttachPoint={comps:[{type:"rect",background:{func:function(){return hm.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Kb}},rect:{func:function(){var D=hm.AttachPoint.data.isAttach?tq+4:tq;return[[hm.AttachPoint.data.x,hm.AttachPoint.data.y],D,D]}}}]},hm.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return hm.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return hm.SimpleRect.data.color||Kb}},rect:{func:function(){var Q=hm.SimpleRect.data;return[Q.x,Q.y,Q.width,Q.height]}}}]},q.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),hm.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var Q=hm.MoveDummy.data;return[[Q.pos.x,Q.pos.y],2*Q.size,2*Q.size]}}}]},gk.Icons.DrawIcon=function(k,V,X,U){X.width=X.height=Nf,X.data=U,Sl=k,q.Default.drawImage(V,X,0,0,Nf,Nf)},gk.Icons.MapPoints=function(j,D){for(var $=0,m=j.length;m>$;$++)j[$]/=D},gk.roundTo=function(O,i,q){var J=Math.abs(O%i);return q>J||q>i-J?i*Math.round(O/i):O},gk.toFixed=function(L){return Math.round(100*L)/100},gk.getDataMatrix=function(n){if(n instanceof q.Shape){var k=new q.Math.Matrix2d,R=n.getPosition();return k.translate(-R.x,-R.y).scale(n.getScale().x,n.getScale().y).rotate(n.getRotation()).translate(R.x,R.y),k}return n.getMatrix?n.getMatrix():new q.Math.Matrix2d};var Sk=gk.Math.Curve=function(){this._curves=[]};Sk.prototype={},Sk.prototype.constructor=Sk,Sk.prototype.createFromHtShape=function(T,X,V){X instanceof q.List&&(X=X.toArray());var r,W,N,x,i,n,P,B=this,J=null,o=null,j=0,s=gk.Math.Vector2,z=gk.Math.CubicBezier,e=function(h){return new s(T[h],T[h+1],V?V[h/2]:D)};for(W=0,N=X.length;N>W;W++){switch(x=X[W],i=null,x){case 1:o=e(j),J=o,j+=2;break;case 2:r=e(j),j+=2,i=new z(o,o.clone(),r.clone(),r),o=r;break;case 3:n=e(j),r=e(j+2),j+=4,i=new z(o,n.clone().sub(o).multiplyScalar(2/3).add(o),n.clone().sub(r).multiplyScalar(2/3).add(r),r),o=r;break;case 4:n=e(j),P=e(j+2),r=e(j+4),j+=6,i=new z(o,n,P,r),o=r;break;case 5:if(!J)break;i=new z(o,o.clone(),J.clone(),J),o=null,J=null}i&&(i._index=B._curves.length,B._curves.push(i))}},Sk.prototype.checkPoint=function(c,e){var E,S,_,K,k,Z=this,s=Z._curves;for(E=0,S=s.length;S>E;E++)if(K=s[E],k=K.intersectRect(c,e,e),k.length)return _=0,k.forEach(function(m){_+=m.t}),_/=k.length,c=K.getPointAt(_),c.t=_,{bezier:K,intersection:c}},Sk.prototype.insertKnot=function(m,K){var y=m.insertKnot(K),A=this,O=A._curves;O.splice(m._index,1,y[0],y[1])},Sk.prototype._isCloseEnough=function(w,R){return Math.abs(w.x-R.x)<1e-6&&Math.abs(w.y-R.y)<1e-6},Sk.prototype._isSamePoint=function(Z,q){return Z===q},Sk.prototype.moveRealPoint=function(I,v){var $=this,V=$._curves,t=v.clone().sub(I);V.forEach(function(O){var k=O._p1;O._p2,O._p3;var j=O._p4;$._isSamePoint(k,I)&&(O._p2.add(t),O._p1=v),$._isSamePoint(j,I)&&(O._p3.add(t),O._p4=v)})},Sk.prototype.moveCtrlDueToRealPointMovement=function(R,l){var T=this,Q=T._curves,z=function(f){f.add(l),f.e&&l.e&&(f.e+=l.e)};Q.forEach(function(Q){var n=Q._p1;Q._p2,Q._p3;var u=Q._p4;T._isSamePoint(n,R)&&z(Q._p2),T._isSamePoint(u,R)&&z(Q._p3)})},Sk.prototype.moveCtrlPoint=function(o,i,w){var y=o[w];if(y){y.e!==D&&(i.e=y.e);var l=this,$=l._curves;i.clone().sub(y),$.forEach(function(T){var N;"c2"===w?N="_p2":"c1"===w&&(N="_p3"),l._isSamePoint(T[N],y)&&(T[N]=i)}),o[w]=i}},Sk.prototype.deleteRealPoint=function(T,V){var P,R,u,x,s,c,E,U=this,W=U._curves,O={},$=[],D=gk.Math.CubicBezier;for(R=0,u=W.length;u>R;R++)P=W[R],x=P._p1,s=P._p2,c=P._p3,E=P._p4,(O[R]||!U._isSamePoint(x,T))&&(U._isSamePoint(E,T)?u>R+1&&U._isSamePoint(W[R+1]._p1,T)&&(V||$.push(new D(x,s,W[R+1]._p3,W[R+1]._p4))):$.push(P));U._curves=$},Sk.prototype.findPairs=function(Y,X){var C,s,z,T,N,j,A,w,p=this,O=p._curves,f={},d=[];for(s=0,z=O.length;z>s;s++)C=O[s],T=C._p1,N=C._p2,j=C._p3,A=C._p4,!f[s]&&p._isSamePoint(T,Y)&&(X?d.push({point:T,r2:A}):d.push({point:T,c2:N})),p._isSamePoint(A,Y)&&(w=X?{point:A,r1:T}:{point:A,c1:j},z>s+1&&p._isSamePoint(O[s+1]._p1,Y)&&(X?w.r2=O[s+1]._p4:w.c2=O[s+1]._p2,f[s+1]=!0),d.push(w));return d},Sk.prototype.toHtShape=function(){var U=this,H=U._curves,j=[],t=[],C={x:1/0,y:1/0};return H.forEach(function(s){var f=s._p1,W=s._p2,q=s._p3,e=s._p4;return U._isCloseEnough(f,C)||(j.push(1),t.push(f.clone())),C=e,U._isCloseEnough(f,W)&&U._isCloseEnough(q,e)?(j.push(2),t.push(e.clone()),void 0):(j.push(4),t.push(W.clone(),q.clone(),e.clone()),void 0)}),{segments:j,points:t}};var Bn=gk.Math.CubicBezier=function(U,D,M,S){var P=this;P._id=gk.Math.CubicBezier._globalId++,P._p1=U,P._p2=D,P._p3=M,P._p4=S};Bn._globalId=1,Bn.prototype={},Bn.prototype.constructor=Bn,Bn.prototype.toString=function(){return this._id},Bn.prototype.intersectRect=function(m,r,I){var o=r/2,H=I/2,F=m.x,b=m.y,x=gk.Math.Vector2,p=new x(-o+F,-H+b),U=new x(o+F,H+b),V=new x(U.x,p.y),y=new x(p.x,U.y),w=this,S=w.intersectLine(p,V),e=w.intersectLine(V,U),Z=w.intersectLine(U,y),s=w.intersectLine(y,p),K=S.concat(e).concat(Z).concat(s);return K},Bn.prototype.intersectLine=function($,C){var r,x,P,z,M,k,S,Q,p,Z,E,d,B,w=this,A=$.clone().min(C),o=$.clone().max(C);z=w._p1,M=w._p2,k=w._p3,S=w._p4,r=z.clone().multiplyScalar(-1),x=M.clone().multiplyScalar(3),P=k.clone().multiplyScalar(-3),E=r.add(x).add(P).add(S),r=z.clone().multiplyScalar(3),x=M.clone().multiplyScalar(-6),P=k.clone().multiplyScalar(3),Z=r.add(x).add(P),r=z.clone().multiplyScalar(-3),x=M.clone().multiplyScalar(3),p=r.add(x),Q=z.clone(),B=new gk.Math.Vector2($.y-C.y,C.x-$.x),d=$.x*C.y-C.x*$.y;for(var U=w.getRoots(B.dot(E),B.dot(Z),B.dot(p),B.dot(Q)+d),T=new Array,X=0,Y=U.length;Y>X;X++){var J=U[X];if(!(0>J||J>1)){var H=w.getPointAt(J);H.t=J,$.x==C.x?A.y<=H.y&&H.y<=o.y&&T.push(H):$.y==C.y?A.x<=H.x&&H.x<=o.x&&T.push(H):H.x>=A.x&&H.y>=A.y&&H.x<=o.x&&H.y<=o.y&&T.push(H)}}return T},Bn.prototype.solveTForPoint=function(_){var s,y,C,O,R=this;s=R._p1.x-_.x,y=R._p2.x-_.x,C=R._p3.x-_.x,O=R._p4.x-_.x;for(var A=R.getRoots(O-3*C+3*y-s,3*C-6*y+3*s,3*y-3*s,s),x=D,m=1/0,G=0,o=A.length;o>G;G++){var g=A[G];if(!(0>g||g>1)){var c=R.getPointAt(g);c.t=g;var P=Math.abs(c.y-_.y);m>P&&(m=P,x=c)}}return x},Bn.prototype.getPointAt=function(p){var K=this,g=K._p1,t=K._p2,r=K._p3,S=K._p4,I=g.clone().lerp(t,p),n=t.clone().lerp(r,p),W=r.clone().lerp(S,p),E=I.lerp(n,p),X=n.lerp(W,p);return E.lerp(X,p)},Bn.prototype.getPointByPercentage=function(Y){var j=this.length*Y,N=this._cacheLength,u=N.length;if(0===j)return N[0].point;if(Y>=1)return N[u-1].point;for(var d=0;u>d;d++){var v=N[d];if(!(v.len<j)){var y=N[d-1];return v.point.clone().sub(y.point).setLength(j-y.len).add(y.point)}}},Bn.prototype.getTByPercentage=function(d){var G=this.length*d,N=this._cacheLength,M=N.length;if(0===G||0>=d)return N[0].t;if(d>=1)return N[M-1].t;for(var q=0;M>q;q++){var Z=N[q];if(!(Z.len<G)){var S=N[q-1];return(G-S.len)/(Z.len-S.len)*(Z.t-S.t)+S.t}}},Bn.prototype.getRoots=function(M,j,t,o){var w,K,c,d,Y,h=new Array;if(Math.abs(M)<1e-6){var w=j,K=t/w,c=o/w,d=K*K-4*c;if(d>0){var Y=Math.sqrt(d);h.push(.5*(-K+Y)),h.push(.5*(-K-Y))}else 0==d&&h.push(.5*-K)}j/=M,t/=M,o/=M,w=(3*t-j*j)/3,K=(2*j*j*j-9*t*j+27*o)/27;var a=j/3,y=K*K/4+w*w*w/27,A=K/2;if(Math.abs(y)<=1e-6&&(y=0),y>0){var W,i,Y=Math.sqrt(y);W=-A+Y,i=W>=0?Math.pow(W,1/3):-Math.pow(-W,1/3),W=-A-Y,W>=0?i+=Math.pow(W,1/3):i-=Math.pow(-W,1/3),h.push(i-a)}else if(0>y){var R=Math.sqrt(-w/3),z=Math.atan2(Math.sqrt(-y),-A)/3,T=Math.cos(z),I=Math.sin(z),p=Math.sqrt(3);h.push(2*R*T-a),h.push(-R*(T+p*I)-a),h.push(-R*(T-p*I)-a)}else{var W;W=A>=0?-Math.pow(A,1/3):Math.pow(-A,1/3),h.push(2*W-a),h.push(-W-a)}return h},Bn.prototype._70I=function(){var U=this;return U._p1.distanceToSquared(U._p2)<1e-10&&U._p3.distanceToSquared(U._p4)<1e-10},Bn.prototype.insertKnot=function(O){var S=this,g=S._p1,r=S._p2,E=S._p3,s=S._p4,X=g.clone().lerp(r,O),A=r.clone().lerp(E,O),l=E.clone().lerp(s,O),I=X.clone().lerp(A,O),e=A.clone().lerp(l,O),R=I.clone().lerp(e,O);return S._70I()?(g.clone().lerp(s,O),[new gk.Math.CubicBezier(g,g.clone(),R.clone(),R),new gk.Math.CubicBezier(R,R.clone(),s.clone(),s)]):[new gk.Math.CubicBezier(g,X,I,R),new gk.Math.CubicBezier(R,e,l,s)]},t.defineProperties(Bn.prototype,{length:{get:function(){var m=this._cacheLength;if(!m){m=this._cacheLength=[];for(var U=this._p1,h=0,Z=0;1>=h;){var l=this.getPointAt(h+=.001);Z+=l.clone().sub(U).length(),U=l,m.push({len:Z,t:h,point:l.clone()})}}return m[m.length-1].len}},p1:{get:function(){return this._p1},set:function(F){this._p1=F,this._cacheLength=D}},p2:{get:function(){return this._p2},set:function(d){this._p2=d,this._cacheLength=D}},p3:{get:function(){return this._p3},set:function(T){this._p3=T,this._cacheLength=D}},p4:{get:function(){return this._p4},set:function(Q){this._p4=Q,this._cacheLength=D}}});var lq=q.Default.getInternal().ui().EdgeUI,$l={_47O:function(Y){var m=this,L=$l.getBackups()._47O;gk.inEdit(m.gv)||L.call(m,Y)}};gk.Inject.registAsModule($l,lq);var Tq=q.Default.getInternal().ui().NodeUI,dg={_47O:function(y){var A=this,X=dg.getBackups()._47O;gk.inEdit(A.gv)||X.call(A,y)},getSelectWidth:function(){var R=this,u=R.gv,D=R._data;if(u.isEditable(D)&&gk.inEdit(u))return 0;var H=dg.getBackup("getSelectWidth");return H.call(R)}};gk.Inject.registAsModule(dg,Tq);var Ho=q.graph.GraphView,ch={_editPointSize:function(){var n=q.Default.isTouchable,V=gk.getStyle("pointSize");return V[n?0:1]}(),isPointEditable:function(b){var i=this;if(gk.inEdit(i))return i._pointEditableFunc?i._pointEditableFunc(b):!0;var z=ch.getBackup("isPointEditable");z.call(i,b)},isEditable:function(h){var T,K=this,I=ch.getBackup("isEditable");if(T=h instanceof gk.Group?!0:I.call(K,h),!gk.inEdit(K))return T;if(!(h instanceof q.Edge))return T;if(!h.s("2d.editable"))return!1;var b=K.getEditableFunc();return b?b(h):!0},_42:function(p,d){var Q=this,K=ch.getBackups()._42;if(K.call(Q,p,d),gk.inEdit(Q)){var y=Q.getEditInteractor();y.drawImpl()}}};gk.Inject.registAsModule(ch,Ho);var lf=q.Default.getInternal().ui().ShapeUI,Zi={_47O:function(i){var A=this,_=Zi.getBackups()._47O;gk.inEdit(A.gv)||_.call(A,i)}};gk.Inject.registAsModule(Zi,lf);var Yi=q.graph.DefaultInteractor,hq={handle_mousewheel:function(H){var m=this,j=hq.getBackup("handle_mousewheel");gk.inEdit(m.gv)||j.call(m,H)}};gk.Inject.registAsModule(hq,Yi);var Ir=q.graph.MoveInteractor,Jd={_calcShift:function(V,j){var o=this,D=Jd.getBackup("_calcShift"),n=o.gv;if(!gk.inEdit(n))return D.call(o,V,j);var O=n.getEditInteractor(),d=O.getSubModule("Move").calcShift(V,j,o);return d||D.call(o,V,j)},clear:function(F){var E=this,f=Jd.getBackup("clear");f.call(E,F);var O=E.gv;if(gk.inEdit(O)){var N=O.getEditInteractor();N.getSubModule("Move").clear(F)}}};gk.Inject.registAsModule(Jd,Ir);var wr=gk.Rect=function(o){this.catalog="Rect",this._interactor=o};wr.prototype={},wr.prototype.constructor=wr,wr.prototype.gatherInfo=function(C,Q){var Y=this;if(1===Q.length){var S=Q[0];return S instanceof q.Shape&&S._70I()?Y.gatherLine(C,S):af(S,C)?!1:Y.gatherSingleTarget(C,S)}return Q.length>1?Y.gatherMultiTargets(C,Q):!1},wr.prototype.gatherSingleTarget=function(c,Q){if(Q.getCorners){var p,_=this,L=_.info;_.target=Q,p=_.screenInfo={};var x=Q.getCorners();L.LT=new gk.Math.Vector2(x[0]),L.LB=new gk.Math.Vector2(x[1]),L.RB=new gk.Math.Vector2(x[2]),L.RT=new gk.Math.Vector2(x[3]),L.T=L.LT.clone().add(L.RT).divideScalar(2),L.B=L.LB.clone().add(L.RB).divideScalar(2),L.L=L.LT.clone().add(L.LB).divideScalar(2),L.R=L.RT.clone().add(L.RB).divideScalar(2);for(var D in L)p[D]=gk.toScreenPosition(c,L[D]);var d=_._interactor,b=d.getStyle("checkSize"),m=function(F,e,r){var I=e.clone().sub(F).setLength(-b),S=r.clone().sub(F).setLength(-b),y=I.add(S).add(F);return y};return p.rotLT=m(p.LT,p.RT,p.LB),p.rotLB=m(p.LB,p.LT,p.RB),p.rotRB=m(p.RB,p.LB,p.RT),p.rotRT=m(p.RT,p.LT,p.RB),p.rotT=p.rotLT.clone().add(p.rotRT).divideScalar(2),p.rotB=p.rotLB.clone().add(p.rotRB).divideScalar(2),p.rotL=p.rotLT.clone().add(p.rotLB).divideScalar(2),p.rotR=p.rotRT.clone().add(p.rotRB).divideScalar(2),p.rotation=Q.getRotation(),_.gatherConnectInfo(),!0}},wr.prototype.gatherConnectInfo=function(){var C=this,u=C.target,Y=C._interactor,w=C.screenInfo,c=Y.gv;if(c.isConnectActionVisible(u)&&Y.getStyle("connectGuideVisible")){var I;u.s&&(I=u.s("connectGuideShift")),I||(I=Y.getStyle("connectGuideShift"));var p=u.getAnchor(),m=u.getSize(),V=u.toGlobal({x:m.width*(I[0]-p.x),y:m.height*(I[1]-p.y)});V=gk.toScreenPosition(c,V),w.P1?V.add(w.P2.clone().sub(w.P1).setLength(I[2])):(V.add(w.RT.clone().sub(w.LT).setLength(I[2])),V.add(w.LB.clone().sub(w.LT).setLength(I[3]))),w.connect=V}},wr.prototype.gatherMultiTargets=function(i,p){var l=gk.Group.findOrCreateGroup(p,this._interactor._uuid);if(!l)return!1;var w=this;return w.editing&&"rotate"!==w.editing.mode||l.calcInfo(),w.gatherSingleTarget(i,l)},wr.prototype.gatherLine=function($,Z){this.target=Z;var p=this.screenInfo={},m=Z.getPoints(),j=gk.getDataMatrix(Z);return p.P1=gk.toScreenPosition($,j.apply(m.get(0))),p.P2=gk.toScreenPosition($,j.apply(m.get(1))),this.gatherConnectInfo(),!0},wr.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],wr.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],wr.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],wr.prototype.check=function(C,h,H){if(q.Default.isLeftButton(h)){var A=this;if(A.editing=null,A.tipInfo=null,A.screenInfo){var d=A.target,$=C.isEditable(d),c=A.screenInfo;if($&&c.connect){var S=A._checkConnect(H);if(S)return S}if(c.P1)return A._checkLine(H);var U,k,O,Y=null,E=A._interactor,p=E.getStyle("checkSize");if($&&C.isRectEditable(d))for(k=0;k<gk.Rect.ResizeKeys.length;k++)if(O=gk.Rect.ResizeKeys[k],gk.checkHit(H,c[O],p)){Y=O,U="resize";break}if(!Y&&$&&C.isRotationEditable(d)&&!E.getStyle("rotateAsClock")){var K=E.getStyle("rotateCheckSize");for(k=0;k<gk.Rect.RotateKeys.length;k++)if(O=gk.Rect.RotateKeys[k],gk.checkHit(H,c[O],K)){Y=O,U="rotate";break}}if(!Y)return E.setCursor("default"),void 0;if("rotate"===U){var P,x=C.lp(h);if(d instanceof gk.Group){var M=E.getStyle("groupRotateModeKey");"string"==typeof M&&(M=[M]);for(var L=!1,Z=0,m=M.length;m>Z;Z++)if(h[M[Z]]){L=!0;break}var o=E.getStyle("groupRotateModeDefault");P=L?"batch"===o?"block":"batch":o}var _="batch"===P?d.getAnchor2():d.getPosition(),b=Math.atan2(x.y-_.y,x.x-_.x);E._setRotateCursor(b),A.editing={mode:U,key:Y,pos:_,flipY:d.getScale().y<0,rotation:d.getRotation(),hitRot:b},P&&(A.editing.groupRotateMode=P)}else{var r=gk.Rect.ResizeKeys.indexOf(Y),l=gk.Rect.ResizeDirection[r],f=Math.cos(d.getRotation()),z=Math.sin(d.getRotation()),I=l.x*Math.sign(d.getScale().x),D=l.y*Math.sign(d.getScale().y),F=Math.atan2(-z*I-f*D,f*I-z*D),J=(Math.round(F/(Math.PI/4))+8)%8,g=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][J];this._interactor.setCursor(g);var B=d.getWidth(),W=d.getHeight(),i=d.getAnchor();A.editing={mode:U,key:Y,rect:{x:-B*i.x,y:-W*i.y,width:B,height:W},anchor:i,matrix:d.getMatrix()}}return Y}}},wr.prototype._checkLine=function(o){var y=this;y.screenInfo;var u,N=y._interactor.getStyle("checkSize");if(gk.checkHit(o,y.screenInfo.P1,N))u="P1";else{if(!gk.checkHit(o,y.screenInfo.P2,N))return this._interactor.setCursor("default"),void 0;u="P2"}return y.editing={mode:"line",key:u},u},wr.prototype._checkConnect=function(l){var I=this,d=I.screenInfo,H=I._interactor,M=H.getStyle("connectGuideIntersectSize"),$=d.connect,V=l.x,R=$.x;if(R>V&&M>R-V&&Math.abs($.y-l.y)<M||V>=R&&gk.checkHit(l,$,M)){var C="connect",g=m.getConnectAction(H.gv);if(I.editing={mode:C},g&&g.delete)if(I.target instanceof gk.Group){var K=!0;H.gv.sm().getSelection().each(function(E){g.delete.visible.call(null,H.gv,E)||(K=!1)}),I.editing.hasDeleteAction=K}else g.delete.visible.call(null,H.gv,I.target)&&(I.editing.hasDeleteAction=!0);return H.setCursor("default"),C}},wr.prototype._fireEditEvent=function(t,r){var j=this._interactor,b=this.editing;if(b){var _=b.mode;_="rotate"===_?"Rotation":"connect"===_?"Connection":"resize"===_?"Rect":_[0].toUpperCase()+_.slice(1),j.fi({kind:t+"Edit"+_,event:r})}},wr.prototype.startEdit=function(y,c){y.startDragging(c);var h=this;h._interactor.fi({kind:"prepareEdit",event:c});var o=h.editing,m=h.target;if(o){if(h._fireEditEvent("begin",c),o.started=!0,"rotate"===o.mode)return o.groupRotateMode&&m.beginRotate(o),y._42(),void 0;if("connect"!==o.mode)("line"===o.mode||m&&0===m.getRotation())&&(h._inSmartGuide=!0,h._interactor.rectGuide.gatherRects());else if(o.hasDeleteAction){var g=y.gv,R=h._interactor.getStyle("connectGuideGarbageShift");o.garbageInfo={x:g.getWidth()*R[0]+R[2],y:g.getHeight()*R[1]+R[3],size:h._interactor.getStyle("connectGuideGarbageIntersectsize")},y._42()}}},wr.prototype._46O=function(O){var d,L,z=this,R=z.editing,r=z.target;if(R){if("connect"===R.mode&&!R.canceled&&!R.deleted)try{R.garbageInfo&&R.garbageInfo.hover?m.doDeleteConnectionAction(z._interactor.gv,r):m.doConnectAction(z._interactor.gv,r,R.target)}catch(Q){console.error(Q)}L=R.freezeFlag,d=z.editing.groupRotateMode,z._fireEditEvent("end",O),z.editing=null}z.tipInfo=null,z._inSmartGuide&&(z._interactor.rectGuide.clear(),z._inSmartGuide=!1),d&&r&&r.endRotate(),r instanceof q.Block&&(L===D?delete r._freezeSyncFromChildren:r._freezeSyncFromChildren=L,r.updateFromChildren())},wr.prototype.handleNormalStateDelete=function(){var O=this,k=O.editing;if(k&&"connect"===k.mode&&!k.canceled&&!k.deleted){if(k.garbageInfo){try{m.doDeleteConnectionAction(O._interactor.gv,O.target)}catch(K){console.error(K)}k.garbageInfo=null}return k.cursorPos=null,k.targetCorners=null,k.deleted=!0,O._interactor._42(),!0}},wr.prototype.handleNormalStateKeyDown=function(o){var z=this,X=z.editing;return!X||"connect"!==X.mode||X.canceled||X.deleted?void 0:q.Default.isEsc(o)?(X.cursorPos=null,X.targetCorners=null,X.canceled=!0,z._interactor._42(),!0):void 0},wr.prototype.handleEdit=function(Y,o){var H=this,n=H.editing;if(n){var O,k,e,K,M,W=H.target,v=n.key,l=n.mode,t=Y.lp(o),X=H._interactor;if("connect"===l){if(n.canceled)return;if(n.deleted)return;n.cursorPos=X._getLogicalPoint(o);var r=n.garbageInfo;return r&&gk.checkHit(n.cursorPos,r,r.size)?(r.hover=!0,n.target=null,n.targetCorners=null):(r&&(r.hover=!1),n.target=Y.getDataAt(t,function(Q){return Y.isSelectable(Q)?ge(Q)?!0:!1:!1})||null,n.targetCorners=gk.getTargetCornersOnScreen(Y,n.target)),X._42(),void 0}if("rotate"===l){var G,a,I=n.pos,D=Math.atan2(t.y-I.y,t.x-I.x);if(n.groupRotateMode?a=D-n.hitRot:(G=D-n.hitRot,a=n.rotation+G),a%=2*Math.PI,0>a&&(a+=2*Math.PI),!q.Default.isCtrlDown(o)){var j,p;Fj(o)?(j=X.getStyle("shiftRotateRound"),p=j/2):(j=X.getStyle("rotateRound"),p=X.getStyle("rotateSensitivity")),a=gk.roundTo(a,j,p)}n.groupRotateMode?(G=a-(n.lastRotation||0),0!==G&&(W.addRotation(G,n.groupRotateMode,function(K){return Y.isRotationEditable(K)}),n.lastRotation=a)):W.setRotation(a),X._setRotateCursor(D),a>Math.PI&&(a-=2*Math.PI);var f=180*(a/Math.PI);f=f.toFixed(2),O=""+f+"°"}else if("resize"===l){var h=n.rect;e=h.x,K=h.y;var J,R=h.width,S=h.height,w=n.anchor,E=n.matrix,y=W.s&&W.s("keepAspectRatio")||X.getStyle("keepAspectRatio");Fj(o)&&(y=!y);var V=H._unionPointMode1,$=H._unionPointMode2;if(H._inSmartGuide&&!q.Default.isCtrlDown(o)&&!y){var C;"L"===v||"R"===v?C="x":("T"===v||"B"===v)&&(C="y"),H._adsorbedToClosest(t,C),M=!0}J=E.tfi(t);var u;"LT"===v?(h=V(J,{x:e+R,y:K+S},R,S,y),u=9):"T"===v?(h=$({x:e,y:J.y},{x:e+R,y:K+S},R,S,y,"v"),u=1):"RT"===v?(h=V(J,{x:e,y:K+S},R,S,y),u=33):"L"===v?(h=$({x:J.x,y:K},{x:e+R,y:K+S},R,S,y,"h"),u=8):"R"===v?(h=$({x:e,y:K},{x:J.x,y:K+S},R,S,y,"h"),u=32):"LB"===v?(h=V(J,{x:e+R,y:K},R,S,y),u=12):"B"===v?(h=$({x:e,y:K},{x:e+R,y:J.y},R,S,y,"v"),u=4):"RB"===v&&(h=V(J,{x:e,y:K},R,S,y),u=36);var m=E.tf(h.x+h.width*w.x,h.y+h.height*w.y);W instanceof q.Block&&(n.hasOwnProperty("freezeFlag")||(n.freezeFlag=W._freezeSyncFromChildren,W._freezeSyncFromChildren=!0)),W.setPosition(m),W.setSize(h.width,h.height),M&&(k=W.getRect(),X.rectGuide.gatherLines({node:W,x:k.x,y:k.y,w:k.width,h:k.height},C,u)),O=""+Math.round(h.width)+" * "+Math.round(h.height)}else if("line"===l){if(Fj(o)){var d=W.getPoints(),L="P1"===v?d.get(1):d.get(0),F={x:t.x-L.x,y:t.y-L.y},T=X.getStyle("shiftLineRotateRound"),b=H._shiftDirList;
if(!b||H._shiftRotateRound!==T){H._shiftRotateRound=T,H._shiftDirList=b=[];for(var A=0;A<Math.PI;A+=T)b.push({x:P(A),y:Z(A)})}for(var Q,B=0,c=0,N=b.length;N>c;c++){var s=b[c],x=s.x*F.x+s.y*F.y;Math.abs(x)>Math.abs(B)&&(B=x,Q=s)}t={x:L.x+Q.x*B,y:L.y+Q.y*B},X.rectGuide.clear()}else H._inSmartGuide&&!q.Default.isCtrlDown(o)&&(H._adsorbedToClosest(t),M=!0);var i=gk.getDataMatrix(W).applyInverse(t);W.setPoint("P1"===v?0:1,i,!0);var _=W.getPoints(),z=_.get(0),g=_.get(1);e=z.x-g.x,K=z.y-g.y,O=" "+Math.round(Math.sqrt(e*e+K*K))+" ",M&&(k=W.getRect(),X.rectGuide.gatherLines({node:W,x:k.x,y:k.y,w:k.width,h:k.height}))}if(O){var U=q.Default.getLogicalPoint(o,X._canvas);U.x+=gk.Icons.TipShiftX,U.y+=gk.Icons.TipShiftY,H.tipInfo={helperPos:U,text:O,size:O.length}}H._fireEditEvent("between",o)}},wr.prototype._unionPointMode1=function(f,I,k,y,E){if(E&&k&&y){var $=f.x-I.x,h=f.y-I.y;Math.abs($*y)<Math.abs(h*k)?(h=Math.sign(h)*Math.abs($*y/k),f.y=I.y+h):($=Math.sign($)*Math.abs(h*k/y),f.x=I.x+$)}return q.Default.unionPoint(f,I)},wr.prototype._unionPointMode2=function(Y,L,E,j,x,I){var r=q.Default.unionPoint(Y,L);if(x&&E&&j){var M;"v"===I?(M=r.x+r.width/2,r.width=E*r.height/j,r.x=M-r.width/2):(M=r.y+r.height/2,r.height=j*r.width/E,r.y=M-r.height/2)}return r},wr.prototype._adsorbedToClosest=function(d,Y){var X=this,R=X._interactor,F=R.rectGuide.findClosest(d,Y),i=R.gridGuide.findClosest(d,Y),e=1/0,l=1/0;F&&(isFinite(F.x)&&(e=F.x),isFinite(F.y)&&(l=F.y)),i&&(isFinite(i.x)&&Math.abs(i.x)<Math.abs(e)&&(e=i.x),isFinite(i.y)&&Math.abs(i.y)<Math.abs(l)&&(l=i.y)),isFinite(e)&&(d.x+=e),isFinite(l)&&(d.y+=l)},wr.prototype._42=function(U,B,o){var I=this;I.info={},I.screenInfo=null;var l=I._interactor;if(!l.editDetail&&I.gatherInfo(B,o)){var E=I.editing,z=E?E.groupRotateMode:null,S=I.screenInfo;if("block"!==z||!E||!E.started){if(S.P1?gk.Icons.DrawIcon(l,U,gk.Icons.Line,S):gk.Icons.DrawIcon(l,U,gk.Icons.Rect,S),S.connect&&(gk.Icons.DrawIcon(l,U,gk.Icons.ConnectGuide,{rotation:S.rotation,connect:S.connect,cursorPos:E?E.cursorPos:null}),E)){if(E.targetCorners){for(var J={x:1/0,y:1/0},C={x:-1/0,y:-1/0},b=0,D=E.targetCorners.length;D>b;b+=2)J.x=Math.min(J.x,E.targetCorners[b]),C.x=Math.max(C.x,E.targetCorners[b]),J.y=Math.min(J.y,E.targetCorners[b+1]),C.y=Math.max(C.y,E.targetCorners[b+1]);gk.Icons.DrawIcon(l,U,gk.Icons.HoverDataRect,{min:J,max:C,color:l.getStyle("hoverGuideColor")||l.getStyle("baseColor")})}E.garbageInfo&&gk.Icons.DrawIcon(l,U,gk.Icons.ConnectGuideGarbage,E.garbageInfo)}l.getStyle("rotateTipVisible")&&I.tipInfo&&gk.Icons.DrawIcon(l,U,gk.Icons.TipHelper,I.tipInfo)}I.target instanceof gk.Group&&I.target._42(l,U,B)}};var bq=gk.Anchor=function(P){this.catalog="Anchor",this._interactor=P};bq.prototype={},bq.prototype.constructor=bq,bq.prototype.gatherInfo=function(k,O){var j=this;if(1===O.length){var Q=O[0];if(!Q.getAnchor)return;if(Q instanceof q.Shape&&Q._70I())return;if(af(Q,k))return;return j.gatherSingleTarget(k,O[0])}return O.length>1?j.gatherMultiTargets(k,O):!1},bq.prototype.gatherSingleTarget=function(u,U){var S=this;return S.info.POS=U.getPosition(),S.screenInfo.POS=gk.toScreenPosition(u,S.info.POS),S.target=U,!0},bq.prototype.gatherMultiTargets=function(J,p){var H=this,M=gk.Group.findOrCreateGroup(p,this._interactor._uuid);return M?(H.screenInfo.POS=gk.toScreenPosition(J,M.getAnchor2()),H.target=M,!0):!1},bq.prototype.isVisible=function(){var i=this,r=i._interactor;if(r.getStyle("anchorVisible")===!1)return!1;var G=i.target;if(G){if(this.editing)return!0;var $=G.getAnchor(),j=r.getStyle("anchorOutsideVisibleThreshold");if($.x<-j||$.x>1+j||$.y<-j||$.y>1+j)return!0;var q=G.getSize(),t=G.getScale(),E=Math.min(Math.abs(q.width*t.x),Math.abs(q.height*t.y));if(E*r.gv._zoom<r.getStyle("anchorHideThreshold"))return!1}return!0},bq.prototype.check=function(S,H,n){if(q.Default.isLeftButton(H)){var v=this,J=v._interactor;if(v.isVisible()&&J.getStyle("anchorMovable")!==!1){v.editing=null,v.tipInfo=null;var m=v.target;if(m&&S.isAnchorEditable(m)&&S.isEditable(m)){var A;if(v.screenInfo&&(A=v.screenInfo.POS)&&gk.checkHit(n,new gk.Math.Vector2(A),J.getStyle("checkSize"))){if(m instanceof gk.Group)return v.editing={},!0;var y=m.getWidth(),b=m.getHeight(),I=m.getAnchor();return v.editing={rect:{x:-y*I.x,y:-b*I.y,width:y,height:b},anchor:I,matrix:m.getMatrix()},!0}}}}},bq.prototype.startEdit=function(p,Q){p.startDragging(Q),p.fi({kind:"beginEditAnchor",event:Q})},bq.prototype._46O=function(r){var w=this;w.editing&&(w.editing=null,w._interactor.fi({kind:"endEditAnchor",event:r})),w.tipInfo=null},bq.prototype.handleEdit=function(M,W){var s=this,E=s.target;if(E){var p=s.editing;if(p){var f=M.lp(W),r=s._interactor;if(E instanceof gk.Group)return E.setAnchor2(f),r._42(),void 0;var F=p.matrix,G=F.tfi(f),P=p.rect,Z=(G.x-P.x)/P.width,$=(G.y-P.y)/P.height;if(!q.Default.isCtrlDown(W)){var J=r.getStyle("anchorRound"),m=r.getStyle("anchorSensitivity");Z=gk.roundTo(Z,J,m),$=gk.roundTo($,J,m)}E.setAnchor(Z,$,!0);var O=q.Default.getLogicalPoint(W,r._canvas);O.x+=gk.Icons.TipShiftX,O.y+=gk.Icons.TipShiftY;var T=""+Z.toFixed(2)+", "+$.toFixed(2);s.tipInfo={helperPos:O,text:T,size:T.length},r.fi({kind:"betweenEditAnchor",event:W})}}},bq.prototype._42=function(K,s,b){var k=this;k.info={},k.screenInfo={};var V=k._interactor;V.editDetail||k.gatherInfo(s,b)&&k.isVisible()&&(gk.Icons.DrawIcon(V,K,gk.Icons.Anchor,k.screenInfo),k.tipInfo&&gk.Icons.DrawIcon(V,K,gk.Icons.TipHelper,k.tipInfo))};var ie=gk.MoveDummy=function(m){this.catalog="MoveDummy",this._interactor=m};ie.prototype={},ie.prototype.constructor=ie,ie.prototype.gatherInfo=function(){var m=this,Q=this._interactor.getSubModule("Rect");if(Q){var k=Q.screenInfo;if(k){var f=m._interactor,P=m.getMovableTarget(Q.target);if(P){var j=f.getStyle("moveDummyThreshold");if(j!==!1){var o=k.LT||k.P1,H=k.RT||k.P2,g=k.LB||o;if(o){var n=k.P1,D=Math.min(o.distanceTo(g),o.distanceTo(H));if(!(j!==!0&&D>j)){var A=f.getStyle("moveDummyPosition"),h=H.clone().sub(o),c=g.clone().sub(o),e=A[2],S=A[3];if(n){var V=f.getStyle("moveDummyLineExtraShift");V&&(e+=V[0],S+=V[1])}var t=o.clone().add(h.clone().multiplyScalar(A[0])).add(h.setLength(e)).add(c.clone().multiplyScalar(A[1])).add(c.setLength(S));return m.screenInfo.pos=t,m.screenInfo.size=f.getStyle("moveDummySensitivity"),!0}}}}}}},ie.prototype.getMovableTarget=function(u){var x=this._interactor.gv;if(ge(u)){if(x.isMovable(u))return u}else if(u instanceof gk.Group)for(var p=u._entities,H=p.length-1;H>=0;H--){var Z=p[H];if(ge(Z)&&x.isMovable(Z))return Z}return null},ie.prototype.getMoveInteractor=function(){for(var T,B,X,a=this._interactor.gv,f=a.getInteractors(),T=0,B=f.length;B>T;T++)if(X=f.get(T),X instanceof Ir)return X},ie.prototype.startEdit=function(T,U){T.startDragging(U);var r=this.getMoveInteractor();if(r){var G=this.selectedTarget,J=T.gv;J._moving=1,r._data=G,J.handleMouseDown&&J.handleMouseDown(U,G)}},ie.prototype._46O=function(H){var h=this,t=h.getMoveInteractor();t&&(t.handleWindowMouseUp(H),h.selectedTarget=null)},ie.prototype.handleEdit=function(A,R){var U=this.getMoveInteractor();U&&U.handleWindowMouseMove(R)},ie.prototype.check=function(R,e,A){if(this.selectedTarget=null,q.Default.isLeftButton(e)&&!R._scrolling&&!tk()){var h=this;if(h.screenInfo){var S=h.screenInfo.pos;if(S&&!(A.distanceTo(S)>h.screenInfo.size)){var K=h._interactor;return h.selectedTarget=h.getMovableTarget(K.getSubModule("Rect").target),K.setCursor("default"),!0}}}},ie.prototype._42=function(h,v,J){var t=this;t.screenInfo={};var O=t._interactor;O.editDetail||t.gatherInfo(v,J)&&(!O.editing||t.selectedTarget)&&gk.Icons.DrawIcon(O,h,gk.Icons.MoveDummy,t.screenInfo)};var Mn=gk.RotateX=function(b){this.catalog="RotateX",this._interactor=b};Mn.prototype={},Mn.prototype.constructor=Mn,Mn.prototype.gatherInfo=function(o,x){var _=this;if(1===x.length){var A=x[0];return A instanceof q.Shape&&A._70I()||af(A,o)?!1:_.gatherSingleTarget(o,A)}return x.length>1?_.gatherMultiTargets(o,x):!1},Mn.prototype.gatherSingleTarget=function(){var s=new q.Math.Vector2,p=new q.Math.Vector2,F=new q.Math.Vector2,S=new q.Math.Vector2,k=function(d,c){var N=d.x-c.x,a=d.y-c.y;return N*N+a*a};return function(D,i){if(i.getCorners){var w=this,l=i.getCorners(),I=15,o=i.getPosition();s.copy(l[0]),F.copy(l[1]),S.copy(l[3]),p.copy(s).add(S).divideScalar(2).add(s.sub(F).setLength(I/D.getZoom()));var z=Math.max(k(o,l[0]),k(o,l[1]),k(o,l[2]),k(o,l[3]));return w.info.POS=p.clone(),w.screenInfo.POS=gk.toScreenPosition(D,w.info.POS),w.screenInfo.LEN=Math.sqrt(z)*D.getZoom()+I,w.screenInfo.CENTER=gk.toScreenPosition(D,o),w.target=i,!0}}}(),Mn.prototype.gatherMultiTargets=function(l,D){var Z=this,_=gk.Group.findOrCreateGroup(D,this._interactor._uuid);if(!_)return!1;var Z=this;return Z.gatherSingleTarget(l,_)},Mn.prototype.isVisible=function(){var T=this._interactor;if(!T.getStyle("rotateAsClock"))return!1;var v=this.target;if(!v)return!0;var z=T.gv;return z.isEditable(v)&&z.isRotationEditable(v)?!0:!1},Mn.prototype.check=function(H,B,C){var o=this,p=o._checkImpl(H,B,C);return(p||o._clockPainted)&&o._interactor._42(),p},Mn.prototype._checkImpl=function(W,L,B){if(q.Default.isLeftButton(L)){var A=this;A.editing=null,A.tipInfo=null;var u;if(A.screenInfo&&(u=A.screenInfo.POS)&&A.isVisible()){var b=A._interactor;if(gk.checkHit(B,u,b.getStyle("checkSize"))){var h=A.target,f=W.lp(L),_=h.getPosition(),j=Math.atan2(f.y-_.y,f.x-_.x);return b._setRotateCursor(j),A.editing={pos:_,rotation:h.getRotation(),hitRot:j,groupRotateMode:"block",screenInfo:{CENTER:A.screenInfo.CENTER,LEN:A.screenInfo.LEN}},!0}}}},Mn.prototype.startEdit=function(R,U){R.startDragging(U),R.fi({kind:"beginEditRotation",event:U}),this.target instanceof gk.Group&&this.target.beginRotate(this.editing)},Mn.prototype._46O=function(z){var o=this;o.editing&&(o.editing=null,o._interactor.fi({kind:"endEditRotation",event:z})),o.target instanceof gk.Group&&o.target.endRotate(),o.tipInfo=null},Mn.prototype.handleEdit=function(Z,U){var F=this,X=F.editing;if(X){var S,P,l=F.target,y=Z.lp(U),D=F._interactor,L=X.pos,r=Math.atan2(y.y-L.y,y.x-L.x),m=l instanceof gk.Group;if(m?P=r-X.hitRot:(S=r-X.hitRot,P=X.rotation+S),P%=2*Math.PI,0>P&&(P+=2*Math.PI),!q.Default.isCtrlDown(U)){var s,a;Fj(U)?(s=D.getStyle("shiftRotateRound"),a=s/2):(s=D.getStyle("rotateRound"),a=D.getStyle("rotateSensitivity")),P=gk.roundTo(P,s,a)}m?(S=P-(X.lastRotation||0),0!==S&&(l.addRotation(S,X.groupRotateMode,function(Q){return Z.isRotationEditable(Q)}),X.lastRotation=P)):l.setRotation(P),D._setRotateCursor(r),P>Math.PI&&(P-=2*Math.PI);var O=180*(P/Math.PI),N=""+O.toFixed(2)+"°",A=q.Default.getLogicalPoint(U,D._canvas);A.x+=gk.Icons.TipShiftX,A.y+=gk.Icons.TipShiftY,F.tipInfo={helperPos:A,text:N,size:N.length},D.fi({kind:"betweenEditRotation",event:U})}},Mn.prototype._42=function(H,n,L){var r=this;r._clockPainted=!1,r.info={},r.screenInfo={};var l=r._interactor;l.editDetail||r.gatherInfo(n,L)&&r.isVisible()&&(gk.Icons.DrawIcon(l,H,gk.Icons.RoundPoint,r.screenInfo.POS),l.getStyle("rotateTipVisible")&&r.tipInfo&&gk.Icons.DrawIcon(l,H,gk.Icons.TipHelper,r.tipInfo),r.editing&&r.drawClock(H))},Mn.prototype.drawClock=function(N){N.save();var K=this;K._clockPainted=!0;var T=K.editing||{},V=T.screenInfo||K.screenInfo,n=V.LEN,J=n+8,f=n+18;N.save(),N.translate(V.CENTER.x,V.CENTER.y),N.beginPath(),N.strokeStyle="rgb(150, 150, 150)";for(var S,j,b,i,z,Y=0;360>Y;Y++)S=Y*Math.PI/180,0===Y%5&&(j=Z(S)*n,b=P(S)*n,i=Z(S)*J,z=P(S)*J,N.moveTo(j,b),N.lineTo(i,z)),0===Y%45&&(j=Z(S)*n,b=P(S)*n,i=Z(S)*f,z=P(S)*f,N.moveTo(j,b),N.lineTo(i,z));N.stroke(),N.rotate(-Rm);var k=T.lastRotation||K.target.getRotation();N.beginPath(),N.fillStyle="rgba(255, 0, 0, 0.1)",N.strokeStyle="rgb(157, 157, 157)",N.moveTo(0,0),N.arc(0,0,f,0,k,!1),N.fill(),N.beginPath(),N.moveTo(0+f,0),N.arc(0,0,f,0,k,!1),N.stroke(),N.restore()};var Sk=gk.Curve=function(N){this.catalog="Curve",this._interactor=N};Sk.prototype={},Sk.prototype.constructor=Sk,t.defineProperties(Sk.prototype,{activing:{get:function(){return this._activing},set:function(f){var Z=this;if(f)Z._activing=new gk.CurveActiving(this,f),Z._activing._firePointChange();else{var A=Z._activing;A&&A.dispose(),Z._activing=null}}}}),Sk.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Sk.prototype.setUp=function(){var A=this,o=A._interactor;o&&o.gv.mp(A._onGraphviewPropertyChanged,A)},Sk.prototype._onGraphviewPropertyChanged=function(K){("zoom"===K.property||"translateX"===K.property||"translateY"===K.property)&&this._handleDataChanged()},Sk.prototype.tearDown=function(){var t=this,p=t._interactor;p&&p.gv.ump(t._onGraphviewPropertyChanged,t)},Sk.prototype.canEnterEditDetailMode=function(){var e=zb(this._interactor);return e?this.target=e:void 0},Sk.prototype.canQuitEditDetailMode=function(N){var t=this,D=t._interactor._getLogicalPoint(N);return t._checkEditRealPoint(D)?void 0:t._interactor.gv.getDataAt(N)!==t.target?!0:void 0},Sk.prototype.preHandleScroll=function(){var G=this.editing;return G&&G.inEdit?!0:void 0},Sk.prototype.getCurrentSelectintStatus=function(){var X=this;if(X.activing&&!X.activing.selections){if(X.activing.status!=D)return X.activing.status;var h=function(L){var g=X.activing.status;X.activing.status=L,X._interactor.fp("shapePointStatus",g,L)},z=gk.Curve.PointType,k=X.activing.point,g=X.activing.pairs;if(!g||1!==g.length)return h(z.Mirrored);var o=g[0],d=o.c1&&o.c1.isNearEnough(k),B=o.c2&&o.c2.isNearEnough(k);if(!o.c1||!o.c2)return d||B?h(z.Straight):h(z.Disconnected);if(d&&B)return h(z.Straight);if(d||B)return h(z.Asymmetric);var f=o.c1.clone().sub(k),O=o.c2.clone().sub(k);return Math.abs(f.x*O.y-f.y*O.x)>1e-5||f.x*O.x>0?h(z.Disconnected):Math.abs(f.length()-O.length())>1e-5?h(z.Asymmetric):h(z.Mirrored)}},Sk.prototype.handle_keydown=function(u){var l=this;if(l._interactor.editDetail){var r=gk.Curve.PointType;"1"===u.key?l._setCurrentSelectionStatus(r.Straight):"2"===u.key?l._setCurrentSelectionStatus(r.Mirrored):"3"===u.key?l._setCurrentSelectionStatus(r.Disconnected):"4"===u.key&&l._setCurrentSelectionStatus(r.Asymmetric)}},Sk.prototype.setCurrentSelectionStatus=function(z){var r=this,b=r._interactor;if(b){var C=b.gv;C.dm().beginTransaction(),this._setCurrentSelectionStatus(z),C.dm().endTransaction()}},Sk.prototype._setCurrentSelectionStatus=function(U){var j=this,X=j.activing;if(X){var x=j.getCurrentSelectintStatus();if(null!==x&&x!==U){X.status=U;var T=j.activing.point,W=j.activing.pairs;if(W&&1===W.length){var Z=W[0],H=j.screenInfo.curve,i=gk.Curve.PointType,d=j._interactor,Q=function(){j._writeToHt(),d.fp("shapePointStatus",x,U),j.check(d.gv,null,new gk.Math.Vector2(d._lastLogicalPoint))};if(U===i.Straight)return H.moveCtrlPoint(Z,T,"c1"),H.moveCtrlPoint(Z,T,"c2"),Q(),void 0;if(x===i.Straight){var B=H.findPairs(T,!0),F=B[0],O=F.r1||T,C=F.r2||T,E=C.clone().sub(O).multiplyScalar(.25);return H.moveCtrlPoint(Z,T.clone().sub(E),"c1"),H.moveCtrlPoint(Z,T.clone().add(E),"c2"),Q(),void 0}var k=Z.c1,D=Z.c2;if(k&&D){if(U===i.Mirrored)return H.moveCtrlPoint(Z,T.clone().multiplyScalar(2).sub(D),"c1"),Q(),void 0;if(U===i.Asymmetric&&x===i.Disconnected){var e=k.clone().sub(T).length(),E=T.clone().sub(D).setLength(e).add(T);return H.moveCtrlPoint(Z,E,"c1"),Q(),void 0}}X._firePointChange(),d.fp("shapePointStatus",x,U),j.check(d.gv,null,new gk.Math.Vector2(d._lastLogicalPoint))}}}},Sk.prototype._handleDataChanged=function(){var d="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(B){var Z=this;if(Z.screenInfo&&Z.target){if(B&&d.indexOf(B.property)<0)return;var k=Z._interactor;Z.gatherSingleTarget(k.gv,Z.target,!0),Z.check(k.gv,null,new gk.Math.Vector2(k._lastLogicalPoint)),k._42()}}}(),Sk.prototype.gatherSingleTarget=function(x,Q,W){var P,R,T=this;T.screenInfo&&T.screenInfo.curve&&(R=T.screenInfo.curve._curves);var p=T.editing;P=p?T.screenInfo:T.screenInfo={};var G,y,u=Q instanceof q.Edge;u?(G=Q.s("edge.segments"),y=Q.s("edge.points")||new q.List):(G=Q._58O,y=Q._59O),P.S=G;var t,h=P.P=[],J=gk.getDataMatrix(Q);if(Q instanceof q.Polyline||Q instanceof q.Edge&&T._interactor.getStyle("edgeElevationEditable"))t=Q.getElevation&&Q.getElevation()||0,P.E=[];else{var V=!1;y.each(function(W){W.e!==D&&(V=!0)}),V&&(P.E=[])}if(y.each(function(n){P.E&&P.E.push(n.e!=D?n.e:t),n=J.apply(n);var f=gk.toScreenPosition(x,n);h.push(f.x,f.y)}),u){var r=h.length,g=gk.toScreenPosition(x,Q._lastSourcePoint||(r?{x:h[0],y:h[1]}:{x:0,y:0})),F=gk.toScreenPosition(x,Q._lastTargetPoint||(r?{x:h[r-2],y:h[r-1]}:{x:0,y:0}));if(h.splice(0,0,g.x,g.y),h.push(F.x,F.y),P.E){var e=Q.getSource(),$=Q.getTarget();P.E.splice(0,0,((Q.s("edge.source.anchor.elevation")||.5)-.5)*e.getTall()+e.getElevation()),P.E.push(((Q.s("edge.target.anchor.elevation")||.5)-.5)*$.getTall()+$.getElevation())}}if(!P.S||!P.S.size()){P.S=new q.List,P.S.add(1);for(var O=0;O<h.length/2-1;O++)P.S.add(2)}if((!p||W)&&T.convertToCubicBezier(R),T.activing&&(W||!T.editing||"realPoint"===T.editing.type)){var k=P.curve.findPairs(T.activing.point);T.activing.pairs=k}},Sk.prototype._convertToNewPoint=function(V,w,B,f){var S,E,N;for(S=0,E=w.length;E>S;S++){if(N=w[S],N._p1.isNearEnough(V)&&(!f||f.indexOf(N._p1)<0))return N._p1;if(N._p4.isNearEnough(V)&&(!f||f.indexOf(N._p4)<0))return N._p4}if(B)for(S=0,E=Math.min(B.length,E);E>S;S++){if(N=B[S],N._p1===V&&(!f||f.indexOf(w[S]._p1)<0))return w[S]._p1;if(N._p4===V&&(!f||f.indexOf(w[S]._p4)<0))return w[S]._p4}},Sk.prototype.convertToCubicBezier=function(V){var C,w,M=this,j=new gk.Math.Curve,Y=M.screenInfo;if(j.createFromHtShape(Y.P,Y.S,Y.E),Y.curve=j,M.activing){var E=j._curves;C=M.activing.point,w=M._convertToNewPoint(C,E,V);var $=[];if(w&&(M.activing.point=w,$.push(w)),M.activing.selections){var F=-1,X=M.activing.selections;X.forEach(function(Y){F++,w=M._convertToNewPoint(Y,E,V,$),w&&(X[F]=w,$.push(w))})}}},Sk.prototype.check=function(y,G,n){if(!G||Cm(G)||Jn(G)){var I=this;if(I._interactor.setCursor("default"),I.editing=null,I.highlight=null,I.tipInfo=null,I.edgeEditResult=null,I.screenInfo){if(tk()||G&&Jn(G))return I._interactor._42(),!0;if(I._checkEditCtrlPoint(n))return I._interactor._42(),!0;if(I._checkEditRealPoint(n))return I._interactor._42(),!0;if(I._checkEditElevation(n))return I._interactor._42(),!0;var x=I.screenInfo.curve,i=x.checkPoint(n,I._interactor.getStyle("curveIntersectSize"));if(i){var Q=I.highlight={};Q.type="insertKnot",Q.bezier=i.bezier,Q.point=i.intersection}return I._interactor._42(),!0}}},Sk.prototype.getAdjacentBeziers=function(s){var K=this.screenInfo;if(K){var e,R,z,g=K.curve._curves,P=[],E=D;for(e=0,R=g.length;R>e;e++)if(z=g[e],E===D){if(z._p4.isNearEnough(s)){P.push(z),E=e;continue}}else{if(z._p1.isNearEnough(s))return P.push(z),P;if(z._p4.isNearEnough(s)){P[0]=z,E=e;continue}}}},Sk.prototype.roundCorner=function(f){if(this.activing&&this.screenInfo){var A=this.screenInfo.curve,o=A._curves,l=this.getAdjacentBeziers(this.activing.point),U=l[1],E=U._index;U=U.insertKnot(U.getTByPercentage(f/U.length))[1],o[E]=U;var w=U.p1,t=l[0],N=t._index;t=t.insertKnot(t.getTByPercentage(1-f/t.length))[0],o[N]=t;var M=t.p4,B=this.activing.point,Q=new gk.Math.CubicBezier(M,B.clone().sub(M).multiplyScalar(2/3).add(M),B.clone().sub(w).multiplyScalar(2/3).add(w),w);o.splice(E,0,Q),this._writeToHt(),this.activing=null,this._interactor._42()}},Sk.prototype._checkEditRealPoint=function(z){var Q,w,l,J,x,N,R=this,f=R.screenInfo.curve._curves,G=R._interactor.getStyle("curvePointIntersectSize"),k=1/0;for(G*=G,l=0,J=f.length;J>l;l++)Q=f[l],x=Q._p1,N=z.distanceToSquared(x),k>N&&(k=N,w=x),x=Q._p4,N=z.distanceToSquared(x),k>N&&(k=N,w=x);if(k>G)return!1;var _=R.highlight={};return _.type="changeRealPoint",_.point=w,R.editing={type:"realPoint",point:w,shiftGuide:{point:w.clone(),dir:"x",limit:0}},R._interactor.setCursor("crosshair"),!0},Sk.prototype._checkEditElevation=function(Q){var m=this;if(!m._interactor.getStyle("curveElevationVisible"))return!1;var x=m.target;if(x instanceof q.Edge&&!m._interactor.getStyle("edgeElevationEditable"))return!1;var G=m.activing;if(!G)return!1;var l=G.getCurrentEditingPoint();if(!l)return!1;var j=m._interactor,$=j.getStyle("curveElevationGuideShift"),v=j.getStyle("curveElevationIntersectSize"),a=Q.distanceToSquared({x:l.x+$[0],y:l.y+$[1]});if(!(a>v*v)){var T=m.highlight={};T.type="elevation";var I=new gk.Math.Vector2(Q.x,Q.y,l.e);return m.editing={type:"elevation",startPoint:I},m._interactor.setCursor("crosshair"),!0}},Sk.prototype._checkEditCtrlPoint=function(O){var X=this;if(X.activing&&!X.activing.selections){var Y=X.getCurrentSelectintStatus();if(Y!==gk.Curve.PointType.Straight){var V=X.activing.pairs;if(V){var m=X._interactor.getStyle("curvePointIntersectSize");m*=m;var Q,n,o,l,$,t,g,k,M,A=1/0;for(g=0,M=V.length;M>g;g++)for(l=V[g],k=0;2>k;k++)$=0===k?"c1":"c2",l[$]&&(t=O.distanceToSquared(l[$]),A>t&&(A=t,Q=l,n=g,o=$));if(A>m)return!1;X.activing.hlpair=Q,X.activing.hltype=o;var S=X.highlight={};return S.type="changeCtrlPoint",S.point=Q[o],X.editing={type:"ctrlPoint",pair:Q,pairId:n,ctrlType:o,direction:Q[o].clone().sub(X.activing.point).normalize()},X._interactor.setCursor("crosshair"),!0}}}},Sk.prototype.startEdit=function(x,f){x.startDragging(f);var A=this;A.highlight&&"insertKnot"===A.highlight.type&&(A.insertKnot(),A.gatherSingleTarget(A._interactor.gv,A.target),A.activing=null,A._checkEditRealPoint(A._interactor._getLogicalPoint(f)));var B=A._activing;if(B){var j=A.editing?A.editing.type:null;"ctrlPoint"===j?B.editingCtrl={pairId:A.editing.pairId,type:B.hltype}:"realPoint"===j&&(B.editingCtrl=!1)}var o=A.highlight,U=q.Default.isCtrlDown(f);if(!o||tk()||Jn(f)){var P=A._interactor.gv;if(!P.setFocus(f)||P._scrolling)return;return U?A._multiSelect={startPoint:P.lp(f)}:P.isPannable()&&(Cm(f)||Jn(f))&&(A._pan={tx:P.tx(),ty:P.ty()},x.fi({kind:"beginPan",event:f})),void 0}if("changeRealPoint"===o.type){var s,Y=A.activing?A.activing.point:null,O=A.activing?A.activing.selections:null;if(U&&A.activing)Y===o.point?(O?(A.activing={point:O[0]},O.length>1&&(O.splice(0,1),A.activing.selections=O)):A.activing=null,A.editing=null):O&&(s=O.indexOf(o.point))>=0?(O.length>1?O.splice(s,1):delete A.activing.selections,A.editing=null):O?(O.push(Y),A.activing={point:o.point,selections:O}):A.activing={point:o.point,selections:[Y]};else if(O)Y===o.point||((s=O.indexOf(o.point))>=0?(O.splice(s,1,Y),A.activing={point:o.point,selections:O}):A.activing={point:o.point});else{var _;Y===o.point&&(_=A.activing.status),A.activing={point:o.point},_&&(A.activing.status=_)}x.fi({kind:"beginEditPoint",event:f})}},Sk.prototype.insertKnot=function(){var n=this,e=n.highlight,s=n.screenInfo.curve;s.insertKnot(e.bezier,e.point.t),n._writeToHt()},Sk.prototype._writeToHt=function(){var l,h,L=this,$=L.screenInfo.curve,F=$.toHtShape(),o=F.points,j=[],x=F.segments,c=L._interactor.gv;c.dm().beginTransaction();var X,y,w=L.target,K=w instanceof q.Edge,W=gk.getDataMatrix(w).invert();y=w instanceof q.Polyline||K&&L._interactor.getStyle("edgeElevationEditable"),y&&(X=w.getElevation&&w.getElevation()||0);for(var O=0,z=o.length;z>O;O++)l=o[O],h=gk.toWorldPosition(c,l),h=W.apply(h),isFinite(l.e)&&l.e!==X&&(h.e=l.e),j.push(h);if(w._writing=!0,K){w.s("edge.type","points"),w.setStyle("edge.segments",x),w.setStyle("edge.points",j.slice(1,j.length-1)),w.setStyle("edge.source.offset.x",0),w.setStyle("edge.source.offset.y",0),w.setStyle("edge.target.offset.x",0),w.setStyle("edge.target.offset.y",0);var Y=L._nextChangeEdgeHost;delete L._nextChangeEdgeHost,Y&&("source"===Y.type?w.setSource(Y.host):w.setTarget(Y.host)),L._writeEdgeHostAnchor("source",j[0]),L._writeEdgeHostAnchor("target",j[j.length-1])}else j.length?(w.setSegments(x),w.setPoints(j,!0)):w.removeFromDataModel();c.dm().endTransaction(),delete w._writing},Sk.prototype._writeEdgeHostAnchor=function(K,Q){var X=this,N=X.target,o=X._calcHostAnchor(N,K,Q);o.index!==D?(N.setStyle("edge."+K+".index",o.index),N.setStyle("edge."+K+".percent",D),N.setStyle("edge."+K+".anchor.x",D),N.setStyle("edge."+K+".anchor.y",D)):o.percent!==D?(N.setStyle("edge."+K+".percent",o.percent),N.setStyle("edge."+K+".index",D),N.setStyle("edge."+K+".anchor.x",D),N.setStyle("edge."+K+".anchor.y",D)):(N.s("edge."+K+".anchor.x",o.x),N.s("edge."+K+".anchor.y",o.y),N.s("edge."+K+".anchor.elevation",o.e),o.offsetX||o.offsetY?(N.s("edge."+K+".offset.x",o.offsetX),N.s("edge."+K+".offset.y",o.offsetY),N.s("edge."+K+".offset.elevation",o.offsetElevation)):(N.s("edge."+K+".offset.x",0),N.s("edge."+K+".offset.y",0),N.s("edge."+K+".offset.elevation",0)))},Sk.prototype._calcHostAnchor=function(q,n,g,B){B||(B="source"===n?q.getSource():q.getTarget());var Q=this._interactor.gv,o=Q.calculateAttachPoint(B,g);if(o)return o.info;if(Lb(B)){var I=Q.calculateEdgePosition(B,g);return I}var Z=B.getRotation(),R=B.getAnchor();af(B,Q)&&(Z=0);var F=B.getElevation(),l=B.getTall();F=((g.e||0)-F)/l+.5;var p=B.getScale();if(Z||p.x<0||p.y<0){var s=B.getMatrix(),A=s.tfi(g),x=B.getSize();return{x:A.x/x.width+R.x,y:A.y/x.height+R.y,e:F}}var u=Dj(Q,B),t={x:(g.x-u.x)/u.width,y:(g.y-u.y)/u.height,e:F};return t},Sk.prototype._handlePanning=function(n){var L=this,J=L._pan;if(J){J.started=!0;var F=L._interactor,Y=F.gv,M=F._lastClientPoint,P=Lp(n),s=Fm(Y,P,M);Y.setTranslate(J.tx+s.x,J.ty+s.y),L.gatherSingleTarget(F.gv,L.target),F._42(),F.fi({kind:"betweenPan",event:n})}},Sk.prototype.handleEdit=function(P,F){var r=this,t=r.editing;if(r._pan)return r._handlePanning(F),void 0;if(r._multiSelect)return r._multiSelect.endPoint=P.lp(F),r._interactor.redraw(),void 0;if(t){t.inEdit=!0;var p,_,k,A=r._interactor._getLogicalPoint(F),x=q.Default.isCtrlDown(F),Z=q.Default.isShiftDown(F),L=t.type,R=r.activing;if(r._guideInfo=null,"ctrlPoint"===L&&Z){var l=r.editing.direction.clone();p=R.point;var b=l.dot(A.clone().sub(p));A=l.setLength(b).add(p)}else if("ctrlPoint"===L||"realPoint"===L){var l;if("realPoint"===L&&Z){var z=r.editing.shiftGuide;_=z.point;var B=Math.abs(A.x-_.x),E=Math.abs(A.y-_.y);B>E&&B>z.limit&&"y"===z.dir&&(z.dir="x"),E>B&&E>z.limit&&"x"===z.dir&&(z.dir="y"),l=z.dir,"x"===l?(A.y=_.y,z.limit=Math.max(z.limit,B)):"y"===l&&(A.x=_.x,z.limit=Math.max(z.limit,E))}var Q=r._isEditEdgeSourceTarget();if(Q){var G=r._editEdgeSourceTarget(Q,A,x);G&&(r.edgeEditResult=G,k=G.tipText)}else if(!x){var e=r._guidingToEdit(A,l),i="realPoint"===L?r._interactor.gridGuide.findClosest(A,l,!0):null,o=1/0,d=1/0;i&&(i.x&&(o=i.x),i.y&&(d=i.y));var a=!1;e&&(e.xList&&(Math.abs(e.x)<=Math.abs(o)?(a=!0,o=e.x):delete e.xList),e.yList&&(Math.abs(e.y)<=Math.abs(d)?(a=!0,d=e.y):delete e.yList),a&&(r._guideInfo=e)),isFinite(o)&&(A.x+=o),isFinite(d)&&(A.y+=d),a&&(e.v=A)}}var S=r.screenInfo.curve;if("realPoint"===t.type){p=t.point,p.e!==D&&(A.e=p.e),S.moveRealPoint(p,A),t.point=A,r.highlight.point=A;var C=R.status,H=R.selections;if(r.activing={point:A,status:C},H){var y=A.clone().sub(p),s=0;H.forEach(function(F){var o=F.clone().add(y);S.moveRealPoint(F,o),H[s++]=o}),r.activing.selections=H}}else if("ctrlPoint"===t.type){var X=R.pairs,h=X[t.pairId];S.moveCtrlPoint(h,A,t.ctrlType);var K=R.status,n=gk.Curve.PointType;if((K===n.Mirrored||K===n.Asymmetric)&&h.c1&&h.c2){var p=new gk.Math.Vector2(R.point),Y="c1"===t.ctrlType?"c2":"c1";if(K===gk.Curve.PointType.Mirrored)S.moveCtrlPoint(h,p.clone().multiplyScalar(2).sub(A),Y);else if(K===n.Asymmetric){var b=h[Y].clone().sub(p).length(),J=p.clone().sub(h[t.ctrlType]).setLength(b).add(p);isNaN(J.x)||S.moveCtrlPoint(h,J,Y)}}R._firePointChange()}else if("elevation"===t.type){_=t.startPoint;var c=_.e+(_.y-A.y)/P._zoom;r._setCurrentPointImpl("e",c),R._firePointChange(),k="E: "+gk.toFixed(c)}var I=q.Default.getLogicalPoint(F,r._interactor._canvas);if(I.x+=gk.Icons.TipShiftX,I.y+=gk.Icons.TipShiftY,!k){var N=gk.toWorldPosition(P,A);k=""+gk.toFixed(N.x)+", "+gk.toFixed(N.y)}r.tipInfo={helperPos:I,text:k,size:k.length},r._writeToHt(),r._interactor.fi({kind:"betweenEditPoint",event:F})}},Sk.prototype._setCurrentPointImpl=function(z,C){var X=this,c=X._activing;if(!c)return!1;var y=X.target;if(!y)return!1;var R=c.getCurrentEditingPoint();if(!R)return!1;var s=c.editingCtrl;if(!s)var E=R.clone();if("e"===z)R.e=C;else{var F;if("x"===z||"y"===z){var f=c._lastFirePoint;F="x"===z?{x:C,y:f?f.y:0}:{x:f?f.x:0,y:C}}else"object"==typeof z?(F=z,z.e!==D&&(R.e=z.e)):(F={x:arguments[0],y:arguments[1]},arguments[2]!==D&&(R.e=arguments[2]));var G=gk.getDataMatrix(y);F=gk.toScreenPosition(X._interactor.gv,G.apply(F)),R.x=F.x,R.y=F.y}if(!s){var d=E.multiplyScalar(-1).add(R);R.e&&E.e&&(d.e=R.e-E.e);var Y=X.screenInfo.curve;Y.moveCtrlDueToRealPointMovement(R,d);var x=c.selections;if(x){var T=0;x.forEach(function(i){var _=i.clone().add(d);isFinite(d.e)&&(_.e=(isFinite(i.e)?i.e:y.getElevation()||0)+d.e),Y.moveRealPoint(i,_),x[T++]=_}),c.selections=x}}return!0},Sk.prototype.setCurrentPoint=function(U,R){return this._setCurrentPointImpl(U,R)?(this._writeToHt(),!0):!1},Sk.prototype._isEditEdgeSourceTarget=function(){var i=this,X=i.target;if(!(X instanceof q.Edge))return!1;var D=i.editing.point,l=i.screenInfo.curve._curves;return D===l[0]._p1?"source":D===l[l.length-1]._p4?"target":!1},Sk.prototype._editEdgeSourceTarget=function(N,K,e){var U,l=this,u=l.target;if(U="source"===N?u.getSource():u.getTarget()){var m,a=l._interactor.gv,t=gk.toWorldPosition(a,K),s=l._calcHostAnchor(u,N,t,U);if(m=s.index!==D||s.percent!==D?s.distance*a.getZoom()>l._interactor.getStyle("edgeHostEdgeMaxDistance"):l._interactor.getStyle("edgeHostDetectPerFrame")?!0:s.x<0||s.x>1||s.y<0||s.y>1?!0:!1){var x=a.getDataAt(t,function(s){return a.isSelectable(s)?a.isSourceTargetEditable(u,s,N)?u.canSetSourceTarget(s,N)?!0:!1:!1:!1});if(x){var v=l._calcHostAnchor(u,N,t,x);U=x,l._nextChangeEdgeHost={type:N,host:x},s=v}}var _,E,k;if(e||s.x===D)(s.percent!==D||s.index!==D)&&(E=s.point);else{var A=l._interactor.getStyle("anchorRound"),T=l._interactor.getStyle("anchorSensitivity");_=a.calculateAttachPoint(U,t),_?s=_.info:(s.x=gk.roundTo(s.x,A,T),s.y=gk.roundTo(s.y,A,T)),E=Pj(a,U,0,s.offsetX||0,s.offsetY||0,s.x,s.y)}E&&(k=gk.toScreenPosition(a,E),K.x=k.x,K.y=k.y),l._edgeHostGuideInfo={corners:gk.getTargetCornersOnScreen(a,U),attach:_?_.index:-1,host:U};var F;return s.percent!==D?F="percent: "+s.percent.toFixed(2):s.index!==D?F="index: "+s.index:(F=""+s.x.toFixed(2)+", "+s.y.toFixed(2),(s.offsetX||s.offsetY)&&(F+=" offset: "+s.offsetX.toFixed(2)+", "+s.offsetY.toFixed(2))),{host:U,anchor:s,tipText:F}}},Sk.prototype._guidingToEdit=function(V,h){var Y,p,H=this;if(Y=H.screenInfo.curve){p=Y._curves;var n,W,q,D,T,s,d,P,B=1/0,e=1/0,S=[];for(H.editing&&"realPoint"===H.editing.type&&(P=H.editing.point),T=0,s=2*p.length;s>T;T++)d=p[Math.floor(T/2)][T%2?"_p4":"_p1"],S.indexOf(d)>=0||(S.push(d),P&&P===d||(q=d.x-V.x,D=d.y-V.y,Math.abs(q)<Math.abs(B)?(B=q,n=[d]):q===B&&n.push(d),Math.abs(D)<Math.abs(e)?(e=D,W=[d]):D===e&&W.push(d)));var l=H._interactor.getStyle("smartGuideThreshold");if((Math.abs(B)>l||"y"===h)&&(n=null),(Math.abs(e)>l||"x"===h)&&(W=null),n||W){var w=!1,F={};if(n&&(w=!0,F.xList=n,F.x=B),W&&(w=!0,F.yList=W,F.y=e),w)return F}}},Sk.prototype._46O=function(b){var M=this;M.editing&&(M.editing=null,M._interactor.fi({kind:"endEditPoint",event:b})),M._guideInfo=null,M._edgeHostGuideInfo=null,M._pan&&(M._pan=null,M._interactor.fi({kind:"endPan",event:b})),M._multiSelect&&(M._handleMultiSelect(M._multiSelect),M._multiSelect=null),M.tipInfo=null,M.edgeEditResult=null},Sk.prototype._handleMultiSelect=function(j){if(j.startPoint&&j.endPoint){var b,N,J,R,i,B=this,E=B._interactor,H=E.gv,T=gk.toScreenPosition(H,j.startPoint),A=gk.toScreenPosition(H,j.endPoint),Q=q.Default.unionPoint(T,A),V=B.screenInfo.curve._curves,l=[],p=function(k){k.x>=Q.x&&k.y>=Q.y&&k.x<=Q.x+Q.width&&k.y<=Q.y+Q.height&&l.indexOf(k)<0&&l.push(k)};for(b=0,N=V.length;N>b;b++)i=V[b],p(i._p1),p(i._p4);if(l.length){var x=B.activing||{},o=x.selections||[];for(x.point&&o.push(x.point),b=0,N=o.length;N>b;b++)J=o[b],R=l.indexOf(J),R>=0?l[R]=D:l.push(J);var h=l;for(l=[],b=0,N=h.length;N>b;b++)h[b]&&l.push(h[b]);N=l.length,0===N?B.activing=null:1===N?B.activing={point:l[0]}:(J=l[N-1],B.activing={point:J,selections:l.splice(0,N-1)}),E.redraw()
}}},Sk.prototype._canDeletePoint=function(g,y){var E=this.target;if(!(E instanceof q.Edge))return!0;var M=g._curves[0],O=g._curves[g._curves.length-1];return M._p1===y||O._p4===y?!1:!0},Sk.prototype.handleDelete=function(){var J=this;if(J.activing&&J.screenInfo){var v=q.Default.isShiftDown(),f=J.screenInfo.curve;J._canDeletePoint(f,J.activing.point)&&f.deleteRealPoint(J.activing.point,v),J.activing.selections&&J.activing.selections.forEach(function(s){J._canDeletePoint(f,s)&&f.deleteRealPoint(s,v)}),J.activing=null,delete J.editing,delete J.tipInfo,delete J.edgeEditResult,delete J._pan,delete J._multiSelect,J._writeToHt(),J._interactor.fp("deleteShapePoint",!1,!0)}},Sk.prototype.handleDoubleClick=function(V){var c=this,p=c._interactor._getLogicalPoint(V);if(c.screenInfo&&c._checkEditRealPoint(p)){var g=c.getCurrentSelectintStatus(),d=gk.Curve.PointType;return g=g===d.Mirrored?d.Straight:d.Mirrored,c._setCurrentSelectionStatus(g),c._interactor._42(),!0}},Sk.prototype._drawHighlight=function(g){var N=this,P=N.highlight;if(P){var d=P.bezier,D=N._interactor;d&&gk.Icons.DrawIcon(D,g,gk.Icons.ShapeHighlightCurve,[d._p1.x,d._p1.y,d._p2.x,d._p2.y,d._p3.x,d._p3.y,d._p4.x,d._p4.y]);var Z=P.point;Z&&"insertKnot"===P.type&&gk.Icons.DrawIcon(D,g,gk.Icons.ShapeHighlighPoint,Z)}},Sk.prototype._drawGuide=function(M){var J=this,G=J._guideInfo;if(G){var F,_,q,Q,x=G.v;for(F=0;2>F;F++)if(Q=0===F?G.xList:G.yList)for(_=0,q=Q.length;q>_;_++)gk.Icons.DrawIcon(J._interactor,M,gk.Icons.ShapeGuideLine,[x.x,x.y,Q[_].x,Q[_].y])}},Sk.prototype._drawCurrentPoint=function(V){var g=this;if(g.activing){var q=g.activing,o=g.getCurrentSelectintStatus(),L=g._interactor;if(o!==gk.Curve.PointType.Straight){var v=q.pairs;q.hlpair,q.hltype;var w=q.selections,M=q.editingCtrl;if(v&&!w){var p,l,d;for(l=0,d=v.length;d>l;l++)p=v[l],M&&l===M.pairId&&p[M.type]?gk.Icons.DrawIcon(L,V,gk.Icons.ShapeActivingCtrl,{point:p.point,c1:p.c1,c2:p.c2,hl:M.type}):gk.Icons.DrawIcon(L,V,gk.Icons.ShapeActivingCtrl,p)}}gk.Icons.DrawIcon(L,V,gk.Icons.ShapeHighlighRealPoint,g.activing.point),w&&w.forEach(function(Q){gk.Icons.DrawIcon(L,V,gk.Icons.ShapeHighlighRealPoint,Q)})}},Sk.prototype.clear=function(){var v=this;v.editing=null,v._guideInfo=null,v.activing=null,v.highlight=null},Sk.prototype._42=function(V){var X=this;X.info={},X.editing||(X.screenInfo=null);var N=X._interactor;if(!N.editDetail)return X.clear(),void 0;var n=N.gv;if(!X.target||!n.isSelected(X.target)||!n.isVisible(X.target))return N.editDetail=!1,X.clear(),void 0;if(X.gatherSingleTarget(n,X.target),gk.Icons.DrawIcon(N,V,gk.Icons.ShapeBgCurve,X.screenInfo),X._interactor.getStyle("curveElevationVisible")&&(X.target instanceof q.Polyline||X.target instanceof q.Edge&&X._interactor.getStyle("edgeElevationEditable"))&&X.activing){var E=X.activing.getCurrentEditingPoint();E&&"string"!=typeof E.e&&gk.Icons.DrawIcon(N,V,gk.Icons.EdgeElevationGuide,E)}if(X._drawHighlight(V),X._drawCurrentPoint(V),X._getRealPoint().forEach(function(f){gk.Icons.DrawIcon(N,V,gk.Icons.ShapePoint,f)}),X._drawGuide(V),X.tipInfo&&X._interactor.getStyle("curveTipVisible")&&gk.Icons.DrawIcon(N,V,gk.Icons.TipHelper,X.tipInfo),X._edgeHostGuideInfo&&N._drawHostGuide(X._edgeHostGuideInfo),X.edgeEditResult&&X._drawEdgeHostHighlight(V,X.edgeEditResult.host,X.edgeEditResult.anchor),X._multiSelect&&X._multiSelect.endPoint){var r=q.Default.unionPoint(gk.toScreenPosition(n,X._multiSelect.startPoint),gk.toScreenPosition(n,X._multiSelect.endPoint));r.color=n.getRectSelectBorderColor(),V.save(),V.setTransform(1,0,0,1,0,0);var M=m.devicePixelRatio,k=r.borderWidth=Math.round(M);k/=2,r.x=Math.round(r.x*M)+k,r.y=Math.round(r.y*M)+k,r.width=Math.round(r.width*M),r.height=Math.round(r.height*M),gk.Icons.DrawIcon(N,V,gk.Icons.SimpleRect,r),V.restore()}},Sk.prototype._drawEdgeHostHighlight=function(I,K,p){this.drawEdgeHostHighlight(I,K,p),this._interactor.redraw()},Sk.prototype.drawEdgeHostHighlight=function(h,C,G){if(Lb(C)){var W,R,x,e,F=this,L=F._interactor,p=L.gv,c=p.getDataUI(C),O=Vq(c),S=[];for(x=0,e=O.points.length;e>x;x++)R=gk.toScreenPosition(p,O.points.get(x)),S.push(R.x,R.y);O.segments&&(W=O.segments.toArray());var u=L.getStyle("edgeHostHighlighPeriod"),K=L.getStyle("edgeHostEdgeHighlighColor");gk.Icons.DrawIcon(L,h,gk.Icons.ShapeBgCurve,{P:S,S:W,color:K,dynamicVisible:G.index===D,dynamicPeriod:u}),K=L.getStyle("edgeHostPointHighlighColor");var i=zc(c);for(x=0,e=i.length;e>x;x++){var m=i[x],H=gk.toScreenPosition(p,m);gk.Icons.DrawIcon(L,h,gk.Icons.ShapePoint,{point:{x:H.x,y:H.y},color:K,size:12,dynamicVisible:x===G.index,dynamicPeriod:u})}}},Sk.prototype._getRealPoint=function(){var j,Q=this.screenInfo,Z=Q.P,q=Q.S,d=-1,e=[],o=-1,E=q.length;return q.each(function(D){o++;var w=1;if(3===D)w=2;else if(4===D)w=3;else if(5===D)return;d+=w,j=o+1>=E?!0:1===q.get(o+1)?!0:!1,e.push({point:{x:Z[2*d],y:Z[2*d+1]},segmentIndex:o,pointIndex:d,isEnd:j})}),e},Sk.prototype.getEditingPointsInfo=function(Y){var r=this,n=r.activing;if(!n)return!1;var s=n.point;if(!s)return!1;var P=this._getRealPoint(),$=[{screen:s}];n.selections&&n.selections.forEach(function(f){$.push({screen:f})});var J,j,C=P.length;return $.forEach(function(A){for(J=0;C>J;J++)if(j=P[J],A.screen.isNearEnough(j.point)){A.segmentIndex=j.segmentIndex,A.pointIndex=j.pointIndex,A.point=r.target.getPoints().get(j.pointIndex);break}}),Y&&$.sort(function(D,X){return D.segmentIndex-X.segmentIndex}),$};var _p=gk.MoveHelper=function(s){var T=this;T.catalog="Move",T._interactor=s};_p.prototype={},_p.prototype.constructor=_p,_p.prototype.calcShift=function(n,O,$){var W,w,I=this,E=I._interactor.gv,B=E.lp(O);if("beginMove"===n&&I._gatherGridInfo($._lastLogicalPoint||B),W=I._target){var v=W.downPosition;if(v){var Q=I._interactor.getStyle("moveSensitivity")/E._zoom;if(v.distanceTo(B)<Q)return{x:0,y:0};delete W.downPosition}var g;w=q.Default.isShiftDown(O),w&&(B=I._dealShiftDown(B),g=W.shiftGuide.dir);var S,J=W.rawPos={x:W.pos.x+B.x-W.lp.x,y:W.pos.y+B.y-W.lp.y};if(q.Default.isCtrlDown(O)){if(S=I._calcShiftByAddon(),I._target.node instanceof gk.Group){var d=I._target.node;d._position.x+=S.x,d._position.y+=S.y}return S}var D=I._interactor.rectGuide;if(W.node instanceof q.Data&&W.node.s("2d.attachable")){var _=I._calcAttachNodeShift(W.node,J);if(D.clear(),_)return _}for(var T,C=W.x+J.x,N=W.y+J.y,i={x:C,y:N},l={x:C+W.w/2,y:N+W.h/2},M={x:C+W.w,y:N+W.h},m=I._interactor.gridGuide,j=[D.findClosest(i,g),D.findClosest(l,g),D.findClosest(M,g),m.findClosest(i,g),m.findClosest(l,g),m.findClosest(M,g)],X=1/0,r=1/0,k=0,h=j.length;h>k;k++)T=j[k],T&&(C=T.x,N=T.y,isFinite(C)&&Math.abs(C)<Math.abs(X)&&(X=C),isFinite(N)&&Math.abs(N)<Math.abs(r)&&(r=N));if(isFinite(X)||(X=0),isFinite(r)||(r=0),S=I._calcShiftByAddon(X,r),I._target.node instanceof gk.Group){var d=I._target.node;d._position.x+=S.x,d._position.y+=S.y}var z=W.node;if(!af(z,E)){var y=J.x+X,b=J.y+r;I._interactor.rectGuide.gatherLines({node:z,x:W.x+y,y:W.y+b,w:W.w,h:W.h},g)}return S}},_p.prototype._calcShiftByAddon=function(e,i){var Z=this._target,T=Z.rawPos,v=Z.node.getPosition();return e=e||0,i=i||0,{x:T.x-v.x+e,y:T.y-v.y+i}},_p.prototype._dealShiftDown=function(l){var u=this,K=u._target.shiftGuide,h=u._target.lp,F=Math.abs(l.x-h.x),Q=Math.abs(l.y-h.y);F>Q&&F>K.limit&&"y"===K.dir&&(K.dir="x"),Q>F&&Q>K.limit&&"x"===K.dir&&(K.dir="y");var P=K.dir;return"x"===P?(l.y=h.y,K.limit=Math.max(K.limit,F)):"y"===P&&(l.x=h.x,K.limit=Math.max(K.limit,Q)),l},_p.prototype._isAttachableLineShape=function(S){if(!S.getSegments)return!1;var p=S.getSegments();if(!p)return!0;p instanceof q.List&&(p=p.getArray());for(var b=1,H=p.length;H>b;b++)if(2!==p[b])return!1;return!0},_p.prototype._calcAttachNodeShift=function(){var A=new ac,S=new ac,b=new ac,o=new ac;return function(f,q){var w=this._interactor.gv,Y=f.getHost(),y=w.getDataAt(q,function(_){return _.s("2d.hostable")?!0:!1});if(y&&Y!==y&&f.setHost(y),!y)return this._edgeHostGuideInfo=null,f.setHost(null);var G=this._edgeHostGuideInfo={corners:gk.getTargetCornersOnScreen(w,y),host:y,attach:-1};if(this._isAttachableLineShape(y)){for(var I,l,K,U,H,z,c=y.getPoints(),n=c.size(),t=y.getPointsMatrix2d(),O=1/0,E=0;n>E&&(E!==n-1||y.isClosePath());E++)0!==E?S.copy(b):t.apply(c.get(E),S),t.apply(E===n-1?c.get(0):c.get(E+1),b),A.copy(q).sub(S),o.copy(b).sub(S),I=o.length(),o.divideScalar(I),l=A.dot(o),0>l?l=0:l>I&&(l=I),o.multiplyScalar(l).add(S),K=A.copy(q).sub(o).lengthSq(),O>K&&(O=K,z=E,U=l,H=I);return Math.sqrt(O)*w.getZoom()>this._interactor.getStyle("attachThreshold")?(f.s({"attach.index":-1}),f.setHost(null),void 0):(f.s("attach.offset.opposite")&&(U=H-U),f.s({"attach.index":z,"attach.offset":f.s("attach.offset.relative")?U/H:U}),{x:0,y:0})}var V=w.calculateAttachPoint(y,q);if(V){var v=V.point;return G.attach=V.index,this._calcShiftByAddon(v.x-q.x,v.y-q.y)}}}(),_p.prototype._gatherGridInfo=function(n){var d,x=this,L=x._interactor,U=L._getValidSelection();if(U.length){if(1===U.length){if(d=U[0],!d.getRect)return x._target=null,void 0}else if(d=gk.Group.findOrCreateGroup(U,L._uuid),!d)return x._target=null,void 0}else{var U=L.gv.sm().getSelection();if(U.length&&(d=U.get(0),!d.getRect))return x._target=null,void 0}if(d){var y=d.getPosition(),Q=d.getRect();x._target={node:d,x:Q.x-y.x,y:Q.y-y.y,w:Q.width,h:Q.height,lp:{x:n.x,y:n.y},pos:{x:y.x,y:y.y},shiftGuide:{dir:"x",limit:0},downPosition:new gk.Math.Vector2(n)},L.rectGuide.gatherRects()}},_p.prototype.clear=function(){var U=this;U._edgeHostGuideInfo=null,U._interactor.rectGuide.clear(),U._interactor._42()},_p.prototype._42=function(){var q=this._edgeHostGuideInfo;q&&this._interactor._drawHostGuide(q)};var aq=t.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),jj=function(){function E(h,I){var w=D;return function(){return w||(w=h.getExtension(I)),w}}function U(K,h){h==D&&(h={}),h.version=W&&(K instanceof WebGL2RenderingContext||t.prototype.toString.call(K)===c)?2:1,h.extensions=function(){for(var s={},f=K.getSupportedExtensions(),q=f.length;q--;)s[name]=E(K,f[q]);return s}();for(var u=t.keys(T),g=0,N=u.length;N>g;++g){var R=u[g];h[R]=K.getParameter(T[R])}if(h.version>1){u=t.keys(z);for(var g=0,N=u.length;N>g;++g){var R=u[g];h[R]=K.getParameter(z[R])}}return h}var W="undefined"!=typeof WebGL2RenderingContext,c="[object WebGL2RenderingContext]",T={aliasedLineWidthRange:aq.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:aq.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:aq.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:aq.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:aq.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:aq.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:aq.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:aq.MAX_TEXTURE_SIZE,maxVaryingVectors:aq.MAX_VARYING_VECTORS,maxVertexAttribs:aq.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:aq.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:aq.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:aq.MAX_VIEWPORT_DIMS},z={max3DTextureSize:aq.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:aq.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:aq.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:aq.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:aq.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:aq.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:aq.MAX_DRAW_BUFFERS,maxElementIndex:aq.MAX_ELEMENT_INDEX,maxElementsIndices:aq.MAX_ELEMENTS_INDICES,maxElementsVertices:aq.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:aq.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:aq.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:aq.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:aq.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:aq.MAX_SAMPLES,maxTextureLODBias:aq.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:aq.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:aq.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:aq.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:aq.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:aq.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:aq.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:aq.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:aq.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:aq.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:aq.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(J){var E=J._info;return E||(J._info=E=U(J,E)),E}}}(),wc=function(){function Q(V,Z,O){return{def:V,getter:O?function(R){var Y=jj.for(R);return Y.version>1?R.getParameter(Z):V}:function(Y){return Y.getParameter(Z)},setter:O?function(n,G){var h=jj.for(n);h.version>1&&n.pixelStorei(Z,G)}:function(I,o){I.pixelStorei(Z,o)}}}function V(O){return"string"==typeof O?Xi(O):O.r!==D?(j[0]=O.r,j[1]=O.g,j[2]=O.b,j[3]=O.a,j):O.red!==D?(j[0]=O.red,j[1]=O.green,j[2]=O.blue,j[3]=O.alpha,j):O}function l(n){return y(n)?Array.prototype.slice.call(n,0):n}function e(w,T,v){this.gl=T,this._record=v||{},this._branches={},this._leafSync={},this._struct=w;for(var s=w.children,r=s.length;r--;){var K=s[r],J=K.name;K.isLeaf?(this._leafSync[J]=!1,this._record[J]=l(K.desc.def)):this._record[J]={}}}function c(O){function G(k,Z){e.call(this,O,k,Z);for(var D=U.length;D--;){var v=U[D];this._branches[v._name]=new v._type(k,this._record[v._name])}}function F(f,z){function W(z,n){for(var m=Q,R=!1;m--;)z[m]!==n[m]&&(z[m]=n[m],R=!0);return R}var w=f.name,R=y(f.desc.def),Q=R&&f.desc.def.length;if(f.isLeaf){var _=f.desc.setter,O=f.desc.parse;t.defineProperty(z,w,{configurable:!1,enumerable:!0,get:function(){return this._record[w]},set:R?function(B){O&&(B=O(B)),(W(this._record[w],B)||!this._leafSync[w])&&(_(this.gl,this._record[w]),this._leafSync[w]=!0)}:function(X){this._record[w]===X&&this._leafSync[w]||(_(this.gl,X),this._record[w]=X,this._leafSync[w]=!0)}})}else U.push({_name:w,_type:c(f)}),t.defineProperty(z,w,{configurable:!1,enumerable:!0,get:function(){return this._branches[w]},set:function(I){this._branches[w].apply(I)}})}var U=[];return n(G,e),O.forEach(F,G.prototype),G}var j="undefined"!=typeof Float32Array&&new Float32Array(4),O={viewport:{def:[0,0,0/0,0/0],getter:function(E){return E.getParameter(E.VIEWPORT)},setter:function(A,p){var n=p[2]!==p[2]?A.drawingBufferWidth-p[0]:p[2],M=p[3]!==p[3]?A.drawingBufferHeight-p[1]:p[3];A.viewport(p[0],p[1],n,M)}},dither:{def:!1,getter:function(T){return T.isEnabled(T.DITHER)},setter:function(g,G){G?g.enable(g.DITHER):g.disable(g.DITHER)}},rasterizerDiscard:{def:!1,getter:function(L){var F=jj.for(L);return F.version>1&&L.isEnabled(L.RASTERIZER_DISCARD)},setter:function(q,a){var s=jj.for(q);1!==s.version&&(a?q.enable(q.RASTERIZER_DISCARD):q.disable(q.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(K){return K.lineWidth?K.getParameter(K.LINE_WIDTH):1},setter:function(p,u){p.lineWidth&&p.lineWidth(u)}},color:{clear:{def:[0,0,0,0],getter:function(o){return o.getParameter(o.COLOR_CLEAR_VALUE)},setter:function(l,t){l.clearColor(t[0],t[1],t[2],t[3])},parse:V},mask:{def:[!0,!0,!0,!0],getter:function(L){return L.getParameter(L.COLOR_WRITEMASK)},setter:function(h,Y){h.colorMask(Y[0],Y[1],Y[2],Y[3])}}},blend:{enabled:{def:!1,getter:function(r){return r.isEnabled(r.BLEND)},setter:function(a,H){H?a.enable(a.BLEND):a.disable(a.BLEND)}},color:{def:[0,0,0,0],getter:function(I){return I.getParameter(I.BLEND_COLOR)},setter:function(a,u){a.blendColor(u[0],u[1],u[2],u[3])},parse:V},equation:{def:[aq.FUNC_ADD,aq.FUNC_ADD],getter:function(s){return[s.getParameter(s.BLEND_EQUATION_RGB),s.getParameter(s.BLEND_EQUATION_ALPHA)]},setter:function(j,z){j.blendEquationSeparate(z[0],z[1])},parse:function(n){var G=n.length;return G>1?n:1===G?(j[1]=j[0]=n[0],j):(j[1]=j[0]=n,j)}},func:{def:[aq.ONE,aq.ZERO,aq.ONE,aq.ZERO],getter:function(Z){return[Z.getParameter(Z.BLEND_SRC_RGB),Z.getParameter(Z.BLEND_DST_RGB),Z.getParameter(Z.BLEND_SRC_ALPHA),Z.getParameter(Z.BLEND_DST_ALPHA)]},setter:function(b,_){b.blendFuncSeparate(_[0],_[1],_[2],_[3])},parse:function(k){var $=k.length;return $>3?k:(j[2]=j[0]=k[0],j[3]=j[1]=k[1],j)}}},cullFace:{enabled:{def:!1,getter:function(J){return J.isEnabled(J.CULL_FACE)},setter:function(h,z){z?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE)}},mode:{def:aq.BACK,getter:function(N){return N.getParameter(N.CULL_FACE_MODE)},setter:function(h,d){h.cullFace(d)}},frontFace:{def:aq.CCW,getter:function(z){return z.getParameter(z.FRONT_FACE)},setter:function(u,V){u.frontFace(V)}}},scissor:{enabled:{def:!1,getter:function(J){return J.isEnabled(J.SCISSOR_TEST)},setter:function(q,s){s?q.enable(q.SCISSOR_TEST):q.disable(q.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(N){return N.getParameter(N.SCISSOR_BOX)},setter:function(z,Y){var w=Y[2]!==Y[2]?z.drawingBufferWidth-Y[0]:Y[2],G=Y[3]!==Y[3]?z.drawingBufferHeight-Y[1]:Y[3];z.scissor(Y[0],Y[1],w,G)}}},depth:{enabled:{def:!1,getter:function(l){return l.isEnabled(l.DEPTH_TEST)},setter:function(C,u){u?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST)}},clear:{def:1,getter:function(m){return m.getParameter(m.DEPTH_CLEAR_VALUE)},setter:function(f,k){f.clearDepth(k)}},mask:{def:!0,getter:function(j){return j.getParameter(j.DEPTH_WRITEMASK)},setter:function(S,W){S.depthMask(W)}},range:{def:[-1,1],getter:function(m){return m.getParameter(m.DEPTH_RANGE)},setter:function(r,b){r.depthRange(b[0],b[1])}},func:{def:aq.LESS,getter:function(L){return L.getParameter(L.DEPTH_FUNC)},setter:function(i,p){i.depthFunc(p)}}},stencil:{enabled:{def:!1,getter:function(R){return R.isEnabled(R.STENCIL_TEST)},setter:function(j,h){h?j.enable(j.STENCIL_TEST):j.disable(j.STENCIL_TEST)}},clear:{def:0,getter:function(I){return I.getParameter(I.STENCIL_CLEAR_VALUE)},setter:function(N,J){N.clearStencil(J)}},frontMask:{def:255,getter:function(w){return w.getParameter(w.STENCIL_WRITEMASK)},setter:function(v,z){v.stencilMaskSeparate(v.FRONT,z)}},frontOp:{def:[aq.KEEP,aq.KEEP,aq.KEEP],getter:function(n){return[n.getParameter(n.STENCIL_FAIL),n.getParameter(n.STENCIL_PASS_DEPTH_FAIL),n.getParameter(n.STENCIL_PASS_DEPTH_PASS)]},setter:function(O,P){O.stencilOpSeparate(O.FRONT,P[0],P[1],P[2])}},frontFunc:{def:[aq.ALWAYS,0,255],getter:function(F){return[F.getParameter(F.STENCIL_FUNC),F.getParameter(F.STENCIL_REF),F.getParameter(F.STENCIL_VALUE_MASK)]},setter:function(o,C){o.stencilFuncSeparate(o.FRONT,C[0],C[1],C[2])}},backMask:{def:255,getter:function(D){return D.getParameter(D.STENCIL_BACK_WRITEMASK)},setter:function(F,N){F.stencilMaskSeparate(F.BACK,N)}},backOp:{def:[aq.KEEP,aq.KEEP,aq.KEEP],getter:function(L){return[L.getParameter(L.STENCIL_BACK_FAIL),L.getParameter(L.STENCIL_BACK_PASS_DEPTH_FAIL),L.getParameter(L.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(c,_){c.stencilOpSeparate(c.BACK,_[0],_[1],_[2])}},backFunc:{def:[aq.ALWAYS,0,255],getter:function(B){return[B.getParameter(B.STENCIL_BACK_FUNC),B.getParameter(B.STENCIL_BACK_REF),B.getParameter(B.STENCIL_BACK_VALUE_MASK)]
},setter:function($,N){$.stencilFuncSeparate($.BACK,N[0],N[1],N[2])}}},hint:{generateMipmap:{def:aq.DONT_CARE,getter:function(H){return H.getParameter(H.GENERATE_MIPMAP_HINT)},setter:function(k,C){k.hint(k.GENERATE_MIPMAP_HINT,C)}},fragmentShaderDerivative:{def:aq.DONT_CARE,getter:function(S){var U=jj.for(S);return 1!==U.version||U.extensions.OES_standard_derivatives?S.getParameter(aq.FRAGMENT_SHADER_DERIVATIVE_HINT):aq.DONT_CARE},setter:function(U,d){var h=jj.for(U);return h.version>1||h.extensions.OES_standard_derivatives?(U.hint(aq.FRAGMENT_SHADER_DERIVATIVE_HINT,d),void 0):void 0}}},pixelStore:{packAlignment:Q(4,aq.PACK_ALIGNMENT,!1),unpackAlignment:Q(4,aq.UNPACK_ALIGNMENT,!1),unpackFlipY:Q(!1,aq.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:Q(!1,aq.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:Q(aq.BROWSER_DEFAULT_WEBGL,aq.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:Q(0,aq.PACK_ROW_LENGTH,!0),packSkipPixels:Q(0,aq.PACK_SKIP_PIXELS,!0),packSkipRows:Q(0,aq.PACK_SKIP_ROWS,!0),unpackRowLength:Q(0,aq.UNPACK_ROW_LENGTH,!0),unpackImageHeight:Q(0,aq.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:Q(0,aq.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:Q(0,aq.UNPACK_SKIP_ROWS,!0),unpackSkipImages:Q(0,aq.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(Z){return Z.isEnabled(Z.POLYGON_OFFSET_FILL)},setter:function(H,$){$?H.enable(H.POLYGON_OFFSET_FILL):H.disable(H.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(Y){return[Y.getParameter(Y.POLYGON_OFFSET_FACTOR),Y.getParameter(Y.POLYGON_OFFSET_UNITS)]},setter:function(X,u){X.polygonOffset(u[0],u[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(k){return k.isEnabled(k.SAMPLE_COVERAGE)},setter:function(W,F){F?W.enable(W.SAMPLE_COVERAGE):W.disable(W.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(I){return I.isEnabled(I.SAMPLE_ALPHA_TO_COVERAGE)},setter:function($,m){m?$.enable($.SAMPLE_ALPHA_TO_COVERAGE):$.disable($.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(z){return[z.getParameter(z.SAMPLE_COVERAGE_VALUE),z.getParameter(z.SAMPLE_COVERAGE_INVERT)]},setter:function(I,x){I.sampleCoverage(x[0],x[1])}}}},X=xr.create(O,function(c){return"def"in c});e.prototype.reset=function(){for(var e=this._struct.children,J=e.length;J--;){var Q=e[J],M=Q.name;Q.isLeaf?this[M]=Q.desc.def:this._branches[M].reset()}},e.prototype.save=function(I){I==D&&(I={});for(var n=this._struct.children,k=n.length;k--;){var O=n[k],q=O.name;if(O.isLeaf)I[q]=l(this._record[q]);else{var P=I[q];P==D&&(I[q]=P={}),this._branches[q].save(P)}}return I},e.prototype.sync=function($,U){for(var k=this._struct.children,f=k.length;f--;){var N=k[f],p=N.name;N.isLeaf?(U||!this._leafSync[p])&&($?(this._record[p]=N.desc.getter(this.gl),this._leafSync[p]=!0):(N.desc.setter(this.gl,this._record[p]),this._leafSync[p]=!0)):this._branches[p].sync($,U)}},e.prototype.syncLoss=function(){for(var C=this._struct.children,Z=C.length;Z--;){var E=C[Z];E.isLeaf?this._leafSync[E.name]=!1:this._branches[E.name].syncLoss()}},e.prototype.apply=function(h){for(var B=this._struct.children,H=B.length;H--;){var E=B[H],m=E.name;m in h&&(E.isLeaf?this[m]=h[m]:this._branches[m].apply(h[m]))}},e.prototype.append=function(s){var U=this._struct.childMap;for(var M in s){var f=U[M];f&&(f.isLeaf?this[M]=s[M]:this._branches[M].append(s[M]))}};var A=c(X);return function(L){var c=L._state;return c||(L._state=c=new A(L)),c}}(),Kl=function(){function R(k,M,r,U){if(k){var P=k.length;if(P!=D)for(var S=0;U>S;++S)M[r+S]=k[S];else k.toArray&&k.toArray(M,r)}else for(var S=0;U>S;++S)M[r+S]=0}function m(s,o,_){var z=s[0];if(0>=z||z>0)return s;var p=o*_,y=j[p];if(y==D&&(j[p]=new Float32Array(p)),0!==o){R(z,y,0,_);for(var B=1,O=0;B!==o;++B)O+=_,R(s[B],y,O,_)}return y}function r(P,t){P.uniform1f(this.addr,t)}function i(E,h){E.uniform1fv(this.addr,h)}function x(u,e){if(e.x!=D)u.uniform2f(this.addr,e.x,e.y);else{var c=j[2];c.set(e,0),u.uniform2fv(this.addr,c)}}function k(R,w){R.uniform2fv(this.addr,m(w,this.size,2))}function L(X,k){if(k.x!=D)X.uniform3f(this.addr,k.x,k.y,k.z);else if(k.r!=D)X.uniform3f(this.addr,k.r,k.g,k.b);else if(k.red!=D)X.uniform3f(this.addr,k.red,k.green,k.blue);else{var N=j[3];N.set(k,0),X.uniform3fv(this.addr,N)}}function S(H,w){H.uniform3fv(this.addr,m(w,this.size,3))}function P(h,X){if("string"==typeof X&&(X=Xi(X)),X.x!=D)h.uniform4f(this.addr,X.x,X.y,X.z,X.w);else if(X.r!=D)h.uniform4f(this.addr,X.r,X.g,X.b,X.a);else if(X.red!=D)h.uniform4f(this.addr,X.red,X.green,X.blue,X.alpha);else{var T=j[4];T.set(X,0),h.uniform4fv(this.addr,T)}}function b(U,a){U.uniform4fv(this.addr,m(a,this.size,4))}function y(C,m){C.uniform1i(this.addr,m)}function d(y,O){y.uniform1iv(this.addr,O)}function B(V,P){V.uniform2iv(this.addr,P)}function V(B,D){B.uniform3iv(this.addr,D)}function c(O,i){O.uniform4iv(this.addr,i)}function K(M,w){M.uniform1i(this.addr,C[w?1:0])}function W(H,F){var z=j[4];z.set(F,0),H.uniformMatrix2fv(this.addr,!1,z)}function G(V,f){V.uniformMatrix2fv(this.addr,!1,m(f,this.size,4))}function g(y,L){var W=j[9];W.set(L,0),y.uniformMatrix3fv(this.addr,!1,W)}function X(j,L){j.uniformMatrix3fv(this.addr,!1,m(L,this.size,9))}function I(i,I){var z=j[16];z.set(I,0),i.uniformMatrix4fv(this.addr,!1,z)}function H(w,V){w.uniformMatrix4fv(this.addr,!1,m(V,this.size,16))}function $(E,D){E.uniform1i(this.addr,this.slots[0]),E.activeTexture(E.TEXTURE0+this.slots[0]),E.bindTexture(E.TEXTURE_2D,D||E._emptyTexture)}function s(U,d){U.uniform1iv(this.addr,this.slots);for(var H=this.slots.length;H--;)U.activeTexture(U.TEXTURE0+this.slots[H]),U.bindTexture(U.TEXTURE_2D,d[H]||U._emptyTexture)}function o(l,W){l.uniform1i(this.addr,this.slots[0]),l.activeTexture(l.TEXTURE0+this.slots[0]),l.bindTexture(l.TEXTURE_CUBE_MAP,W||l._emptyCubeTexture)}function q(I,j){I.uniform1iv(this.addr,this.slots);for(var J=this.slots.length;J--;)I.activeTexture(I.TEXTURE0+this.slots[J]),I.bindTexture(I.TEXTURE_CUBE_MAP,j[J]||I._emptyCubeTexture)}function Q(T,m,C){M[T]=[m,C]}function w(m,x,h){switch(m.type){case 35678:case 35680:if("uSampler"===h)return[0];if("uBlendSampler"===h)return[1];for(var K=m.size,S=new Int32Array(K),W=0;K>W;++W)S[W]=x.usedTextureSlot++;return S}return D}function e(R,n,E,Y,L){this.name=R,this.addr=n,this.size=Y?E.size:0,this.activeInfo=E,this.setter=M[E.type][Y?1:0],this.slots=w(E,L,R),Fq(this)}function O(U,V,B,c){var Q=U.name,H=Q.length;for(h.lastIndex=0;;){var A=h.exec(Q),k=h.lastIndex,J=A[1],E="]"===A[2],M=A[3];if(E&&(J=0|J),M===D||"["===M&&k+2===H){B[J]=new e(J,V,U,M!==D,c);break}var q=B[J];q==D&&(B[J]=q={}),B=q}}function U(c,T,O){this.gl=T,this._program=O,this._leaves={},this._branches={},this._struct=c}function A(O){function T(f,o){U.call(this,O,f,o);for(var H=c.length;H--;){var e=c[H];this._branches[e._name]=new e._type(f,o)}}function s(k,R){var b=k.name;if(k.isLeaf){var e=N("d.setter(this.gl, v);",["v"],["d"],[k.desc]);t.defineProperty(R,b,{configurable:!1,enumerable:!0,get:function(){return e},set:e})}else c.push({_name:b,_type:A(k)}),t.defineProperty(R,b,{configurable:!1,enumerable:!0,get:function(){return this._branches[b]},set:function(V){this._branches[b].apply(V)}})}var c=[];return n(T,U),O.forEach(s,T.prototype),T}function E(p,r){for(var j=p.getProgramParameter(r,p.ACTIVE_UNIFORMS),v={},i={usedTextureSlot:2};j--;){var K=p.getActiveUniform(r,j),V=K.name,e=p.getUniformLocation(r,V);O(K,e,v,i)}var $=xr.create(v,function(M){return"addr"in M}),D=A($);return t.defineProperty(D.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:i.usedTextureSlot}),new D(p,r)}var j=[];if("function"==typeof Float32Array)for(var Y=1;17>Y;++Y)j[Y]=new Float32Array(Y);var C=[0,1],M=[];Q(aq.FLOAT,r,i),Q(aq.FLOAT_VEC2,x,k),Q(aq.FLOAT_VEC3,L,S),Q(aq.FLOAT_VEC4,P,b),Q(aq.INT,y,d),Q(aq.INT_VEC2,B,B),Q(aq.INT_VEC3,V,V),Q(aq.INT_VEC4,c,c),Q(aq.BOOL,K,d),Q(aq.BOOL_VEC2,B,B),Q(aq.BOOL_VEC3,V,V),Q(aq.BOOL_VEC4,c,c),Q(aq.FLOAT_MAT2,W,G),Q(aq.FLOAT_MAT3,g,X),Q(aq.FLOAT_MAT4,I,H),Q(aq.SAMPLER_2D,$,s),Q(aq.SAMPLER_CUBE,o,q);var h=/([\w\d_]+)(\])?(\[|\.)?/g;return U.prototype.apply=function(R){for(var g=this._struct.children,D=g.length;D--;){var v=g[D],k=v.name;k in R&&(v.isLeaf?this[k]=R[k]:this._branches[k].apply(R[k]))}},U.prototype.append=function(K){var o=this._struct.childMap;for(var E in K){var q=o[E];q&&(q.isLeaf?this[E]=K[E]:this._branches[E].append(K[E]))}},function(H,p){var l=p._uniforms;return l||(p._uniforms=l=E(H,p)),l}}(),gh=function(){function h(P,$,x){$.vertexAttrib1f(P.addr,x)}function P(I,y,r){if(r.x!=D)y.vertexAttrib2f(I.addr,r.x,r.y);else{var N=o[2];N.set(r,0),y.vertexAttrib2fv(I.addr,N)}}function q(s,H,u){if(u.x!=D)H.vertexAttrib3f(s.addr,u.x,u.y,u.z);else if(u.r!=D)H.vertexAttrib3f(s.addr,u.r,u.g,u.b);else if(u.red!=D)H.vertexAttrib3f(s.addr,u.red,u.green,u.blue);else{var f=o[3];f.set(u,0),H.vertexAttrib3fv(s.addr,f)}}function E(a,M,q){if("string"==typeof q&&(q=Xi(q)),q.x!=D)M.vertexAttrib4f(a.addr,q.x,q.y,q.z,q.w);else if(q.r!=D)M.vertexAttrib4f(a.addr,q.r,q.g,q.b,q.a);else if(q.red!=D)M.vertexAttrib4f(a.addr,q.red,q.green,q.blue,q.alpha);else{var H=o[4];H.set(q,0),M.vertexAttrib4fv(a.addr,H)}}function J(G,O,I){I=I.el||I;for(var M=0,X=0;2>M;++M)O.vertexAttrib2f(G.addr,I[X++],I[X++])}function g(h,t,W){W=W.el||W;for(var z=0,j=0;3>z;++z)t.vertexAttrib3f(h.addr,W[j++],W[j++],W[j++])}function z(U,Q,E){E=E.el||E;for(var L=0,m=0;4>L;++L)Q.vertexAttrib4f(U.addr,E[m++],E[m++],E[m++],E[m++])}function S(S,L,A,M,f,T,t){L.bindBuffer(L.ARRAY_BUFFER,A),L.vertexAttribPointer(S.addr,1,M||L.FLOAT,!!f,T||0,t||0),L.bindBuffer(L.ARRAY_BUFFER,null)}function V(H,E,l,e,L,f,p){E.bindBuffer(E.ARRAY_BUFFER,l),E.vertexAttribPointer(H.addr,2,e||E.FLOAT,!!L,f||0,p||0),E.bindBuffer(E.ARRAY_BUFFER,null)}function w(p,l,S,M,I,h,v){l.bindBuffer(l.ARRAY_BUFFER,S),l.vertexAttribPointer(p.addr,3,M||l.FLOAT,!!I,h||0,v||0),l.bindBuffer(l.ARRAY_BUFFER,null)}function b(S,k,d,M,_,j,A){k.bindBuffer(k.ARRAY_BUFFER,d),k.vertexAttribPointer(S.addr,4,M||k.FLOAT,!!_,j||0,A||0),k.bindBuffer(k.ARRAY_BUFFER,null)}function _(J,m,P,K,u,M,T){var M=M||4,T=T||0;m.bindBuffer(m.ARRAY_BUFFER,P),m.vertexAttribPointer(J.addr,2,K||m.FLOAT,!!u,M,T),m.vertexAttribPointer(J.addr+1,2,K||m.FLOAT,!!u,M,T+2),m.bindBuffer(m.ARRAY_BUFFER,null)}function B(G,c,j,S,U,J,C){var J=J||9,C=C||0;c.bindBuffer(c.ARRAY_BUFFER,j),c.vertexAttribPointer(G.addr,3,S||c.FLOAT,!!U,J,C),c.vertexAttribPointer(G.addr+1,3,S||c.FLOAT,!!U,J,C+3),c.vertexAttribPointer(G.addr+2,3,S||c.FLOAT,!!U,J,C+6),c.bindBuffer(c.ARRAY_BUFFER,null)}function I(Q,$,g,Y,R,H,o){var H=H||16,o=o||0;$.bindBuffer($.ARRAY_BUFFER,g),$.vertexAttribPointer(Q.addr,4,Y||$.FLOAT,!!R,H,o),$.vertexAttribPointer(Q.addr+1,4,Y||$.FLOAT,!!R,H,o+4),$.vertexAttribPointer(Q.addr+2,4,Y||$.FLOAT,!!R,H,o+8),$.vertexAttribPointer(Q.addr+3,4,Y||$.FLOAT,!!R,H,o+12),$.bindBuffer($.ARRAY_BUFFER,null)}function l(c,l,T){W[c]=function(G,o,d,I,M,w){this.addr==D||this.addr<0||(o==D||o===!1?G.disableVertexAttribArray(this.addr):Ao(o)===i?(G.enableVertexAttribArray(this.addr),T(this,G,o,d,I,M,w)):(G.disableVertexAttribArray(this.addr),l(this,G,o)))}}function R(m,H,L){this.name=m,this.addr=H,this.activeInfo=L,this.setter=W[L.type],Fq(this)}function u(A,N,C){this.gl=N,this.program=C,this._branches={},this._struct=A}function a(B){function c(e,d){u.call(this,B,e,d);for(var x=R.length;x--;){var X=R[x];this._branches[X._name]=new X._type(e,d)}}function w(M,U){var O=M.name;if(M.isLeaf){var d=N("d.setter(this.gl, v);",["v"],["d"],[M.desc]);t.defineProperty(U,O,{configurable:!1,enumerable:!0,get:function(){return d},set:d})}else R.push({_name:O,_type:a(M)}),t.defineProperty(U,O,{configurable:!1,enumerable:!0,get:function(){return this._branches[O]},set:function(d){this._branches[O].apply(d)}})}var R=[];return n(c,u),B.forEach(w,c.prototype),c}function f(s,W){for(var V=s.getProgramParameter(W,s.ACTIVE_ATTRIBUTES),d={};V--;){var C=s.getActiveAttrib(W,V),N=C.name,$=s.getAttribLocation(W,N);d[N]=new R(N,$,C)}var e=xr.create(d,function(V){return"addr"in V}),I=a(e);return new I(s,W)}for(var o=[],Z=1;17>Z;++Z)o[Z]=new Hg(Z);var W=[],i="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return l(aq.FLOAT,h,S),l(aq.FLOAT_VEC2,P,V),l(aq.FLOAT_VEC3,q,w),l(aq.FLOAT_VEC4,E,b),l(aq.FLOAT_MAT2,J,_),l(aq.FLOAT_MAT3,g,B),l(aq.FLOAT_MAT4,z,I),u.prototype.disable=function(){for(var u=this._struct.children,E=u.length;E--;){var C=u[E],y=C.name;C.isLeaf?this.gl.disableVertexAttribArray(C.desc.addr):this._branches[y].disable()}},u.prototype.apply=function(n){for(var p=this._struct.children,M=p.length;M--;){var u=p[M],A=u.name;A in n&&(u.isLeaf?this[A]=n[A]:this._branches[A].apply(n[A]))}},u.prototype.append=function(h){var P=this._struct.childMap;for(var v in h){var R=P[v];R&&(R.isLeaf?this[v]=h[v]:this._branches[v].append(h[v]))}},function(K,Y){var l=Y._attribs;return l||(Y._attribs=l=f(K,Y)),l}}(),Gh=function(b){var M=this;t.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:b,writable:!1},glState:{configurable:!1,enumerable:!1,value:wc(b),writable:!1}}),M._currProgram=D,M._currUniforms=D,M._currAttribs=D,M._sync=!0};t.defineProperties(Gh.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(d){var u=this;u._sync&&d===u._currProgram||(u.gl.useProgram(d),u._currProgram=d,u._currUniforms=Kl(u.gl,d),u._currAttribs=gh(u.gl,d),u._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var q=this;return q._currProgram&&!q._sync&&(q.gl.useProgram(q._currProgram),q._sync=!0),q._currUniforms},set:function(n){var I=this;I._currUniforms&&(I._currProgram&&!I._sync&&(I.gl.useProgram(I._currProgram),this._sync=!0),I._currUniforms.apply(n))}},attribs:{configurable:!1,enumerable:!1,get:function(){var $=this;return $._currProgram&&!$._sync&&($.gl.useProgram($._currProgram),$._sync=!0),$._currAttribs},set:function(q){var F=this;F._currUniforms&&(F._currProgram&&!F._sync&&(F.gl.useProgram(F._currProgram),this._sync=!0),F._currAttribs.apply(q))}}}),Gh.prototype.useProgram=function(a){var C=this;C._sync&&a===C._currProgram||(C.gl.useProgram(a),C._currProgram=a,C._currUniforms=Kl(C.gl,a),C._currAttribs=gh(C.gl,a),C._sync=!0)},Gh.prototype.directState=function(){return this.glState},Gh.prototype.directUniforms=function(){return this._currUniforms},Gh.prototype.directAttribs=function(){return this._currAttribs},Gh.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Gh.for=function(N){var i=N._renderState;return i||(N._renderState=i=new Gh(N)),i};var mo="directional",nc="point",xo="spot",wn="light.color",Or={},Pd=[],xg=0,zq=function(Z,f){on(f)&&Wf.test(f)?yj(Z,f):vc(f)&&f.modelType?Kp(Z,f):f===D?delete $p[Z]:$p[Z]=f},Ii=function(v){return v},Cr=function(v){v=m.convertShape3dModelName(v);var w;if(vc(v)){if(v.modelType){if(v.uuid){if(w=$p[v.uuid])return w}else v.uuid=q.Math.generateUUID();return w===D&&(bg&&bg[v.uuid]||Kp(v.uuid,v)),D}return v}return w=$p[v],v&&w===D&&Wf.test(v)&&(bg&&bg[v]||yj(v,v)),w},jk=function(P,f){P.frameStack?P.frameStack.push(f):P.frameStack=[f],P.bindFramebuffer(P.FRAMEBUFFER,f)},Do=function(M){var i=M.frameStack;if(i){if(i.pop(),i.length)return M.bindFramebuffer(M.FRAMEBUFFER,i[i.length-1]),void 0;M.frameStack=null}M.bindFramebuffer(M.FRAMEBUFFER,null)};Jg(m,{graph3dViewAttributes:G,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:Y/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ni,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:Y,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:Y/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:zq,getShape3dModel:Cr,convertShape3dModelName:Ii,getShape3dModelMap:function(){return $p},getCachedShape3dModelMap:function(){return Fg},createMatrix:function(l,I){bf(l)||(l=[l]);for(var j=l.length-1;j>=0;j--){var F=l[j];I=Op(F.mat,F.s3,F.r3,F.rotationMode,F.t3,I)}return I},transformVec:function(B,R){return Be(B,R)},glBindFrame:jk,glUnbindFrame:Do,createBoxModel:function(){return{vs:ze,ns:xj,uv:Jm,is:Kj}},createRoundRectModel:function(M,w){return Ve.roundRect(M,w)},createStarModel:function(k,V){return Ve.star(k,V)},createRectModel:function(A,U){return Ve.rect(A,U)},createTriangleModel:function(X,k){return Ve.triangle(X,k)},createRightTriangleModel:function(N,$){return Ve.rightTriangle(N,$)},createParallelogramModel:function(v,N){return Ve.parallelogram(v,N)},createTrapezoidModel:function(W,H){return Ve.trapezoid(W,H)},createSmoothSphereModel:function(x,N,d,H,F,Z,f){return rd(new oc(x,N,d,H,F,Z,f))},createSphereModel:function(H,X,J,_,o,v,K){return H?zf(H,X,J,_,o,v,K):m.createSmoothSphereModel()},createSmoothConeModel:function(l,S,b,m,F){return ed(l,S,b,m,F)},createConeModel:function(r,A,o,k,G,_,p,l){return r?hk(r,A,o,k,G,_,p,l):ed(_)},createSmoothCylinderModel:function(r,q,L,y,F,n,u,J){return rd(new Kf(r,q,L,y,F,n,u,J))},createCylinderModel:function(L,w,d,C,q,V,U,I){return L?ce(L,w,d,C,q,V,U,I):dp(V,U)},createSmoothTorusModel:function(R,x,v,m,k,O){return rd(new Fd(R,x,v,m,k,O))},createTorusModel:function(o,f,J,R,W,E,t,w){return o?Dr(o,f,J,R,W,E,t,w):Xh(E,t)},createExtrusionModel:function(y,k,z,O,j,n,b,W){return uo(y,k,z,O,j,n,b,W)},createSmoothRingModel:function(D,_,j,d,F,x){for(var U=[],R=0;R<D.length-1;R+=2)U.push({x:D[R],y:D[R+1]});for(D=ns(U,_,j)[0],U=[],R=0;R<D.length;R++){var K=D[R];U.push(new se(K.x,0,K.y))}return rd(new Yd(U,x,d,F))},createTextGeometry:function(t,C){return rd(new Np(t,C))},loadFontFace:function(O,l){m.xhrLoad(O,function(v){if(!v)return l();var F;try{F=JSON.parse(v)}catch(g){F=JSON.parse(v.substring(65,v.length-2))}yo.loadFace(F),l&&l(F.familyName.toLowerCase())},l?null:{sync:!0})},getShaderErrorLog:function(){return Pd.join("\n")},createRingModel:function(Q,I,U,K,M,c,H,e,j,o){for(var D=[],s=0;s<Q.length-1;s+=2)D.push({x:Q[s],y:Q[s+1]});c=c||m.shapeSide,H=H||0,e=e||c;var d,W,l,b,E,Y,S,L,V,x,s,n,v,X,p,h,B,r,A=[],y=[],J=j?[]:G,u=j?[]:G,T=o?[]:G,O=o?[]:G,f=K?[]:G,R=K?[]:G,$=M?[]:G,C=M?[]:G,Q=ns(D,I,U),k=Vc(Q),w=0,q=2*Math.PI/c;return Q.forEach(function(D){if(l=D.length,l>1){if(b=D[0],K)for(Y=b.x,L=b.y,s=H;e>s;s++)n=s+1,v=s*q,X=n*q,p=Z(v),h=P(v),B=Z(X),r=P(X),f.push(p*Y,L,-h*Y,B*Y,L,-r*Y,0,L,0),R.push(.5-.5*p,.5-.5*h,.5-.5*B,.5-.5*r,.5,.5);for(x=0;l>x;x++){for(E=D[x],Y=b.x,S=E.x,L=b.y,V=E.y,d=w/k,w+=qj(b,E),W=w/k,s=H;e>s;s++)n=s+1,v=s*q,X=n*q,p=Z(v),h=P(v),B=Z(X),r=P(X),A.push(p*S,V,-h*S,B*S,V,-r*S,p*Y,L,-h*Y,B*S,V,-r*S,B*Y,L,-r*Y,p*Y,L,-h*Y),y.push(s/c,W,n/c,W,s/c,d,n/c,W,n/c,d,s/c,d),j&&s===H&&(J.push(0,L,0,0,V,0,p*S,V,-h*S,p*S,V,-h*S,p*Y,L,-h*Y,0,L,0),u.push(0,.5-L,0,.5-V,2*S,.5-V,2*S,.5-V,2*Y,.5-L,0,.5-L)),o&&n===e&&(T.push(0,L,0,B*S,V,-r*S,0,V,0,B*S,V,-r*S,0,L,0,B*Y,L,-r*Y),O.push(1,.5-L,1-2*S,.5-V,1,.5-V,1-2*S,.5-V,1,.5-L,1-2*Y,.5-L));b=E}if(M)for(Y=b.x,L=b.y,s=H;e>s;s++)n=s+1,v=s*q,X=n*q,p=Z(v),h=P(v),B=Z(X),r=P(X),$.push(B*Y,L,-r*Y,p*Y,L,-h*Y,0,L,0),C.push(.5-.5*B,.5+.5*r,.5-.5*p,.5+.5*h,.5,.5)}}),{vs:A,uv:y,bottom_vs:$,bottom_uv:C,top_vs:f,top_uv:R,from_vs:J,from_uv:u,to_vs:T,to_uv:O}}},!0),Jg(e,{"3d.move.mode":D,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":D,"edge.gradient.color":D,"edge.source.t3":D,"edge.target.t3":D,"light.type":nc,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":Y/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Xg,"wf.short":!1,"wf.mat":D,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:D,"transparent.mask":!1,brightness:D,"select.brightness":.7,"repeat.uv.length":D,"shadow.cast":!0,"shadow.receive":!0,bloom:!1,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":D,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":rs,"label.t3":D,"label.r3":D,"label.texture.scale":2,"label.rotationMode":qs,"label.light":!1,"label.blend":D,"label.reverse.flip":!1,"label.reverse.color":wj,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":rs,"label2.t3":D,"label2.r3":D,"label2.texture.scale":2,"label2.rotationMode":qs,"label2.light":!1,"label2.blend":D,"label2.reverse.flip":!1,"label2.reverse.color":wj,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":rs,"note.t3":D,"note.r3":D,"note.texture.scale":2,"note.rotationMode":qs,"note.light":!1,"note.blend":D,"note.reverse.flip":!1,"note.reverse.color":wj,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":rs,"note2.t3":D,"note2.r3":D,"note2.texture.scale":2,"note2.rotationMode":qs,"note2.light":!1,"note2.blend":D,"note2.reverse.flip":!1,"note2.reverse.color":wj,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:D,"shape3d.color":Vp,"shape3d.top.color":D,"shape3d.bottom.color":D,"shape3d.from.color":D,"shape3d.to.color":D,"shape3d.image":D,"shape3d.image.projection":D,"shape3d.top.image":D,"shape3d.bottom.image":D,"shape3d.from.image":D,"shape3d.to.image":D,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":D,"shape3d.side.to":D,"shape3d.smooth":D,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":D,"shape3d.opacity":D,"shape3d.reverse.flip":!1,"shape3d.reverse.color":wj,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":D,"shape3d.uv.scale":D,"shape3d.uv.rotation":D,"shape3d.top.uv.offset":D,"shape3d.top.uv.scale":D,"shape3d.top.uv.rotation":D,"shape3d.bottom.uv.offset":D,"shape3d.bottom.uv.scale":D,"shape3d.bottom.uv.rotation":D,"shape3d.from.uv.offset":D,"shape3d.from.uv.scale":D,"shape3d.from.uv.rotation":D,"shape3d.to.uv.offset":D,"shape3d.to.uv.scale":D,"shape3d.to.uv.rotation":D,"shape3d.top.cap":D,"shape3d.bottom.cap":D,"shape3d.start.angle":0,"shape3d.sweep.angle":k,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":D,"texture.filter":D,"texture.filter.min":D,"texture.filter.mag":D,"texture.wrap":D,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Vp,"all.image":D,"all.blend":D,"all.opacity":D,"all.reverse.flip":!1,"all.reverse.color":wj,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":D,"all.uv.offset":D,"all.uv.scale":D,"all.uv.rotation":D,"all.discard.selectable":!0,mat:D,"left.mat":D,"right.mat":D,"top.mat":D,"bottom.mat":D,"front.mat":D,"back.mat":D,"edge.source.anchor.elevation":D,"edge.target.anchor.elevation":D},!0);var zj,cl=!1,pl=[0,0,0,0],Dh=function(I){return I instanceof Ti},Vn=function(t){return[t.x,t.e||0,t.y]},Nj=function(f,w,R){for(var w=Xi(w||0),G=w[0],x=w[1],X=w[2];R--;)f.push(G,x,X)},Ak=function(J,R,B){for(var R=Xi(R||0),H=R[0],E=R[1],I=R[2],Q=R[3];B--;)J.push(H,E,I,Q)},Jr=function(B,w,T){if(w)for(var m,H,C,j=w[0],D=w[1],p=w[2],$=w[4],y=w[5],q=w[6],V=w[8],U=w[9],v=w[10],R=w[12],f=w[13],_=w[14],Q=T.length,X=0,X=0;Q>X;X+=3)m=T[X],H=T[X+1],C=T[X+2],B.push(j*m+$*H+V*C+R,D*m+y*H+U*C+f,p*m+q*H+v*C+_);else bi(B,T)},ol=function(J,N){var u=N.s("light.intensity"),e=Xi(N.s(wn)),C=e[0],A=e[1],D=e[2];1!==u&&(C*=u,A*=u,D*=u),J.push(C,A,D,N.s("light.disabled")?1:0)},ym=function(w,T){var M=Gh.for(T),F=M.directUniforms();F.uHeadlightRange=w._headlightRange,F.uHeadlightAmbientIntensity=w._headlightAmbientIntensity;var h=w._headlightIntensity,B=Xi(w._headlightColor);1!==h&&(B=[B[0]*h,B[1]*h,B[2]*h]),F.uHeadlightColor=[B[0],B[1],B[2],w._headlightDisabled?1:0];var q=w._59O,K=w._spots,u=w._dirs;if(q.length){var Q=[],x=[],r=[];q.forEach(function(M){ol(Q,M),bi(x,w._transformPointToViewSpace(M.p3())),r.push(M.s("light.range"))}),F.uPointColor=Q,F.uPointRange=r,F.uPointPosition=x}if(K.length){var _=[],m=[],E=[],D=[],Y=[],C=[];K.forEach(function(k){ol(_,k),bi(m,w._transformPointToViewSpace(k.p3())),bi(Y,w._transformDirectionToViewSpace(k.p3(),k.s("light.center"))),E.push(k.s("light.range")),D.push(Z(k.s("light.angle")/2)),C.push(k.s("light.exponent"))}),F.uSpotColor=_,F.uSpotRange=E,F.uSpotAngle=D,F.uSpotExponent=C,F.uSpotPosition=m,F.uSpotDirection=Y}if(u.length){var j=[],U=[];u.forEach(function(a){ol(j,a),bi(U,w._transformDirectionToViewSpace(a.p3()))}),F.uDirColor=j,F.uDirDirection=U}},Yr=function(c,q){return Math.max(c.getRotateMinPhi()+sm,Math.min(c.getRotateMaxPhi()-sm,q))},fh=function(){return.05+ps()/2},hn=function(c,s,z,o){var q,i=c.getEye();return c.isOrtho()?(q=mm(c.getCenter(),i),q[0]+=o[0],q[1]+=o[1],q[2]+=o[2]):q=i,Pg(s,z,o,q)},Pg=function(d,W,e,n){var v=_b(d,W),Z=mm(n,e,!0),x=_b(Z,W);if(E(x)<sm)return G;var k=(v-_b(e,W))/x;return[e[0]+Z[0]*k,e[1]+Z[1]*k,e[2]+Z[2]*k]},Pp=function(k,Z){return{x:2*k.x-Z.x,y:2*k.y-Z.y}},Qk=function($,h,z,x){var i,k;if(!$)return i=pd(h.y-z.y,z.x-h.x),{x:h.x+x*P(i),y:h.y+x*Z(i)};if(!z)return i=pd($.y-h.y,h.x-$.x),{x:h.x+x*P(i),y:h.y+x*Z(i)};var A=mm([$.x,$.y,0],[h.x,h.y,0],!0),V=mm([z.x,z.y,0],[h.x,h.y,0],!0),s=-(A[0]+V[0])/2,C=-(A[1]+V[1])/2,p=j(s*s+C*C);if(sm>p)return i=pd($.y-h.y,h.x-$.x),{x:h.x+x*P(i),y:h.y+x*Z(i)};var m=$.x-h.x,o=$.y-h.y,G=z.x-h.x,X=z.y-h.y,u=j(m*m+o*o),O=j(G*G+X*X);i=M(_b(A,V))/2,k=A[1]*V[0]-A[0]*V[1]>0?-1:1,s/=p,C/=p;var Y=x/P(i),K=L(u,O)/Z(i);p=Math.min(Y,K);var H={x:h.x+k*p*s,y:h.y+k*p*C};return z.b&&Y>O/Z(i)&&(H.adjust=!0),H},ms=function(O){var J=O[1],H=O[2],u=O[3],b=O[6],M=O[7],D=O[11];O[1]=O[4],O[2]=O[8],O[3]=O[12],O[4]=J,O[6]=O[9],O[7]=O[13],O[8]=H,O[9]=b,O[11]=O[14],O[12]=u,O[13]=M,O[14]=D},qn=function(m){var I=m[0],t=m[1],L=m[2],K=m[3],R=m[4],u=m[5],C=m[6],l=m[7],b=m[8],T=m[9],z=m[10],H=m[11],M=m[12],d=m[13],F=m[14],N=m[15],w=I*u-t*R,W=I*C-L*R,v=I*l-K*R,A=t*C-L*u,P=t*l-K*u,U=L*l-K*C,e=b*d-T*M,k=b*F-z*M,X=b*N-H*M,c=T*F-z*d,s=T*N-H*d,V=z*N-H*F,S=w*V-W*s+v*c+A*X-P*k+U*e;return S?(S=1/S,m[0]=(u*V-C*s+l*c)*S,m[1]=(L*s-t*V-K*c)*S,m[2]=(d*U-F*P+N*A)*S,m[3]=(z*P-T*U-H*A)*S,m[4]=(C*X-R*V-l*k)*S,m[5]=(I*V-L*X+K*k)*S,m[6]=(F*v-M*U-N*W)*S,m[7]=(b*U-z*v+H*W)*S,m[8]=(R*s-u*X+l*e)*S,m[9]=(t*X-I*s-K*e)*S,m[10]=(M*P-d*v+N*w)*S,m[11]=(T*v-b*P-H*w)*S,m[12]=(u*k-R*c-C*e)*S,m[13]=(I*c-t*k+L*e)*S,m[14]=(d*W-M*A-F*w)*S,m[15]=(b*A-T*W+z*w)*S,void 0):G},pe=function(m,t){if(t){var K=t[0],N=t[1],o=t[2];m[12]=m[0]*K+m[4]*N+m[8]*o+m[12],m[13]=m[1]*K+m[5]*N+m[9]*o+m[13],m[14]=m[2]*K+m[6]*N+m[10]*o+m[14],m[15]=m[3]*K+m[7]*N+m[11]*o+m[15]}},Ac=function(w,a){if(a){var g=a[0],H=a[1],$=a[2];w[0]=w[0]*g,w[1]=w[1]*g,w[2]=w[2]*g,w[3]=w[3]*g,w[4]=w[4]*H,w[5]=w[5]*H,w[6]=w[6]*H,w[7]=w[7]*H,w[8]=w[8]*$,w[9]=w[9]*$,w[10]=w[10]*$,w[11]=w[11]*$}},Sg=function(O,G,d){var Q=G[0],o=G[1],j=G[2],g=G[3],C=G[4],I=G[5],_=G[6],X=G[7],z=G[8],L=G[9],l=G[10],u=G[11],Y=G[12],$=G[13],q=G[14],y=G[15],v=d[0],U=d[1],D=d[2],r=d[3];return O[0]=v*Q+U*C+D*z+r*Y,O[1]=v*o+U*I+D*L+r*$,O[2]=v*j+U*_+D*l+r*q,O[3]=v*g+U*X+D*u+r*y,v=d[4],U=d[5],D=d[6],r=d[7],O[4]=v*Q+U*C+D*z+r*Y,O[5]=v*o+U*I+D*L+r*$,O[6]=v*j+U*_+D*l+r*q,O[7]=v*g+U*X+D*u+r*y,v=d[8],U=d[9],D=d[10],r=d[11],O[8]=v*Q+U*C+D*z+r*Y,O[9]=v*o+U*I+D*L+r*$,O[10]=v*j+U*_+D*l+r*q,O[11]=v*g+U*X+D*u+r*y,v=d[12],U=d[13],D=d[14],r=d[15],O[12]=v*Q+U*C+D*z+r*Y,O[13]=v*o+U*I+D*L+r*$,O[14]=v*j+U*_+D*l+r*q,O[15]=v*g+U*X+D*u+r*y,O},os=function(a,D,c,Z){var m,I,$,f,B,n,z,X,U,Q,r=D[0],o=D[1],w=D[2],Y=Z[0],V=Z[1],C=Z[2],F=c[0],e=c[1],M=c[2];return E(r-F)<sm&&E(o-e)<sm&&E(w-M)<sm?Tm(a):(z=r-F,X=o-e,U=w-M,Q=1/j(z*z+X*X+U*U),z*=Q,X*=Q,U*=Q,m=V*U-C*X,I=C*z-Y*U,$=Y*X-V*z,Q=j(m*m+I*I+$*$),Q?(Q=1/Q,m*=Q,I*=Q,$*=Q):(m=0,I=0,$=0),f=X*$-U*I,B=U*m-z*$,n=z*I-X*m,Q=j(f*f+B*B+n*n),Q?(Q=1/Q,f*=Q,B*=Q,n*=Q):(f=0,B=0,n=0),a[0]=m,a[1]=f,a[2]=z,a[3]=0,a[4]=I,a[5]=B,a[6]=X,a[7]=0,a[8]=$,a[9]=n,a[10]=U,a[11]=0,a[12]=-(m*r+I*o+$*w),a[13]=-(f*r+B*o+n*w),a[14]=-(z*r+X*o+U*w),a[15]=1,a)},Jl=function(r,t,h,O,Y){var k=1/yh(t/2),c=1/(O-Y);return r[0]=k/h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=k,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(Y+O)*c,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*Y*O*c,r[15]=0,r},db=function(r,H,d,R,m,a,X){var Q=1/(H-d),V=1/(R-m),P=1/(a-X);return r[0]=-2*Q,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*V,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*P,r[11]=0,r[12]=(H+d)*Q,r[13]=(m+R)*V,r[14]=(X+a)*P,r[15]=1,r},qh=function(E,s){var f=s[0],d=s[1],H=s[2],_=s[3],X=f*f+d*d+H*H+_*_,U=X?1/X:0;return E[0]=-f*U,E[1]=-d*U,E[2]=-H*U,E[3]=_*U,E},vn=function(_,l){var q=l[0]+l[5]+l[10],J=0;return q>0?(J=2*Math.sqrt(q+1),_[3]=.25*J,_[0]=(l[6]-l[9])/J,_[1]=(l[8]-l[2])/J,_[2]=(l[1]-l[4])/J):l[0]>l[5]&l[0]>l[10]?(J=2*Math.sqrt(1+l[0]-l[5]-l[10]),_[3]=(l[6]-l[9])/J,_[0]=.25*J,_[1]=(l[1]+l[4])/J,_[2]=(l[8]+l[2])/J):l[5]>l[10]?(J=2*Math.sqrt(1+l[5]-l[0]-l[10]),_[3]=(l[8]-l[2])/J,_[0]=(l[1]+l[4])/J,_[1]=.25*J,_[2]=(l[6]+l[9])/J):(J=2*Math.sqrt(1+l[10]-l[0]-l[5]),_[3]=(l[1]-l[4])/J,_[0]=(l[8]+l[2])/J,_[1]=(l[6]+l[9])/J,_[2]=.25*J),_},us=function(z,W,q){var O=W[0],b=W[1],$=W[2],j=W[3],t=O+O,T=b+b,y=$+$,o=O*t,K=O*T,k=O*y,u=b*T,c=b*y,m=$*y,f=j*t,h=j*T,s=j*y;return z[0]=1-(u+m),z[1]=K+s,z[2]=k-h,z[3]=0,z[4]=K-s,z[5]=1-(o+m),z[6]=c+f,z[7]=0,z[8]=k+h,z[9]=c-f,z[10]=1-(o+u),z[11]=0,z[12]=q[0],z[13]=q[1],z[14]=q[2],z[15]=1,z},Qj=function(_,F){if(_.isVREnabled()){var Y=_.vr.getViewMatrix(F);if(Y)return Y}return os(F?F:Mj(),_._eye,_._center,_._up)},vd=function(T,z){if(T.isVREnabled()){var D=T.vr.getProjectMatrix();if(D)return D}if(!z&&T._computedProjectMatrix)return Qc(T._computedProjectMatrix);var j=T.getAspect(),u=T._near,E=T._far,n=Mj();if(T._ortho){var w=T._orthoWidth/2,Q=w/j;db(n,-w,w,-Q,Q,u,E)}else Jl(n,T._fovy,j,u,E);return n},Gb=function(L,p){if(!L)return G;var W=0,B=1,I=2,s=[],U=0,A=L.length,c=A/3;if(p){for(;A>U;U++)s[U]=0;for(U=0;U<p.length;U+=3){var C=[],R=[],n=[];C[W]=L[3*p[U+1]+W]-L[3*p[U]+W],C[B]=L[3*p[U+1]+B]-L[3*p[U]+B],C[I]=L[3*p[U+1]+I]-L[3*p[U]+I],R[W]=L[3*p[U+2]+W]-L[3*p[U+1]+W],R[B]=L[3*p[U+2]+B]-L[3*p[U+1]+B],R[I]=L[3*p[U+2]+I]-L[3*p[U+1]+I],n[W]=C[B]*R[I]-C[I]*R[B],n[B]=C[I]*R[W]-C[W]*R[I],n[I]=C[W]*R[B]-C[B]*R[W];for(var i=0;3>i;i++)s[3*p[U+i]+W]+=n[W],s[3*p[U+i]+B]+=n[B],s[3*p[U+i]+I]+=n[I]}}else for(U=0;c>U;U+=3){var C=[],R=[],n=[];C[W]=L[3*(U+1)+W]-L[3*U+W],C[B]=L[3*(U+1)+B]-L[3*U+B],C[I]=L[3*(U+1)+I]-L[3*U+I],R[W]=L[3*(U+2)+W]-L[3*(U+1)+W],R[B]=L[3*(U+2)+B]-L[3*(U+1)+B],R[I]=L[3*(U+2)+I]-L[3*(U+1)+I],n[W]=C[B]*R[I]-C[I]*R[B],n[B]=C[I]*R[W]-C[W]*R[I],n[I]=C[W]*R[B]-C[B]*R[W];
for(var i=0;3>i;i++)s[3*(U+i)+W]=n[W],s[3*(U+i)+B]=n[B],s[3*(U+i)+I]=n[I]}for(U=0;A>U;U+=3){var Y=[];Y[W]=s[U+W],Y[B]=s[U+B],Y[I]=s[U+I];var m=j(Y[W]*Y[W]+Y[B]*Y[B]+Y[I]*Y[I]);0===m&&(m=sm),Y[W]=Y[W]/m,Y[B]=Y[B]/m,Y[I]=Y[I]/m,s[U+W]=Y[W],s[U+B]=Y[B],s[U+I]=Y[I]}return new Hg(s)},eq=function(g,B,E,W){if(E||(E=g.createTexture()),B){var d=g.TEXTURE_2D,A=g.REPEAT,L=g.CLAMP_TO_EDGE,z=g.TEXTURE_MIN_FILTER;W=W||_d;var o=W.minFilter||W.filter||g.LINEAR,q=W.magFilter||W.filter||g.LINEAR;g.activeTexture(g.TEXTURE0),ik(g,E),g.texImage2D(d,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,B),Rp(g,g.TEXTURE_MAG_FILTER,q);var a=B.naturalWidth||B.width,O=B.naturalHeight||B.height;pj.isPOT(a)&&pj.isPOT(O)&&!W.clampToEdge&&!B.clampToEdge?(Rp(g,g.TEXTURE_WRAP_S,A),Rp(g,g.TEXTURE_WRAP_T,A),Rp(g,z,o===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR),W.mipmapMaxLevel!==D&&Rp(g,g.TEXTURE_MAX_LEVEL,W.mipmapMaxLevel),g.generateMipmap(d)):(Rp(g,g.TEXTURE_WRAP_S,L),Rp(g,g.TEXTURE_WRAP_T,L),Rp(g,z,o)),ik(g,G)}return E},ph=function(T,u){var v=new Uint8Array(4);return u=u||T.createTexture(),T.activeTexture(T.TEXTURE0),ik(T,u),Rp(T,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,1,1,0,T.RGBA,T.UNSIGNED_BYTE,v),u},Dc=function(j,Z){var $=new Uint8Array(4);return Z=Z||j.createTexture(),j.activeTexture(j.TEXTURE0),j.bindTexture(j.TEXTURE_CUBE_MAP,Z),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MAG_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),Z},rk=function(b){b._26I&&b._prg&&(b._26I.deleteProgram(b._prg),b._prg=G)},Og=function(x,f,A,i){var $=x.createShader(A);return x.shaderSource($,i),x.compileShader($),x.attachShader(f,$),$},np=function(M){return M.createBuffer()},ik=function(A,W){A.bindTexture(A.TEXTURE_2D,W||A._emptyTexture)},Rp=function(w,c,t){w.texParameteri(w.TEXTURE_2D,c,t)},th=function(W,j){var I=Gh.for(W).directState();I.polygonOffset.enabled=!0,I.polygonOffset.value=j},$o=function(P){var K=Gh.for(P).directState();K.polygonOffset.enabled=!1},lj=function(W,p){if(p){var J=Gh.for(W).directState();J.color.clear=Xi(p)}},wd=function(m){var z=Gh.for(m),P=z.directUniforms(),A=z.directAttribs();P.uFix=!0,A.aNormal=!1},sg=function(D){var w=Gh.for(D),C=w.directUniforms();w.directAttribs(),C.uFix=!1},ld=function(l,g,z,j,C,t,F,h){var A=Gh.for(l),b=A.directState(),n=A.directUniforms();l._picking||(z?(n.uBlend=!0,n.uBlendColor=z):n.uBlend=!1,n.uLight=j==G?!0:j,Lk(C)&&1!==C&&(n.uPartOpacity=C),n.uReverseFlip=t==G?!1:t,n.uFixPickReverseColor=F||wj),b.cullFace.enabled=h?!0:!1},tm=function(C){if(!C._picking){var A=Gh.for(C),Q=A.directUniforms();Q.uPartOpacity=1}},Kn=function(){var N=new q.Math.Matrix2d,s=[1,0,0,0,1,0,0,0,0];return function(B,t,I,P,f,K,O,z,H,U){var r=Gh.for(B),p=r.directUniforms(),n=r.directAttribs();return I?(p.uTexture=!0,p.uDiscardSelectable=Xd(P)?P:!0,n.aUv=im(B,f,K,G,2),U?(p.uBlendTexture=!0,p.uBlendSampler=U):(p.uBlendTexture=!1,p.uBlendSampler=B._emptyBlendTexture),p.uSampler=I,p.uUvMatrix=O||z||H?Md(H,O,z,N).toArray9():s,void 0):(p.uSampler=B._emptyTexture,p.uBlendSampler=B._emptyBlendTexture,void 0)}}(),qq=function(U,r,T){var M=Gh.for(U),E=M.directUniforms(),o=M.directAttribs();U.activeTexture(U.TEXTURE0),ik(U,G),U.activeTexture(U.TEXTURE1),ik(U,G),T&&(o.aUv=!1,E.uTexture=!1,E.uSampler=U._emptyTexture,E.uBlendTexture=!1,E.uBlendSampler=U._emptyBlendTexture)},Yp=function(X,b,K,h,c,w){var j=Gh.for(X),m=j.directUniforms(),E=j.directAttribs();!K||jr||gm||X.lineWidth(K),h&&!X._picking&&(m.uFixPickReverseColor=h),c&&(E.aPosition=im(X,c,w,G))},co=function(g,w,V,m){zj&&(m=g[zj]),g.drawArrays(m==G?g.TRIANGLES:m,w,V);var P=g._renderInfo;P&&(P.calls++,P.vertices+=V,(m==G||m===g.TRIANGLES)&&(P.faces+=V/3),m===g.LINES&&(P.lines+=V/2),m===g.POINTS&&(P.points+=V))},ek=function(J,n,V,L,u){zj&&(L=J[zj]),J.drawElements(L==G?J.TRIANGLES:L,V,u==G?J.UNSIGNED_SHORT:u,n==G?0:2*n);var x=J._renderInfo;x&&(x.calls++,x.vertices+=V,(L==G||L===J.TRIANGLES)&&(x.faces+=V/3),L===J.LINES&&(x.lines+=V/2),L===J.POINTS&&(x.points+=V))},xe=function(Y,D,E){var j=Y.ARRAY_BUFFER;return Y.bindBuffer(j,D),E&&Y.bufferData(j,E,Y.STATIC_DRAW),D},im=function(Z,e,E,m,r){return E?mh(Z,Z.ARRAY_BUFFER,e,E):xe(Z,e,E,m,r)},Ro=function(d,w,r){var x=d.ELEMENT_ARRAY_BUFFER;d.bindBuffer(x,w),r&&d.bufferData(x,r,d.STATIC_DRAW)},pf=function(U,F,d){mh(U,U.ELEMENT_ARRAY_BUFFER,F,d)},mh=function(p,l,Y,j){var c=j._bufId;c||(c=j._bufId=q.Math.generateIncreasingID());var Y,z=p._bufPool;return(Y=z[c])&&Y._buf?p.bindBuffer(l,Y._buf):(Y=z[c]={_buf:np(p)},p.bindBuffer(l,Y._buf),p.bufferData(l,j,p.STATIC_DRAW)),Y._fid=p._renderInfo.frame,Y._buf},Jc=function(E,p){p!=G&&p>=0&&E.enableVertexAttribArray(p)},zm=function(v,r){r!=G&&r>=0&&v.disableVertexAttribArray(r)},gf=function(q,r){var l=q.getGL(),Z=Gh.for(l),p=Z.directUniforms();q._7O=q._8O.pop(),r&&(p.uMVMatrix=q._7O,q._6O=r,p.uNMatrix=r)},fo=function(r,w){return w||(w=Mj()),kg(w,r),qn(w),ms(w),w},es=function(y,l){var k=y.getGL(),Y=y._7O,z=Gh.for(k),W=z.directUniforms();l?(y._8O.push(Qc(Y)),W.uMMatrix=l,Sg(Y,Y,l),y._7O=Y):W.uMMatrix=de,W.uMVMatrix=Y,W.uNMatrix=fo(Y,y._6O)},ag={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Zl=10,zr=function(E,I,d,h,U,o){var L;if(d){var Y=h._pickId;Y||(Y=h._pickId=I._pickIdUsed,I._pickIdUsed+=Zl);var v,D=ag[U];if(null!=D)v=Y+D;else{var B=h._pickExtraPartMap;B||(B=h._pickExtraPartMap={}),(v=B[U])||(v=B[U]=I._pickIdUsed++)}I[v]||(I[v]={data:h,part:U}),L=Ml(v)}else L=pl;if(!o){var q=Gh.for(E),i=q.directUniforms();i.uFixPickReverseColor=L}return L},rp=zr,sr=function(p,U,C){"target"!==C&&(C="source");var g="target"===C?U.getTargetAgent():U.getSourceAgent(),X="edge."+C+".";if(ge(g)){var w=U.s(X+"anchor.x"),J=U.s(X+"anchor.elevation"),n=U.s(X+"anchor.y"),V=Yb(g,p.getMat(g)),H=g.getAnchor3d();return Be([(w===D?.5:w)-H.x,(J===D?.5:J)-H.y,(n===D?.5:n)-H.z],V)}var f=U.s(X+"index"),Z=p.getData3dUI(g);if(!Z.info||!Z.info.list)return!1;if(f>=0){var q,u,c,I,j,i=Z.info._lastPointsSegments,T=i.points,Y=i.segments,b=-1,L=-1;for(c=0,I=Y?Y.length:T.length;I>c;c++){if(u=Y?Y.get(c):1,3===u)j=2;else if(4===u)j=3;else{if(5===u)continue;j=1}if(b+=j,L++,L===f){q=T.get(b);break}}return q||(q=T.get(T.length-1)),[q.x,q.e||0,q.y]}var G=U.s(X+"percent")||.5;if(G=Math.max(0,Math.min(G,1)),!Z||!Z.getCache)return!1;var m=Z.getCache(),I=m[m.length-1].length,i=p.getLineOffset(g,G*I),v=i.point;return[v.x,v.y,v.z]},js=function(){var e={center:function(n,A,v,D,L){var q=-A[1]/2,u={x:-A[0]/2,y:q,width:A[0],height:A[1]},k=yq(n,u,v);return[k.x+D,-k.y-L,fh()]},front:function(o,p,$,C,M){var v=-p[1]/2,L={x:-p[0]/2,y:v,width:p[0],height:p[1]},n=yq(o,L,$);return[n.x+C,-n.y-M,p[2]/2+fh()]},back:function(G,w,t,h,c){var Y=-w[0]/2,L=-w[1]/2,H={x:Y,y:L,width:w[0],height:w[1]},W=yq(G,H,t);return[-W.x-h,-W.y-c,-w[2]/2-fh()]},left:function(D,R,y,Y,w){var B=-R[1]/2,U={x:-R[2]/2,y:B,width:R[2],height:R[1]},k=yq(D,U,y);return[-R[0]/2-fh(),-k.y-w,k.x+Y]},right:function(H,S,B,y,W){var v=-S[2]/2,p=-S[1]/2,_={x:v,y:p,width:S[2],height:S[1]},N=yq(H,_,B);return[S[0]/2+fh(),-N.y-W,-N.x-y]},top:function(M,k,o,L,i){var S={x:-k[0]/2,y:-k[2]/2,width:k[0],height:k[2]},C=yq(M,S,o);return[C.x+L,k[1]/2+fh(),C.y+i]},bottom:function(O,H,W,L,a){var E=-H[2]/2,N={x:-H[0]/2,y:E,width:H[0],height:H[2]},p=yq(O,N,W);return[p.x+L,-H[1]/2-fh(),-p.y-a]}};return function(R,T,$,h,O,M){return e[h](R,T,$,O||0,M||0)}}(),ad=function(s,x,W,F,G,$,c,v,X,C){if(G&&(x[0]+=G[0],x[1]+=G[1],x[2]+=G[2]),pe(s,W),v){var H=Mj();if(hc(H,X,C),Be(x,H),pe(s,x),s.auto=v,s.pos=Be([0,0,0],s),$){var d=s.mat2=Mj();hc(d,$,c)}}else hc(s,X,C),pe(s,x),F===xb?cm(s,-Rm):F===ui?cm(s,Rm):F===am?mr(s,-Rm):F===ye?mr(s,Rm):F===hb&&cm(s,Y),hc(s,$,c);return s},Lq=function(M,j){var C=j.auto,r=j.mat2,W=M.gv;if(C){var t,n=Mj(),w=[0,0,0,0];t="string"==typeof C?[C.indexOf("x")<0?W._eye[0]:W._center[0],C.indexOf("y")<0?W._eye[1]:W._center[1],C.indexOf("z")<0?W._eye[2]:W._center[2]]:W._eye,vn(w,os(Mj(),t,W._center,W._up)),us(n,qh(w,w),j.pos),r&&Sg(n,n,r),es(W,n)}else es(W,j)},Ah=function(X,p,d,n,z){var E=X.s,V=X.gv,W=V.getGL(),x=V._prg,r=V._buffer,Y=V._1O,e=Gh.for(W),R=e.directAttribs();eq(W,el,Y),Lq(X,d),ld(W,x,E(p+".blend"),E(p+".light"),E(p+".opacity"),E(p+".reverse.flip"),E(p+".reverse.color"),E(p+".reverse.cull")),Kn(W,x,Y,z,r.uv,qp),R.aPosition=im(W,r.vs,n,G),R.aNormal=im(W,r.ns,ki,G),pf(W,r.is,nh),ek(W,0,nh.length),qq(W,x,Y),tm(W,x),gf(V)},dm=function(z,I,D){var t=z.gv,C=z.data,p=z[I]={blend:t.getBodyColor(C)||t.getFaceBlend(C,I),light:t.getFaceLight(C,I),color:t.getFaceColor(C,I),opacity:t.getFaceOpacity(C,I),transparent:t.getFaceTransparent(C,I),reverseFlip:t.getFaceReverseFlip(C,I),reverseColor:t.getFaceReverseColor(C,I),reverseCull:t.getFaceReverseCull(C,I),texture:t.getFaceImage(C,I),blendTexture:t.getFaceBlendImage(C,I),discardSelectable:t.getFaceDiscardSelectable(C,I)};if("csg"!==I){p.uv=t.getFaceUv(C,I)||D&&D[I+"Uv"],p.uvScale=t.getFaceUvScale(C,I)||D&&D[I+"UvScale"],p.uvOffset=t.getFaceUvOffset(C,I)||D&&D[I+"UvOffset"],p.uvRotation=t.getFaceUvRotation(C,I)||D&&D[I+"uvRotation"];var Z=t.getFaceMat(C,I);if(Z){var P=Yb(C,Z);C.appendAnchorMatrix3d(P),p.mat=P}}return p},yb=function(n,C,i,Z,y){var k=n[Z];if(k){if(!y(k.transparent))return;var l=n.data,o=n.gv,h=o._buffer,Y=o.getTexture(k.texture,l,Z),B=o.getTexture(k.blendTexture,l),f=Gh.for(C),s=f.directUniforms(),x=f.directAttribs();Kn(C,i,Y,k.discardSelectable,h.uv,k.tuv,k.uvOffset,k.uvScale,k.uvRotation,B),ld(C,i,k.blend,k.light,k.opacity,k.reverseFlip,k.reverseColor,k.reverseCull),k.cs&&!o._batchColorDisabled?(s.uBatchColor=!0,x.aBatchColor=im(C,h.batchColor,k.cs,i.aBatchColor,4)):s.uDiffuse=k.color||e["color.empty"],x.aPosition=im(C,h.vs,k.vs,G),x.aNormal=im(C,h.ns,k.ns,G),co(C,0,k.vs.length/3),k.cs&&!o._batchColorDisabled&&(s.uBatchColor=!1,zm(C,i.aBatchColor)),tm(C,i),qq(C,i,Y)}},Ci=function(W,K,H){bf(W)?W.forEach(function(v){Ci(v,K,H)}):on(W)?Ci(ff(K,W),K,H):vc(W)?W.shape3d?Ci(W.shape3d,K,H):H.push(W):H.push(W)},oo=function(){for(var g=50,V=arguments.length,M=[],R=0;V>R;R++)M[R]=arguments[R];Pd[xg]="Time : "+(new Date).toLocaleString()+", Info :"+M.join(", "),xg=(xg+1)%g,console.error("Failed to create shader.")},Md=function(){var A=new pj.Matrix2d;return function(z,n,i,o){o||(o=A);var C,p,d,j;return n?(C=n[0],p=n[1]):C=p=0,i?(d=i[0],j=i[1]):d=j=1,o.setFromTransform(z||0,C,p,d,j)}}(),yp=function(M,t,A,y,P,m){var S,W,x,k,J,v,K,b,B,w,u,i=[y-t,P-A],X=M?M.length:0;for(x=0;X>x;x++){for(k=2,S=M[x],J=S[0],v=S[1];k+1<S.length;){if(K=S[k],b=S[k+1],W=nl(t,A,y,P,J,v,K,b,!0)){B=[K-J,b-v],w=qj(B),B[0]/=w,B[1]/=w,w=_b(i,B),w=w>0?m:-m,u=[B[0]*w,B[1]*w];break}J=K,v=b,k+=2}if(u)break}if(u)for(y=t+u[0],P=A+u[1],x=0;X>x;x++)for(k=2,S=M[x],J=S[0],v=S[1];k+1<S.length;){if(K=S[k],b=S[k+1],W=nl(t,A,y,P,J,v,K,b,!0))return[0,0];J=K,v=b,k+=2}return u?u:[y-t,P-A]},Pm=function(E){return"nearest"===E?aq.NEAREST:"linear"===E?aq.LINEAR:E},Dl=q.graph3d={},Xk=function(G,h,w){mj(X+".graph3d."+G,h,w)},ob="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Gi="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Jg(m,{setBatchInfo:function(Q,e){an[Q]=e},getBatchInfo:function(Z){return an[Z]},getBatchInfoMap:function(){return an},setBatchInfoMap:function(Y){an=Y}},!0);var pr=[1,1,1],Tn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],dc=[1,0,0,0,0,1,0,1,1,1,1,0],Gp=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Bq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],El=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],xs=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],mf=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ci=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],wi=function(T,h){var m=T._40Q;m.each(function(L){L.ivBatch(h)})},lo=function(y,m,J){var F=J._id,k=m[F];if(k){var $=k.batch,p=y[$],E=p.ds,W=k.index;if(p.invalidate=!0,delete m[F],E.splice(W,1),Dk(E))return delete y[$],void 0;for(var M=k.begin,f=k.size,Q=3*M,Z=3*f,I=4*M,H=4*f,u=p.vs,A=p.ps,w=p.uv,s=p.cs,n=p.bs,v=p.rs,b=p.ns,h=p.ls;W<E.length;W++)k=m[E[W]._id],k.index--,k.begin-=f;u.splice(Q,Z),A.splice(I,H),w&&w.splice(2*M,2*f),s&&s.splice(I,H),n&&n.splice(Q,Z),v&&v.splice(M,f),b&&b.splice(Q,Z),h&&h.splice(M,f)}},ip=function(V,O,J,S,L){if(!S)return G;var d=O[S];if(!d){var X=L.getBatchInfo(S)||_d,C=X.image?[]:G;d=O[S]={vs:[],ns:[],uv:C,cs:C?G:X.color?G:[],bs:X.blend?[]:G,ps:[],rs:X.brightness?[]:G,ds:[]}}return d.invalidate=!0,V[J._id]={index:d.ds.length,begin:d.vs.length/3,batch:S},d.ds.push(J),d},qk=function(S,l){return l!=G&&1!==l?[S[0]*l,S[1]*l,S[2]*l,S[3]]:S},Od=function(P){var s=P.shapeModel;s||(s=ff(P)),s&&(s._ctlineModel=[],s._lineModel=D)},Rf=function(){var y;return function(c,E,k){var C=c.getData3dUI(E),G=C.shapeModel;if(G||(G=ff(C)),G||!C.shapeName){var R,r=E.s("wf.combineTriangle");if(k.geometry){if(!G&&(E instanceof q.Node&&!(E instanceof q.Shape)?(y||(y={vs:ze,is:Kj,uv:Jm}),G=y):G=[C.left,C.front,C.right,C.back,C.top,C.bottom],!G))return D;if(r){var z=E.s("wf.normEpsilon");isNaN(z)&&(z=2),r=0|Math.min(3,Math.max(1,isNaN(r)?1:r)),R=Mm[r-1](G,C,180/(Math.PI*z))}else R=$m(G,C);if(!R||0===R.length)return}else R=k.short?Ar:Ad;var L=c.getBrightness(E),Y=E.s("bloom"),o=E.s("3d.reflectable"),j=Xi(k.color||"white"),Q=j[3]<1,T=Math.ceil(k.width)||1,Z=(Q?"T":"O")+(Y?"_1":"_0")+(o?"1_":"0_")+T,w=E.getRenderLayer(),n=c._40Q.get(w),P=n.wireframeIndexMap,_=n.wireframeModelMap,F=_[Z];F||(F=_[Z]={vs:[],cs:[],ps:[],ds:[],T:Q,B:Y,reflectable:!!o,W:T}),F.invalidate=!0;var X=F.vs,U=F.cs,B=F.ds,m=P[E._id]={index:B.length,begin:X.length/3,batch:Z};B.push(E);var J=C.mat;E instanceof q.Edge||!(!J||!k.geometry&&E instanceof q.Shape)||(J=Yb(E,k.mat),E.appendAnchorMatrix3d(J)),Jr(X,J,R);var g=m.size=X.length/3-m.begin;Ak(U,qk(j,L),g)}}}(),Tb=function(l,I,f,F,E,t,g,s,P){var X=l.getBrightness(I);X==G&&(X=1);var A=qk(Xi(F),X),B=A[3]<1;t=Math.ceil(t)||1;var $=(B?"T":"O")+t;if(g){var Q=g[0],e=(g[1]||Q)+Q;$+="-"+Q+"-"+e,P&&($+="-"+Tp(P)+"-"+X,P=qk(Xi(P),X))}var N=I.getRenderLayer(),i=l._40Q.get(N),M=i.polylineIndexMap,d=i.polylineModelMap,C=d[$];C||(C=d[$]={vs:[],cs:[],ps:[],ds:[],ls:g?[]:G,T:B,W:t},g&&(C.D=Q,C.G=e,C.A=P)),C.invalidate=!0;var u,x=C.vs,D=C.cs,n=C.ds,a=C.ls,U=M[I._id]={index:n.length,begin:x.length/3,batch:$};n.push(I),bi(x,f);var L,Z=U.size=x.length/3-U.begin,O=f.length,R=0,h=[];if(g||E)for(u=0;O>u;u+=6)L=qj([f[u],f[u+1],f[u+2]],[f[u+3],f[u+4],f[u+5]]),h.push(L),R+=L;if(R&&E){var j,v=qk(Xi(E),X),y=[v[0]-A[0],v[1]-A[1],v[2]-A[2],v[3]-A[3]],c=0;for(u=0;O>u;u+=6)j=c/R,Ak(D,[A[0]+y[0]*j,A[1]+y[1]*j,A[2]+y[2]*j,A[3]+y[3]*j],1),c+=h[u/6],j=c/R,Ak(D,[A[0]+y[0]*j,A[1]+y[1]*j,A[2]+y[2]*j,A[3]+y[3]*j],1)}else Ak(D,A,Z);if(g)for(c=s||0,u=0;O>u;u+=6)a.push(c),c+=h[u/6],a.push(c)},ul=function(T,s,p){if(s){var V=4*s.begin,h=p[s.batch].ps;if(h[V]!==T[0]||h[V+1]!==T[1]||h[V+2]!==T[2]||h[V+3]!==T[3]){for(var X=0;X<s.size;X++)h[V++]=T[0],h[V++]=T[1],h[V++]=T[2],h[V++]=T[3];
h._invalidateThisFrame=!0}}},$c=function(){var y=new q.Math.Vector3,T=new q.Math.Vector3;return function(_,F){var j=F+["32"],k=_[F],N=_[j];if(k){if(m.extractBatchTranslation&&"vs"===F){T.set(0,0,0);for(var S=k.length,d=0;S>d;d+=3)T.add(y.fromArray(k,d));T.divideScalar(S/3);for(var o=T.x,P=T.y,w=T.z,J=new Array(S),d=0;S>d;d+=3)J[d]=k[d]-o,J[d+1]=k[d+1]-P,J[d+2]=k[d+2]-w;k=J,_.translate=[o,P,w]}N&&N.length===k.length?(N.set(k),N._bufId=null):_[j]=new Hg(k)}else delete _[j]}}(),$d=function(B,d,b,N,X,Y,C,J){if(bf(b))b.forEach(function(x){$d(B,d,x,N,X,Y,C,J)});else if(on(b))$d(B,d,ff(N,b),N,X,Y,C,J);else if(vc(b)){var V,P=$b(b.mat,d,B),t=$b(b.s3,d,B),v=$b(b.t3,d,B),y=$b(b.r3,d,B);if((t||y||v||P)&&(V=Op(P,t,y,$b(b.rotationMode,d,B),v),Y.push(V)),b.shape3d)$d(B,d,b.shape3d,N,X,Y,C,b);else{var n=N.s;J=J||_d;var c=Y[0],h=Y.length,a=n("shape3d.color",b.color,J.color);if(X||(X=n("shape3d.blend",b.blend,J.blend)),h>1){c=Qc(c);for(var K=1;h>K;K++)Sg(c,c,Y[K])}var R=c?fo(c):G;b.vs&&n(We,b.visible,J.visible)&&rm(c,C,b.vs,b.uv,b.is,b.ns,R,X,a),b.top_vs&&n(ah,b.topVisible,J.topVisible)&&rm(c,C,b.top_vs,b.top_uv,b.top_is,b.top_ns,R,X,n("shape3d.top.color",b.topColor,J.topColor)||a),b.bottom_vs&&n(tl,b.bottomVisible,J.bottomVisible)&&rm(c,C,b.bottom_vs,b.bottom_uv,b.bottom_is,b.bottom_ns,R,X,n("shape3d.bottom.color",b.bottomColor,J.bottomColor)||a),b.from_vs&&n(Ff,b.fromVisible,J.fromVisible)&&rm(c,C,b.from_vs,b.from_uv,b.from_is,b.from_ns,R,X,n("shape3d.from.color",b.fromColor,J.fromColor)||a),b.to_vs&&n(as,b.toVisible,J.toVisible)&&rm(c,C,b.to_vs,b.to_uv,b.to_is,b.to_ns,R,X,n("shape3d.to.color",b.toColor,J.toColor)||a)}V&&Y.pop()}},rm=function(x,s,c,B,L,S,o,T,P){var H,U=s.cs,Q=s.uv,z=s.bs,m=s.ns,I=s.vs;if(S&&0!==S.length||(S=Gb(c,L)),L){H=L.length;for(var N=0;H>N;N++){var h=L[N],X=3*h;Jr(I,x,[c[X],c[X+1],c[X+2]]),Jr(m,o,[S[X],S[X+1],S[X+2]]),Q&&bi(Q,[B[2*h],B[2*h+1]])}}else H=c.length/3,Jr(I,x,c),Jr(m,o,S),Q&&bi(Q,B);U&&Ak(U,P,H),z&&(T?Nj(z,T,H):bi(z,pr,H))},Wc=function(y,H,Q,N){N?$d(y.gv,y.data,N,y,y.getBodyColor(),[H],Q):(Gc(y,xb,H,Q),Gc(y,ui,H,Q),Gc(y,rs,H,Q),Gc(y,hb,H,Q),Gc(y,am,H,Q),Gc(y,ye,H,Q),Gc(y,"csg",H,Q))},Gc=function($,e,V,X){var M=$[e];if(M){var v=M.tuv;if(v){var R=M.uvScale,j=M.uvOffset,N=M.uvRotation;if(R||j||N){var U,P,g,B=Md(N,j,R),y=B.a,H=B.b,_=B.c,E=B.d,p=B.tx,z=B.ty,F=v.length;for(g=0;F>g;g+=2)U=v[g],P=v[g+1],v[g]=y*U+_*P+p,v[g+1]=H*U+E*P+z}}rm(V,X,M.vs,v,G,G,V?fo(V):G,M.blend,M.color)}},So=function(c,Q,L,d,o,u,E,K){var X,b=L.cs,Y=L.uv,r=L.bs,s=L.vs,V=L.ns,$=Gb(K);if(c.getFaceVisible(Q,E)){var R=c.getFaceMat(Q,E);if(R&&(o=Yb(Q,R),u=fo(o)),Jr(s,o,K),Jr(V,u,$),b&&Ak(b,c.getFaceColor(Q,E),6),Y){var y=c.getFaceUv(Q,E)||d[E+"Uv"],g=c.getFaceUvScale(Q,E)||d[E+"UvScale"],p=c.getFaceUvOffset(Q,E)||d[E+"UvOffset"],v=c.getFaceUvRotation(Q,E)||d[E+"UvRotation"];y=y?[y[6],y[7],y[0],y[1],y[2],y[3],y[2],y[3],y[4],y[5],y[6],y[7]]:dc;var H=y[0],J=y[1],P=y[2],U=y[3],M=y[4],m=y[5],I=y[6],G=y[7],x=y[8],q=y[9],t=y[10],k=y[11];if(g||p||v){var e=Md(v,p,g),z=e.a,C=e.b,T=e.c,l=e.d,f=e.tx,B=e.ty;H=z*H+T*J+f,J=C*H+l*J+B,P=z*P+T*U+f,U=C*P+l*U+B,M=z*M+T*m+f,m=C*M+l*m+B,I=z*I+T*G+f,G=C*I+l*G+B,x=z*x+T*q+f,q=C*x+l*q+B,t=z*t+T*k+f,k=C*t+l*k+B}Y.push(H,J,P,U,M,m,I,G,x,q,t,k)}r&&(X=c.getBodyColor(Q)||c.getFaceBlend(Q,E),X?Nj(r,X,6):bi(r,pr,6))}},bs=function(Y,l,k,p){var k=Y._picking?Y.pickColorMap:null,g=Y.getGL(),U=Y._prg,b=Y._buffer;if(!_k(l)){es(Y,Tn),wd(g,U);for(var F in l){var X=l[F];if(!(p&&!X.T||!p&&X.T||Y.isReflecting(g)&&X.reflectable===!1)){X.invalidate?(X.invalidate=!1,$c(X,"vs"),$c(X,"cs"),$c(X,"ls"),$c(X,"ps")):k&&X.ps&&X.ps._invalidateThisFrame&&(X.ps._invalidateThisFrame=!1,$c(X,"ps"));var I=X.translate;I&&es(Y,[1,0,0,0,0,1,0,0,0,0,1,0,I[0],I[1],I[2],1]);var T=X.vs32,O=k?X.ps32:X.cs32;Yp(g,U,X.W,G,b.vs,T);var A=Gh.for(g),Z=A.directUniforms(),h=A.directAttribs(),Q=X.D,D=!Y._dashDisabled&&Q;Z.uAlphaTest=e.alphaTest,g._blooming&&!X.B&&(Z.blackout=!0),D&&(Z.uDash=!0,Z.uDashDistance=Q,Z.uDashGapDistance=X.G,Z.uDiffuse=X.A||e["color.empty"],h.aLineDistance=im(g,b.lineDistance,X.ls32,G,1));var w=!Y._batchColorDisabled;w&&O.length?(Z.uBatchColor=!0,h.aBatchColor=im(g,b.batchColor,O,G,4)):(Z.uBatchColor=!1,h.aBatchColor=!1),Kn(g),co(g,0,T.length/3,g.LINES),qq(g),w&&(Z.uBatchColor=!1,h.aBatchColor=!1),D&&(Z.uDash=!1,h.aLineDistance=!1),g._blooming&&!X.B&&(Z.blackout=!1),I&&gf(Y)}}sg(g,U),gf(Y)}},Wj=function(h){h.invalidate=!1,$c(h,"vs"),$c(h,"ns"),$c(h,"cs"),$c(h,"rs"),$c(h,"ps"),$c(h,"bs"),$c(h,"uv")},Dq=function(t,x,E,V,Z){var u,O,U,g,L,I,Y,P,B,K,Q,T,E=t._picking?t.pickColorMap:null,J=t.getGL(),$=t._prg,l=Gh.for(J),r=l.directUniforms(),a=l.directAttribs(),w=t._buffer;if(!_k(x)&&!t.drawFilter){es(t,Tn);for(u in x)if(O=t.getBatchInfo(u)||_d,O.visible!==!1&&!(V&&!O.transparent||!V&&O.transparent||t.isReflecting(J)&&O.reflectable===!1)){var f=O.renderLayerMask;if(f==G&&(f=si),Z==G&&(Z=si),Li(Z,f)&&(U=x[u],E||!O.transparentMask)){var y=V&&O.autoSort===!0&&(t._33Q||U.invalidate);if(U.invalidate?Wj(U):E&&U.ps&&U.ps._invalidateThisFrame&&(U.ps._invalidateThisFrame=!1,$c(U,"ps")),L=U.vs32,I=E?U.ps32:U.cs32,B=U.uv32,Y=U.bs32,P=U.rs32,Q=L.length/3,y){var k=sh(L,t.getEye(),t);k?(U.is=k.is,U.elementTypeUint=k.useUint32):(U.is=null,U.elementTypeUint=null)}if(Q){T=U.translate,T&&es(t,[1,0,0,0,0,1,0,0,0,0,1,0,T[0],T[1],T[2],1]),g=O.light,K=t.getTexture(O.image),ld(J,$,G,O.light,O.opacity,O.reverseFlip,O.reverseColor,O.reverseCull),I?t._batchColorDisabled?(r.uBatchColor=!1,a.aBatchColor=!1):(r.uBatchColor=!0,a.aBatchColor=im(J,w.batchColor,I,G,4)):(r.uBatchColor=!1,r.uDiffuse=O.color||e["color.empty"]);var j=O.alphaTest;r.uAlphaTest=j===D?e.alphaTest:j,r.shadowReceive=!E&&O.shadowReceive!==!1,J._blooming&&!O.bloom&&(r.blackout=!0),O.envmap!==D?(r.uUseEnvMap=!0,r.uReflectivity=O.envmap):(r.uUseEnvMap=!1,r.uReflectivity=0);var v=Y&&!t._batchBlendDisabled;v&&(r.uBatchBlend=!0,a.aBatchBlend=im(J,w.batchBlend,Y,G));var F=P&&!t._batchBrightnessDisabled;F&&(r.uBatchBrightness=!0,a.aBatchBrightness=im(J,w.batchBrightness,P,G,1)),B?Kn(J,$,K,O.discardSelectable,w.uv,B,O.uvOffset,O.uvScale,O.uvRotation):Kn(J),a.aPosition=im(J,w.vs,L,G),a.aNormal=im(J,w.ns,U.ns32,G),U.is?(Ro(J,w.is,U.is),ek(J,0,Q,null,U.elementTypeUint?J.UNSIGNED_INT:null)):co(J,0,Q),B?qq(J,$,K):qq(J),I&&!t._batchColorDisabled&&(r.uBatchColor=!1,a.aBatchColor=!1),v&&(r.uBatchBlend=!1,a.aBatchBlend=!1),F&&(r.uBatchBrightness=!1,a.aBatchBrightness=!1),J._blooming&&!O.bloom&&(r.blackout=!1),tm(J,$),T&&gf(t)}}}gf(t)}},sh=function(c,Z,d){var m=c.length/3,t=m>65535,G=d._glCapabilities.elementTypeUint&&t;if(!G&&t)return null;for(var O=new Array(m),L=m/3,z=new Array(L),R=0;L>R;R++)z[R]=R;z.sort(function(O,u){var J=9*O,k=[(c[J]+c[J+3]+2*c[J+6])/4,(c[J+1]+c[J+4]+2*c[J+7])/4,(c[J+2]+c[J+5]+2*c[J+8])/4];J=9*u;var z=[(c[J]+c[J+3]+2*c[J+6])/4,(c[J+1]+c[J+4]+2*c[J+7])/4,(c[J+2]+c[J+5]+2*c[J+8])/4],_=qj(Z,k)-qj(Z,z);return _>0?-1:0>_?1:0});for(var R=0;L>R;R++){var M=3*R,V=3*z[R];O[M]=V,O[M+1]=V+1,O[M+2]=V+2}return{useUint32:G,is:G?new Uint32Array(O):new oh(O)}},Un={obj:function(W,_){var z={mat:W.mat,s3:W.s3,r3:W.r3,rotationMode:W.rotationMode,t3:W.t3,cube:W.cube==G?!0:W.cube,center:W.center==G?!0:W.center,ignoreMtls:W.ignoreMtls,ignoreTransparent:W.ignoreTransparent,ignoreColor:W.ignoreColor,ignoreImage:W.ignoreImage,ignoreNormal:W.ignoreNormal,prefix:W.prefix,flipY:W.flipY,flipFace:W.flipFace,reverseFlipMtls:W.reverseFlipMtls,finishFunc:function(Q,Z){if(Q){var Z=[];for(var r in Q){var X=Q[r];Z.rawS3=X.rawS3,X.center&&(Z.center=X.center),Z.push(X),W.eachModel&&W.eachModel(r,X)}Z.json=W,_(Z)}else _()}};m.loadObj(W.obj,W.mtl,z)},bin:function(_,D){var T={finishFunc:function(L){L?D(L):D()}};m.loadBin(_.url,T)}};m.getModelTypeHandlers=function(){return Un},m.setModelTypeHandler=function(q,P){Un[q]=P},m.getModelTypeHandler=function(T){return Un[T]},m.handleModelLoaded=function(){},m.handleUnfoundModel=function(){};var bg=G,Vf=G,Hr=function(k){bg&&!k._loadingModelView_&&(Vf||(Vf={}),Vf[k._loadingModelView_=Fe()]=k)},yj=function(o,T){bg||(bg={});var t=bg[o];if(t){if(t.url===T)return;t.request.onload=Hb,t.request.onerror=Hb}if(T.indexOf(".bin")===T.length-4)return Kp(o,{modelType:"bin",url:T},T);if(T=m.beforeLoadURL(T),T.data){var v=m.parse(T.data);Kp(o,v,T)}else{var X=new Ei;bg[o]={request:X,url:T},X.onload=function(){if(200===this.status||0===this.status){delete bg[o];var q=m.parse(X.getResponseText());Kp(o,q,T)}else gp(o,m.handleUnfoundModel(o,T)||G)},X.onerror=function(){gp(o,m.handleUnfoundModel(o,T)||G)};var r={};r.url=encodeURI(T),r.sync=!1,X.send(r)}},Kp=function(P,B,j){var s=B.modelType;if(!s)return gp(P,B),m.handleModelLoaded(P,B),void 0;var E=m.getModelTypeHandler(s);if(E){if(bg||(bg={}),bg[P])return;bg[P]=!0;var q=function(S){S?(gp(P,S),m.handleModelLoaded(P,S)):gp(P,m.handleUnfoundModel(P,j,B)||G)};E(B,q)}else gp(P,m.handleUnfoundModel(P,j,B)||G)},gp=function(c,q){if(delete bg[c],on(q)&&Wf.test(q))return yj(c,q),void 0;if($p[c]=q,_k(bg)&&(bg=G,Vf)){for(var x in Vf){var d=Vf[x];d.invalidateAll&&d.invalidateAll(D,"modelLoaded",c),d.redraw&&d.redraw(),d.iv(),delete d._loadingModelView_}Vf=G}if(q&&Vf)for(var x in Vf){var d=Vf[x];d.invalidateAll&&d.invalidateAll(D,"modelLoading",c),d.redraw&&d.redraw(),d.iv()}},qp=new Hg([0,0,0,1,1,1,1,0]),ki=new Hg([0,0,1,0,0,1,0,0,1,0,0,1]),nh=new oh([0,1,2,2,3,0]),ze=new Hg([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Kj=new oh([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Jm=new Hg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),xj=Gb(ze,Kj),Xq=(new Hg([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new oh([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[xb,rs,ui,hb,am,ye]),Ad=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Ar=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],zf=function(f,V,y,H,v,J,p){J=J||16,f=f||16,V=V||0,y=y||f;var C,O,I,$,l,F,z,M,g,w=.5,_=[],B=[],W=k/f,n=Y/J;for(C=0;J>C;C++)for(F=C+1,$=C*n,g=F*n,O=V;y>O;O++)z=O+1,I=O*W,M=z*W,_.push(w*P($)*Z(I),w*Z($),-w*P($)*P(I),w*P(g)*Z(M),w*Z(g),-w*P(g)*P(M),w*P($)*Z(M),w*Z($),-w*P($)*P(M),w*P($)*Z(I),w*Z($),-w*P($)*P(I),w*P(g)*Z(I),w*Z(g),-w*P(g)*P(I),w*P(g)*Z(M),w*Z(g),-w*P(g)*P(M)),B.push(O/f,C/J,z/f,F/J,z/f,C/J,O/f,C/J,O/f,F/J,z/f,F/J);if(p){var U=[];for(C=0,l=_.length;l>C;C+=3)U.push(2*_[C],2*_[C+1],2*_[C+2])}if(H){var x=[],Q=[];for(I=V*W,C=0;J>C;C++)F=C+1,$=C*n,g=F*n,x.push(0,0,0,w*P(g)*Z(I),w*Z(g),-w*P(g)*P(I),w*P($)*Z(I),w*Z($),-w*P($)*P(I)),Q.push(0,.5,V/f,F/J,V/f,C/J)}if(v){var c=[],L=[];for(I=y*W,C=0;J>C;C++)F=C+1,$=C*n,g=F*n,c.push(0,0,0,w*P($)*Z(I),w*Z($),-w*P($)*P(I),w*P(g)*Z(I),w*Z(g),-w*P(g)*P(I)),L.push(1,.5,y/f,C/J,y/f,F/J)}var m={vs:_,uv:B,from_vs:x,from_uv:Q,to_vs:c,to_uv:L};return p&&(m.ns=U),m},Xh=function(z,I,F){z=z||.17,I=I||12,F=F||18,0>z?z=0:z>.25&&(z=.25);var S,O,T,$,h,B,C,v=.5,l=[],U=[],N=[],A=k/F,r=k/I,Q=v-z;for(O=0;I>=O;O++)for($=-Y+O*r,B=Z($),h=P($),S=0;F>=S;S++)T=S*A,C=Q+z*B,l.push(Z(T)*C,h*z,-P(T)*C),U.push(S/F,1-O/I);for(O=0;I>O;O++){var p=O*(F+1),G=(O+1)*(F+1);for(S=0;F>S;S++)N.push(p+S,G+S+1,G+S,p+S,p+S+1,G+S+1)}return{vs:l,uv:U,is:N}},Dr=function(n,c,y,q,b,p,v,O){v=v||12,n=n||18,c=c||0,y=y||n,p=p||.17,0>p?p=0:p>.25&&(p=.25);var d,J,a,C,W,V,s,X,T,M,r=.5,U=[],x=[],K=k/n,g=k/v,j=r-p,L=O?[]:D;for(a=0;v>a;a++)for(C=a+1,s=-Y+a*g,X=-Y+C*g,d=c;y>d;d++)J=d+1,W=d*K,V=J*K,T=j+p*Z(s),M=j+p*Z(X),U.push(Z(W)*T,P(s)*p,-P(W)*T,Z(V)*T,P(s)*p,-P(V)*T,Z(V)*M,P(X)*p,-P(V)*M,Z(W)*T,P(s)*p,-P(W)*T,Z(V)*M,P(X)*p,-P(V)*M,Z(W)*M,P(X)*p,-P(W)*M),x.push(d/n,1-a/v,J/n,1-a/v,J/n,1-C/v,d/n,1-a/v,J/n,1-C/v,d/n,1-C/v),O&&L.push(Z(W)*Z(s),P(s),-P(W)*Z(s),Z(V)*Z(s),P(s),-P(V)*Z(s),Z(V)*Z(X),P(X),-P(V)*Z(X),Z(W)*Z(s),P(s),-P(W)*Z(s),Z(V)*Z(X),P(X),-P(V)*Z(X),Z(W)*Z(X),P(X),-P(W)*Z(X));if(q){var Q=[],I=[];for(a=0;v>a;a++)C=a+1,s=-Y+a*g,X=-Y+C*g,W=c*K,T=j+p*Z(s),M=j+p*Z(X),Q.push(Z(W)*T,P(s)*p,-P(W)*T,Z(W)*M,P(X)*p,-P(W)*M,Z(W)*j,0,-P(W)*j),I.push(.5+.5*Z(s),.5-.5*P(s),.5+.5*Z(X),.5-.5*P(X),.5,.5)}if(b){var o=[],u=[];for(a=0;v>a;a++)C=a+1,s=-Y+a*g,X=-Y+C*g,W=y*K,T=j+p*Z(s),M=j+p*Z(X),o.push(Z(W)*T,P(s)*p,-P(W)*T,Z(W)*j,0,-P(W)*j,Z(W)*M,P(X)*p,-P(W)*M),u.push(.5-.5*Z(s),.5-.5*P(s),.5,.5,.5-.5*Z(X),.5-.5*P(X))}var i={vs:U,uv:x,from_vs:Q,from_uv:I,to_vs:o,to_uv:u};return O&&(i.ns=L),i},dp=function(q,E){for(var h,f,o,G=.5,$=16,N=[],y=[],B=[],t=k/$,J=0;$>=J;J++)h=J*t,f=Z(h)*G,o=P(h)*G,N.push(f,-G,o,f,G,o),y.push(1-J/$,1,1-J/$,0);for(J=0;$>J;J++)B.push(2*J,2*J+1,2*J+3,2*J,2*J+3,2*J+2);if(E){var n=[],Q=[],T=[];for(n.push(0,-G,0),Q.push(.5,.5),J=0;$>=J;J++)h=J*t,f=Z(h),o=P(h),n.push(f*G,-G,-o*G),Q.push(.5+.5*f,.5+.5*o);for(J=0;$>J;J++)T.push(0,J+2,J+1)}if(q){var u=[],b=[],S=[];for(u.push(0,G,0),b.push(.5,.5),J=0;$>=J;J++)h=J*t,f=Z(h),o=P(h),u.push(f*G,G,-o*G),b.push(.5+.5*f,.5-.5*o);for(J=0;$>J;J++)S.push(0,J+1,J+2)}return{vs:N,uv:y,is:B,bottom_vs:n,bottom_uv:Q,bottom_is:T,top_vs:u,top_uv:b,top_is:S}},ce=function(I,U,s,u,p,T,J,h){I=I||12,U=U||0,s=s||I;for(var f,A,c,F,j,G,y,Y,d,R=.5,L=[],n=[],e=k/I,H=U;s>H;H++)f=H+1,A=H*e,c=f*e,F=Z(A)*R,j=P(A)*R,G=Z(c)*R,y=P(c)*R,L.push(F,-R,-j,G,-R,-y,F,R,-j,G,-R,-y,G,R,-y,F,R,-j),n.push(H/I,1,f/I,1,H/I,0,f/I,1,f/I,0,H/I,0);if(h){var N=[];for(H=0,d=L.length;d>H;H+=3)N.push(2*L[H],0,2*L[H+2])}if(J){var i=[],X=[];for(H=U;s>H;H++)A=e*H,c=e*(H+1),F=Z(A),j=P(A),G=Z(c),y=P(c),i.push(F*R,-R,-j*R,0,-R,0,G*R,-R,-y*R),X.push(.5+.5*F,.5+.5*j,.5,.5,.5+.5*G,.5+.5*y)}if(T){var D=[],l=[];for(H=U;s>H;H++)A=e*H,c=e*(H+1),F=Z(A),j=P(A),G=Z(c),y=P(c),D.push(F*R,R,-j*R,G*R,R,-y*R,0,R,0),l.push(.5+.5*F,.5-.5*j,.5+.5*G,.5-.5*y,.5,.5)}if(u){var q=[],O=[];A=e*U,F=Z(A)*R,j=P(A)*R,Y=U/I,q.push(0,R,0,0,-R,0,F,-R,-j,F,-R,-j,F,R,-j,0,R,0),O.push(0,0,0,1,Y,1,Y,1,Y,0,0,0)}if(p){var r=[],E=[];A=e*s,F=Z(A)*R,j=P(A)*R,Y=s/I,r.push(0,-R,0,0,R,0,F,R,-j,F,R,-j,F,-R,-j,0,-R,0),E.push(1,1,1,0,Y,0,Y,0,Y,1,1,1)}var W={vs:L,uv:n,bottom_vs:i,bottom_uv:X,top_vs:D,top_uv:l,from_vs:q,from_uv:O,to_vs:r,to_uv:E};return h&&(W.ns=N),W},ed=function(L,h,R,O,Y){h=h||18,R=R||0,O=O==G?k:O,Y=Y==G?.5:Y;for(var f,o,K,w,B,u,N=[0,.5,.75,.875,.9375],q=[],c=[],D=[],I=O/h,s=0;s<N.length;s++){var x=0===s%2?0:.5;for(f=0;h>=f;f++)o=(f+x)*I+R,K=1-N[s],q.push(Z(o)*Y*K,-Y+2*N[s]*Y,-P(o)*Y*K),c.push((f+x)/h,K)}for(s=0;s<N.length-1;s++){var l=s*(h+1),j=(s+1)*(h+1);for(f=0;h>f;f++)D.push(l+f,j+f+1,j+f,l+f,l+f+1,j+f+1)}for(u=q.length/3-(h+1),f=0;h>f;f++)q.push(0,Y,0),c.push((f+.5)/h,0);for(f=0;h>f;f++)D.push(u+f,u+f+1,u+(h+1)+f);if(L){var M=[],X=[],H=[];for(M.push(0,-Y,0),X.push(.5,.5),f=0;h>=f;f++)o=f*I+R,w=Z(o),B=P(o),M.push(w*Y,-Y,-B*Y),X.push(.5+.5*w,.5+.5*B);for(f=0;h>f;f++)H.push(0,f+2,f+1)}return{vs:q,uv:c,is:D,bottom_vs:M,bottom_uv:X,bottom_is:H}},hk=function(f,W,I,v,n,o,T,B){f=f||16,W=W||0,I=I||f,T=T||1;var X,K,d,R,p,a,J,i=.5,z=[],Q=[],t=k/f,D=W,x=1/T,K=new tb,d=new tb,y=new tb,j=new tb,w=new tb,c=new tb,A=new tb;for(B&&(X=[],p=new tb,a=new tb,J=new tb);I>D;D++){var M=D+1,Y=t*D,O=t*M;for(K.set(Z(Y)*i,-i,-P(Y)*i),d.set(Z(O)*i,-i,-P(O)*i),y.set(0,i,0),B&&(p.set(Z(Y),.5,-P(Y)).normalize(),a.set(Z(O),.5,-P(O)).normalize(),J.copy(p).add(a).normalize()),j.lerpVectors(y,K,x),w.lerpVectors(y,d,x),z.push(j.x,j.y,j.z,w.x,w.y,w.z,y.x,y.y,y.z),Q.push(D/f,x,M/f,x,(D+M)/2/f,0),B&&X.push(p.x,p.y,p.z,a.x,a.y,a.z,J.x,J.y,J.z),R=1;T>R;R++)j.lerpVectors(y,K,x*(R+1)),w.lerpVectors(y,d,x*(R+1)),c.lerpVectors(y,K,x*R),A.lerpVectors(y,d,x*R),z.push(j.x,j.y,j.z,w.x,w.y,w.z,c.x,c.y,c.z,c.x,c.y,c.z,w.x,w.y,w.z,A.x,A.y,A.z),Q.push(D/f,x*(R+1),M/f,x*(R+1),D/f,x*R,D/f,x*R,M/f,x*(R+1),M/f,x*R),B&&X.push(p.x,p.y,p.z,a.x,a.y,a.z,p.x,p.y,p.z,p.x,p.y,p.z,a.x,a.y,a.z,a.x,a.y,a.z)}if(o){var q=[],g=[];for(D=W;I>D;D++){Y=t*D,O=t*(D+1);var E=Z(Y),C=P(Y),S=Z(O),$=P(O);q.push(E*i,-i,-C*i,0,-i,0,S*i,-i,-$*i),g.push(.5+.5*E,.5+.5*C,.5,.5,.5+.5*S,.5+.5*$)}}if(v){var l=[],m=[];Y=t*W,l.push(0,i,0,0,-i,0,Z(Y)*i,-i,-P(Y)*i),m.push(0,0,0,1,W/f,1)}if(n){var V=[],u=[];Y=t*I,V.push(0,-i,0,0,i,0,Z(Y)*i,-i,-P(Y)*i),u.push(1,1,1,0,I/f,1)}var e={vs:z,uv:Q,bottom_vs:q,bottom_uv:g,from_vs:l,from_uv:m,to_vs:V,to_uv:u};return B&&(e.ns=X),e},uo=function(a,x,d,R,e,Z,r,j){for(var n=[],I=0;I<a.length-1;I+=2)n.push({x:a[I],y:a[I+1]});return tr(n,x,d,R,e,Z,r,j,!1)},Ve={roundRect:function(T,j){return uo([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],T,j,3)},star:function(j,l){return uo([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],j,l)},rect:function(q,O){return uo([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],q,O)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Q,Z){return uo([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Q,Z)},rightTriangle:function(w,u){return uo([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],w,u)},parallelogram:function(L,d){return uo([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],L,d)},trapezoid:function(_,V){return uo([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],_,V)}},Td={sphere:1,cylinder:1,cone:1,torus:1},gd={torus:1,sphere:1,cone:1},hh=Jg(gl(Ve),{cylinder:1}),jg=Jg(gl(Ve),{cylinder:1,cone:1}),$g=function(f,M,$){var H,u=$b(f.anchor3d,$,M),a=$b(f.mat,$,M),R=$b(f.s3,$,M),P=$b(f.t3,$,M),D=$b(f.r3,$,M),C=R||D||P||a;if(u||C){H=Qc(M._6O);var T=C?Op(a,R,D,$b(f.rotationMode,$,M),P):Mj();u&&pe(T,[.5-u[0],.5-u[1],.5-u[2]]),es(M,T)}return H},io=function(U,z,X,l,D,v,E){if(bf(X))X.forEach(function(I){io(U,z,I,l,D,v,E)});else if(on(X))io(U,z,ff(l,X),l,D,v,E);else if(vc(X))if(X.shape3d){var e=$g(X,U,z);io(U,z,X.shape3d,l,D,v,X),e&&gf(U,e)}else xc(U,z,X,l.s,D,v,E)},xc=function(i,U,v,b,T,V,z){if(z=z||_d,!V||V(b("shape3d.transparent",v.transparent,z.transparent))){var I=$g(v,i,U);if(Vg(v)){var Z=i.getData3dUI(U);Z.dispatchBoundingBoxChanged()}var a=i._26I,h=i._prg,K=i._buffer,N=b("shape3d.color",v.color,z.color);T||(T=b("shape3d.blend",v.blend,z.blend));var s,Q=v.opacity==G?z.opacity:v.opacity,d=b("shape3d.opacity");s=d!=G&&Q!=G?Q*d:Q!=G?Q:d,ld(a,h,T,b("shape3d.light",v.light,z.light),s,b("shape3d.reverse.flip",v.reverseFlip,z.reverseFlip),b("shape3d.reverse.color",v.reverseColor,z.reverseColor),b("shape3d.reverse.cull",v.reverseCull,z.reverseCull));var M=b("polygonOffset",v.polygonOffset,z.polygonOffset);v.vs&&b(We,v.visible,z.visible)&&Hd(a,h,K,N,i.getTexture(b("shape3d.image",v.image,z.image),U),b("shape3d.discard.selectable",v.discardSelectable,z.discardSelectable),v.vs,v.uv,v.ns,v.is,b("shape3d.uv.offset",v.uvOffset,z.uvOffset),b("shape3d.uv.scale",v.uvScale,z.uvScale),b("shape3d.uv.rotation",v.uvRotation,z.uvRotation),M),v.top_vs&&b(ah,v.topVisible,z.topVisible)&&Hd(a,h,K,b("shape3d.top.color",v.topColor,z.topColor)||N,i.getTexture(b("shape3d.top.image",v.topImage,z.topImage),U,"top"),b("shape3d.top.discard.selectable",v.topDiscardSelectable,z.topDiscardSelectable),v.top_vs,v.top_uv,v.top_ns,v.top_is,b("shape3d.top.uv.offset",v.topUvOffset,z.topUvOffset),b("shape3d.top.uv.scale",v.topUvScale,z.topUvScale),b("shape3d.top.uv.rotation",v.topUvRotation,z.topUvRotation),M),v.bottom_vs&&b(tl,v.bottomVisible,z.bottomVisible)&&Hd(a,h,K,b("shape3d.bottom.color",v.bottomColor,z.bottomColor)||N,i.getTexture(b("shape3d.bottom.image",v.bottomImage,z.bottomImage),U,"bottom"),b("shape3d.bottom.discard.selectable",v.bottomDiscardSelectable,z.bottomDiscardSelectable),v.bottom_vs,v.bottom_uv,v.bottom_ns,v.bottom_is,b("shape3d.bottom.uv.offset",v.bottomUvOffset,z.bottomUvOffset),b("shape3d.bottom.uv.scale",v.bottomUvScale,z.bottomUvScale),b("shape3d.bottom.uv.rotation",v.bottomUvRotation,z.bottomUvRotation),M),v.from_vs&&b(Ff,v.fromVisible,z.fromVisible)&&Hd(a,h,K,b("shape3d.from.color",v.fromColor,z.fromColor)||N,i.getTexture(b("shape3d.from.image",v.fromImage,z.fromImage),U,"from"),b("shape3d.from.discard.selectable",v.fromDiscardSelectable,z.fromDiscardSelectable),v.from_vs,v.from_uv,v.from_ns,v.from_is,b("shape3d.from.uv.offset",v.fromUvOffset,z.fromUvOffset),b("shape3d.from.uv.scale",v.fromUvScale,z.fromUvScale),b("shape3d.from.uv.rotation",v.fromUvRotation,z.fromUvRotation),M),v.to_vs&&b(as,v.toVisible,z.toVisible)&&Hd(a,h,K,b("shape3d.to.color",v.toColor,z.toColor)||N,i.getTexture(b("shape3d.to.image",v.toImage,z.toImage),U,"to"),b("shape3d.to.discard.selectable",v.toDiscardSelectable,z.toDiscardSelectable),v.to_vs,v.to_uv,v.to_ns,v.to_is,b("shape3d.to.uv.offset",v.toUvOffset,z.toUvOffset),b("shape3d.to.uv.scale",v.toUvScale,z.toUvScale),b("shape3d.to.uv.rotation",v.toUvRotation,z.toUvRotation),M),tm(a,h),I&&gf(i,I)}},Hd=function(i,J,w,r,x,f,N,d,g,o,C,p,A,M){if(N){M&&th(i,M);var _=Gh.for(i),P=_.directUniforms(),R=_.directAttribs();P.uDiffuse=r||e["color.empty"],d?Kn(i,J,x,f,w.uv,d,C,p,A):Kn(i),R.aPosition=im(i,w.vs,N,G),R.aNormal=im(i,w.ns,g,G),o?(pf(i,w.is,o),ek(i,0,o.length,null,o instanceof Uint32Array?i.UNSIGNED_INT:null)):co(i,0,N.length/3),d?qq(i,J,x):qq(i),M&&$o(i)}},ff=function(V,z){var Z=V.s;if(z||(z=Z(ig)),!z)return G;var X=Cr(z);if(X)return X;if("text"===z){var J={amount:Z("shape3d.text.amount"),size:Z("shape3d.text.size"),font:Z("shape3d.text.font"),style:Z("shape3d.text.style"),weight:Z("shape3d.text.weight"),fill:Z("shape3d.text.fill"),curveSegments:Z("shape3d.text.curveSegments"),spacing:Z("shape3d.text.spacing")},E=V.gv.getShape3dText(V.data),H=E;for(var R in J)H+="_"+(J[R]===D?"U":J[R]);return V._cachedTextKey===H?V._cachedTextGeometry:(V._cachedTextKey=H,V._cachedTextGeometry=m.createTextGeometry(E,J))}var R=z;if(Td[z]){var w=Z("shape3d.side"),j=Z("shape3d.side.from"),F=Z("shape3d.side.to"),C=Z(Ff),W=Z(as);3>w?(w=0,j=0,F=0,C=!1,W=!1):((j==G||0>j)&&(j=0),(F==G||F>w)&&(F=w),0===j&&F===w&&(C=!1,W=!1));var b=Z("shape3d.smooth");R+="-"+w+"-"+j+"-"+F+"-"+C+"-"+W+(b?1:0)}if(hh[z]){var O=Z(ah);R+="-"+O}if(jg[z]){var P=Z(tl);R+="-"+P}if("torus"===z){var L=Z("shape3d.torus.radius");0>L?L=0:L>.25&&(L=.25),R+="-"+L}if(gd[z]){var A=Z(Po);R+="-"+A}return X=Fg[R],X||("box"===z?X=m.createBoxModel():Ve[z]?X=Ve[z](O,P):"sphere"===z?X=m.createSphereModel(w,j,F,C,W,A,b):z===Jq?X=m.createCylinderModel(w,j,F,C,W,O,P,b):"cone"===z?X=m.createConeModel(w,j,F,C,W,P,A,b):"torus"===z&&(X=m.createTorusModel(w,j,F,C,W,L,A,b)),Fg[R]=X),X},Vg=function(){var e=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],H=["is","top_is","bottom_is","from_is","to_is"];return R=Ed(ob.substr(ob.indexOf("^#")+2)),sk(m[ei(Pn+e[15]+"n"+e[16])]())&&Rq()?function(u){return u&&!u._complete_?(u._complete_=!0,u.vs&&Dk(u.ns)&&(u.ns=Gb(u.vs,u.is),u.boundingBox=D),u.top_vs&&Dk(u.top_ns)&&(u.top_ns=Gb(u.top_vs,u.top_is),u.top_boundingBox=D),u.bottom_vs&&Dk(u.bottom_ns)&&(u.bottom_ns=Gb(u.bottom_vs,u.bottom_is),u.bottom_boundingBox=D),u.from_vs&&Dk(u.from_ns)&&(u.from_ns=Gb(u.from_vs,u.from_is),u.from_boundingBox=D),u.to_vs&&Dk(u.to_ns)&&(u.to_ns=Gb(u.to_vs,u.to_is),u.to_boundingBox=D),e.forEach(function(f){var m=u[f];bf(m)&&(u[f]=new Hg(m))}),H.forEach(function(w){var R=u[w];bf(R)&&(u[w]=new oh(R))}),!0):!1}:void 0}(),_n=function(E,Y){var V=E[Y];bf(V)&&(E[Y]=new Hg(V))};Jg(Qn,{_25Q:function(s){s._16O=function(n,F,E,r,s,v,h,U,H){var o=this.info;if(o){var e,A,c,y,X,w,N=Mj();if(Fo[F]?(e=o.p3,A=o.c1,c=o.c2):Nc[F]?(A=o.s1||o.c1,c=o.s2||o.c2):(A=o.t1||o.c1,c=o.t2||o.c2),e)w=js(F,kc,E,r,U,H);else{var u=mm(c,A),K=qj(A,c);y=[0,-pd(u[2],u[0]),C(u[1]/K)],X="zyx",e=[(A[0]+c[0])/2,(A[1]+c[1])/2,(A[2]+c[2])/2],w=js(F,[K,0,0],E,r,U,H)}return ad(N,w,e,r,s,v,h,n,y,X)}return de},s._80o=function(N,U,a){var Y=this,G=Y.shapeModel;if(G){var e=Y.gv;es(e),io(e,Y.data,G,Y,Y.getBodyColor(),a)}},s.createLineModel=function(n,o,y,t,r){var b=this,g=b.s,Q=Rd(n,o,g(Po)),j=g(t+".color");if(j){for(var B=[],k=0;k<Q.length;k++){var K=Q[k],q=K.length;if(q>1){var l=K[0];B.push(l.x,l.y,l.z);for(var J=1;q-1>J;J++)l=K[J],B.push(l.x,l.y,l.z),B.push(l.x,l.y,l.z);l=K[q-1],B.push(l.x,l.y,l.z)}}var X,z,h,s=g(r),W=0;s&&(z=g(r+".color"),X=g(r+".pattern"),W=g(r+".offset"),h=j),Tb(b.gv,b.data,B,z||j,h?G:g(t+".gradient.color"),y,X||g(t+".pattern"),W,h)}return Q},s.createTubeModel=function(Z,k,H,O){for(var $=this,x=$.s,m=x("shape3d.side")||om,b=x("shape3d.start.angle"),U=x("shape3d.sweep.angle"),r=x(ah)?x("shape3d.top.cap"):G,y=x(tl)?x("shape3d.bottom.cap"):G,Y="flat"===r,z="flat"===y,v=Y&&(O?O.uv:x("shape3d.top.image")),X=z&&(O?O.uv:x("shape3d.bottom.image")),f=O?O.uv:x("shape3d.image"),l=x("shape3d.smooth"),Q={vs:[],uv:f?[]:G,ns:l?[]:G,top_vs:Y?[]:G,top_uv:v?[]:G,bottom_vs:z?[]:G,bottom_uv:X?[]:G},D=Rd(Z,k,x(Po),H),n=0,t=D.length;t>n;n++)_g(Q,D[n],x(Eq),H,m,b,U,r,y);return O?$d($.gv,$.data,Q,$,$.getBodyColor(),$.mat?[$.mat]:[],O):$.shapeModel=Q,$.lineShapeModel=Q,D},s.getCache=function(){var i=this.info;if(i){var L=i.list;if(L){var v=i.cache;return v||(v=i.cache=Ud(L)),v}}return G}}});var gb=function(V,_){for(var M,B=0,E=V.length,n=0,J=E-1;J>=n;)if(B=i(n+(J-n)/2),M=V[B].length-_,0>M)n=B+1;else{if(!(M>0)){J=B;break}J=B-1}B=J;var I=V[B],c=I.point;return B===E-1||I.length===_||(c=(new se).subVectors(V[B+1].point,c).normalize().multiplyScalar(_-I.length).add(c)),{point:c,tangent:I.tangent}},Ud=function(C){for(var g,L,e=[],K=0,T=0;T<C.length;T++){for(var s=C[T],A=0;A<s.length;A++){g=s[A],L&&(K+=L.distanceTo(g));var G=new se,Q=s[A+1];Q?G.subVectors(Q,g):L?G.subVectors(g,L):G.x=1,G.normalize(),e.push({point:g,length:K,tangent:G}),L=g}L=null}return e},Rd=function(I,q,k,v){k=k||jc;for(var L=[],E=0,O=I.size();O>E;E++){var Y=I.get(E);L.push(new se(Y.x,Y.e||0,Y.y))}q&&(Kc(q)&&(q=q._as),q.length||(q=null));for(var X,B,R,Z,J,H=[],e=[],g=0,M=0,n=q?q.length:O;n>M;M++){if(J=q?q[M]:0===M?1:2,1===J)H.push(R=[]),R.push(L[g++]);else if(2===J||5===J)if(Z=2===J?L[g++]:R[0],v){var y=q?q[M+1]:n>M+1?2:G;if(2===y||5===y){var r=R[R.length-1],V=2===y?L[g]:R[0],A=(new se).subVectors(r,Z),C=(new se).subVectors(V,Z),K=A.length(),$=C.length();if(K&&$)if(v>K/2&&v>$/2)R.push(Z);else for(A.multiplyScalar(S(v,K/2)/K).add(Z),C.multiplyScalar(S(v,$/2)/$).add(Z),X=new Ol(A,Z,C).getPoints(k),B=0;k>=B;B++)R.push(X[B])}else R.push(Z)}else R.push(Z);else if(3===J)for(X=new Ol(R[R.length-1],L[g++],L[g++]).getPoints(k),B=1;k>=B;B++)R.push(X[B]);else if(4===J)for(X=new Oj(R[R.length-1],L[g++],L[g++],L[g++]).getPoints(k),B=1;k>=B;B++)R.push(X[B]);e.push(H.length,R.length)}return H.indexMark=e,H},nn=function(t){for(var y,S,B=new se,C=[],V=[],e=[],N=0,w=t.length;w>N;N++)y=t[N],S=t[N+1],S?B.subVectors(S,y):B.subVectors(y,t[N-1]),C.push(B.normalize().clone());var J,A=new se,D=new se,p=new ds,r=1e-4,n=C[0],G=V[0]=new se,E=e[0]=new se;for(Math.abs(Math.abs(n.y)-1)<r?A.set(1,0,0):A.set(0,1,0),D.crossVectors(n,A).normalize(),G.crossVectors(n,D),E.crossVectors(n,G),N=1;w>N;N++)V[N]=V[N-1].clone(),e[N]=e[N-1].clone(),D.crossVectors(C[N-1],C[N]),D.length()>r&&(D.normalize(),J=M(Ki(C[N-1].dot(C[N]),-1,1)),V[N].applyMatrix4(p.makeRotationAxis(D,J))),e[N].crossVectors(C[N],V[N]);return{B:e,T:C,N:V}},_g=function(){var B=function(p){for(var r=1;r<arguments.length;r++){var h=arguments[r];p.push(h.x,h.y,h.z)}},W=function(q){for(var m=1;m<arguments.length;m++){var C=arguments[m].uv;q.push(C[0],C[1])}},a=function(M){for(var s=1;s<arguments.length;s++){var q=arguments[s].ns;M.push(q[0],q[1],q[2])}},V=function(R,n,r,E,d){var M=-E*Z(d),F=E*P(d);return new se(R.x+M*r.x+F*n.x,R.y+M*r.y+F*n.y,R.z+M*r.z+F*n.z)},X=function(s,H,A,L,b,a,o,w,T){o=o||k;for(var l,g=[],v=o/b,l=T?new tb:G,t=0;b>=t;t++){var j=V(s,H,A,L,t*v+a);g.push(j),w!=G&&(j.uv=[w,1-t/b]),T&&(j.ns=l.subVectors(j,s).normalize().toArray())}return g},d=function(y,C,q,z,O,n,p,e,N){N=N||k;var D=C?y.top_vs:y.bottom_vs;if(D)for(var o=C?y.top_uv:y.bottom_uv,w=N/p,W=0;p>W;W++){var T,L;C?(T=W*w+e,L=(W+1)*w+e):(L=W*w+e,T=(W+1)*w+e),B(D,V(q,z,O,n,T),V(q,z,O,n,L),q),o&&o.push(.5-.5*Z(T),.5-.5*P(T),.5-.5*Z(L),.5-.5*P(L),.5,.5)}};return function(t,q,k,m,h,g,f,n,Z){var Y=q.length;if(Y>1){var v,z,C,p,c,l,N,T=nn(q),$=T.T,u=T.N,P=T.B;"flat"===n&&d(t,!0,q[0],P[0],u[0],m,h,g,f),"flat"===Z&&d(t,!1,q[Y-1],P[Y-1],u[Y-1],m,h,g,f);var R,y,r=[],K=U(h/2),I="round"===n,A="round"===Z,x=q[0],Q=$[0],H=P[0],w=u[0],S=q[Y-1],J=$[Y-1],s=P[Y-1],o=u[Y-1];if(I){for(C=1;K>=C;C++)u.splice(0,0,w),P.splice(0,0,H),$.splice(0,0,Q),y=-C/K*m,q.splice(0,0,Q.clone().multiplyScalar(y).add(x)),r[K-C]=j(m*m-y*y);Y+=K}if(A){for(C=1;K>=C;C++)u.push(o),P.push(s),$.push(J),y=C/K*m,q.push(J.clone().multiplyScalar(y).add(S)),r[q.length-1]=j(m*m-y*y);Y+=K}if(t.uv){var i=0,M=0,V=[];for(k&&(i=k),c=q[0],V[0]=0,C=1;Y>C;C++)p=q[C],V[C]=c.distanceTo(p),c=p,k||(i+=V[C]);for(R=[],C=0;Y>C;C++)M+=V[C],R[C]=i?M/i:0}var L=t.ns?!0:!1;for(C=0;Y>C;C++){if(p=q[C],l=P[C],N=u[C],v=X(p,l,N,r[C]===D?m:r[C],h,g,f,R?R[C]:G,L),z)for(var F=0;h>F;F++){var E=z[F],e=z[F+1]||z[0],O=v[F],b=v[F+1]||v[0];B(t.vs,e,E,O,O,b,e),t.uv&&W(t.uv,e,E,O,O,b,e),L&&a(t.ns,e,E,O,O,b,e)}z=v}}}}();Jg(m,{getLineLength:function(d){return d[d.length-1].length},getLineOffset:function(k,Y){return gb(k,Y)},getLineCacheInfo:function(z,C,L,p){return Ud(Rd(z,C,L,p))}});var Mr=q.graph3d.RenderLite={},Qp=new Array(0),Aj=Mr.Buffer=function(q,G,_,$){this.gl=q,this.buffer=q.createBuffer(),this.type=G||q.ARRAY_BUFFER,this.drawType=$||q.STATIC_DRAW,this.data=Qp,_&&this.upload(_)};Aj.prototype.upload=function(r,$,I){I||this.bind();var a=this.gl;r=r||this.data,$=$||0,this.data.byteLength>=r.byteLength?a.bufferSubData(this.type,$,r):a.bufferData(this.type,r,this.drawType),this.data=r},Aj.prototype.bind=function(){var u=this.gl;u.bindBuffer(this.type,this.buffer)},Aj.createVertexBuffer=function(S,k,i){return new Aj(S,S.ARRAY_BUFFER,k,i)},Aj.createIndexBuffer=function(m,p,B){return new Aj(m,m.ELEMENT_ARRAY_BUFFER,p,B)},Aj.create=function(V,B,b,s){return new Aj(V,B,s)},Aj.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var vo=Mr.Shader=function($,X,b){this.gl=$,this.program=Lf($,X,b),this.attributes=Ef($,this.program);var g=fd($,this.program);this.uniforms=tj($,g)};vo.prototype.bind=function(){this.gl.useProgram(this.program)},vo.prototype.destroy=function(){this.gl};var Lf=function(n,l,R){var o=sp(n,n.VERTEX_SHADER,l),i=sp(n,n.FRAGMENT_SHADER,R),O=n.createProgram();return n.attachShader(O,o),n.attachShader(O,i),n.linkProgram(O),n.getProgramParameter(O,n.LINK_STATUS)||(oo("LINK","LITE",n.getProgramParameter(O,n.VALIDATE_STATUS),n.getError(),n.getProgramInfoLog(O)),n.deleteProgram(O),O=null),n.deleteShader(o),n.deleteShader(i),O},sp=function(I,K,j){var n=I.createShader(K);return I.shaderSource(n,j),I.compileShader(n),I.getShaderParameter(n,I.COMPILE_STATUS)?n:(oo("COMPILE","LITE",K,I.getError(),I.getShaderInfoLog(n)),null)},fd=function(P,V){for(var X={},h=P.getProgramParameter(V,P.ACTIVE_UNIFORMS),T=0;h>T;T++){var l=P.getActiveUniform(V,T),F=l.name.replace(/\[.*?\]/,""),t=Xb(P,l.type);X[F]={type:t,size:l.size,location:P.getUniformLocation(V,F),value:_h(t,l.size)}}return X},Ef=function(y,L){for(var P={},d=y.getProgramParameter(L,y.ACTIVE_ATTRIBUTES),V=0;d>V;V++){var s=y.getActiveAttrib(L,V),n=Xb(y,s.type);P[s.name]={type:n,size:Wp(n),gl:y,location:y.getAttribLocation(L,s.name),pointer:Ue}
}return P},Ue=function(r,U,n,V,d){var W=this.gl;W.enableVertexAttribArray(this.location),r instanceof Mr.Buffer||(r=Mr.Buffer.createVertexBuffer(W,r)),W.bindBuffer(r.type,r.buffer),W.vertexAttribPointer(this.location,this.size,U||W.FLOAT,n||!1,V||0,d||0)},Wp=function(q){return _e[q]},_e={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Xb=function(A,T){if(!wq){var o=t.keys(ep);wq={};for(var u=0;u<o.length;++u){var c=o[u];wq[A[c]]=ep[c]}}return wq[T]},wq=null,ep={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},_h=function(f,Q){switch(f){case"float":return 0;case"vec2":return new Float32Array(2*Q);case"vec3":return new Float32Array(3*Q);case"vec4":return new Float32Array(4*Q);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*Q);case"ivec3":return new Int32Array(3*Q);case"ivec4":return new Int32Array(4*Q);case"bool":return!1;case"bvec2":return Xm(2*Q);case"bvec3":return Xm(3*Q);case"bvec4":return Xm(4*Q);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Xm=function(H){for(var N=new Array(H),W=0;W<N.length;W++)N[W]=!1;return N},tj=function(S,T){var E={data:{}};E.gl=S;for(var p=t.keys(T),v=0;v<p.length;v++){var X=p[v],g=X.split("."),x=g[g.length-1],r=wp(g,E),$=T[X];r.data[x]=$,r.gl=S,t.defineProperty(r,x,{get:le(x),set:xq(x,$)})}return E},le=function(A){var H=Hn.replace("%%",A);return new Function(H)},xq=function(d,i){var a,r=Th.replace(/%%/g,d);return a=1===i.size?Ap[i.type]:Qf[i.type],a&&(r+="\nthis.gl."+a+";"),new Function("value",r)},wp=function(d,K){for(var C=K,A=0;A<d.length-1;A++){var R=C[d[A]]||{data:{}};C[d[A]]=R,C=R}return C},Hn=["return this.data.%%.value;"].join("\n"),Th=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Ap={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Qf={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},kf=function(J){function Z(t){if("string"!=typeof t)return 0|t;switch(t){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var Q=this;Q.enable=!1;var H,A,i=m.graph3dViewShadowType,f=m.graph3dViewShadowIntensity,T=m.graph3dViewShadowBias,M=m.graph3dViewShadowQuality,E=m.graph3dViewShadowRadius,s=m.graph3dViewShadowDegreeX,k=m.graph3dViewShadowDegreeZ,z=1,g=Z(M),w=!1,h=new q.Math.Matrix4,R=new q.Math.Matrix4,u=Q.pvMatrix=new q.Math.Matrix4;Q.render=function(){if(!J._picking&&Q.enable){var x=J.getGL();if(x){w&&Q.setupShadowCamera(),J._glCapabilities&&(g=Math.min(g,J._glCapabilities.maxTextureSize)),Q.map?H.setSize(g,g):H=Q.map=new gi(J,J.getGL(),0,0,{samples:1,minFilter:aq.NEAREST,magFilter:aq.NEAREST,width:g,height:g}),x._shadowShader||(x._shadowShader=new Mr.Shader(x,kf.shaderSrc.vs,kf.shaderSrc.fs));var a=J._frameState,S=a.renderState.glState;S.blend.enabled=!1,S.depth.enabled=!0,S.depth.mask=!0;var Z=S.color.clear.slice(0);lj(x,[1,1,1,1]),a.renderState.useProgram(x._shadowShader.program),n(),lj(x,Z)}}},Q.getShadow=function(){var q={degreeX:s,degreeZ:k,intensity:f,quality:M,type:i,radius:E,bias:T};return 1!==z&&(q.boundExtend=z),q},Q.setShadow=function(H,l){H=!!H;var Y=Q.enable!==H;Q.enable=H,"object"==typeof l&&(l.intensity!==D&&(f=l.intensity),l.bias!==D&&(T=l.bias),l.radius!==D&&(E=l.radius),l.degreeX!==D&&(s=l.degreeX),l.degreeZ!==D&&(k=l.degreeZ),l.quality!==D&&(M=l.quality),l.type!==D&&i!==l.type&&(i=l.type,Y=!0),g=Z(M),l.boundExtend!==D&&(z=l.boundExtend)),H&&Q.setupShadowCamera(),Y&&rk(J),J.iv()},Q.refresh=function(){this.enable&&(this.setupShadowCamera(),J.iv())},Q.tryUpdateBounding=function(z){var T=this.boundingSphere;if(T){var _=(new ds).fromArray(Yb(z,J.getMat(z))),S=z.getAnchor3d(),C=new tb;T.containsPoint(C.set(0-S.x,0-S.y,0-S.z).applyMatrix4(_))&&T.containsPoint(C.set(0-S.x,0-S.y,1-S.z).applyMatrix4(_))&&T.containsPoint(C.set(0-S.x,1-S.y,0-S.z).applyMatrix4(_))&&T.containsPoint(C.set(0-S.x,1-S.y,1-S.z).applyMatrix4(_))&&T.containsPoint(C.set(1-S.x,0-S.y,0-S.z).applyMatrix4(_))&&T.containsPoint(C.set(1-S.x,0-S.y,1-S.z).applyMatrix4(_))&&T.containsPoint(C.set(1-S.x,1-S.y,0-S.z).applyMatrix4(_))&&T.containsPoint(C.set(1-S.x,1-S.y,1-S.z).applyMatrix4(_))||Q.setupShadowCamera()}},Q.createShadow=function(W){W||(W=J._frameState.renderState.directUniforms()),W.shadowMatrix=u.toArray(),W.shadowMap=H.texture,W.shadowSize=[H.width,H.height],W.shadowIntensity=f,W.shadowBias=T,W.shadowRadius=E},Q.genShaderDefine=function(){var H="#define USE_SHADOWMAP\n";return"hard"===i?H+="#define SHADOWMAP_TYPE_PCF\n":"soft"===i&&(H+=J.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),H};var N;Q.setupShadowCamera=function(){A||(A=Q.boundingSphere=new q.Math.Sphere),w=!1;var C,d,g=J.getBoundingBox(J.dm().toDatas(function($){return $.s("shadow.cast")&&J.isVisible($)}));g?(C=new tb(g.min),d=new tb(g.max)):(C=new tb(-256,-256,-256),d=new tb(256,256,256),w=!0),A.set(C.clone().add(d).multiplyScalar(.5),.5*C.distanceTo(d)*z);var M,W=A.radius,v=J.getBoundingBox(J.dm().toDatas(function(l){return(l.s("shadow.cast")||l.s("shadow.receive"))&&J.isVisible(l)}));if(v){C.copy(v.min),d.copy(v.max);var R=.5*C.distanceTo(d);M=R+Math.min(R,W+A.center.distanceTo(C.add(d).multiplyScalar(.5)))}else M=2*W;N=db(Mj(),-W,W,-W,W,M/1e3,M),u.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),u.multiply(h.fromArray(N));var j=Math.tan(-s*Math.PI/180),l=Math.tan(-k*Math.PI/180),e=W/Math.sqrt(j*j+l*l+1),U=new tb(e*j,e,e*l);h.lookAt(U,new tb(0,0,0),new tb(0,1,0)).setPosition(U.add(A.center)),h.getInverse(h),u.multiply(h)};var n=function(){var e=J.getGL(),B=g,$=g;H.setSize(e,B,$),H.bind(e),e.clear(aq.COLOR_BUFFER_BIT|aq.DEPTH_BUFFER_BIT);var r=J._frameState,W=r.renderState,q=W.directUniforms(),l=W.directAttribs(),K=W.directState();q.projectionMatrix=N;var u=J._viewport;J.setViewport(e,0,0,B,$);var f,x,X,U;for(f=0,x=tp.length;x>f;f++)if(X=tp[f],!uj[X].ignore&&(U=J._40Q.get(X))){var _=U.batchIndexMap;Q.renderItems(e,q,l,K,U.opaque,_),Q.renderItems(e,q,l,K,U.transparent,_),Q.renderBatch(e,q,l,K,U.batchModelMap,_)}H.unbind(e),J.setViewport(e,u[0],u[1],u[2],u[3])};Q._renderDirect=function(H,z,Q,E){Q&&Q.length&&(z.position=im(H,J._buffer.vs,Q,G),E?(pf(H,J._buffer.is,E),ek(H,0,E.length,null,E instanceof Uint32Array?H.UNSIGNED_INT:null)):co(H,0,Q.length/3))},Q.renderShapeModel=function(O,u,a,z){var T,i,w;if(bf(a))for(i=0,w=a.length;w>i;i++)T=a[i],T&&Q.renderShapeModel(O,u,T,z);else on(a)?Q.renderShapeModel(O,u,ff(z,a),z):vc(a)&&(a.shape3d?Q.renderShapeModel(O,u,a.shape3d,z):Q.renderShapeModelImpl(O,u,a))},Q.renderShapeModelImpl=function(P,B,y){Vg(y),Q._renderDirect(P,B,y.vs,y.is),Q._renderDirect(P,B,y.top_vs,y.top_is),Q._renderDirect(P,B,y.bottom_vs,y.bottom_is),Q._renderDirect(P,B,y.from_vs,y.from_is),Q._renderDirect(P,B,y.to_vs,y.to_is)},Q.renderBatch=function(S,E,Z,v,A){if(!_k(A)&&!J.drawFilter){E.modelViewMatrix=R.identity().premultiply(h).toArray();var t,w,b;for(t in A)b=J.getBatchInfo(t)||_d,b.visible!==!1&&b.shadowCast!==!1&&(w=A[t],w.invalidate&&Wj(w),Q._renderDirect(S,Z,w.vs32,w.is))}},Q.renderItems=function(g,t,k,H,$,c){var y,Z,S,m,V,e=$.length;for(y=0;e>y;y++)if(Z=$[y],m=Z.ui,S=Z.data,!(Dh(S)||!S.s("shadow.cast")||S instanceof gs)&&J.isVisible(S)&&!c[S._id]){var r=m.s("3d.clip.direction");if(r){var P=m.s("3d.clip.percentage");if(0===P)continue;var F=m._formatClipUniforms(r,P,S);t.uClipPercent=F[1],t.uClipDirection=F[0]}else t.uClipDirection=0;V=m.shapeModel||ff(m),V||(V=S instanceof q.Node&&!(S instanceof q.Shape)?{vs:ze,is:Kj}:[m.left,m.front,m.right,m.back,m.top,m.bottom]),t.modelViewMatrix=(m.mat?R.fromArray(m.mat):R.identity()).premultiply(h).toArray(),H.cullFace.enabled=!!S.s("shape3d.reverse.cull"),Q.renderShapeModel(g,k,V,m)}}};kf.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},kf.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var lg=function(O){this.gv=O,this.onMouseOver=this.onMouseOver.bind(this),this.mode=lg.Mode.Style,this.type=e["highlight.type"],this.color=e["highlight.color"],this.width=e["highlight.width"],this.glow=e["highlight.glow"],this.strength=e["highlight.strength"]};lg.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Qn.ms_highlight=function(D){D.setHighlightMode=function(v){var u;u="selection"===v||"selected"===v?lg.Mode.Selection:"mouseover"===v||"hover"===v?lg.Mode.MouseOver:"style"===v?lg.Mode.Style:lg.Mode.Disable;var H=this.getHighlightMode();this._highlightHelper.mode=u,this.firePropertyChange("highlightMode",H,v)},D.getHighlightMode=function(){var r=this._highlightHelper.mode;return r===lg.Mode.Selection?"selected":r===lg.Mode.MouseOver?"hover":r===lg.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(u){var V=u.replace(/(^|\.)[a-z]/g,function(m){return m[m.length-1].toUpperCase()});D["getHighlight"+V]=function(){return this._highlightHelper[u]},D["setHighlight"+V]=function(I){var C=this._highlightHelper,o=C[u];I!==o&&(C[u]=I,this.firePropertyChange("highlight"+V,o,I))}})},mj(lg,t,{onMouseOver:function(l){m.preventDefault(l);var v=this.gv.getDataAt(l);v!==this.mouseOverData&&(this.mouseOverData=v,this.gv.iv())},setFetchTargetFunc:function(c){this.fetchTargetFunc=c},_42:function(u,W){var H,c,D=this,g=D._mode,h=D.gv;if(!u._renderInfo.reflectDepth&&g!==lg.Mode.Disable){if(g===lg.Mode.Selection?H=h.sm().getSelection().toArray(function(n){return n.s("highlight.visible")}):g===lg.Mode.MouseOver&&D.mouseOverData&&D.mouseOverData.s("highlight.visible")&&(H=[D.mouseOverData]),D.fetchTargetFunc&&(H=D.fetchTargetFunc(H)),g===lg.Mode.Style)H=H||[],c=function(p){if(H.indexOf(p)>=0)return!1;var w=h.getDataHighlightMode(p);return w===!1?!0:w===!0?!1:"selected"===w?h.isSelected(p)?!1:!0:"hover"===w?p===D.mouseOverData?!1:!0:!0};else{if(!H||!H.length)return;c=function(F){return H.indexOf(F)<0?!0:void 0}}var p=h.isVRPresenting(),m=h.getWidth();if(p){var G=h.getWidth;m/=2,h.getWidth=function(){return m};var r=h.getViewport()}var f,N=h.getDevicePixelRatio(),s=Math.floor(m*N),T=Math.floor(h.getHeight()*N);(f=D._renderTarget)?f.setSize(u,s,T):D._renderTarget=f=new Dl.RenderTarget(h,u,s,T);var Y="soft"===D.type;if(f.bind(u),Y){var l=u.getParameter(u.COLOR_CLEAR_VALUE);lj(u,[1,1,1,1]),u.clear(u.COLOR_BUFFER_BIT),lj(u,l)}else u.clear(u.COLOR_BUFFER_BIT);h.setViewport(u,0,0,s,T),h.drawFilter=c,zr=function(X,V,k,K,b,H){var O=[k?0:1,1,1,1];return H||(Gh.for(X).directUniforms().uFixPickReverseColor=O),O},h.renderPickScene(),zr=rp,h.drawFilter=null,f.unbind(u),jr&&zm(u,W.aPosition),zm(u,W.aNormal),p&&(h.getWidth=G,h.setViewport(u,r[0],r[1],r[2],r[3]));var v=h.getHighlightColor();if(D._lastHighlightColor!==v){var J=Tp(D._lastHighlightColor=v);D._highlightColorData=[J[0]/255,J[1]/255,J[2]/255,J[3]/255]}return Y?D.renderSoftOutline(u,s,T):D.renderHardOutline(u,s,T),u.useProgram(W=h._prg),jr&&Jc(u,W.aPosition),!0}},_assureShader:function(B,f){var y=B._compiledShader[f];return y||(y=B._compiledShader[f]=new Mr.Shader(B,lg.CommonShaderVs,lg[f].fs)),y},renderHardOutline:function(Z,J,U){var q=this,w=q.gv,r=w._postProcessing,X=Gh.for(Z),y=X.directState();y.blend.enabled=!0,y.depth.enabled=!1,r.blitScreen(null,q._renderTarget.texture,q._assureShader(Z,"HighlightHard"),{textureSize:[J,U],edgeWidth:w.getHighlightWidth(),edgeColor:q._highlightColorData},{clear:!1}),y.blend.enabled=!1,y.depth.enabled=!0},renderSoftOutline:function(W,t,x){var w,b,I,M,i,o=this,y=o.gv,H=y._postProcessing,K=Math.floor(t/2),Z=Math.floor(x/2),V=Math.floor(t/4),j=Math.floor(x/4),l=o._downSampleRenderTarget;l?(w=o._edgeDetectionRenderTarget,b=o._blurV2,I=o._blurH2,M=o._blurV4,i=o._blurH4,(l.width!==K||l.height!==Z)&&(l.setSize(K,Z),w.setSize(K,Z),b.setSize(K,Z),I.setSize(K,Z),M.setSize(V,j),i.setSize(V,j))):(l=o._downSampleRenderTarget=new Dl.RenderTarget(y,W,K,Z),w=o._edgeDetectionRenderTarget=new Dl.RenderTarget(y,W,K,Z),b=o._blurV2=new Dl.RenderTarget(y,W,K,Z),I=o._blurH2=new Dl.RenderTarget(y,W,K,Z),M=o._blurV4=new Dl.RenderTarget(y,W,V,j),i=o._blurH4=new Dl.RenderTarget(y,W,V,j));var Y=W.getParameter(W.COLOR_CLEAR_VALUE),Q=y.getViewport(),D=o.width,c=o.strength,e=o.glow,C=Gh.for(W).glState,B=C.depth,$=C.blend,F=B.enabled;lj(W,[1,1,1,1]),B.enabled=!1,$.apply({func:[W.SRC_ALPHA,W.ONE]}),H.blitScreen(l,o._renderTarget.texture),H.blitScreen(w,l.texture,o._assureShader(W,"EdgeDetection"),{texSize:[K,Z],color:o._highlightColorData}),H.blitScreen(I,w.texture,o._assureShader(W,"Blur"),{direction:[1,0],texSize:[K,Z],radius:D}),H.blitScreen(b,I.texture,o._assureShader(W,"Blur"),{direction:[0,1],texSize:[K,Z],radius:D}),H.blitScreen(i,b.texture,o._assureShader(W,"Blur"),{direction:[1,0],texSize:[V,j],radius:D}),H.blitScreen(M,i.texture,o._assureShader(W,"Blur"),{direction:[0,1],texSize:[V,j],radius:D}),$.apply({enabled:!0}),y.setViewport(W,Q[0],Q[1],Q[2],Q[3]),H.blitScreen(null,o._renderTarget.texture,o._assureShader(W,"BlendTogether"),{edgeTexture1:b.texture,edgeTexture2:M.texture,edgeStrength:c*D,edgeGlow:e},{clear:!1}),$.apply({func:[W.SRC_ALPHA,W.ONE_MINUS_SRC_ALPHA,W.ONE,W.ONE_MINUS_SRC_ALPHA]}),B.enabled=F,lj(W,Y)}}),t.defineProperties(lg.prototype,{mode:{get:function(){return this._mode},set:function(e){var U=this._mode;if(e!==U){this._mode=e;var b=U===lg.Mode.MouseOver||U===lg.Mode.Style,a=e===lg.Mode.MouseOver||e===lg.Mode.Style;a&&b||(b&&J(this.gv.getView(),"mousemove",this.onMouseOver),a&&$(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),lg.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),lg.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},lg.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},lg.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},lg.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var Ti=q.Light=function(){ln(Ti,this),this.s(wn,e[wn]),this.s(ig,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Eg("Light",yg,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(L,T,_){Ti.superClass.onStyleChanged.apply(this,arguments),L===wn&&this.s("shape3d.color",_)}});var al=Dl.FrameState=function(Z,I){this.renderState=Gh.for(I),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=D,this.projectMatrix=D,this.viewMatrix=D,this.view=Z,this.defaultProgram=D,this.pickColorMap=D,this._pvStack=[],this._renderStateStack=[]};al.prototype.savePV=function(){var N=this.view;this._pvStack.push([Qc(this.projectMatrix),Qc(this.viewMatrix),N._18Q,Qc(N._7O)])},al.prototype.restorePV=function(){var v=this._pvStack.pop();if(v){var Q=this.view;this.projectMatrix=Q._projectMatrix=v[0],this.viewMatrix=Q._viewMatrix=v[1],Q._18Q=v[2],Q._7O=v[3]}},al.prototype.setPV=function(S,s){var d=this.view,H=!1;if(S&&(this.projectMatrix=d._projectMatrix=S,H=!0),s&&(this.viewMatrix=d._viewMatrix=s,d._7O=Qc(s),H=!0),H){var u=d.getWidth(),n=d.getHeight(),Q=Qc(this.projectMatrix);d._18Q=Sg(Q,Q,s),d._18Q._wh=u/n}},al.prototype.syncEnv=function(K){var n=this,w=n.view;n.envmapReflectivity=w._envmapReflectivity||.5,n.cameraPosition=w.getEye(),n.projectMatrix=w._projectMatrix,n.viewMatrix=w._viewMatrix,n.pickColorMap=K,n.picking=w.getGL()._picking},al.prototype.setGLState=function(){var J=[0,0,0,0],K=[!0,!0,!0,!0],X=[-1,1],e=[aq.FUNC_ADD,aq.FUNC_ADD],P=[aq.SRC_ALPHA,aq.ONE_MINUS_SRC_ALPHA,aq.ONE,aq.ONE_MINUS_SRC_ALPHA];return function(h,$){var g=this,V=g.renderState.gl,i=g.renderState.glState;i.dither=!1,$?i.color.mask=K:i.color.reset(),i.pixelStore.reset(),i.blend.color=J,i.blend.equation=e,i.blend.func=P,i.cullFace.enabled=!1,i.scissor.enabled=!1,i.depth.enabled=!0,i.depth.clear=1,i.depth.func=V.LEQUAL,i.depth.range=X,i.stencil.enabled=!1,i.polygonOffset.enabled=!1,h?(i.depth.mask=!1,i.blend.enabled=!0):(i.depth.mask=!0,i.blend.enabled=!1)}}(),al.prototype.setUniforms=function(G){var l=this,J=l.view,s=l.renderState,f=s.gl,x=s.uniforms;x.uBrightness=1,x.uOpacity=1,x.uPartOpacity=1,x.uPick=l.picking,x.uTexture=!1,x.uBlendTexture=!1,x.uAlphaTest=e.alphaTest,x.uTransparent=!!G,x.uFix=!1,x.uBatchColor=!1,x.uBatchBlend=!1,x.uBatchBrightness=!1,x.uReflectivity=l.envmapReflectivity||.5,x.uCameraPosition=l.cameraPosition,x.uPMatrix=l.projectMatrix,x.uViewMatrix=l.viewMatrix,J.bindEnvMap(f),l.picking||(ym(J,f,D),J._fogDisabled||(x.uFogColor=J._fogColor,x.uFogDensity=J._fogDensity,x.uFogNear=J._fogNear,x.uFogFar=J._fogFar))},al.prototype.drawLayer=function(d){return this.view.renderLayers(d,!0)},al.prototype.drawData=function(l,I,t){var v=this.view;if(v.isVisible(l)){var u=this.renderState,C=u.uniforms,r=v.getData3dUI(l);if(r){var W=u.gl,e=W._picking,n=v._picking,j=l._pickId;t&&(l._pickId=t),C.uPick=W._picking=v._picking=!!t,C.uTransparent=!!I,r._42(u.gl,u.program,I?B:z),C.uPick=W._picking=e,v._picking=n,l._pickId=j}}};var Fp=Dl.Graph3dView=function(z,U){var K=this;K._webGLVersion=1,K._attributes=U||m.graph3dViewAttributes,K._25I={},K._view=Qo(1,K);var l=K._canvas=Ae(K._view);$(l,"webglcontextlost",function(Y){Y.preventDefault(),rk(K),K._26I&&K._doBufferGC(K._26I,!0),K._26I=G,K._1o.onContextLost(),K._35O=!0}),$(l,"webglcontextrestored",function(){K._35O=!1,K.iv()}),K._40Q=new Af,K._43Q={},K._44Q=-1,K._batchIndexMap={},K._batchModelMap={},K._wireframeIndexMap={},K._wireframeModelMap={},K._wireframeIndexMapSwap={},K._wireframeModelMapSwap={},K._polylineIndexMap={},K._polylineIndexMap={},K._polylineIndexMapSwap={},K._polylineIndexMapSwap={},K._8O=[],K._7O=Mj(),K._6O=Mj(),K._1o=new Hp(K),K._30O=new ec(K),K._31O=new Io(K),K._32O=new An(K),K._raycaster=new Is(K),K._highlightHelper=new lg(K),K._postProcessing=new Ss(K),K._41Q=[],K._42Q=0,K._frameRenderOptionStack=[],Dl.VR?(K.vr=new Dl.VR(K),K.isVREnabled=function(){return this.vr.enable},K.isVRPresenting=function(){return this.vr.isPresenting()}):(K.vr={enable:!1,isPresenting:W},K.isVREnabled=W,K.isVRPresenting=W),K.shadowMap=new kf(K),K._33Q=!0,K._eye=gl(m.graph3dViewEye),K._center=gl(m.graph3dViewCenter),K._up=gl(m.graph3dViewUp),K._lightChanged=!1,K._59O=[],K._spots=[],K._dirs=[],K._frameId=0,K._batchInfoMap={},K.overlappingBox=new jm(K),K.dm(z?z:new sn),K._coreInteractor=new Oo(this),K.setInteractors([new dj(K)]),K._initView()},Br={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Pr=0;Xk("Graph3dView",t,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",hs,qg,"firstPersonMode",Bd,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",vs,Wl,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:m.graph3dViewSortable,_editHelperDisabled:m.graph3dViewEditHelperDisabled,_blockSelectable:m.graph3dViewBlockSelectable,_devicePixelRatio:D,_boundaries:D,_moveStep:m.graph3dViewMoveStep,_rotateStep:m.graph3dViewRotateStep,_rotateMinPhi:m.graph3dViewMinPhi===D?m.graph3dViewRotateMinPhi:m.graph3dViewMinPhi,_rotateMaxPhi:m.graph3dViewMaxPhi===D?m.graph3dViewRotateMaxPhi:m.graph3dViewMaxPhi,_pannable:m.graph3dViewPannable,_rotatable:m.graph3dViewRotatable,_walkable:m.graph3dViewWalkable,_resettable:m.graph3dViewResettable,_zoomable:m.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:m.graph3dViewFirstPersonMode,_mouseRoamable:m.graph3dViewMouseRoamable,_gridVisible:m.graph3dViewGridVisible,_gridSize:m.graph3dViewGridSize,_gridGap:m.graph3dViewGridGap,_gridColor:m.graph3dViewGridColor,_originAxisVisible:m.graph3dViewOriginAxisVisible,_centerAxisVisible:m.graph3dViewCenterAxisVisible,_axisXColor:m.graph3dViewAxisXColor,_axisYColor:m.graph3dViewAxisYColor,_axisZColor:m.graph3dViewAxisZColor,_ortho:m.graph3dViewOrtho,_orthoWidth:m.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:m.graph3dViewSyncEyeWithOrthoWidth,_fovy:m.graph3dViewFovy,_near:m.graph3dViewNear,_far:m.graph3dViewFar,_headlightColor:m.graph3dViewHeadlightColor,_headlightIntensity:m.graph3dViewHeadlightIntensity,_headlightRange:m.graph3dViewHeadlightRange,_headlightAmbientIntensity:m.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:m.graph3dViewHeadlightDisabled,_rectSelectable:m.graph3dViewRectSelectable,_rectSelectBackground:m.graph3dViewRectSelectBackground,_editSizeColor:m.graph3dViewEditSizeColor,_autoMakeVisible:qd,_fogDisabled:m.graph3dViewFogDisabled,_fogMode:m.graph3dViewFogMode,_fogDensity:m.graph3dViewFogDensity,_fogColor:m.graph3dViewFogColor,_fogNear:m.graph3dViewFogNear,_fogFar:m.graph3dViewFogFar,_pickerResolution:m.graph3dViewPickerResolution,_dashDisabled:m.graph3dViewDashDisabled,_batchColorDisabled:m.graph3dViewBatchColorDisabled,_batchBlendDisabled:m.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:m.graph3dViewBatchBrightnessDisabled,addCamera:function(N){var O=this,k=t.freeze({id:O._42Q++,priority:N.priority||0,ignoreInPick:!!N.ignoreInPick,render:N.render});N.switch3DStatus&&(O._43Q[k.id]=!0),O._41Q.push(k),O._41Q.sort(function(Y,F){return Y.priority!==F.priority?Y.priority-F.priority:Y.id-F.id})},setEye:function(o,h,z){1===arguments.length&&(h=o[1],z=o[2],o=o[0]);var i=this._eye;i[0]=o,i[1]=h,i[2]=z,this.fp(vs,G,i)},setCenter:function(c,d,C){1===arguments.length&&(d=c[1],C=c[2],c=c[0]);var p=this._center;p[0]=c,p[1]=d,p[2]=C,this.fp(Wl,G,p)},setUp:function(f,p,d){1===arguments.length&&(p=f[1],d=f[2],f=f[0]);var j=this._up;j[0]=f,j[1]=p,j[2]=d,this.fp("up",G,j)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||pi},isTransparentMask:function(w){return w.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var N=this,O=N._aspect;return O?O:(O=N.getWidth()/N.getHeight(),O||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(u){var b=this,Q=b._dataModel,O=b._selectionModel;Q!==u&&(Q&&(Q.ump(b.handleDataModelPropertyChange,b),Q.umm(b.handleDataModelChange,b),Q.umd(b.handleDataPropertyChange,b),O||Q.sm().ums(b.handleSelectionChange,b)),b._dataModel=u,u.mp(b.handleDataModelPropertyChange,b),u.mm(b.handleDataModelChange,b),u.md(b.handleDataPropertyChange,b),O?O._21I(u):u.sm().ms(b.handleSelectionChange,b),b._postProcessing.handleDataModleChange(Q,u),b.invalidateAll(!0),b.invalidateLight(),b.fp(Bp,Q,u),b._canvas.style.background=u.getBackground()||"")},handleDataModelPropertyChange:function(X){if("background"===X.property){var Y=this._canvas.style.background,T=X.newValue||"";this._canvas.style.background=T,this.fp("canvasBackground",Y,T)}else"envmap"===X.property?this.iv():"cubicEnvmap"===X.property&&(this._lastEnvMap=D,this.iv())},handleDataPropertyChange:function(H){var Q=H.data;this.invalidateData(Q),Dh(Q)&&"s:light.type"===H.property?this.invalidateLight():"s:shadow.cast"===H.property&&this.shadowMap.tryUpdateBounding(Q)},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(s){var p=this,L=s.property;p.iv(),p._18Q=G,"eye"===L?p._33Q=!0:"devicePixelRatio"===L?p._42(p.getDevicePixelRatio()):Br[L]&&rk(p)},_5O:function(c){var T=c._22Q();return T?new T(this,c):G},getData3dUI:function(k){var v=this._25I[k._id];return v===D&&(v=this._5O(k),this._25I[k._id]=v),v},invalidateAll:function(j){var N=this;if(j){for(var X in N._25I){var _=N._25I[X];_&&_.dispose()}N._25I={},N.iv(),wi(N)}else wi(N),N.dm().each(function(A){N.invalidateData(A)})},invalidateSelection:function(){var n=this;n.sm().each(function(w){n.invalidateData(w)})},invalidateData:function(e){var v=this,h=v.getData3dUI(e);h&&(h.iv(),v.iv()),wi(v,e)},getShape3dText:function($){return $.getStyle("shape3d.text")||this.getLabel($)},invalidateBatch:function(W){var g=this,r=g._40Q;r.each(function(m){g._invalidateBatch(m.batchModelMap,m.batchIndexMap,m.polylineModelMap,m.polylineIndexMap,m.wireframeModelMap,m.wireframeIndexMap,W),m.markBatchInvalid()})},_invalidateBatch:function(v,s,N,K,q,F,b){var $=this,J=v[b],j=[],Z={};if(J){J.ds.forEach(function(U){var S=$.getData3dUI(U);S&&S.iv(),delete s[U._id],j.push(U._id)}),delete v[b];for(var w,y,O,X,U,I,c,l,P,Y=[q,N],n=[F,K],m=0;m<Y.length;m++){var z=Y[m],d=n[m];for(Z={},l=0;l<j.length;l++){var i=d[j[l]];if(i){delete d[j[l]],P=i.batch,w=z[P];var f=i.begin,k=i.size,S=3*f,a=3*k,o=4*f,M=4*k;for(y=w.ds,O=w.vs,X=w.cs,U=w.ps,I=w.ls,c=i.index,w.invalidate=!0,y[c]=D,c=S;S+a>c;c++)O[c]=D;for(c=o;o+M>c;c++)X[c]=D;for(c=o;o+M>c;c++)U[c]=D;if(I)for(c=S;S+a>c;c++)I[c]=D;Z[P]=!0}}for(P in Z){w=z[P],y=w.ds,O=w.vs,X=w.cs,U=w.ps,I=w.ls;var A=[];for(c=0;c<y.length;c++)y[c]!==D&&A.push(y[c]);if(0===A.length)delete z[P];else{for(w.ds=A,A=[],c=0;c<O.length;c++)O[c]!==D&&A.push(O[c]);for(w.vs=A,A=[],c=0;c<X.length;c++)X[c]!==D&&A.push(X[c]);for(w.cs=A,A=[],c=0;c<U.length;c++)U[c]!==D&&A.push(U[c]);if(w.ps=A,I){for(A=[],c=0;c<I.length;c++)I[c]!==D&&A.push(I[c]);w.ls=A}}}}$.iv()}},handleDataModelChange:function(O){var A=this,N=O.kind,d=O.data;if("add"===N)A.invalidateData(d),Lb(d)&&d.getEdgeGroup()&&d.getEdgeGroup().eachSiblingEdge(A.invalidateData,A),Dh(d)&&A.invalidateLight();else if(N===ai){var P=d._id,b=A._25I[P];b&&(b.dispose(),delete A._25I[P],A.iv()),d===A._currentSubGraph&&A.setCurrentSubGraph(G),wi(A,d),Dh(d)&&A.invalidateLight()}else N===$k&&(A.invalidateAll(!0),A.setCurrentSubGraph(G),wi(A),A.invalidateLight())},toCanvas:function(f,P,V){var E=this,q=E.getGL();if(E.validate(),f){var Q=q.getParameter(q.COLOR_CLEAR_VALUE);lj(q,f)}E._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var L=E.getWidth()||1,H=E.getHeight()||1,n=new Uint8Array(4*L*H),l=Ae(),J=l.getContext("2d");q.readPixels(0,0,L,H,q.RGBA,q.UNSIGNED_BYTE,n),Ek(l,L,H,1);for(var s=J.getImageData(0,0,L,H),y=s.data,I=0;I<y.length;I+=4){var b=I/4,B=i(b/L),W=b-B*L;b=4*((H-1-B)*L+W),y[b]=n[I],y[b+1]=n[I+1],y[b+2]=n[I+2],y[b+3]=n[I+3]
}if(J.putImageData(s,0,0),f&&lj(q,Q),E._42(E.getDevicePixelRatio()),P&&V){var x=Ae(),k=x.getContext("2d");return Ek(x,P,V,1),m.drawImage(k,l,0,0,P,V),x}return l},toDataURL:function(m,c){var J=this,T=J.getGL();if(J.validate(),m){var f=T.getParameter(T.COLOR_CLEAR_VALUE);lj(T,m)}J._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var K=J._canvas.toDataURL(c||"image/png",1);return m&&lj(T,f),J._42(J.getDevicePixelRatio()),K},getGL:function(){var i=this._26I;if(i)return this.acquireProgram(),i;if(!this._35O){var n=this,g=n._canvas,P=n._attributes;if(!P||P.requestWebGL2!==!1)try{i=g.getContext("webgl2",P)||g.getContext("experimental-webgl2",P),i&&(n._webGLVersion=2,n._26I=i)}catch(K){}if(!i)try{i=g.getContext("webgl",P)||g.getContext("experimental-webgl",P)}catch(K){throw new Error("WebGL not supported")}if(!i)throw new Error("WebGL not supported");n._26I=i;var U=n._frameState=new al(this,i);n._glExtensions=new Q(i),n._glCapabilities=new p(i,n._glExtensions),n._2O={},i._emptyCubeTexture=Dc(i),i._compiledShader={},i._emptyTexture=ph(i),i._emptyBlendTexture=ph(i),i._bufPool={},i._id=++Pr,U.setGLState(),n._buffer={vs:np(i),ns:np(i),is:np(i),uv:np(i),batchColor:np(i),batchBlend:np(i),batchBrightness:np(i),lineDistance:np(i)},n._1O=eq(i);var J=n._cube={vs:np(i),ns:np(i),is:np(i),uv:np(i)};return xe(i,J.vs,ze),xe(i,J.ns,xj),xe(i,J.uv,Jm),Ro(i,J.is,Kj),n.acquireProgram(),i._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},i}},getGLCapabilities:function(){var O=this.getGL();return O?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<m.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},acquireProgram:function(){var I=this,W=I._26I;if(W){var w=m.getImage(I.getEnvmap()),J=w&&w.tagName?!0:!1,v=I._prg&&I._prg.envMapFlag?!0:!1;if(!I._prg||J!==v){var L=I._prg=W.createProgram();if(!L)return G;L.envMapFlag=J;var $=I._dirs.length,X=I._spots.length,f=I._59O.length,b=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];$&&b.push("uDirColor","uDirDirection"),X&&b.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),f&&b.push("uPointColor","uPointRange","uPointPosition"),cl||(ob=Ed(ob.substring(0,ob.indexOf("^#"))),Gi=Ed(Gi),cl=!0);var S=["#define MAX_DIR "+$,"#define MAX_SPOT "+X,"#define MAX_POINT "+f,I._fogDisabled?"":"#define FOG","exp2"===I.getFogMode()?"#define FOG_EXP2":"",I._dashDisabled?"":"#define DASH",J?"#define USE_ENVMAP":"",I.isOrtho()?"#define ORTHOGRAPHIC":"",I._batchColorDisabled?"":"#define BATCHCOLOR",I._batchBlendDisabled?"":"#define BATCHBLEND",I._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",I.shadowMap.enable?I.shadowMap.genShaderDefine():"",""].join("\n"),O=Og(W,L,W.VERTEX_SHADER,ob.replace("PREFIX",S));W.getShaderParameter(O,W.COMPILE_STATUS)||oo("COMPILE",W.VERTEX_SHADER,W.getError(),W.getShaderInfoLog(O));var x=Og(W,L,W.FRAGMENT_SHADER,Gi.replace("PREFIX",S));if(W.getShaderParameter(x,W.COMPILE_STATUS)||oo("COMPILE",W.FRAGMENT_SHADER,W.getError(),W.getShaderInfoLog(x)),jr?b.push("aPosition"):(L.aPosition=0,W.bindAttribLocation(L,0,"aPosition")),W.linkProgram(L),!W.getProgramParameter(L,W.LINK_STATUS)){var Q=W.getProgramInfoLog(L);return I._prg=G,Q.indexOf("maximum temp register")>=0&&!I._glTempRegisterLimited?(I._glTempRegisterLimited=!0,W.deleteProgram(L),I.acquireProgram()):(oo("LINK",W.getProgramParameter(L,W.VALIDATE_STATUS),W.getError(),Q),W.deleteProgram(L),G)}b.forEach(function(k){L[k]=/^u/.test(k)?W.getUniformLocation(L,k):W.getAttribLocation(L,k)});var N=I._frameState;N.renderState.program=N.defaultProgram=L,W.deleteShader(O),W.deleteShader(x)}}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(d){var T=d.s("brightness"),h=this.isSelected(d)?d.s("select.brightness"):G;return T==G?h:h==G?T:T*h},getDataHighlightMode:function(d){return d.s("highlight.mode")},bindEnvMap:function(T){var N=this,E=Gh.for(T),t=E.directUniforms(),L=N.getEnvmap(),X=m.getImage(L);if(X&&X.tagName){if(L!==N._lastEnvMap){var H={};if(N.dm().isCubicEnvmap()){var v=Ur(X),W=wb(X);if(0===v||0===W)return;var g=v/4,S=W/3,A={top:{x:g,y:0},left:{x:0,y:S},front:{x:g,y:S},right:{x:2*g,y:S},back:{x:3*g,y:S},bottom:{x:g,y:2*S}};["top","left","front","right","back","bottom"].forEach(function(Q){var K=A[Q],G=H[Q]=Ae();Ek(G,g,S,1);var q=Nm(G);q.drawImage(X,K.x,K.y,g,S,0,0,g,S),q.restore(),H[Q]=m.resizeImagePOT(G,!0)})}else X=m.resizeImagePOT(X,!0);N._envMapTexture&&T.deleteTexture(N._envMapTexture);var l=N._envMapTexture=T.createTexture();T.activeTexture(T.TEXTURE0),T.bindTexture(T.TEXTURE_CUBE_MAP,l),T.texParameteri(T.TEXTURE_CUBE_MAP,T.TEXTURE_MAG_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_CUBE_MAP,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,H.right||X),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,H.left||X),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,H.top||X),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,H.bottom||X),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,H.front||X),T.texImage2D(T.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,H.back||X),T.bindTexture(T.TEXTURE_CUBE_MAP,T._emptyCubeTexture),N._lastEnvMap=L}t.uEnvMap=N._envMapTexture}},getWireframe:function(V){var L=V.s("wf.visible"),I=V.s("wf.width");return L===!0||I>0&&"selected"===L&&this.isSelected(V)?{color:V.s("wf.color"),width:I,"short":V.s("wf.short"),mat:V.s("wf.mat")}:void 0},_transformPointToViewSpace:function(C){var S=[C[0],C[1],C[2]];return Be(S,this._viewMatrix),S},_transformDirectionToViewSpace:function(e,s){var c=[e[0],e[1],e[2]];Be(c,this._viewMatrix);var r=s?[s[0],s[1],s[2]]:[0,0,0];Be(r,this._viewMatrix);var F=r[0]-c[0],Y=r[1]-c[1],g=r[2]-c[2],v=Math.sqrt(F*F+Y*Y+g*g);return v?[F/v,Y/v,g/v]:[F,Y,g]},getWireframeGeometry:function(d){return d.s("wf.geometry")?{color:d.s("wf.color"),width:d.s("wf.width"),mat:d.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(J){return J.s("body.color")},getMat:function(C){return C.getMat?C.getMat():C.s("mat")},getFaceMat:function(C,E){return C.getFaceMat?C.getFaceMat(E):C.s(E+".mat")},getFaceBlend:function(s,p){return s.s(p+".blend")||s.s("all.blend")},getFaceColor:function(L,h){return L.s(h+".color")||L.s("all.color")},getFaceImage:function(W,i){return W.s(i+".image")||W.s("all.image")},getFaceBlendImage:function(P,B){return P.s(B+".blend.image")||P.s("all.blend.image")},getFaceDiscardSelectable:function(U,z){var P=U.s(z+".discard.selectable");return P==G?U.s("all.discard.selectable"):P},getFaceUv:function(F,o){return F.s(o+".uv")||F.s("all.uv")},getFaceUvOffset:function(L,q){return L.s(q+".uv.offset")||L.s("all.uv.offset")},getFaceUvScale:function(b,g){return b.s(g+".uv.scale")||b.s("all.uv.scale")},getFaceUvRotation:function(m,e){return m.s(e+".uv.rotation")||m.s("all.uv.rotation")},getFaceLight:function(d,V){var l=d.s(V+".light");return l==G?d.s("all.light"):l},getFaceVisible:function(n,I){var k=n.s(I+".visible");return k==G?n.s("all.visible"):k},getFaceOpacity:function(Y,z){var t=Y.s(z+".opacity");return t==G?Y.s("all.opacity"):t},getFaceTransparent:function(S,Q){var x=S.s(Q+".transparent");return x==G?S.s("all.transparent"):x},getFaceReverseColor:function(l,R){return l.s(R+".reverse.color")||l.s("all.reverse.color")},getFaceReverseFlip:function(J,l){var i=J.s(l+".reverse.flip");return i==G?J.s("all.reverse.flip"):i},getFaceReverseCull:function(P,U){var N=P.s(U+".reverse.cull");return N==G?P.s("all.reverse.cull"):N},getTextureMap:function(){return this._2O},deleteTexture:function(s){var A=this;if(A._2O){var D=A._2O[s];D&&(delete A._2O[s],A.getGL().deleteTexture(D))}},renderPickScene:function(){var k=this.getGL();this.syncRenderState(),this._picking=k._picking=!0,this.renderScene(),this._picking=k._picking=!1},invalidateCachedTexture:function(U){var M=this.getData3dUI(U);M.invalidateCachedTexture(this.getGL()),this.invalidateData(U)},invalidateShape3dCachedImage:function(D){this.invalidateCachedTexture(D)},invalidateCachedGeometry:function(f){var P=this.getData3dUI(f);P.invalidateCachedGeometry(),this.invalidateData(f)},isInteractive:function(v){return v.s("interactive")},getTexture:function(Q,b,i){if(!Q)return G;var M=this,Y=M.getGL(),x=M._2O[Q];if(!x){var k=Nd(Q),H={};if(!k)return Y._emptyTexture;if(b){H.mipmapMaxLevel=b.s("texture.mipmap.max");var E=b.s("texture.wrap");H.clampToEdge="clampToEdge"===E?!0:"repeat"===E?!1:D}if(k.uuid||(k.uuid=q.Math.generateUUID()),k.tagName){if(k.dynamic)return eq(Y,k,M._1O,H);x=M._2O[Q]=eq(Y,k,D,H)}else{var r,R=b&&(b.s("texture.cache")||b.s("shape3d.image.cache")||k.textureCache),X=M.isVRPresenting();if(X&&(b._textureUpdateFrame===Y._renderInfo.frame?R=!0:b._textureUpdateFrame=Y._renderInfo.frame),R&&(r=M.getData3dUI(b),x=r.getCachedTexture(i),x&&r.interactiveInfo&&x.interactiveInfo&&(r.interactiveInfo[x.interactiveInfo.key]=x.interactiveInfo.info)),!x){var Z=Y._renderInfo.textureCache;if(R){if(Z.time>m.graph3dMaxVectorCacheTime)return M.redraw(),Y._emptyTexture;if(!Kd(k,b))return Y._emptyTexture}var A;b&&(1!==b.s("texture.scale")?A=b.s("texture.scale"):1!==b.s("shape3d.texture.scale")&&(A=b.s("shape3d.texture.scale"))),A||(A=1);var t=b&&(b.s("fixSizeOnScreen")||b.s("shape3d.fixSizeOnScreen")),v=t?Y.NEAREST:Y.LINEAR;t?"number"==typeof t&&(A*=0>t?1:t):b&&(b.s("vector.dynamic")||b.s("shape3d.vector.dynamic"))&&(r||(r=M.getData3dUI(b)),t=r.getVectorDynamicSize());var a,J,n,g=b&&b.s("shape3d");"billboard"===g?n=b.getTall()/b.getWidth():"plane"===g&&(n=b.getHeight()/b.getWidth());var K=Ur(k,b);if(t){var $;$=R?M._devicePixelRatio||pi:M.getDevicePixelRatio(),a=t[0]>0?t[0]*$:A*K*$,J=t[1]>0?t[1]*$:A*(n?wb(k,b,M,Math.min(4096,K*n)):wb(k,b))*$}else a=A*K,J=A*(n?wb(k,b,M,Math.min(4096,K*n)):wb(k,b));if(a>=1&&J>=1){var C=0;(R||X)&&(C=Date.now());var W=M._glCapabilities.maxTextureSize;a=Math.min(a,W),J=Math.min(J,W);var N=ri(a,J);if(!r&&b&&(r=M.getData3dUI(b)),r&&r.interactiveInfo){var s=Q;"object"==typeof s&&(s=s.uuid||(s.uuid=q.Math.generateUUID()));var e=r.interactiveInfo[s]={};N.interactiveInfo=e.bodyInfo={compInfos:[],matrix:new Qh,rect:{x:0,y:0,width:a,height:J}}}Rb(N,k,0,0,a,J,b,M),N.interactiveInfo&&(N.interactiveInfo=null),N.restore(),Z.count++,Z.pixels+=a*J,b?(H.minFilter=Pm(b.s("texture.filter.min")||b.s("texture.filter"))||v,H.magFilter=Pm(b.s("texture.filter.mag")||b.s("texture.filter"))||v):H.minFilter=H.magFilter=v,R||X?(x=eq(Y,el,null,H),r.setCachedTexture(x,i),Z.time+=Date.now()-C,e&&(x.interactiveInfo={key:s,info:e}),el=null):x=eq(Y,el,M._1O,H)}}}}return x},redraw:function(){this.iv()},validateImpl:function(){var $=this;if($._lightChanged){$._lightChanged=!1;var Y=[],S=[],K=[];$.dm().each(function(H){if(Dh(H)){var m=H.s("light.type");m===nc?Y.push(H):m===xo?S.push(H):m===mo&&K.push(H)}}),(Y.length!==$._59O.length||S.length!==$._spots.length||K.length!==$._dirs.length)&&rk($),$._59O=Y,$._spots=S,$._dirs=K}var e=$.getAspect();e!==$.__cachedAspect__&&($._updateSkybox({property:"asceptChanged"}),$.__cachedAspect__=e),$._42(),$._1o.iv()},getRenderInfo:function(){var F=this.getGL();return F?F._renderInfo:void 0},getDebugTip:function(){var H=this,S=H.getRenderInfo();if(S){var r=H.getGL()._validBufCount||0,J="Draw Calls: "+S.calls+"<br/>"+"Vertices: "+S.vertices+"<br/>"+"Faces: "+S.faces+"<br/>"+"Lines: "+S.lines+"<br/>"+(S.points?"Points: "+S.points+"<br/>":"")+"Buffers: "+r+"<br/>"+"Cache Models: "+t.keys(Fg).length+"<br/>"+"Shape3d Models: "+t.keys($p).length;if(H.isVRPresenting()&&(J+="<br/>VR fps: "+H.vr.getFps()),S.textureCache){var g=S.textureCache.count;if(J+="<br/>2D Dynamic Textures: "+S.textureCache.count,g>0){var f,n=S.textureCache.pixels;f=n>1e6?Math.round(n/1e6)+"M":n>1e3?Math.round(n/1e3)+"K":Math.round(n),J+="<br/>2D Dynamic pixels: "+f}}return J}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var Z=new q.Math.Box3,c=new q.Math.Matrix4;return function(x){var B=x;if(B instanceof q.Data&&(B=this.getData3dUI(B)),!B.mat)return!0;var a=B.getBoundingBox();Z.copy(a).applyMatrix4(c.fromArray(B.mat));var h=this.getFrustum();return h.intersectsBox(Z)}}(),updateScene:function(){var n=this;n._81O=G,n.overlappingBox.clear();var R=n._40Q;R.init();var P=n.getGL(),d=n.dm();if(d.isHierarchicalRendering())d.eachByHierarchical(function(D){var T=n.getData3dUI(D);T&&T.update(n,P,R)});else{var M,O,U,C=d.getDatas().getArray(),t=C.length;for(M=0;t>M;M++)O=C[M],U=n.getData3dUI(O),U&&U.update(n,P,R)}R.onUpdated()},_pushFrameRenderOptions:function(T){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=T},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(j){var O=this._currentFrameRenderOptions;return O&&O[j]},renderScene:function(t){function f(L,C){e.setGLState(L,C),e.setUniforms(L),e.renderState.attribs.disable(),n=E.directUniforms(),N=E.directAttribs(),N.disable()}function j(z){for(;Z>A;A++){var J=H[A];if(!r||!J.ignoreInPick){if(J.priority>=z)break;(!U._43Q[U._44Q=J.id]||Wm[Yc.length])&&(J.render(o,U,e),f())}}}var U=this;U._pushFrameRenderOptions(t),U.shadowMap.render(),U._44Q=-1;var N,e=U._frameState,E=e.renderState,L=E.glState,n=E.directUniforms(),o=U.getGL(),v=U._prg;U._projectMatrix=vd(U),Qj(U,U._7O),U._viewMatrix=Qc(U._7O),Sg(U._projScreenMatrix=Mj(),U._projectMatrix,U._viewMatrix),e.syncEnv(this._picking?this.pickColorMap:D),E.useProgram(v),f(!1,!0),o.clear(o.DEPTH_BUFFER_BIT);var r=U._picking,H=this._41Q,A=0,Z=H.length;if(j(m.cameraPriority.skybox),r){var X=L.color.clear.slice(0);lj(o,[0,0,0,0])}else lj(o,[0,0,0,0]),L.blend.enabled=!1,L.depth.enabled=!1,L.depth.mask=!1,U.drawSky(o,v),U.drawReflectors(o)&&(U._projectMatrix=vd(U),Qj(U,U._7O),U._viewMatrix=Qc(U._7O),e.syncEnv(),f()),L.blend.enabled=!1,L.depth.enabled=!0,L.depth.mask=!0,n.uTransparent=!1,U._getFrameRenderOptions("renderGrid")!==!1&&U._31O._42(o,v);if(!o.textureBatch||Wm[(ONE_FRAME_TIME-6)/2]){!r&&U.shadowMap.enable&&U.shadowMap.createShadow(n);for(var h=0,R=tp.length;R>h;h++){var q=tp[h],Q=uj[q];if(!Q.ignore){var Y=Q.priority;j(Y),this.renderLayer(q)}}j(m.cameraPriority.infinity),L.depth.enabled=!1,n.uTransparent=!1,n.shadowReceive=!1,r?U.drawFilter||U._30O._42(o,v):(U._highlightHelper._42(o,v),this._renderAxisAndEditHelper(U._getFrameRenderOptions("renderAxis")!==!1,U._getFrameRenderOptions("renderEdit")!==!1),L.blend.enabled=!1,L.depth.mask=!0),L.depth.enabled=!0,r&&lj(o,X),xe(o,G),Ro(o,G),U._44Q=-1,U._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(D,J){if(D||J){var $=this,f=$.getGL(),n=$._prg,X=$._frameState,e=X.renderState,K=e.glState,F=e.directUniforms();X.renderState.attribs.disable(),K.depth.enabled=!1,F.uTransparent=!1,F.shadowReceive=!1,K.blend.enabled=!1,K.depth.mask=!0,F.uPick=$._picking,D&&$._32O._42(f,n),J&&$._30O._42(f,n),xe(f,G),Ro(f,G)}},renderLayers:function(d,p){p&&(d=bd(d));for(var Z=0,n=d.length;n>Z;Z++)this.renderLayer(d[Z])},addRenderLayerListener:function(L,a,B){var H=this;H._renderLayerNotifier||(H._renderLayerNotifier=new mn),H._renderLayerNotifier.add(L,a,B)},removeRenderLayerListener:function(i,n){this._renderLayerNotifier&&this._renderLayerNotifier.remove(i,n)},fireRenderLayerEvent:function(S,t){var $=this._renderLayerNotifier;$&&$.fire({layer:S,phase:t})},renderLayer:function(k){var j=this,H=j._picking,f=j._40Q.get(k);if(f){j.fireRenderLayerEvent(k,"prepare");var g=j.getGL(),Q=uj[k],u=j._frameState,t=u.renderState,d=t.glState,F=t.directUniforms();!H&&j.isSortable()&&f.sort(j._sortFunc,j._projScreenMatrix);var W,h,V,Z=f.opaque,Y=f.transparent,m=f.batchModelMap,i=f.polylineModelMap,P=f.wireframeModelMap,g=j.getGL(),J=j._prg;H||(d.blend.enabled=!1,d.depth.enabled=!0,d.depth.mask=!0),F.uTransparent=!1,Q.clearDepth!==!1&&g.clear(g.DEPTH_BUFFER_BIT);var G=this.drawFilter;if(G)for(V=Z,W=0,h=V.length;h>W;W++)G(V[W].data)!==!0&&V[W].ui._42(g,J,z);else{for(V=Z,W=0,h=V.length;h>W;W++)V[W].ui._42(g,J,z);if(H)for(V=Y,W=0,h=V.length;h>W;W++)V[W].ui._46Q(g);Dq(j,m),bs(j,i),bs(j,P)}if(H||(d.blend.enabled=!0,d.depth.mask=!1),j._45Q=F.uTransparent=!0,G)for(V=Y,W=0,h=V.length;h>W;W++)G(V[W].data)!==!0&&V[W].ui._42(g,J,B);else{for(V=Y,W=0,h=V.length;h>W;W++)V[W].ui._42(g,J,B);Dq(j,m,null,!0),bs(j,i,null,!0),bs(j,P,null,!0)}j._45Q=null,j.fireRenderLayerEvent(k,"post")}},_42:function(I,R){var T=this;if(!T._35O&&(!Hc||Wm(Hc))){var f=T.getWidth(),r=T.getHeight();if(f&&r){var w=T.getGL();if(w){var a,z=T._canvas;if(I?a=!0:I=T.getDevicePixelRatio(),!T._picking&&(a||f!==z.clientWidth||r!==z.clientHeight)){Ek(z,f,r,I);var D=I;f&&Math.abs(w.drawingBufferWidth-f*I)>1&&(D=Math.min(D,w.drawingBufferWidth/f)),r&&Math.abs(w.drawingBufferHeight-r*I)>1&&(D=Math.min(D,w.drawingBufferHeight/r)),D!==I&&(T.setDevicePixelRatio(I=D),Ek(z,f,r,I)),T._18Q=null}w.clear(w.COLOR_BUFFER_BIT);var j=w._renderInfo;j.calls=0,j.vertices=0,j.faces=0,j.lines=0,j.points=0,j.textureCache={time:0,count:0,pixels:0},j.frame=++T._frameId,j.cacheTimeCost=0,j.reflectDepth=0,f*=I,r*=I,this.syncRenderState();do{if(T.isVREnabled()&&T.vr.render(w,f,r,R))break;if(T.updateScene(),T._postProcessing.render(w,f,r,R))break;T.setViewport(w,0,0,f,r),T.renderScene(R)}while(!1);T._33Q=!1,T.countFrame(),T._doBufferGC(w)}}}},syncRenderState:function(){var O,z;(O=this._frameState)&&(z=O.renderState)&&z.syncLoss()},drawReflectors:function(x){x._renderInfo.reflectDepth++;var c,w,l,z=this,d=z._dataModel.getReflectors(),X=!1;for(c in d)w=d[c],z.isVisible(w)&&(l=z.getData3dUI(w),l&&l.drawReflector(x)&&(X=!0));return x._renderInfo.reflectDepth--,X},isReflecting:function(L){return L._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(Y,$){return this._postProcessing.enableModule(Y,$)},getPostProcessingModule:function(t){return this._postProcessing.getModule(t)},getPostProcessingValue:function(N,o){var i=this._postProcessing.getModule(N);return i?i[o]:D},setPostProcessingValue:function(k,P,y){var f=this.getPostProcessingValue(k,P),E=this._postProcessing.getModule(k);E&&f!==y&&("enable"===P?this.enablePostProcessing(k,y):E[P]=y,this.firePropertyChange("postProcessing."+k+"."+P,f,y))},setViewport:function(u,n,e,S,I){this._viewport=[n,e,S,I],Gh.for(u).directState().viewport=this._viewport},getRenderState:function(){return Gh.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(N){this._bufferGCInterval=N},_doBufferGC:function(q,m){var f,b,d=q._bufPool,W=0,U=0,M=q._renderInfo.frame,P=this._bufferGCInterval||10;for(f in d)W++,b=d[f],b&&(m||M-b._fid>P?(q.deleteBuffer(b._buf),b._buf=null,d[f]=null):U++);if(W/2>U&&W>128){var K={};for(f in d)d[f]&&(K[f]=d[f]);q._bufPool=K}q._validBufCount=U},_swapLineMap:function(){var L=this;Co=L._polylineModelMap,L._polylineModelMap=L._polylineModelMapSwap,L._polylineModelMapSwap=Co,Co=L._wireframeModelMap,L._wireframeModelMap=L._wireframeModelMapSwap,L._wireframeModelMapSwap=Co,Co=L._polylineIndexMap,L._polylineIndexMap=L._polylineIndexMapSwap,L._polylineIndexMapSwap=Co,Co=L._wireframeIndexMap,L._wireframeIndexMap=L._wireframeIndexMapSwap,L._wireframeIndexMapSwap=Co},_updateSkybox:function(R){if(this._skybox&&R){var p=R.property,o=!1,Z=this._skybox;if("eye"===p||"forceUpdate"===p){var u=this._eye;Z.p3(u[0],u[1],u[2]),o=!0}if("near"===p||"far"===p||"forceUpdate"===p||"asceptChanged"===p){var l=Z.__cachedS3__;l||(l=Z.__cachedS3__=Z.getFinalScale3d());var T=Math.sqrt(3),D=1/0,z=-1/0;l.forEach(function(Q){Q/=2,D=S(Q,D),z=L(Q,z)}),z*=T;var r=this._near,w=this._far,f=Math.tan(this.getFovy()/2)*r,m=this.getAspect()*f,X=1.1*Math.sqrt(m*m+f*f+r*r),J=1;if(X>D)J=X/D;else if(z>=w){var i=w*w/(r+w);J=i/z}if(1!==J){Z.__updatingSkybox__=!0;var s=Z.getScale3d().map(function(b,v){return b*J*l[v]});Z.s3(s),Z.setScale3d(1,1,1),o=!0,delete Z.__updatingSkybox__}}o&&this.invalidateData(Z)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(Z){return this.setSkybox(Z)},getSkybox:function(){return this._skybox},setSkybox:function(u){var Q=this._skybox;if(Q===u)return u&&this._updateSkybox({property:"forceUpdate"}),void 0;if(Q&&(this._skyboxStyleMap&&Q.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&Q.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&Q.p3(this._skyboxP3),this._skyboxP3=null),this._skybox=u,this.ump(this._updateSkybox,this),u){u.dm()&&u.dm().remove(u),this._skyboxStyleMap=q.Default.clone(u.getStyleMap()),this._skyboxAnchor3d=u.getAnchor3d(),u.setAnchor3d(.5,.5,.5),this._skyboxP3=u.p3().slice(0),u.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var y=u.onPropertyChanged;u.onPropertyChanged=function(A){y.call(u,A),!u.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(A.property)>=0&&(u.__cachedS3__=D)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",Q,u)},drawSky:function(z,Z){var R=this,K=R._skybox;if(K){var O=Gh.for(z).directUniforms(),A=R._headlightIntensity,C=Xi(R._headlightColor),Z=R._prg;1!==A&&(C=[C[0]*A,C[1]*A,C[2]*A]),O.uHeadlightColor=[C[0],C[1],C[2],1];var $=R.getData3dUI(K);if($){var x=R.isOrtho(),m=x||this._computedProjectMatrix;if(m){var c=R._projectMatrix;x&&(R._ortho=!1),O.uPMatrix=R._projectMatrix=vd(R,!0)}var G=K.p3(),l=this._eye;(G[0]!==l[0]||G[1]!==l[1]||G[2]!==l[2])&&(K._position.x=l[0],K._54O=l[1],K._position.y=l[2]),$.validate(),$._42(z,Z,r),m&&(x&&(R._ortho=!0),O.uPMatrix=R._projectMatrix=c)}z.clear(z.DEPTH_BUFFER_BIT),O.uHeadlightColor=[C[0],C[1],C[2],R._headlightDisabled?1:0]}},getLogicalPoint:function(R){return Dg(R,this._canvas)},isRectOverlapping:function(b){var D=this.getData3dUI(b);return D._rectOverlapping},getHitFaceInfo:function($){$.target&&($=this.lp($));var P=this.getDataInfoAt($);if(P){var t=this.intersectObject($,P.data);if(t)return{data:P.data,face:t.part}}return G},unproject:function(o,$){var c=this,w=c.getWidth(),G=c.getHeight(),k=o.target?c.lp(o):o,v=k.x-w/2,W=k.y-G/2,m=2*(v/w),T=2*(-1*W/G);$=$||0;var x=Mj(),S=vd(c),P=Qj(c);Sg(x,S,P),qn(x);var N=Ui([m,T,$,1],x);return[N[0]/N[3],N[1]/N[3],N[2]/N[3]]},getDataAt:function(l){var r=this.getDataInfoAt(l);return r?r.data:G},getDataInfoAt:function(n,M,a){return n.target&&(n=this.lp(n)),this._1o.get(Lr(n.x,n.y,M),!0,a)},getDatasInRect:function(D,r){return this._1o.get(D,!1,r)},setEditable:function(w){var A=this,M=A._editable;A._editable=w,this.fp(rc,M,w)},isEditable:function(X){var L=this;return X?L._editable?ge(X)?X.s("3d.editable")?L._editableFunc?L._editableFunc(X):!0:!1:!1:!1:L._editable},isSelectable:function(A){return A.s("3d.selectable")&&this.sm().isSelectable(A)},isMovable:function(Z){var R=this;return Lb(Z)&&Z.getStyle(cd)!==gj?!1:Z.s("3d.movable")?R._movableFunc?R._movableFunc(Z):!0:!1},isSizeEditable:function(x){return ge(x)?this._sizeEditableFunc?this._sizeEditableFunc(x):!0:!1},isRotationEditable:function(h){return ge(h)&&h.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(h):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(g){this.setZoom(dr,g)},zoomOut:function(V){this.setZoom(1/dr,V)},setZoom:function(){var o=new tb,d=new tb,K=new tb,S=new tb;return function(y,n){if(1!==y){var P=this;P._14o&&P._14o.stop(!0);var Y,V=1/y;o.copy(P.getCenter()),d.copy(P.getEye());var Q=P._ortho;if(Q){if(Y=P._orthoWidth,Y<P._moveStep&&y>1)return}else if(o.distanceTo(d)<P._moveStep&&1>V)return;var k=!1;return P._zoomToCenter===!1&&P._lastZoomLP&&(K.copy(d).sub(o).normalize(),P._81O=null,S.copy(P.getHitPosition(P._lastZoomLP,o.toArray(),K.toArray())),k=!0,P._lastZoomHit=S),(n=Ne(n))?(n.action=function(B){P.fi({kind:P._zooming?"betweenZoom":"beginZoom"}),P._zooming=1;var m=(V-1)*B+1;Q&&P.setOrthoWidth(Y*m),k?(P.setEye(K.lerpVectors(S,d,m).toArray()),P.setCenter(K.lerpVectors(S,o,m).toArray())):Q||P.setEye(K.lerpVectors(o,d,m).toArray())},n._37o=function(){delete P._14o,delete P._zooming,P.fi({kind:"endZoom"}),P.onZoomEnded()},P._14o=mk(n)):(Q&&P.setOrthoWidth(Y*V),k?(P.setEye(K.lerpVectors(S,d,V).toArray()),P.setCenter(K.lerpVectors(S,o,V).toArray())):Q||P.setEye(K.lerpVectors(o,d,V).toArray()),void 0)}}}(),setOrthoZoom:function(N,i){return this.setZoom(N,i)},getPositionInfo:function(C){var x=this,B=x._eye,S=x._center,J=x.getAspect(),W=C?_b(mm(S,B,!0),mm(C,B)):qj(B,S);if(x._ortho){var h=x._orthoWidth;return{length:W,height:h/J,width:h}}var H=2*yh(x._fovy/2)*W;return{length:W,height:H,width:H*J}},getCenterInfo:function(){var K=this;return K._81O||(K._81O=K.getPositionInfo()),gl(K._81O)},rotate:function(M,J,w,t){var o=this;if(M||J){t==G&&(t=o._firstPersonMode),o._88O&&o._88O.stop(!0);var V=o._center,u=o._eye,m=o.getCenterInfo().length,c=t?V:u,F=t?u:V,x=mm(c,F),v=pd(x[0],x[2]),d=pd(j(x[0]*x[0]+x[2]*x[2]),x[1]),R=t?Wl:vs;return t&&(J=-J),(w=Ne(w))?(w.action=function(C){o.fi({kind:o._rotating?"betweenRotate":"beginRotate"}),o._rotating=1;var r=v+M*C,B=d+J*C;B=t?Y-Yr(o,Y-B):Yr(o,B),x[0]=m*P(B)*P(r),x[1]=m*Z(B),x[2]=m*P(B)*Z(r),c[0]=F[0]+x[0],c[1]=F[1]+x[1],c[2]=F[2]+x[2],o.fp(R,G,c)},w._37o=function(){delete o._88O,delete o._rotating,o.fi({kind:"endRotate"}),o.onRotateEnded()},o._88O=mk(w)):(v+=M,d+=J,d=t?Y-Yr(o,Y-d):Yr(o,d),x[0]=m*P(d)*P(v),x[1]=m*Z(d),x[2]=m*P(d)*Z(v),c[0]=F[0]+x[0],c[1]=F[1]+x[1],c[2]=F[2]+x[2],o.fp(R,G,c),void 0)}},pan:function(x,Z,k,L){if(x||Z){var g=this;L==G&&(L=g._firstPersonMode),g._89O&&g._89O.stop(!0);var c=Qj(g),N=[c[0]*x,c[4]*x,c[8]*x],M=[c[1]*Z,c[5]*Z,c[9]*Z],J=N[0]+M[0],o=N[1]+M[1],m=N[2]+M[2],D=g._center,V=g._eye;if(L){var u=yp(g.getBoundaries(),V[0],V[2],V[0]+J,V[2]+m,j(J*J+m*m));J=u[0],m=u[1]}if(k=Ne(k)){var h=gl(V),s=gl(D);return k.action=function(M){g.fi({kind:g._panning?"betweenPan":"beginPan"}),g._panning=1,D[0]=s[0]+J*M,D[1]=s[1]+o*M,D[2]=s[2]+m*M,V[0]=h[0]+J*M,V[1]=h[1]+o*M,V[2]=h[2]+m*M,g.fp(vs,G,V),g.fp(Wl,G,D)},k._37o=function(){delete g._89O,delete g._panning,g.fi({kind:"endPan"}),g.onPanEnded()},g._89O=mk(k)}D[0]+=J,D[1]+=o,D[2]+=m,V[0]+=J,V[1]+=o,V[2]+=m,g.fp(vs,G,V),g.fp(Wl,G,D)}},walk:function(P,t,L){if(P){var g=this;L==G&&(L=g._firstPersonMode),g._90O&&g._90O.stop(!0);var s=g._center,V=g._eye,d=mm(s,V,!0);if(L){var c=yp(g.getBoundaries(),V[0],V[2],V[0]+d[0]*P,V[2]+d[2]*P,E(P));if(P=qj(c),!P)return;d=[c[0]/P,0,c[1]/P]}if(t=Ne(t)){var f=gl(V),Y=gl(s);return t.action=function(m){g.fi({kind:g._walking?"betweenWalk":"beginWalk"}),g._walking=1;var c=P*m;V[0]=f[0]+d[0]*c,V[1]=f[1]+d[1]*c,V[2]=f[2]+d[2]*c,s[0]=Y[0]+d[0]*c,s[1]=Y[1]+d[1]*c,s[2]=Y[2]+d[2]*c,g.fp(vs,G,V),g.fp(Wl,G,s)},t._37o=function(){delete g._90O,delete g._walking,g.fi({kind:"endWalk"}),g.onWalkEnded()},g._90O=mk(t)}V[0]+=d[0]*P,V[1]+=d[1]*P,V[2]+=d[2]*P,s[0]+=d[0]*P,s[1]+=d[1]*P,s[2]+=d[2]*P,g.fp(vs,G,V),g.fp(Wl,G,s)}},handleScroll:function(t,w){Ji(t);var F=this,I=F._moveStep,S=F.getDataInfoAt(t);if(S){var s=S.data;if(s&&F.isInteractive(s)){var y=F.intersectObject(t,s);if(y){var x=y.part,J=Nd(s.s(x+".image")||s.s("shape3d."+x+".image")||s.s("all.image")||s.s("shape3d.image"));if(J&&$b(J.scrollable,s,F))return}}}return F.isFirstPersonMode()?(F.isPannable()&&F.pan(0,w>0?I:-I),void 0):(F.isZoomable()&&(F._lastZoomLP=F.lp(t),F.setZoom(0>w?1/df:df),F._lastZoomLP=F._lastZoomHit=null),void 0)},handlePinch:function(B,J){if(this.isZoomable()){if(Math.abs(B-J)<m.pinchZoomThreshold)return;this.setZoom(J>B?1/Sj:Sj)}},reset:function(g){this.setUp(m.graph3dViewUp),this.moveCamera(m.graph3dViewEye,m.graph3dViewCenter,g)},moveSelection:function(L,c,$){var U=this;U.dm().beginTransaction(),uh(this.sm().toSelection(this.isMovable,this),L,c,$),U.dm().endTransaction()},getMoveMode:function(m,Z){var L=Z.s("3d.move.mode");if(L)return L;var P="88",O="89",w="90";return Fj(m)||zh[P]&&zh[O]&&zh[w]?"xyz":zh[P]&&zh[O]?"xy":zh[P]&&zh[w]?"xz":zh[O]&&zh[w]?"yz":zh[P]?"x":zh[O]?"y":zh[w]?"z":"xz"},handleTick:function(){var k=this,r=!1,j=k._moveStep,J=j,g=!1,m=!0,W=k._rotateStep*(m?-1:1);if(k.isWalkable()||(J=0),k.isPannable()||(j=0),k.isRotatable()||(W=0),k._32Q){var w=(Oi()-k._32Q)/50;J*=w,j*=w,W*=w}k._31Q&&(Bb(k._31Q),delete k._31Q,delete k._32Q),Om()&&(r=!0,k.pan(-j,0,g,m)),td()&&(r=!0,k.pan(j,0,g,m)),Ce()&&(r=!0,Fj()?k.pan(0,j,g,m):k.walk(J,g,m)),Rh()&&(r=!0,Fj()?k.pan(0,-j,g,m):k.walk(-J,g,m)),op()&&(r=!0,k.rotate(-W,0,g,m)),tn()&&(r=!0,k.rotate(W,0,g,m)),cn()&&(r=!0,k.rotate(0,-W/2,g,m)),qo()&&(r=!0,k.rotate(0,W/2,g,m)),r&&(k._32Q=Oi(),k._31Q=Vm(k.handleTick,k))},handleKeyDown:function(n){var r=this;!hi(n)&&Cp[n.keyCode]?r.handleTick():Xe(n)?r.selectAll():ls(n)?r.handleDelete(n):tk(n)&&this.isResettable()&&r.reset()},checkDoubleClickOnNote:function(i,O,g){var x=this;if(g===uk){if(O.s("note.toggleable"))return O.s(oe,!O.s(oe)),x.fi({kind:"toggleNote",event:i,data:O,part:g}),!0}else if(g===Te&&O.s("note2.toggleable"))return O.s(Vk,!O.s(Vk)),x.fi({kind:"toggleNote2",event:i,data:O,part:g}),!0;return!1},checkDoubleClickOnRotation:function(w,c,e){return e===Mq?(c.setRotationX(0),!0):e===Ug?(c.setRotationY(0),!0):e===Ds?(c.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(r){var R=this;if(R.isOrtho())return R.getWidth()/R.getOrthoWidth();var T=R.getCenter(),g=R.getHeight(),y=R.getEye(),o=[T[0]-y[0],T[1]-y[1],T[2]-y[2]],$=[r[0]-y[0],r[1]-y[1],r[2]-y[2]],c=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]),W=1/Math.tan(R.getFovy()/2);return g*c*W/($[0]*o[0]+$[1]*o[1]+$[2]*o[2])},inViewSpace:function(I){var w,C=this,D=C._transformPointToViewSpace(I),q=C.getAspect(),c=C.getNear(),j=C.getFar();return-D[2]<c||-D[2]>j?!1:C.isOrtho()?(w=C.getOrthoWidth()/2,Math.abs(D[0])<=w&&Math.abs(D[1]*q)<=w):(w=Math.sqrt(D[0]*D[0]+D[1]*D[1]+D[2]*D[2])*Math.tan(C.getFovy()/2),Math.abs(D[1]<=w)&&Math.abs(D[0])<=w*q)},getPVMatrix:function(){var J,U=this;return(J=U._18Q)||(J=vd(U),U._18Q=Sg(J,J,Qj(U)),U._18Q._wh=U.getWidth()/2/U.getHeight()),J},getFrustum:function(){var R=new ds,N=new re,h=new Array(16);return function(){for(var H=this.getPVMatrix(),_=!1,o=0;16>o;o++)H[o]!==h[o]&&(_=!0,h[o]=H[o]);return _&&N.setFromMatrix(R.fromArray(H)),N}}(),toViewPosition:function(k){var j=this,Q=j.getWidth()/2,o=j.getHeight()/2,g=j.getPVMatrix();return k=Ui([k[0],k[1],k[2],1],g),{x:Q+Q*k[0]/k[3],y:o-o*k[1]/k[3],z:k[2]/k[3]}},getHitPosition:function(G,I,C){var S=this,d=S.getWidth(),t=S.getHeight(),E=G.target?S.lp(G):G,v=E.x-d/2,a=E.y-t/2,f=S.getCenterInfo(),O=Qj(S);I=I?I:[0,0,0],C=C?C:[0,1,0],v=v/d*f.width,a=-1*a/t*f.height;var H=[O[0]*v,O[4]*v,O[8]*v],o=[O[1]*a,O[5]*a,O[9]*a],R=[H[0]+o[0],H[1]+o[1],H[2]+o[2]],U=S.getCenter(),P=hn(S,I,C,[R[0]+U[0],R[1]+U[1],R[2]+U[2]]);return P?P:[0,0,0]},intersectObject:function(f,$){return this._raycaster.intersectObject(f,$)},intersectObjects:function(z,K,f){return this._raycaster.intersectObjects(z,K,f)},getLineLength:function(I){this.validate();var j=this.getData3dUI(I);if(j&&j.getCache){var v=j.getCache();if(v)return v[v.length-1].length}return 0},getLineOffset:function(Y,P){var K=this.getData3dUI(Y);if(K&&K.getCache){var q=K.getCache();if(q){var A=gb(q,P);
if(!Y.r3)return A;var u=Y.r3();if(0===u[0]&&0===u[1]&&0===u[2])return A;var s=new tb(Y.p3()),B=new tb(A.point).sub(s),a=new tb(A.tangent).add(B),D=(new sq).setFromEuler(new lh(u,Y.getRotationMode(),!0));return B.applyQuaternion(D),a.applyQuaternion(D),{point:B.add(s),tangent:a.sub(B).normalize()}}}return G},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(t,e,I){var B=this,l=B.getEye();l=[l[0],l[1],l[2]];var Z=B.getCenter();if(Z=[Z[0],Z[1],Z[2]],t||(t=l),e||(e=Z),B._flyAnim&&B._flyAnim.stop(!0),I=Ne(I),!I)return B.setEye(t[0],t[1],t[2]),B.setCenter(e[0],e[1],e[2]),delete B._flyAnim,!0;var p=[t[0]-l[0],t[1]-l[1],t[2]-l[2]],U=[e[0]-Z[0],e[1]-Z[1],e[2]-Z[2]];return I.action=function(L){B.setCenter(Z[0]+U[0]*L,Z[1]+U[1]*L,Z[2]+U[2]*L),B.setEye(l[0]+p[0]*L,l[1]+p[1]*L,l[2]+p[2]*L)},I._37o=function(){delete B._flyAnim},B._flyAnim=mk(I)},flyTo:function(){function k(Z,p,E){if(E instanceof q.Node){S.fromArray(Yb(E,p.getMat(E)));var s=E.getAnchor3d();Z.push((new tb).set(0-s.x,0-s.y,0-s.z).applyMatrix4(S)),Z.push((new tb).set(0-s.x,0-s.y,1-s.z).applyMatrix4(S)),Z.push((new tb).set(0-s.x,1-s.y,0-s.z).applyMatrix4(S)),Z.push((new tb).set(0-s.x,1-s.y,1-s.z).applyMatrix4(S)),Z.push((new tb).set(1-s.x,0-s.y,0-s.z).applyMatrix4(S)),Z.push((new tb).set(1-s.x,0-s.y,1-s.z).applyMatrix4(S)),Z.push((new tb).set(1-s.x,1-s.y,0-s.z).applyMatrix4(S)),Z.push((new tb).set(1-s.x,1-s.y,1-s.z).applyMatrix4(S))}}var P=new tb,K=new tb,G=new tb,y=new tb,S=new ds,f=new q.Math.Quaternion,c=new lh,B=new jl;return function(s,J,Y){var I=this;if(Y!==D)J={animation:J,ratio:Y};else{var V=typeof J;("boolean"===V||"object"===V&&J.duration)&&(J={animation:J})}J=J||{},P.fromArray(I.getEye()),K.fromArray(I.getCenter());var e,S,Z=[],i=J.center,Q=J.distance===D;if(i&&G.fromArray(i),s||(s=I.dm().getDatas()),1===s.length&&(s=Kc(s)?s.get(0):s[0]),s instanceof q.Node)i||G.fromArray(s.p3()),Q&&(k(Z,I,s),e=Z.length);else{if(!s.length)return;if((Q||!i)&&(Z=[],s.forEach(function(W){k(Z,I,W)}),e=Z.length,!e))return;i||(B.setFromPoints(Z),G.copy(B.min).add(B.max).multiplyScalar(.5))}if(I.setCenter(G.x,G.y,G.z),y.subVectors(P,K),J.direction||J.worldDirection){!J.worldDirection&&s instanceof q.Node?f.setFromEuler(c.set(s.r3(),s.getRotationMode(),!0)):f.set(0,0,0,1);var x=y.length();y.fromArray(J.worldDirection||J.direction).applyQuaternion(f).setLength(x)}var C=0;if(Q){var T,o,g,Y=J.ratio||.8,j=J.xRatio||Y,R=J.yRatio||Y;if(I.isOrtho()){var X=-1/0;for(I._eye[0]=y.x+G.x,I._eye[1]=y.y+G.y,I._eye[2]=y.z+G.z,T=vd(I),Sg(T,T,Qj(I)),S=0;e>S;S++)g=Z[S],o=Ui([g.x,g.y,g.z,1],T),X=Math.max(X,Math.max(Math.abs(o[0])/j,Math.abs(o[1])/R));C=I.getOrthoWidth()*X,y.add(G)}else{for(var F,A,z=I.getNear(),_=10;_--;){for(I._eye[0]=y.x+G.x,I._eye[1]=y.y+G.y,I._eye[2]=y.z+G.z,T=vd(I),Sg(T,T,Qj(I)),F=!0,A=-1/0,S=0;e>S;S++){if(g=Z[S],o=Ui([g.x,g.y,g.z,1],T),o[3]<z&&_){y.multiplyScalar(2),F=!1;break}A=Math.max(A,Math.max(Math.abs(o[0])/j,Math.abs(o[1])/R)-o[3])}if(F)break}y.setLength(A+y.length()).add(G)}}else y.setLength(J.distance).add(G);I._flyAnim&&I._flyAnim.stop(!0);var t=Ne(J.animation);if(t){I.setEye(P.x,P.y,P.z),I.setCenter(K.x,K.y,K.z);var v=(new tb).subVectors(y,P),H=(new tb).subVectors(G,K);if(C)var d=I.getOrthoWidth();var h=new tb,$=new tb,W=t.action,m=t._37o,b=P.clone(),a=K.clone();return t.action=function(X,w){h.copy(b).addScaledVector(v,X),$.copy(a).addScaledVector(H,X),I.setCenter($.x,$.y,$.z),I.setEye(h.x,h.y,h.z),C&&I.setOrthoWidth((C-d)*X+d),W&&W(X,w)},t._37o=function(){delete I._flyAnim,m&&m()},{lastEye:P,lastCenter:K,eye:y,center:G,orthoWidth:C,animation:I._flyAnim=mk(t)}}return I.setEye(y.x,y.y,y.z),C&&I.setOrthoWidth(C),delete I._flyAnim,{lastEye:P,lastCenter:K,eye:y,center:G,orthoWidth:C}}}(),getBoundingBox:function(){function U(z,y,x){s.fromArray(Yb(x,y.getMat(x)));var j=x.getAnchor3d();z.push((new tb).set(0-j.x,0-j.y,0-j.z).applyMatrix4(s)),z.push((new tb).set(0-j.x,0-j.y,1-j.z).applyMatrix4(s)),z.push((new tb).set(0-j.x,1-j.y,0-j.z).applyMatrix4(s)),z.push((new tb).set(0-j.x,1-j.y,1-j.z).applyMatrix4(s)),z.push((new tb).set(1-j.x,0-j.y,0-j.z).applyMatrix4(s)),z.push((new tb).set(1-j.x,0-j.y,1-j.z).applyMatrix4(s)),z.push((new tb).set(1-j.x,1-j.y,0-j.z).applyMatrix4(s)),z.push((new tb).set(1-j.x,1-j.y,1-j.z).applyMatrix4(s))}var s=new ds;return function(b){if(b=b||this.sm().getSelection(),b instanceof q.Node&&(b=[b]),0===b.length)return G;var m=[];b.forEach(function(N){ge(N)&&U(m,this,N)},this);var n=[1/0,1/0,1/0],K=[-1/0,-1/0,-1/0];return m.forEach(function(a){n[0]=Math.min(a.x,n[0]),n[1]=Math.min(a.y,n[1]),n[2]=Math.min(a.z,n[2]),K[0]=Math.max(a.x,K[0]),K[1]=Math.max(a.y,K[1]),K[2]=Math.max(a.z,K[2])}),{min:n,max:K}}}(),setBatchInfo:function(Q,i){var p=this._batchInfoMap[Q];this._batchInfoMap[Q]=i,this.fp("batchInfo",p,i)},getBatchInfo:function(W){return this._batchInfoMap[W]||an[W]},setOrthoWidth:function(l){var V=this._orthoWidth;if(this._orthoWidth=l,this._syncEyeWithOrthoWidth){var X=l/this.getAspect(),R=X/2/yh(this.getFovy()/2),K=(new tb).fromArray(this.getEye()),h=(new tb).fromArray(this.getCenter());K.sub(h).setLength(R).add(h),this.setEye(K.toArray())}this.fp("orthoWidth",V,l)}}),Dl.RenderEnv=function(i){this.gv=i,this.enable=!1},t.defineProperties(Dl.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(d){this._debugOn=d,this.capture&&this.capture()}}}),t.assign(Dl.RenderEnv.prototype,{renderEnvToCube:function(a,R,V,M){var Y=this,W=Y.gv;if(!a||!R||!V)return Y.enable=!1,Y._42=null,void 0;Y.enable=!0;var c=Math.floor(M/a*R),x=W.getGL(),Q=Y._renderTargets;Q?Q.length<V&&(Q=Y._renderTargets=Q.concat(new Array(V-Q.length))):Q=Y._renderTargets=new Array(V);for(var P=0;V>P;P++)Q[P]?Q[P].setSize(x,M,c):Q[P]=new Dl.RenderTarget(W,x,M,c);var p=!1;Y.capture=function(){p=!0,W._42(),p=!1};var s=new tb,r=new tb,X=new tb,Z=new tb,C=(new tb).setY(0),J=2*Math.PI/V,_=a/2/Math.tan(Math.PI/V),g=2*Math.atan2(R/2,_),h=a/R;Y._42=function(c,j,y,f){var A=Y._debugOn;if(!p&&!A)return!1;s.copy(W.getEye()),Z.copy(W.getCenter()).sub(s);var w=Math.atan2(Z.z,Z.x),d=W.getNear(),e=W.getFovy(),m=W.getAspect();r.copy(W.getCenter());for(var N,H=0;V>H;H++)if(N=Q[H],C.setZ(Math.cos(w)).setX(Math.sin(w)).multiplyScalar(_),w-=J,X.addVectors(s,C),W.setNear(_),W.setCenter([X.x,X.y,X.z]),W.setFovy(g),W.setAspect(h),A){var n=Math.round(j/V);Gh.for(c).glState.viewport=[n*H,0,n,y],f()}else jk(c,N.frame),Gh.for(c).glState.viewport=[0,0,N.width,N.height],c.clear(c.COLOR_BUFFER_BIT),f(),Do(c),N.assureTexture();return W.setNear(d),W.setCenter([r.x,r.y,r.z]),W.setFovy(e),W.setAspect(m),!0},Y.capture()},getTextureInfo:function(d){var o=this._renderTargets;if(!o)return null;var e=this._renderTargets[d];return e?{index:d,texture:e.texture,textureName:e.uuid}:null}}),t.assign(Dl.Graph3dView.prototype,{renderEnvToCube:function(h,v,L,R){var q=this;q.envRenderer||(q.envRenderer=new Dl.RenderEnv(q)),q.envRenderer.renderEnvToCube(h,v,L,R)}});var Fc=["left","front","right","back","top","bottom"],fl=Dl._RenderList=function(){function T(){r.length=0,y.length=0,Z={}}function t(E){var k,K,r,M,q=E.gv,n=E.data,y=E.shapeModel;if(y){var V,J,O,l=n.s("shape3d.transparent")||n.s("points.transparent");for(bf(y)||(V=$b(y.transparent,n,q),y=[y]),r=0,M=y.length;M>r;r++)O=y[r],J=$b(O.transparent,n,q),J===D&&(J=V),J===D&&(J=l),J?K=!0:k=!0}for(r=0,M=Fc.length;M>r;r++){var x=E[Fc[r]];x&&(x.transparent?K=!0:k=!0)}q.isLabelVisible(n)&&(E.labelInfo&&(n.s(Me+".transparent")?K=!0:k=!0),E.label2Info&&(n.s(Am+".transparent")?K=!0:k=!0)),q.isNoteVisible(n)&&(E.noteInfo&&(n.s(uk+".transparent")?K=!0:k=!0),E.note2Info&&(n.s(Te+".transparent")?K=!0:k=!0)),E._38o&&(K=k=!0),K||(k=!0),E._renderParams={opaque:k,transparent:K}}function b(b,B){B&&t(b);var Y=b.data,n=Y._id;if(!Z[n]){Z[n]=!0;var $=b._renderParams;$&&$.visible!==!1&&(b={ui:b,data:Y,z:0,id:n},$.opaque&&r.push(b),$.transparent&&y.push(b))}}function d(g,K){if(y.length>1){for(var C,l=0,B=y.length;B>l;l++)C=y[l].data.p3(),y[l].z=Be(C,K)[2];y.sort(g||v)}}function m(P){P?(lo(w,n,P),lo(V,Y,P),lo(O,W,P)):(w=this.batchModelMap={},n=this.batchIndexMap={},V=this.polylineModelMap={},Y=this.polylineIndexMap={},O=this.wireframeModelMap={},W=this.wireframeIndexMap={}),this.markBatchInvalid()}function x(L){L?lo(w,n,L):(w=this.batchModelMap={},n=this.batchIndexMap={}),this.markBatchInvalid()}function I(n){n?lo(V,Y,n):(V=this.polylineModelMap={},Y=this.polylineIndexMap={}),this.markBatchInvalid()}function F(q){q?lo(O,W,q):(O=this.wireframeModelMap={},W=this.wireframeIndexMap={}),this.markBatchInvalid()}function i(){return this._batchInvalid}function k(){this._batchInvalid=!0}function q(){this._batchInvalid=null}var r=[],y=[],w={},n={},V={},Y={},O={},W={},Z={};return{opaque:r,transparent:y,init:T,push:b,batchModelMap:w,batchIndexMap:n,polylineModelMap:V,polylineIndexMap:Y,wireframeModelMap:O,wireframeIndexMap:W,ivBatch:m,ivModelBatch:x,ivPolylineBatch:I,ivWireframeBatch:F,markBatchInvalid:k,isBatchInvalid:i,onUpdated:q,sort:d}},Af=Dl._RenderLists=function(){function z(){for(var b in J)J[b].init()}function M(){for(var G in J)J[G].onUpdated()}function o(H,g){H=H||"main";var N=J[H];return!N&&g&&(N=J[H]=new fl),N}function S(T,g){var D=T.data.getRenderLayer(),A=o(D,!0);A.push(T,g)}function r($){for(var c in J)$(J[c])}var J={};return{init:z,onUpdated:M,get:o,push:S,each:r,lists:J}},gi=Dl.RenderTarget=function(D,I,i,U,x){var d=this;x=x||{},x.samples=Math.min(D._glCapabilities.maxSamples,x.samples&&x.samples>1&&2===D._webGLVersion?x.samples:0),d.options=x,d.uuid=q.Math.generateUUID(),d.gv=D,d.init(D,I,x),x.samples&&!D._glCapabilities._maxSamplesChecked?d.setSize(I,i||1,U||1):d.setSize(I,i,U)};t.assign(Dl.RenderTarget.prototype,{bind:function(A){jk(A,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(I){Do(I),this.options.samples&&(I.bindFramebuffer(I.READ_FRAMEBUFFER,this._MSAAFbo),I.bindFramebuffer(I.DRAW_FRAMEBUFFER,this.frame),I.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,I.COLOR_BUFFER_BIT,I.NEAREST),I.bindFramebuffer(I.READ_FRAMEBUFFER,null),I.bindFramebuffer(I.DRAW_FRAMEBUFFER,null))},init:function(b,I,l){var f=this,k=f.texture=I.createTexture();I.activeTexture(I.TEXTURE0),ik(I,k);var j=l.samples,x=j?I.NEAREST:I.LINEAR;I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,l.minFilter||x),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,l.magFilter||x),ik(I,null),f.render=I.createRenderbuffer(),f.frame=I.createFramebuffer(),b._2O[f.uuid]=k},assureTexture:function(){var n=this,x=n.uuid,d=n.gv._2O;d[x]||(d[x]=n.texture)},setSize:function(g,j,w){var r=this;if(j&&w&&(r.width!==j||r.height!==w)){var z=g.RGBA,k=g.TEXTURE_2D,s=g.RENDERBUFFER,$=g.FRAMEBUFFER,p=r.options.samples;if(g.activeTexture(g.TEXTURE0),ik(g,r.texture),g.texImage2D(k,0,z,j,w,0,z,g.UNSIGNED_BYTE,G),pj.isPOT(j)&&pj.isPOT(w)&&!r.options.clampToEdge?(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT)):(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE)),g.bindRenderbuffer(s,r.render),p){var o=r.gv._glCapabilities;if(o._maxSamplesChecked)g.renderbufferStorageMultisample(s,p,g.DEPTH_COMPONENT16,j,w);else{for(g.getError();p>1&&(g.renderbufferStorageMultisample(s,p,g.DEPTH_COMPONENT16,j,w),g.getError());)p=Math.floor(p>>1);1>=p&&(p=0,g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,r.options.minFilter||g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,r.options.magFilter||g.LINEAR),g.renderbufferStorage(s,g.DEPTH_COMPONENT16,j,w)),o._maxSamplesChecked=!0,o.maxSamples=r.options.samples=p}}else g.renderbufferStorage(s,g.DEPTH_COMPONENT16,j,w);p&&!r._MSAAFbo&&(r._MSAAFbo=g.createFramebuffer(),r._MSAARbO=g.createRenderbuffer()),jk(g,r.frame),g.framebufferTexture2D($,g.COLOR_ATTACHMENT0,k,r.texture,0),p||g.framebufferRenderbuffer($,g.DEPTH_ATTACHMENT,s,r.render),Do(g),p&&(g.bindRenderbuffer(g.RENDERBUFFER,r._MSAARbO),g.renderbufferStorageMultisample(g.RENDERBUFFER,p,g.RGBA8,j,w),jk(g,r._MSAAFbo),g.framebufferRenderbuffer(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.RENDERBUFFER,r._MSAARbO),g.framebufferRenderbuffer($,g.DEPTH_ATTACHMENT,s,r.render),Do(g)),ik(g,G),g.bindRenderbuffer(s,G),r.width=j,r.height=w}},toCanvas:function(){var e=this,p=e.gv.getGL();jk(p,e.frame);var D=e.width,_=e.height,t=new Uint8Array(4*D*_);p.readPixels(0,0,D,_,p.RGBA,p.UNSIGNED_BYTE,t),Do(p);var B=s.createElement("canvas");B.width=D,B.height=_;var v=B.getContext("2d"),c=v.createImageData(D,_);return c.data.set(t),v.putImageData(c,0,0),B}});var _c=Dl.Interactor=function(P){this.gv=this.g3d=P};Xk("Interactor",t,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(T){this.gv.fi(T)},startDragging:function(d){nr(this,d)}});var dj=Dl.DefaultInteractor=function(x){ln(dj,this,[x])};Xk("DefaultInteractor",_c,{getState:function(){return this._62O},setState:function(g){this._62O=g},getDataInfoAt:function(l,G){var j=this.gv,b=j.getDataInfoAt(l);if(!j.isBlockSelectable()||!b||!b.data)return b;if(!G&&j.isSelected(b.data))return b;for(var y=b.data;(y=y.getParent())&&y instanceof q.Block&&j.isSelectable(y);){var V=j.isSelected(y);if(V&&G)break;if(b={data:y,part:b.part},V&&!G)break}return b},handle_contextmenu:function(m){Ji(m)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(g){2===g.axis&&this.gv.handleScroll(g,-g.detail)},handle_keydown:function(k){this.gv.handleKeyDown(k)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(Z){Ji(Z);var T=this,x=T.gv,F=Cm(Z),P=T.getDataInfoAt(Z),v=P?P.data:G,d=P?P.part:G,R=x.sm(),N=kr(Z),Y=fm(Z);x.setFocus(Z)&&(T._62O=G,T._57I=G,T.pendingClickThrough=G,T.__lastClientPoint__=Lp(Z),v?hi(Z)?R.co(v)?R.rs(v):R.as(v):R.co(v)?v instanceof Ep&&v.isClickThroughEnabled()&&Cm(Z)&&(T.pendingClickThrough=Lp(Z)):R.ss(v):F&&(hi(Z)?x.isRectSelectable()&&(T._62O=dk):T._57I=Lp(Z)),T._31Q&&(Bb(T._31Q),delete T._31Q,delete T._32Q),T._62O||(x.isFirstPersonMode()&&(Fj(Z)||Jn(Z)||Y>2?T._62O="pan":x.isMouseRoamable()||Jo(Z)?(T._62O="roaming",T.foward=N&&Cm(Z),T._32Q=Oi(),T._31Q=Vm(T.tick,T)):F||(T._62O="roaming")),T._62O||(F&&N&&Hs[d]?(T._62O=d,T.p3=v.p3()):F&&N&&ge(v)&&x.isSelected(v)?x.isMovable(v)?(T._62O="move",T.p3=v.p3(),T.movedata=v):x._39Q(v)&&(T._62O="none"):Jo(Z)&&(Y>2?T._62O="pan":2===Y&&(T.dist=vl(Z),T._62O="pinch")))),T.point=x.lp(Z),nr(T,Z),bb(Z)?x.handleDoubleClick(Z,v,d):x.handleClick(Z,v,d))},tick:function(){var T=this,W=T.gv,v=W._moveStep;T.point&&W.isWalkable()&&(T._32Q&&(v*=(Oi()-T._32Q)/50),W.walk(T.foward?v:-v),T._32Q=Oi(),T._31Q=Vm(T.tick,T))},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(m){var b=this._57I;if(b&&(qj(b,Lp(m))<=1&&this.gv.sm().cs(),this._57I=G),b=this.pendingClickThrough){if(qj(b,Lp(m))<=1){var F=this.getDataInfoAt(m);F&&F.data instanceof Ep&&F.data.isClickThroughEnabled()&&(F=this.getDataInfoAt(m,!0),F&&(m.clickThrough=!0,this.gv.sm().ss(F.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(h){var N,z,p=this,$=p.gv,f=p._62O,P=p.point,H=$.dm(),u=$.lp(h),c=u.x-P.x,a=u.y-P.y,v=$.getWidth(),G=$.getHeight();if(v&&G){var g=Lp(h),s=Fm($,g,p.__lastClientPoint__),F=qj({x:0,y:0},s),X=-k*c/v,L=-k*a/G;if("roaming"===f)p.rotate(h,X/2,L/2);else if(f===Mq||f===Ug||f===Ds)$._86O||H.beginTransaction(),$.fi({kind:$._86O?"betweenEditRotation":"beginEditRotation",event:h}),$._86O=1,$.sm().each(function(O){if(ge(O)&&$.isRotationEditable(O)){var I=E(X)>E(L)?X:L;f===Mq?O.setRotationX(O.getRotationX()+I):f===Ug?O.setRotationY(O.getRotationY()+I):f===Ds&&O.setRotationZ(O.getRotationZ()+I)}});else if("move"===f||Hs[f]){if(f===Es||f===Fs||f===Gs)$._87O||H.beginTransaction(),$.fi({kind:$._87O?"betweenEditScale":"beginEditScale",event:h}),$._87O=1;else{if(!$._moving){if(F<m.touchMoveThreshold)return;H.beginTransaction()}$.fi({kind:$._moving?"betweenMove":"beginMove",event:h}),$._moving=1}var J,I=p.p3,K=$.getPositionInfo(I),w=Qj($);J=f===qb?"x":f===Cs?"y":f===Ch?"z":f===Es?"sx":f===Fs?"sy":f===Gs?"sz":$.getMoveMode(h,p.movedata),c=c/v*K.width,a=-1*a/G*K.height;var y,n,x=[w[0]*c,w[4]*c,w[8]*c],S=[w[1]*a,w[5]*a,w[9]*a],W=x[0]+S[0],U=x[1]+S[1],Y=x[2]+S[2],d=[I[0]+W,I[1]+U,I[2]+Y],l=mm($.getEye(),d,!0);if("xyz"===J?(y=d,$.moveSelection(W,U,Y)):"xz"===J?(y=hn($,I,[0,1,0],d),y&&$.moveSelection(y[0]-I[0],0,y[2]-I[2])):"xy"===J?(y=hn($,I,[0,0,1],d),y&&$.moveSelection(y[0]-I[0],y[1]-I[1],0)):"yz"===J?(y=hn($,I,[1,0,0],d),y&&$.moveSelection(0,y[1]-I[1],y[2]-I[2])):"x"===J||"sx"===J?(l[0]=0,y=hn($,I,l,d),y&&(n=y[0]-I[0],"x"===J?$.moveSelection(n,0,0):$.sm().each(function(Q){ge(Q)&&$.isSizeEditable(Q)&&(N=Q.getScaleX()+n/100,z=N/Q.getScaleX(),Q.setScaleX(N),Fj(h)&&(Q.setScaleY(Q.getScaleY()*z),Q.setScaleTall(Q.getScaleTall()*z)))}))):"y"===J||"sy"===J?(l[1]=0,y=hn($,I,l,d),y&&(n=y[1]-I[1],"y"===J?$.moveSelection(0,n,0):$.sm().each(function(x){ge(x)&&$.isSizeEditable(x)&&(N=x.getScaleTall()+n/100,z=N/x.getScaleTall(),x.setScaleTall(N),Fj(h)&&(x.setScaleY(x.getScaleY()*z),x.setScaleX(x.getScaleX()*z)))}))):("z"===J||"sz"===J)&&(l[2]=0,y=hn($,I,l,d),y&&(n=y[2]-I[2],"z"===J?$.moveSelection(0,0,n):$.sm().each(function(i){ge(i)&&$.isSizeEditable(i)&&(N=i.getScaleY()+n/100,z=N/i.getScaleY(),i.setScaleY(N),Fj(h)&&(i.setScaleX(i.getScaleX()*z),i.setScaleTall(i.getScaleTall()*z)))}))),!y)return;p.p3=y}else if(f===dk){var t=p.div;t||(t=p.div=Ic(),ar(p.getView(),t),t.op=P,t.style.background=$.getRectSelectBackground()),$.fi({kind:$._rectSelecting?"betweenRectSelect":"beginRectSelect",event:h}),$._rectSelecting=1,t.rect=Ip(t.op,u),ne(t,t.rect)}else if("pinch"===f&&2===fm(h)){$.fi({kind:$._pinching?"betweenPinch":"beginPinch",event:h}),$._pinching=1;var n=vl(h);$._lastZoomLP||($._lastZoomLP=kj(h)),$.handlePinch(n,p.dist),p.dist=n}else"pan"===f||Fj(h)||Jn(h)?p.pan(h,c,a):"none"===f||$.isFirstPersonMode()||p.rotate(h,X,L);p.point=u}},pan:function($,U,g){var u=this.gv;if(u.isPannable()){var h=u.getWidth(),q=u.getHeight();if(!h||!q)return;var w=u.getCenterInfo(),Z=U/h*w.width,r=-1*g/q*w.height;u.fi({kind:u._panning?"betweenPan":"beginPan",event:$}),u._panning=1,u.pan(-Z,-r)}},rotate:function(N,U,e){var C=this.gv;C.isRotatable()&&(C.fi({kind:C._rotating?"betweenRotate":"beginRotate",event:N}),C._rotating=1,C.rotate(U,e))},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(D){var y=this,$=y.gv,r=$.dm(),s=y.div;if(s){var S=$.getDatasInRect(s.rect);if(!S.isEmpty()){var L=$.sm(),g=L.toSelection();S.each(function(m){L.co(m)?g.remove(m):g.add(m)}),L.ss(g)}Rl(s)}$._moving&&(delete $._moving,$.fi({kind:"endMove",event:D}),$.onMoveEnded(),r.endTransaction()),$._panning&&(delete $._panning,$.fi({kind:"endPan",event:D}),$.onPanEnded()),$._rotating&&(delete $._rotating,$.fi({kind:"endRotate",event:D}),$.onRotateEnded()),$._86O&&(delete $._86O,$.fi({kind:"endEditRotation",event:D}),r.endTransaction()),$._87O&&(delete $._87O,$.fi({kind:"endEditScale",event:D}),r.endTransaction()),$._pinching&&(delete $._pinching,$.fi({kind:"endPinch",event:D}),$.onPinchEnded()),$._rectSelecting&&(delete $._rectSelecting,$.fi({kind:"endRectSelect",event:D}),$.onRectSelectEnded()),$._walking&&(delete $._walking,$.fi({kind:"endWalk",event:D}),$.onWalkEnded()),$._lastZoomLP=$._lastZoomHit=null,y.dist=y.point=y._62O=y.p3=y.movedata=y.div=y._57I=y.pendingClickThrough=y._32Q=y._31Q=y.foward=G,y.__lastClientPoint__=G}});var Eb=Dl.MapInteractor=function(L){ln(Eb,this,[L]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Xk("MapInteractor",_c,{setUp:function(){Eb.superClass.setUp.call(this);var f=this.gv;this.__oldMinPhi__=f.getRotateMinPhi(),this.__oldMaxPhi__=f.getRotateMaxPhi(),f.setRotateMinPhi(this._minPhi),f.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Eb.superClass.tearDown.call(this);var d=this.gv;d.setRotateMinPhi(this.__oldMinPhi__),d.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(K){Ji(K)},handle_mousewheel:function(h){this.gv.handleScroll(h,h.wheelDelta/40)},handle_DOMMouseScroll:function(U){2===U.axis&&this.gv.handleScroll(U,-U.detail)},handle_keydown:function(m){this.gv.handleKeyDown(m)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(w){Ji(w);var V=this,D=V.gv;if(D.setFocus(w)){var M=D.getDataInfoAt(w),x=M?M.data:G,L=M?M.part:G,S=V.editing={point:D.lp(w)};Jo(w)?S.touch=!0:(S.touch=!1,S.clickLeft=Cm(w),S.pan=Jn(w)?!0:"left"===this.panButton===S.clickLeft),x&&D._39Q(x)&&(S.preventDefault=!0),nr(V,w),bb(w)?D.handleDoubleClick(w,x,L):D.handleClick(w,x,L)}},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(){},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(F){var N=this,y=N.gv,O=N.editing;if(O){var V=y.lp(F),K=O.point,A=V.x-K.x,l=V.y-K.y;if(!O.moved){if(Math.abs(A)<N.threshold&&Math.abs(l)<N.threshold&&!(F.touches&&F.touches.length>1))return;O.moved=!0}if(!O.preventDefault)if(O.point=V,O.touch){var u=F.touches.length;if(2!==u)N.pan(F,A,l);else{if(1>=u)return;var i=F.touches,U={x:i[0].clientX,y:i[0].clientY},h={x:i[1].clientX,y:i[1].clientY},X={x:h.x-U.x,y:h.y-U.y},r=O.lastCenter,f=Math.atan2(X.y,X.x),t=O.theta,E=0;t==G?t=O.theta=f:(E=f-t,O.thetaStarted||Math.abs(E)>N.touchRotateThreshold?(O.thetaStarted=!0,O.theta=f):E=0);var W=Y*(U.y+h.y)/2/y.getHeight(),j=O.phi,b=0;j==G?j=O.phi=W:(b=W-j,O.phiStarted||Math.abs(b)>N.touchRotateThreshold?(O.phiStarted=!0,O.phi=W):b=0);var T,D=Math.sqrt(X.x*X.x+X.y*X.y),R=O.vlen;if(R){var $=U.x-r.x,n=U.y-r.y,J=h.x-r.x,e=h.y-r.y,z=Math.sqrt($*$+n*n),_=Math.sqrt(J*J+e*e),w=R/2,B=N._sign2(z-w),g=N._sign2(_-w);0>B*g||0===B&&0===g?(T=1,O.vlen=D):(T||(T=D/R),O.scaleStarted||Math.abs(T-1)>N.touchScaleThreshold?(O.vlen=D,O.scaleStarted=!0):T=1)}else R=O.vlen=D,T=1;1!==T&&y.setZoom(T),(b||E)&&N.rotate(F,E,-b),O.lastCenter={x:(h.x+U.x)/2,y:(h.y+U.y)/2}}}else if(O.pan)N.pan(F,A,l);else{var v=y.getWidth(),H=y.getHeight();if(!v||!H)return;var S=-k*A/v,x=-k*l/H;N.rotate(F,S,x)}}},_sign2:function(u){return Math.abs(u)<this._touchScaleCheckAccuracy?0:u>0?1:-1},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},getDataInfoAt:function(d,M){var W=this.gv,X=W.getDataInfoAt(d);if(!W.isBlockSelectable()||!X||!X.data)return X;if(!M&&W.isSelected(X.data))return X;for(var R=X.data,T=X.part;(R=R.getParent())&&R instanceof q.Block&&W.isSelectable(R);){var x=W.isSelected(R);if(x&&M)break;if(X={data:R,part:T},x&&!M)break}return X},handleWindowTouchEnd:function(m){var A=this,$=A.editing;if(A.editing=null,$){var t=A.gv;if($.moved||!$.clickLeft&&!$.touch)t._panning=null,t._rotating=null,t.fi({kind:$.pan?"endPan":"endRotate",event:m});else{var V=A.getDataInfoAt(m),u=V&&V.data;u instanceof Ep&&u.isClickThroughEnabled()&&(V=A.getDataInfoAt(m,!0),V&&(u=V.data)),u?t.sm().setSelection([u]):t.sm().clearSelection()}}},pan:function(F,J,l){var L=this,x=L.gv;if(x.isPannable()){var u=x.getWidth(),O=x.getHeight();if(u&&O){var R=x.getCenterInfo(),i=-J/u*R.width,E=1*l/O*R.height;x.fi({kind:x._panning?"betweenPan":"beginPan",event:F}),x._panning=1;var o=L.keepHorizon,p=L.editing.touch;if((p&&F.touches&&F.touches.length>1||!p&&Fj(F))&&(o=!o),!o)return x.pan(i,E);if(i||E){var D=Qj(x),M=[D[0]*i,D[4]*i,D[8]*i],a=[D[1],0,D[9]],c=Math.sqrt(a[0]*a[0]+a[2]*a[2]);c&&(a=[a[0]/c*E,0,a[2]/c*E]);var U=M[0]+a[0],f=M[1]+a[1],W=M[2]+a[2],z=x._center,Q=x._eye;z[0]+=U,z[1]+=f,z[2]+=W,Q[0]+=U,Q[1]+=f,Q[2]+=W,x.fp(vs,G,Q),x.fp(Wl,G,z)}}}},rotate:function(v,M,J){var T=this,K=T.gv;if(K.isRotatable()){var c=K._center,q=K._eye,V=mm(q,c),t=pd(j(V[0]*V[0]+V[2]*V[2]),V[1]),$=Yr(K,t+J);J=$-t,K.fi({kind:K._rotating?"betweenRotate":"beginRotate",event:v}),K._rotating=1,K.rotate(M,J)}}}),t.defineProperties(Eb.prototype,{panButton:{get:function(){return this._panButton},set:function(_){this._panButton=_}},minPhi:{get:function(){return this._minPhi},set:function(f){this.gv.setRotateMinPhi(this._minPhi=f)}},maxPhi:{get:function(){return this._maxPhi},set:function(q){this.gv.setRotateMaxPhi(this._maxPhi=q)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(M){this._keepHorizon=M}},threshold:{get:function(){return this._threshold},set:function($){this._threshold=$}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(Q){this._touchScaleThreshold=Q}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(Q){this._touchRotateThreshold=Q}}});var sf,Qr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",gq=32,Fi=Dl.GlobeInteractor=function(X,s){ln(Fi,this,[X]);var Y,i=s.radius||6378137,M=this,D=null;sf||(sf=Ic(),sf.style.border="",sf.style.backgroundImage="url("+Qr+")");var b=new sq,E=new tb,F=new tb,u=new tb,V=new eo,z="number"==typeof i?{x:i,y:i,z:i}:i,P={center:new tb(0,0,0),radius:z},q=function(j){X._81O=null;var I=X.getHitPosition(j,X.getCenter(),E.copy(X.getEye()).sub(F.copy(X.getCenter())).toArray());return V.origin.copy(X.getEye()),V.direction.copy(I).sub(V.origin).normalize(),V.intersectEllipsoid(P)},H=function(M,K){X._81O=null,V.origin.copy(X.getEye());for(var S,W,$=X.getCenter(),e=E.copy(X.getEye()).sub(F.copy(X.getCenter())).toArray(),u=1,I=16,t=0,J=1,r={x:0,y:0};I--;){if(r.x=K.x+(M.x-K.x)*u,r.y=K.y+(M.y-K.y)*u,S=X.getHitPosition(r,$,e),V.direction.copy(S).sub(V.origin).normalize(),W=V.intersectEllipsoid(P),W&&1===u)return{hit:W};W?t=u:J=u,u=(t+J)/2}return{hit:W,out:1>u}},h=function(e,u){if(D){var I=Date.now();D.deltaTime=D.lastTime?I-D.lastTime:1e3,D.lastTime=I,D.lastAxis=e,D.lastAngle=u}u&&(b.setFromAxisAngle(e,u),X.setEye(E.copy(X.getEye()).applyQuaternion(b).toArray()),X.setCenter(E.copy(X.getCenter()).applyQuaternion(b).toArray()),X.setUp(E.copy(X.getUp()).applyQuaternion(b).toArray()))};M._showCrossIcon=function(h){ar(M.getView(),sf),ne(sf,{x:h.clientX-gq/2,y:h.clientY-gq/2,width:gq,height:gq})},M._hideCrossIcon=function(){Rl(sf)},M._scrollImpl=function(m,N){D={point:X.lp(m),screen:Lp(m),hit:q(m),type:"right"},D.hitNormalize=D.hit?D.hit.clone().normalize():new tb;var Z={clientX:D.screen.x,clientY:D.screen.y+10*N};M._handleMoveImpl(Z),M._endMoveImpl(Z)},M._startMoveImpl=function(o){Y&&(Y.stop(!0),Y=null),D={point:X.lp(o),screen:Lp(o),hit:q(o)},D.hitNormalize=D.hit?D.hit.clone().normalize():new tb,Jo(o)?1===o.touches.length?D.hit&&(D.type="left"):2===o.touches.length&&(D.type="touch2"):(Cm(o)?D.hit&&(D.type="left"):cq(o)?D.type="right":Jn(o)&&D.hit&&(D.type="middle"),!D.hit||"right"!==D.type&&"middle"!==D.type||M._showCrossIcon(o)),D.type&&nr(M,o)},M._handleMoveImpl=function(O){if(D)switch(D.type){case"left":return M._handleLeft(O);case"right":return M._handleRight(O);case"middle":return M._handleMiddle(O);case"touch2":return M._handleTouch2(O)}},M._endMoveImpl=function(){if(D){if(this._hideCrossIcon(),"left"===D.type||"middle"===D.type){var i=1e3*(D.lastAngle/(D.deltaTime||30)),f=D.lastAxis,$=D.lastTime,n=function(){var X=Date.now(),S=(X-$)/1e3;return $=X,i*=Math.pow(Math.abs(M.decelerationRate),3*S),Math.abs(i)<.01?(i=0,Y&&Y.stop(),void 0):(h(f,i*S),void 0)};Y=mk({action:function(){n(arguments)},duration:5e3})}D=null}},M._handleLeft=function(w){if(!D.finished){var a=Lp(w),V=H(a,D.lastScreen||D.screen);if(D.lastScreen=a,!V.hit)return D.finished=!0,M._endMoveImpl(w),void 0;var c=V.hit;c.normalize();var n=D.hitNormalize,p=Math.acos(c.dot(n)),o=c.cross(n).normalize();h(o,p),V.out&&(D.finished=!0,M._endMoveImpl(w))}},M._handleRight=function(J){var T=D.lastScreen||D.screen,G=T.y;T=D.lastScreen=Lp(J);var a=T.y,o=a-G;if(o){var k=Math.min(.5,o*M.scaleSpeed);E.copy(X.getEye());var r=D.hit;r||(r=E.clone().divide(z).normalize().multiply(z)),F.copy(E).lerp(r,k),X.setEye(F.toArray()),E.copy(X.getUp()),F.normalize();var t=E.clone().cross(F).normalize();if(u.copy(X.getCenter()),u.sub(t.multiplyScalar(u.dot(t))),X.setCenter(u.toArray()),D.hit){var m=q(D.screen),g=D.hitNormalize;if(m){m.normalize();var v=Math.acos(m.dot(g)),w=m.cross(g).normalize();v&&h(w,v)}}}};var B=function(y){return Math.abs(y)<.01?0:y>0?1:-1};M._handleTouch2=function(H){var R=H.touches.length;if(2===R){var f=H.touches,j={x:f[0].clientX,y:f[0].clientY},c={x:f[1].clientX,y:f[1].clientY},t={x:c.x-j.x,y:c.y-j.y},T=D.lastCenter,C=Math.atan2(t.y,t.x),a=D.theta,v=0;a==G?a=D.theta=C:(v=C-a,D.thetaStarted||Math.abs(v)>.03?(D.thetaStarted=!0,D.theta=C):v=0);var x,l=Math.sqrt(t.x*t.x+t.y*t.y),W=D.vlen;if(W){var Y=j.x-T.x,N=j.y-T.y,d=c.x-T.x,e=c.y-T.y,A=Math.sqrt(Y*Y+N*N),z=Math.sqrt(d*d+e*e),n=W/2,I=B(A-n),U=B(z-n);0>I*U||0===I&&0===U?(x=1,D.vlen=l):(x||(x=l/W),D.scaleStarted||Math.abs(x-1)>.05?(D.vlen=l,D.scaleStarted=!0):x=1)}else W=D.vlen=l,x=1;var t=F.copy(X.getEye()).clone();1!==x&&X.setEye(t.setLength((t.length()-i)/x+i).toArray()),v&&h(t.normalize(),v),D.lastCenter={x:(c.x+j.x)/2,y:(c.y+j.y)/2}}},M._handleMiddle=function(q){var m=Lp(q),w=D.screen;D.screen=m;var V=(m.y-w.y)/180*Math.PI*M.rollSpeed;F.copy(X.getCenter()).sub(E.copy(X.getEye())).normalize(),E.copy(X.getUp()).cross(F).normalize(),F.copy(X.getEye()).sub(D.hit).applyAxisAngle(E,V).add(D.hit);var H=F.clone();F.copy(X.getCenter()).sub(D.hit).applyAxisAngle(E,V).add(D.hit);var T=F.clone(),r=F.copy(X.getUp()).applyAxisAngle(E,V).clone(),O=!1;V>0&&(u.copy(r),F.copy(T).sub(H).normalize(),E.copy(H).multiplyScalar(-1).normalize(),E.dot(u)-F.dot(u)>0&&(O=!0)),O||u.copy(D.hit).sub(H).dot(D.hitNormalize)>=0&&(O=!0),O||(X.setEye(H.toArray()),X.setCenter(T.toArray()),X.setUp(r.toArray()));var g=-(m.x-w.x)/180*Math.PI*M.rotateSpeed;h(D.hitNormalize,g)}};Xk("GlobeInteractor",_c,{handle_contextmenu:function(q){Ji(q)},handle_mousewheel:function(e){this._scrollImpl(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(I){2===I.axis&&this._scrollImpl(I,-I.detail)},handle_keydown:function(G){this.gv.handleKeyDown(G)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function($){Ji($);var J=this.gv;if(J.setFocus($)){var k=J.getDataInfoAt($),W=k?k.data:G;W&&J.isInteractive(W)||this._startMoveImpl($);var a=k?k.part:G;bb($)?J.handleDoubleClick($,W,a):J.handleClick($,W,a)}},handle_mouseup:function(Q){this.handle_touchend(Q)
},handle_touchend:function(){},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(C){this._handleMoveImpl(C)},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(T){this._endMoveImpl(T)}}),t.defineProperties(Fi.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(t){this._rotateSpeed=t}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function($){this._rollSpeed=$}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(c){this._scaleSpeed=c}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(y){this._decelerationRate=y}}});var Ml=function(w){var R=2147483648|w;return[(255&R>>16)/255,(255&R>>8)/255,(255&R)/255,(255&R>>24)/255]},Hp=function(f){this.gv=f,this.gv.pickColorMap={_pickIdUsed:2e3}};mj(Hp,t,{_iv:!0,iv:function(){this._iv=!0},get:function(V,P,C){this.validate();var d=this,Z=d.gv.getGL();if(!Z)return G;var p,b,u=d._resolution,B=Math.round(V.x*u),T=Math.ceil(V.width*u),M=Math.ceil(V.height*u),S=d.height-Math.round(V.y*u)-M,_=i(T/2),W=new Uint8Array(4*T*M),j=0,g=W.length,y=P?G:new pq,k=P?G:{};if(jk(Z,d.frame),Z.readPixels(B,S,T,M,Z.RGBA,Z.UNSIGNED_BYTE,W),Do(Z),P){for(;_>=j;j++)for(var N=_-j,f=_+j,K=N;f>=K;K++)for(var H=N;f>=H;H++)if((K===N||K===f||H===N||H===f)&&(p=d.info(W,4*(K*T+H)))){if(C&&C(p)===!1)continue;return p}}else for(;g>j;j+=4)if(p=d.info(W,j)){if(C&&C(p)===!1)continue;b=p.data,k[b._id]||(y.add(b),k[b._id]=b)}return y},info:function(D,g){return this.gv.pickColorMap[(D[g]<<16)+(D[g+1]<<8)+D[g+2]+((127&D[g+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var p=this,t=p.gv,r=t.getGL();if(r){var Q=p._resolution=t._pickerResolution*t.getDevicePixelRatio(),c=Math.round(Q*t.getWidth()),w=Math.round(Q*t.getHeight()),F=r.RGBA,y=r.TEXTURE_2D,l=r.RENDERBUFFER,z=r.FRAMEBUFFER;if(p.texture||(p.texture=eq(r),p.render=r.createRenderbuffer(),p.frame=r.createFramebuffer()),(p.width!==c||p.height!==w)&&(r.activeTexture(r.TEXTURE0),ik(r,p.texture),r.texImage2D(y,0,F,c,w,0,F,r.UNSIGNED_BYTE,G),Rp(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.bindRenderbuffer(l,p.render),r.renderbufferStorage(l,r.DEPTH_COMPONENT16,c,w),jk(r,p.frame),r.framebufferTexture2D(z,r.COLOR_ATTACHMENT0,y,p.texture,0),r.framebufferRenderbuffer(z,r.DEPTH_ATTACHMENT,l,p.render),ik(r,G),r.bindRenderbuffer(l,G),Do(r),p.width=c,p.height=w),p._iv){p._iv=!1;var s=!1;t._40Q.each(function(D){!s&&D.isBatchInvalid()&&(s=!0)}),s&&t.updateScene(),jk(r,p.frame),r.clear(r.COLOR_BUFFER_BIT),t.overlappingBox.clear(),t.setViewport(r,0,0,c,w),t.renderPickScene(),Do(r)}}}});var Io=function(D){this.gv=D};mj(Io,t,{gap:0,size:0,_42:function(K,N){var Z=this,y=Z.gv,b=y._gridGap,J=y._gridSize;if(y._gridVisible){if(Z.gap!==b||Z.size!==J){for(var C=[],z=y._gridSize/2,Q=b*z,c=0;2*z+1>c;c++){var $=6*c,k=6*(2*z+1)+$;C[$]=-Q,C[$+1]=0,C[$+2]=-Q+c*b,C[$+3]=Q,C[$+4]=0,C[$+5]=-Q+c*b,C[k]=-Q+c*b,C[k+1]=0,C[k+2]=-Q,C[k+3]=-Q+c*b,C[k+4]=0,C[k+5]=Q}Z.vs=new Hg(C),Z.gap=b,Z.size=J}es(y),wd(K,N),Kn(K),Yp(K,N,1,y._gridColor,y._buffer.vs,Z.vs),co(K,0,Z.vs.length/3,K.LINES),qq(K),sg(K,N)}else Z.vs=Z.gap=Z.size=G}});var An=function(c){this.gv=c};mj(An,t,{_42:function(C,m){var n=this.gv,R=n._buffer.vs,V=n._axisXColor,l=n._axisYColor,W=n._axisZColor,L=n._originAxisVisible,h=n._centerAxisVisible;if(L||h){var p=jr?C.TRIANGLES:C.TRIANGLE_FAN,a=C.LINES;if(es(n),wd(C,m),Kn(C),L){var U=n.getCenterInfo(),I=S(U.width,U.height)/5,Y=.8*I,M=.05*I;Yp(C,m,1.5,V,R,new Hg([0,0,0,I,0,0,Y,M,0,Y,0,M,Y,-M,0,Y,0,-M,Y,M,0,0,0,0,0,I,0,M,Y,0,0,Y,M,-M,Y,0,0,Y,-M,M,Y,0,0,0,0,0,0,I,M,0,Y,0,M,Y,-M,0,Y,0,-M,Y,M,0,Y])),co(C,0,2,a),co(C,1,6,p),Yp(C,m,G,l),co(C,7,2,a),co(C,8,6,p),Yp(C,m,G,W),co(C,14,2,a),co(C,15,6,p)}if(h){var N=n._center,e=N[0],y=N[1],J=N[2],U=n.getPositionInfo(N);I=S(U.width,U.height)/20,Yp(C,m,1.5,V,R,new Hg([e,y,J,e+I,y,J,e,y,J,e,y+I,J,e,y,J,e,y,J+I])),co(C,0,2,a),Yp(C,m,G,l),co(C,2,2,a),Yp(C,m,G,W),co(C,4,2,a)}qq(C),sg(C,m)}}});var ec=function(Z){this.gv=Z},qb="edit_tx",Cs="edit_ty",Ch="edit_tz",Mq="edit_rx",Ug="edit_ry",Ds="edit_rz",Es="edit_sx",Fs="edit_sy",Gs="edit_sz",Hs={};Hs[qb]=101,Hs[Cs]=102,Hs[Ch]=103,Hs[Mq]=104,Hs[Ug]=105,Hs[Ds]=106,Hs[Es]=107,Hs[Fs]=108,Hs[Gs]=109,mj(ec,t,{_42:function(l,k,U){var q=this,m=q.gv,L=m.sm().ld();if(L&&m.isEditable(L)&&!m.isEditHelperDisabled()&&ge(L)&&(!m.isFirstPersonMode()||!m.isMouseRoamable()&&!yr)){es(m);var B,n=m.isMovable(L),M=m.isRotationEditable(L),E=m.isSizeEditable(L),N=m._axisXColor,I=m._axisYColor,r=m._axisZColor,$=m._editSizeColor,i=L.p3();if(m.isOrtho()){var e=m.getCenterInfo();B=S(e.width,e.height)/8}else B=qj(m.getEye(),i)/10;var G,j,F=B/(U?5:10),Q=.7*B,b=.4*Q,V=i[0],g=i[1],d=i[2];G=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],n&&q._17O(l,k,L,U,qb,N,G,[V,g-F,d,V+Q,g-F,d,V+Q,g,d,V+Q,g,d,V,g,d,V,g-F,d,V,g-F,d+F,V+Q,g-F,d+F,V+Q,g-F,d,V+Q,g-F,d,V,g-F,d,V,g-F,d+F]),j=V+Q,E&&q._17O(l,k,L,U,Es,$,G,[j,g-F,d,j+b,g-F,d,j+b,g,d,j+b,g,d,j,g,d,j,g-F,d,j,g-F,d+F,j+b,g-F,d+F,j+b,g-F,d,j+b,g-F,d,j,g-F,d,j,g-F,d+F]),j+=b,M&&q._17O(l,k,L,U,Mq,N,G,[j,g-F,d,j+b,g-F,d,j+b,g,d,j+b,g,d,j,g,d,j,g-F,d,j,g-F,d+F,j+b,g-F,d+F,j+b,g-F,d,j+b,g-F,d,j,g-F,d,j,g-F,d+F]),G=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],n&&q._17O(l,k,L,U,Cs,I,G,[V,g,d,V,g+Q,d,V-F,g+Q,d,V-F,g+Q,d,V-F,g,d,V,g,d,V,g,d,V,g,d-F,V,g+Q,d-F,V,g+Q,d-F,V,g+Q,d,V,g,d]),j=g+Q,E&&q._17O(l,k,L,U,Fs,$,G,[V,j,d,V,j+b,d,V-F,j+b,d,V-F,j+b,d,V-F,j,d,V,j,d,V,j,d,V,j,d-F,V,j+b,d-F,V,j+b,d-F,V,j+b,d,V,j,d]),j+=b,M&&q._17O(l,k,L,U,Ug,I,G,[V,j,d,V,j+b,d,V-F,j+b,d,V-F,j+b,d,V-F,j,d,V,j,d,V,j,d,V,j,d-F,V,j+b,d-F,V,j+b,d-F,V,j+b,d,V,j,d]),G=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],n&&q._17O(l,k,L,U,Ch,r,G,[V,g,d,V,g,d+Q,V,g-F,d+Q,V,g-F,d+Q,V,g-F,d,V,g,d,V,g-F,d,V-F,g-F,d,V-F,g-F,d+Q,V-F,g-F,d+Q,V,g-F,d+Q,V,g-F,d]),j=d+Q,E&&q._17O(l,k,L,U,Gs,$,G,[V,g,j,V,g,j+b,V,g-F,j+b,V,g-F,j+b,V,g-F,j,V,g,j,V,g-F,j,V-F,g-F,j,V-F,g-F,j+b,V-F,g-F,j+b,V,g-F,j+b,V,g-F,j]),j+=b,M&&q._17O(l,k,L,U,Ds,r,G,[V,g,j,V,g,j+b,V,g-F,j+b,V,g-F,j+b,V,g-F,j,V,g,j,V,g-F,j,V-F,g-F,j,V-F,g-F,j+b,V-F,g-F,j+b,V,g-F,j+b,V,g-F,j])}},_17O:function(e,Z,I,s,Y,S,W,g){var A=this.gv,q=A._buffer,L=Gh.for(e),u=L.directUniforms(),o=L.directAttribs();if(A._picking){s=A.pickColorMap;var J=Hs[Y];s[J]={data:I,part:Y},u.uFixPickReverseColor=Ml(J)}ld(e,Z,G,!0,G,!0,G,!1),u.uDiffuse=S,o.aPosition=xe(e,q.vs,new Hg(g),G),o.aNormal=xe(e,q.ns,new Hg(W),G),Kn(e),co(e,0,12),qq(e),tm(e,Z)}});var Is=q.Raycaster=function(g){this.gv=g,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Eg("Raycaster",t,{intersect:function(V){var g=this,B=g.gv,T=B.getDataAt(V);return T?g.intersectObject(V,T):null},intersectObjects:function(S,G,h){var R,Z,F,m,U=this,t=1/0,n=S.origin||(new tb).fromArray(U.gv.getEye()),H=U.maxTriangleTest,v=[];G.forEach(function(q){h&&h(q)===!1||q.s("intersect")!==!1&&v.push(q)});var q=n.distanceToSquared2([0,0,0]);return v.sort(function(d,v){return(d.p3?n.distanceToSquared2(d.p3()):q)-(v.p3?n.distanceToSquared2(v.p3()):q)}),U.countTriangles=0,v.forEach(function(M){U.countTriangles>H||(R=U.intersectObject(S,M),R&&(Z=n.distanceToSquared(R.world),t>Z&&(F=M,m=R,t=Z)))}),U.countTriangles=0,{data:F,intersect:m}},intersectObject:function(J,e){if(J instanceof eo)return this._intersectObjectImpl(J,e);var S=this,j=S.gv,C=j.unproject(J),$=new tb,T=j.getEye(),W=new tb;if(j.isOrtho()){var g=new tb(T);W.copy(j.getCenter()).sub(g).normalize();var I=$.copy(C).sub(g).dot(W);$.copy(W).setLength(-I).add(g.copy(C))}else $.copy(T),W.copy(C).sub($).normalize();var o=new q.Math.Ray($,W);return S._intersectObjectImpl(o,e)},_intersectObjectImpl:function(){function u(){var T=new tb;return T.subVectors(x,$),l.subVectors(K,$),T.cross(l).normalize(),T}function F(T,j,V,d,m,x,I){return Db.barycoordFromPoint(T,j,V,d,S),m.multiplyScalar(S.x),x.multiplyScalar(S.y),I.multiplyScalar(S.z),m.add(x).add(I),m.clone()}var h=new ds,A=new ds,o=new eo,M=new tb,v=new tb,r=new tb,s=new tb,t=new tb,K=new tb,$=new tb,x=new tb,a=new ac,p=new ac,Q=new ac,l=new tb,P={vs:ze,is:Kj,uv:Jm},S=new tb,X=Xq.slice(0);return X.push("csg"),function(Z,I){var L=this.gv.getData3dUI(I),_=I.mat||L.mat;_?h.fromArray(_):h.identity(),A.getInverse(h),o.copy(Z).applyMatrix4(A);var D,B,Y,R="body",J=L.shapeModel;if(!J&&(I instanceof q.Polyline||I instanceof q.Edge)&&L.lineShapeModel&&(J=L.lineShapeModel),J||(J=ff(L)),J||(q.CSGNode&&I instanceof q.CSGNode||q.CSGShape&&I instanceof q.CSGShape?(Y=!0,J=[L.left,L.front,L.right,L.back,L.top,L.bottom,L.csg]):I instanceof q.Node&&!(I instanceof q.Shape)?(D=!0,J=P):(B=!0,J=[L.left,L.front,L.right,L.back,L.top,L.bottom])),!J)return console.log("Can not find shape model."),null;bf(J)||(J=[J]);var N,z,O,i,l,E,e,V,H,S,U,C,j,d,k,y,m=1/0,c=["","top_","bottom_"],g=!1,G=this.backfaceCulling,f=[];for(Ci(J,L,f),N=0,z=f.length;z>N;N++)if(j=f[N])for(O=0,i=c.length;i>O;O++)if(d=c[O],e=j[d+"vs"],V=j[d+"is"],H=j[d+"uv"]||j[d+"tuv"],e){if(k=j[d+"boundingBox"]){var U=o.intersectBox(k);if(!U)continue;if(o.origin.distanceTo(U)>m)continue;y=!1}else j[d+"boundingBox"]=k=new q.Math.Box3,y=!0;for(l=0,E=V?V.length:e.length/3;E>l;l+=3)this.countTriangles++,V?(v.fromArray(e,3*V[l]),r.fromArray(e,3*V[l+1]),s.fromArray(e,3*V[l+2])):(v.fromArray(e,3*l),r.fromArray(e,3*(l+1)),s.fromArray(e,3*(l+2))),y&&(k.expandByPoint(v),k.expandByPoint(r),k.expandByPoint(s)),S=o.intersectTriangle(v,r,s,G,M),S&&(C=o.origin.distanceTo(S),m>C&&(m=C,t.copy(S),K.copy(v),$.copy(r),x.copy(s),""!==d?R=d.slice(0,-1):D?R=Xq[Math.floor(l/6)]:B?R=Xq[N]:Y&&(R=X[N]),H&&(g=!0,V?(a.fromArray(H,2*V[l]),p.fromArray(H,2*V[l+1]),Q.fromArray(H,2*V[l+2])):(a.fromArray(H,2*l),p.fromArray(H,2*(l+1)),Q.fromArray(H,2*(l+2))))))}if(!isFinite(m))return null;var T,w=t.clone().applyMatrix4(h);g&&(T=F(t,K,$,x,a,p,Q));var b=u(K,$,x),W=u(K.applyMatrix4(h),$.applyMatrix4(h),x.applyMatrix4(h)),n=o.direction.dot(b);return n>0&&(b.multiplyScalar(-1),W.multiplyScalar(-1)),{world:w,local:t.clone(),worldNormal:W,normal:b,uv:T,part:R}}}()});var Js=function(L,W){this.gv=L,this.s=function(z,n,Q){return n==G&&(n=Q),n==G?W.getStyle(z):$b(n,W,L)},this.data=W};mj(Js,t,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:D,iv:function(){this._iv=!0},update:function(K,u,h){var Y=this,e=Y.data;if(K||(K=Y.gv,u=K.getGL(),h=u._40Q),!Y.needValidate(u)||!K.isVisible(e))return h.push(this,!1),void 0;var _,F,g,Z,v,k=e._id,z=Y.s("autorotate")||Y.s("shape3d.autorotate")||Y.s("fixSizeOnScreen")||Y.s("shape3d.fixSizeOnScreen")?null:Y.s("batch"),N=e.getRenderLayer(),f=h.get(N,!0),c=f.batchIndexMap,D=f.batchModelMap,L=K.getBrightness(e),$=L!=G&&1!==L;_=ip(c,D,e,z,K);var s=Y.validate(_,z?K.getBatchInfo(z)||_d:G);if(_&&(F=c[k],g=F.size=_.vs.length/3-F.begin,v=_.rs))for(L=$?L:1,Z=0;g>Z;Z++)v.push(L);var r=K.getWireframeGeometry(e);if(r)Rf(K,e,r);else if(ge(e)){var R=K.getWireframe(e);R&&Rf(K,e,R)}Y.labelInfo=Y.label2Info=Y.noteInfo=Y.note2Info=Y._38o=G,Y._24O(Me,"getLabel"),Y._24O(Am,"getLabel2"),Y._26O(uk,"getNote"),Y._26O(Te,"getNote2"),Y._15O(),Y.interactiveInfo=K.isInteractive(e)?{}:G,f.push(this,!0),s!==!1&&(Y._iv=!1)},clearWireframeGeometryCache:function(){var A=this;Od(A),A.data.iv()},_46Q:function(h){var V=this,R=V.data,t=V.gv;if(t.isVisible(R)){var e=R._id,v=t._40Q.get(R._renderLayer,!0),H=v.batchIndexMap[e],m=v.polylineIndexMap[e],L=v.wireframeIndexMap[e];if(H||m||L){var W=zr(h,t.pickColorMap,t.isSelectable(R),R,Sr,!0);W&&(ul(W,H,v.batchModelMap),ul(W,m,v.polylineModelMap),ul(W,L,v.wireframeModelMap))}}},_42:function(M,Q,r){function b(k,P,q){var U=P.getBrightness(q),j=q.s("alphaTest"),e=q.s("envmap"),J=Gh.for(k),F=J.directUniforms();U!=G&&1!==U&&(F.uBrightness=U),F.uAlphaTest=j,F.uUseEnvMap=e?!0:!1,F.uReflectivity=e||.01,F.shadowReceive=!z&&q.s("shadow.receive"),F.shadowCull=!z&&!!q.s("shadow.cull");var i=R.s("3d.clip.direction");if(i){var s=R.s("3d.clip.percentage");0===s&&(V=!1);var Q=R._formatClipUniforms(i,s,q);F.uClipPercent=Q[1],F.uClipDirection=Q[0]}else F.uClipDirection=0;k._blooming&&!q.s("bloom")&&(F.blackout=!0)}var R=this,P=R.data,H=R.gv;if(H.isVisible(P)){var x,z=H._picking;if(z)x=H.pickColorMap;else{if(H.isTransparentMask(P)||H.isReflecting(M)&&P.s("3d.reflectable")===!1)return;x=D}if(Js.getTitle===D){Js.getTitle=0;for(var g in m)if(g.length===Am.length+1&&g[Am.length]===Kh[4].toUpperCase()&&g[Am.length-1]===Kh[Am.length+1].toUpperCase()){Js.getTitle=Gg;break}}if(!Js.getTitle||Wm[Am.length+2]){if(Js.getHead===D){Js.getHead=0;for(var g in I){var f="box-sizing";6===g.length&&g[0]===Kh[4]&&g[3]===f[0]&&g[4]===f[1]&&g[5]===f[2]&&(Js.getHead=Gg)}}if(!Js.getHead||Wm[Am.length]){var t,J,h=P._id,X=H._40Q.get(P._renderLayer,!0),s=X.batchIndexMap,$=X.batchModelMap,T=H.isSelectable(P),j=!1,V=!0,N=s[h];if(z&&(J=zr(M,x,T,P,Sr,N),J&&!H._45Q&&(ul(J,N,$),ul(J,X.polylineIndexMap[h],X.polylineModelMap),ul(J,X.wireframeIndexMap[h],X.wireframeModelMap))),N||(j||(j=!0,b(M,H,P)),V&&R._80o(M,Q,r)),H.isLabelVisible(P)&&((t=R.labelInfo)&&(z&&zr(M,x,T,P,Me),j||(j=!0,b(M,H,P)),R._28O(t,Me,r)),(t=R.label2Info)&&(z&&zr(M,x,T,P,Am),j||(j=!0,b(M,H,P)),R._28O(t,Am,r))),H.isNoteVisible(P)&&((t=R.noteInfo)&&(z&&zr(M,x,T,P,uk),j||(j=!0,b(M,H,P)),R._29O(t,uk,r)),(t=R.note2Info)&&(z&&zr(M,x,T,P,Te),j||(j=!0,b(M,H,P)),R._29O(t,Te,r))),(t=R._38o)&&(j||(j=!0,b(M,H,P)),R._99O(M,Q,t,x,T,r)),j){var n=Gh.for(M).directUniforms();n.uBrightness=1,n.uClipDirection=0,M._blooming&&(n.blackout=!1)}}}}},_formatClipUniforms:function(d,I,O){switch(d){case"left":d=2;break;case"top":d=3;break;case"bottom":d=4;break;case"front":d=5;break;case"back":d=6;break;case"right":default:d=1}if(0===d%2&&(I=1-I),O instanceof q.Shape){var r=O.s3(),A=O.p3(),o=O.getAnchor3d();I=3>d?(I-o.x)*r[0]+A[0]:5>d?(I-o.y)*r[1]+A[1]:(I-o.z)*r[2]+A[2]}else I-=.5;return[d,I]},prepare:function(){var i=this,v=i.data;if(!(v instanceof Ep)){var U,J,j,Z,a,z=i.gv,A=z.getGL(),C=v._id,I=i.s("batch"),X=z._batchIndexMap,y=z._batchModelMap,O=z.getBrightness(v),s=O!=G&&1!==O;if(i.needValidate(A)){if(U=ip(X,y,v,I,z),i.validate(U,I?z.getBatchInfo(I)||_d:G),U&&(J=X[C],j=J.size=U.vs.length/3-J.begin,a=U.rs))for(O=s?O:1,Z=0;j>Z;Z++)a.push(O);if(ge(v)){var R=z.getWireframeGeometry(v);if(R)Rf(z,v,R);else{var q=z.getWireframe(v);q&&Rf(z,v,q)}}i.labelInfo=i.label2Info=i.noteInfo=i.note2Info=i._38o=G,i._24O(Me,"getLabel"),i._24O(Am,"getLabel2"),i._26O(uk,"getNote"),i._26O(Te,"getNote2"),i._15O(),i.interactiveInfo=z.isInteractive(v)?{}:G,i._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=D},getBoundingBox:function(){var T,V,u,s,h,S;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;T||(T={vs:ze,is:Kj,uv:Jm},V=new tb,u=new tb,s=new tb,h=new tb,S=new tb);var n=this,p=n.data,v=n.shapeModel;if(v||p instanceof q.Shape||(v=ff(n)),!v&&p instanceof q.Shape&&(n.prepare(),v=n.shapeModel),v||(p instanceof q.Node&&!(p instanceof q.Shape)?v=T:(n.left||n.front||n.right||n.back||n.top||n.bottom)&&(v=[n.left,n.front,n.right,n.back,n.top,n.bottom])),!v)return D;bf(v)||(v=[v]);var c,k,w,R,Y,j,e,d,O,P,$,F,I=["","top_","bottom_"],i=new q.Math.Box3,x=!1;if(n._needRecoverPosition){h.set.apply(h,p.p3());var m=p.s3();S.set(1/(m[0]||1),1/(m[1]||1),1/(m[2]||1))}else h.set(0,0,0),S.set(1,1,1);for(c=0,k=v.length;k>c;c++)if(O=v[c])for(w=0,R=I.length;R>w;w++)if(P=I[w],e=O[P+"vs"],d=O[P+"is"],e){if(F=P+"boundingBox",$=O[F],!$)for(O[F]=$=new q.Math.Box3,Y=0,j=d?d.length:e.length/3;j>Y;Y+=3)d?(V.fromArray(e,3*d[Y]).sub(h).multiply(S),u.fromArray(e,3*d[Y+1]).sub(h).multiply(S),s.fromArray(e,3*d[Y+2]).sub(h).multiply(S)):(V.fromArray(e,3*Y).sub(h).multiply(S),u.fromArray(e,3*(Y+1)).sub(h).multiply(S),s.fromArray(e,3*(Y+2)).sub(h).multiply(S)),!V.isNaN()&&$.expandByPoint(V),!u.isNaN()&&$.expandByPoint(u),!s.isNaN()&&$.expandByPoint(s);i.expandByBox($),x=!0}return x?(this._cacheBoundingBox=i,t.freeze(i),t.freeze(i.min),t.freeze(i.max),wi(n.gv,p),i):D}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return de},_80o:function(){},dispose:function(){var Y=this,c=Y.data,y=c._pickId;if(y){var j=Y.gv.pickColorMap;j[y]&&delete j[y]}},getBodyColor:function(p){var Z=this.data,Y=this.gv.getBodyColor(Z);return Y?Y:p?Z.getStyle(p):G},getCachedTexture:function(S){var s=this._cachedTextures;return s?s[S||"main"]:null},setCachedTexture:function(h,j){var w=this._cachedTextures;return w||(w=this._cachedTextures={}),w[j||"main"]=h,h},invalidateCachedTexture:function(h){var E=this._cachedTextures;if(E){for(var a in E)h.deleteTexture(E[a]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(u,D){var c=this,Q=c.data,J=c.gv,i=c.s,d=J[D](Q);if(d!=G){var a=i(u+".scale"),e=i(u+".max"),P=c[u+"Info"]={label:d,textureScale:i(u+".texture.scale"),color:J[D+"Color"](Q),font:i(u+".font"),align:i(u+".align"),background:J[D+"Background"](Q)},Z=P.rect=Dm(P,d);e>0&&e<Z.width&&(P.labelWidth=Z.width,Z.width=e),Z.x=Z.y=0,Z.width*=a,Z.height*=a,P.mat=c._16O(i(u+".autorotate"),i(u+".position"),Z,i(u+".face"),i(u+".t3"),i(u+".r3"),i(u+".rotationMode"));var C=Z.width/2,q=Z.height/2;P.vs=new Hg([-C,q,0,-C,-q,0,C,-q,0,C,q,0]),Z.width/=a,Z.height/=a}},_26O:function(j,d){var C=this,L=C.data,e=C.gv,H=C.s,y=e[d](L);if(y!=G){var t=H(j+".scale"),v=this[j+"Info"]={note:y,textureScale:H(j+".texture.scale"),expanded:H(j+".expanded"),font:H(j+".font"),color:H(j+".color"),align:H(j+".align"),borderWidth:H(j+".border.width"),borderColor:H(j+".border.color"),background:e[d+"Background"](L)};if(v.expanded){var Y=H(j+".max"),l=Dm(v,y);l.width+=6,l.height+=2,Y>0&&Y<l.width&&(v.labelWidth=l.width,l.width=Y);var X={x:-l.width/2,y:-8-l.height,width:l.width,height:l.height+8}}else X={x:-6,y:-18,width:12,height:18};v.mat=C._16O(H(j+".autorotate"),H(j+".position"),G,H(j+".face"),H(j+".t3"),H(j+".r3"),H(j+".rotationMode")),v.rect=X,1!==t&&(X=gl(X),X.x*=t,X.height*=t,X.y=-X.height,X.width*=t);var A=X.x,R=X.y,Z=X.width,P=X.height;v.vs=new Hg([A,-R,0,A,-R-P,0,A+Z,-R-P,0,A+Z,-R,0])}},eachShapeModel:function(v,$){function G(z){Vg(z),z.vs&&v(z.vs,z.is,z.ns,z.uv),z.top_vs&&v(z.top_vs,z.top_is,z.top_ns,z.top_uv),z.bottom_vs&&v(z.bottom_vs,z.bottom_is,z.bottom_ns,z.bottom_uv),z.from_vs&&v(z.from_vs,z.from_is,z.from_ns,z.from_uv),z.to_vs&&v(z.to_vs,z.to_is,z.to_ns,z.to_uv)}function l(u){var P,f,O;if(bf(u))for(f=0,O=u.length;O>f;f++)P=u[f],P&&l(P);else on(u)?l(ff(a,u),a):vc(u)&&(u.shape3d?l(u.shape3d):G(u))}var a=this,k=a.data,$=$||a.shapeModel||ff(a);$||($=k instanceof q.Node&&!(k instanceof q.Shape)?{vs:ze,is:Kj}:[a.left,a.front,a.right,a.back,a.top,a.bottom]),l($)},_28O:function(j,c,_){if(_(this.s(c+".transparent"))){var a=j.rect,Z=j.textureScale,N=a.width*Z,H=a.height*Z;if(N>=1&&H>=1){var F=ri(N,H);1!==Z&&(F.translate(a.x,a.y),F.scale(Z,Z),F.translate(-a.x,-a.y)),Zb(F,j),F.restore(),Ah(this,c,j.mat,j.vs,!0)}}},_29O:function(o,H,a){if(a(this.s(H+".transparent"))){var Z=o.rect,n=o.textureScale,J=Z.x,I=Z.y,Q=Z.width*n,$=Z.height*n;if(Q>=1&&$>=1){Z.x=Z.y=0;var U=ri(Q,$);1!==n&&U.scale(n,n),Yj(U,o),U.restore(),Z.x=J,Z.y=I,Ah(this,H,o.mat,o.vs,!1)}}},_99O:function(C,Q,k,H,m,J){if(k){var v=this,T=v.gv,e=v.data,r=T._buffer,F=T._1O,Z=k.icons,l=Gh.for(C),n=l.directAttribs();for(var _ in Z){var E=Z[_],z=k.rects[_];if(z&&J($b(E.transparent,e,T))){T._picking&&zr(C,H,m,e,_);var p=$b(E.shape3d,e,T),u=p?[p]:$b(E.names,e,T),h=u?u.length:0,K=$b(E.textureScale,e,T)||1,S=$b(E.light,e,T);S==G&&(S=p?!0:!1),ld(C,Q,$b(E.blend,e,T),S,$b(E.opacity,e,T),$b(E.reverseFlip,e,T),$b(E.reverseColor,e,T),$b(E.reverseCull,e,T));for(var N=0;h>N;N++){var P=u[N],$=z[N];if(Lq(v,$.mat),p)io(T,e,ff(v,p),v);else{var q=Nd(P);if(q){var b=$.width*K,i=$.height*K;if(b>=1&&i>=1){var t=ri(b,i);gr(t,q,$b(E.stretch,e,T),0,0,b,i,e,T),t.restore(),eq(C,el,F),Kn(C,Q,F,$b(E.discardSelectable,e,T),r.uv,qp),n.aPosition=xe(C,r.vs,$.vs,G),n.aNormal=im(C,r.ns,ki,G),pf(C,r.is,nh),ek(C,0,nh.length),qq(C,Q,F)}}}gf(T)}tm(C,Q)}}}}});var Ks=function(X,d){ln(Ks,this,[X,d])};mj(Ks,Js,{_16O:function(b,t,C,V,I,Y,B,K,U){var h=this.data,Q=h.getFinalScale3d(),l=js(t,Q,C,V,K,U);if(h.hasOwnProperty("_anchor")||h.hasOwnProperty("_anchorElevation")){var y=h.getAnchor3d();l[0]-=(y.x-.5)*Q[0],l[1]-=(y.y-.5)*Q[1],l[2]-=(y.z-.5)*Q[2]}return ad(Mj(),l,h.p3(),V,I,Y,B,b,h.getFinalRotation3d(),h.getRotationMode())},clear:function(){var i=this;i.faceMat=i.mat=i.shapeModel=i.left=i.right=i.front=i.back=i.top=i.bottom=i.csg=G},needValidate:function(a){if(this._iv)return this._validateFrameId=a._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var O=a._renderInfo.frame;if(this._validateFrameId!==O)return this._validateFrameId=O,!0}return!1},validate:function(P,y){var q=this,j=q.gv,c=q.data,O=q.shapeName=q.s(ig),l=ff(q,O);if(q._updateAutoRotation(),q._updateFixSize2d(),q._updateOverlapping(),q.dispatchBoundingBoxChanged(),this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")){var C=c.getRenderLayer(),w=j._40Q.get(C);w&&w.ivWireframeBatch(c)}var m=Yb(c,j.getMat(c),l?q.s("shape3d.scaleable"):!0);if(c.appendAnchorMatrix3d(m),q.clear(),q.mat=c.mat=m,l||!O)if(q.shapeModel=l,P)if(l)$d(j,c,l,q,q.getBodyColor(),[m],P);else{var i=fo(m);So(j,c,P,y,m,i,xb,Gp),So(j,c,P,y,m,i,ui,Bq),So(j,c,P,y,m,i,am,El),So(j,c,P,y,m,i,ye,xs),So(j,c,P,y,m,i,rs,mf),So(j,c,P,y,m,i,hb,ci)}else l||(q._cubeUvs=null,q.vf(xb,0),q.vf(ui,16),q.vf(rs,8),q.vf(hb,24),q.vf(am,32),q.vf(ye,40))},_updateAutoRotation:function(){var Y=new lh,b=new ds,u=new tb,s=new tb,G=new tb;return function(){var c=this,y=c.data,t=c.s("autorotate")||c.s("shape3d.autorotate");if(!t)return y._dynamicRotation&&delete y._dynamicRotation,void 0;var q=c.gv;G.copy(c.s("shape3d.autorotate.up")||q._up);var $;$="string"==typeof t?[t.indexOf("x")<0?q._eye[0]:q._center[0],t.indexOf("y")<0?q._eye[1]:q._center[1],t.indexOf("z")<0?q._eye[2]:q._center[2]]:q._eye;var h=q._center,p=y.p3();u.copy(p),s.set($[0]-h[0],$[1]-h[1],$[2]-h[2]).add(u),b.lookAt(s,u,G),Y.set(0,0,0,y.getRotationMode(),!0).setFromRotationMatrix(b);var g=y._dynamicRotation;g&&Math.abs(g[0]-Y.x)<1e-5&&Math.abs(g[1]-Y.y)<1e-5&&Math.abs(g[2]-Y.z)<1e-5||(y._dynamicRotation=[Y.x,Y.y,Y.z])}}(),_updateFixSize2d:function(){var v=this,Y=v.data,q=v.s("fixSizeOnScreen")||v.s("shape3d.fixSizeOnScreen");if(!q)return Y._dynamicScale3d&&delete Y._dynamicScale3d,void 0;var w=v.gv,r=Yb(Y,w.getMat(Y)),M=Be([0,0,0],r),o=w.toViewPosition(M);if(!isNaN(o.x)&&!isNaN(o.y)){var Q=Be([1,0,0],r),e=w.toViewPosition(Q),N=Be([0,1,0],r),H=w.toViewPosition(N),p=e.x-o.x,J=H.y-o.y;if(p&&J){var m,z,k=Y._dynamicScale3d||[1,1,1],B=Nd(Y.s("shape3d.image"));if(q[0]>0&&(m=q[0]),q[1]>0&&(z=q[1]),!m||!z){var Z=q>0?q:1;m||(m=(Ur(B,Y)||Y.getWidth())*Z),z||(z=(wb(B,Y)||Y.getTall())*Z)}var n=Math.abs(p/m),b=Math.abs(J/z);Math.abs(n-1)<.001&&Math.abs(b-1)<.001||(Y._dynamicScale3d=[k[0]/n,k[1]/b,k[2]])}}},_updateOverlapping:function(){var q=this,X=q.s("hide.overlapping.group");if(!X)return q._rectOverlapping&&(q._rectOverlapping=D),void 0;var M,W,e,w=q.gv,F=q.data,Q=Yb(F,w.getMat(F)),g=1/0,Y=1/0,$=-1/0,T=-1/0,o=F.getAnchor3d(),n=o.x,S=o.y,H=o.z;for(M=0;8>M;M++){if(W=Be([(M>>2)-n,(1&M>>1)-S,(1&M)-H],Q),e=w.toViewPosition(W),isNaN(e.x)||isNaN(e.y))return;g=Math.min(g,e.x),$=Math.max($,e.x),Y=Math.min(Y,e.y),T=Math.max(T,e.y)}var j={x:g,y:Y,w:$-g,h:T-Y};q._rectOverlapping=w.overlappingBox.isOverlapping(X,j)},getVectorDynamicSize:function(){var W,C=this,I=C.s("shape3d"),c=C.data;if("billboard"===I||"plane"===I||(W=c._currentCubeElementId)!=G){var h,o,k=C.gv,n=Yb(c,k.getMat(c)),j=c.getAnchor3d(),u=.5-j.x,l=.5-j.y,F=.5-j.z,s=Math.min(C.s("vector.dynamic.maxsize"),k._glCapabilities.maxTextureSize)/k.getDevicePixelRatio(),r=function(d,K){d[0]+=u,d[1]+=l,d[2]+=F,K[0]+=u,K[1]+=l,K[2]+=F;var z=k.toViewPosition(Be(d,n)),f=k.toViewPosition(Be(K,n)),g=z.x-f.x,v=z.y-f.y;return Math.min(s,Math.sqrt(g*g+v*v))};if("billboard"===I)h=r([-.5,0,0],[.5,0,0]),o=r([0,-.5,0],[0,.5,0]);else if("plane"===I)h=r([-.5,0,0],[.5,0,0]),o=r([0,0,-.5],[0,0,.5]);else if(c._currentCubeElementId!=G){var q=3*Kj[W+1],V=3*Kj[W],b=3*Kj[W+2];h=r([ze[q],ze[q+1],ze[q+2]],[ze[b],ze[b+1],ze[b+2]]),o=r([ze[q],ze[q+1],ze[q+2]],[ze[V],ze[V+1],ze[V+2]])}return[h,o]}},vf:function(R,o){var N=this;if(N.gv.getFaceVisible(N.data,R)){var K=dm(N,R);K.mat&&(N.faceMat=!0);var d=K.uv;if(d){var L=N._cubeUvs;L||(L=N._cubeUvs=new Hg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var E=0;8>E;E++)L[o+E]=d[E]}return K}},_billboardInView:function(){var _=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],k=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],t=new jl,R=new tb,z=new ds;return function(G){var r=this;if(!r.mat)return!0;var x=r.gv.getFrustum(),A="billboard"===G?_:k;t.makeEmpty(),z.fromArray(r.mat);for(var u=0,v=A.length;v>u;u+=3)t.expandByPoint(R.fromArray(A,u).applyMatrix4(z));return x.intersectsBox(t)}}(),_80o:function(O,t,n){var z=this;if(z._rectOverlapping)return!0;var y=z.shapeModel;if(y||!z.shapeName){var A=z.s("shape3d");if(("billboard"===A||"plane"===A)&&!z._billboardInView(A))return!0;var Y=z.gv,K=z.data,Z=Y._cube,B=Gh.for(O),l=B.directAttribs();if(Ko&&!cj){var g=z.mat;if(g)for(var D=0;D<g.length;D++)z.mat[D]=g[g.length-D-1]}es(Y,z.mat),z.s("shape3d.reflector")&&!O._picking||(y?io(Y,K,y,z,z.getBodyColor(),n):(l.aPosition=xe(O,Z.vs,G,G),l.aNormal=xe(O,Z.ns,G,G),Ro(O,Z.is),z._18O(O,t,"left",0,n),z._18O(O,t,"front",6,n),z._18O(O,t,"right",12,n),z._18O(O,t,"back",18,n),z._18O(O,t,"top",24,n),z._18O(O,t,"bottom",30,n))),gf(Y),z.faceMat&&(z._18O(O,t,"left",0,n,!0),z._18O(O,t,"front",6,n,!0),z._18O(O,t,"right",12,n,!0),z._18O(O,t,"back",18,n,!0),z._18O(O,t,"top",24,n,!0),z._18O(O,t,"bottom",30,n,!0))}},_18O:function(J,U,K,y,P,$){var r=this[K];if(r){if(!P(r.transparent))return;if($&&!r.mat||!$&&r.mat)return;var W=this.data.s("polygonOffset");W&&th(J,W),$&&es(this.gv,r.mat);var f=this,N=f.data,F=Gh.for(J),Q=F.directUniforms();N._currentCubeElementId=y;var C=f.gv,M=C.getTexture(r.texture,N,K),c=r.uv,X=r.uvScale,D=r.uvOffset,u=r.uvRotation,t=r.discardSelectable;M?c?Kn(J,U,M,t,C._buffer.uv,f._cubeUvs,D,X,u):Kn(J,U,M,t,C._cube.uv,G,D,X,u):Kn(J),ld(J,U,r.blend,r.light,r.opacity,r.reverseFlip,r.reverseColor,r.reverseCull),Q.uDiffuse=r.color||e["color.empty"],ek(J,y,6),tm(J,U),qq(J,U,M),$&&gf(C),W&&$o(J),N._currentCubeElementId=null}},drawReflector:function(){var C=new tb,o=new tb,g=new lh,H=new ds,R=new tb,e=new tb,l=new tb,c=new tb,f=new ds,b=new ds,K=new Di,L=new lk,Z=new lk,n=function(X,T,y){X[y]=T[0],X[y+1]=T[1],X[y+2]=T[2]},w=function(F,c){n(F,c.getEye(),0),n(F,c.getCenter(),3),n(F,c.getUp(),6)},j=function(f,s){s._eye=[f[0],f[1],f[2]],s._center=[f[3],f[4],f[5]],s._up=[f[6],f[7],f[8]],s._18Q=G;var b=s._skybox;b&&(b.p3([f[0],f[1],f[2]]),s.getData3dUI(b).iv())};return function(u){var x=this;x._reflectorInfo=null;var X=x.data;if(X._reflecting)return!1;var A=x.gv;if(A._picking)return!1;var k=x._reflectorRenderTarget,Y=A._canvas.width,p=A._canvas.height;k?k.setSize(u,Y,p):k=x._reflectorRenderTarget=new Dl.RenderTarget(A,u,Y,p),C.copy(X.p3()),o.copy(A.getEye()),H.makeRotationFromEuler(g.set(X.r3(),X.getRotationMode(),!0));var J;if(!x._reflectNormal){var J=ff(x,x.s("shape3d"));if(!J)return!1;if(!J.ns&&J.length&&(J=J[0]),!J.ns||!J.vs)return!1;x._reflectNormal=[J.ns[0],J.ns[1],J.ns[2]],x._reflectorVbuffer=Mr.Buffer.createVertexBuffer(u,new Float32Array(J.vs))}if(R.copy(x._reflectNormal),R.applyMatrix4(H),e.subVectors(C,o),e.dot(R)>0)return!1;e.reflect(R).negate(),e.add(C),l.copy(A.getCenter()).negate().add(C),l.reflect(R).negate(),l.add(C),c.copy(A.getUp()),c.reflect(R);var z=[0,0,0,0,0,0,0,0,0];w(z,A),A._eye=e.toArray(),A._center=l.toArray(),A._up=c.toArray(),A._18Q=G;var v=A._skybox;v&&(v.p3(A._eye),A.getData3dUI(v).iv()),jk(u,k.frame),A.setViewport(u,0,0,k.width,k.height);var P=X.s("shape3d.reflector.background");if(P){var M=u.getParameter(u.COLOR_CLEAR_VALUE);lj(u,P)}else lj(u,[0,0,0,1]);Gh.for(u).glState.depth.mask=!0,u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT);var m=X.s("shape3d.reflector.clip"),d=m===D?.003:m,r=vd(A),n=Qj(A);K.setFromNormalAndCoplanarPoint(R,C.add(R.clone().multiplyScalar(d))),K.applyMatrix4(b.fromArray(n)),L.set(K.normal.x,K.normal.y,K.normal.z,K.constant),b.fromArray(r).getInverse(b),Z.set(Math.sign(L.x),Math.sign(L.y),1,1).applyMatrix4(b),L.multiplyScalar(2/L.dot(Z)),r[2]=L.x-r[3],r[6]=L.y-r[7],r[10]=L.z-r[11],r[14]=L.w-r[15];var Q=A._computedProjectMatrix;A._computedProjectMatrix=r,X._reflecting=!0,A.renderScene({renderAxis:!1,renderEdit:!1,renderGrid:!1}),A._computedProjectMatrix=Q,f.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),f.multiply(b.fromArray(A._projectMatrix)),f.multiply(b.fromArray(A._viewMatrix)),P&&lj(u,M),Do(u),j(z,A);var t=X.s("shape3d.reflector.blur");if(t){var s=A.getPostProcessingModule("Blur");s&&s.drawImpl(u,k,t,t>=3,X.s("shape3d.reflector.blur.iterations"))}var I=u._compiledShader.reflector;I||(I=u._compiledShader.reflector=new Mr.Shader(u,Or.Reflector.vs,Or.Reflector.fs)),I.bind(),u.activeTexture(u.TEXTURE0),ik(u,k.texture),I.uniforms.tDiffuse=0,I.uniforms.color=Xi(X.s("shape3d.reflector.color")||"rgb(128,128,128)"),I.uniforms.textureMatrix=f.toArray(),I.uniforms.modelMatrix=Yb(X),I.uniforms.viewMatrix=Qj(A),I.uniforms.projectionMatrix=vd(A),x._reflectorVbuffer.upload(),I.attributes.pos.pointer(x._reflectorVbuffer);var V=this.s("shape3d.transparent");if(V){var y=Gh.for(u).glState,N=y.depth.mask;y.depth.mask=!1}return u.drawArrays(u.TRIANGLES,0,6),V&&(y.depth.mask=N),X._reflecting=!1,u.useProgram(A._prg),ik(u,G),!0}}()}),Or.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ls=function(M,E){ln(Ls,this,[M,E])};mj(Ls,Ks,{_80o:function(){}});var Ms=function(w,I){ln(Ms,this,[w,I])};mj(Ms,Js,{_25Q:1,validate:function($){var W=this;if(!W.s("geometry.cache")||!W.info){var Q=W.gv,V=W.data,U=W.s,q=U("edge.width"),b=V._40I,v=V._41I;if(W.shapeModel=W.info=W.lineShapeModel=G,b&&v){var p,z,L,w,r,Y,F,E,M,o,X=V.isLooped(),I=U(cd),K=m.getEdgeType(I);if(K){var O=K(V,Gk(W,Q,V,X,I),Q,W._19Q);if(!O.points||O.points.isEmpty())return;Y=W.info={},F=O.segments,r=O.points,E=r.size();for(var B=b.getElevation(),_=v.getElevation(),l=0;E>l;l++){var k=r.get(l);k.e==G&&(k.e=B+(_-B)*l/(E-1))}M=Vn(r.get(0)),o=Vn(r.get(E-1));var t=E%2;0===t?(Y.c1=Vn(r.get(E/2-1)),Y.c2=Vn(r.get(E/2))):Y.p3=Vn(r.get((E-t)/2)),Y.s1=M,Y.s2=Vn(r.get(1)),Y.t1=Vn(r.get(E-2)),Y.t2=o}else{r=new pq,Y=W.info={};var A=U("edge.offset"),H=U("edge.center"),g=U("edge.source.t3"),h=U("edge.target.t3"),y=sr(Q,V,"source"),T=sr(Q,V,"target");if(!y||!T)return Q.invalidateData(V),delete W.info,!1;if(g&&(y[0]+=g[0],y[1]+=g[1],y[2]+=g[2]),h&&(T[0]+=h[0],T[1]+=h[1],T[2]+=h[2]),I===gj){F=U("edge.segments");var a=Y.points=U(Ig)||Vi;if(E=a.size()){M=Vn(a.get(0)),o=Vn(a.get(E-1)),!H&&A&&(L=mm(M,y,!0),A=S(A,qj(y,M)),y=[y[0]+L[0]*A,y[1]+L[1]*A,y[2]+L[2]*A],L=mm(T,o,!0),A=S(A,qj(o,T)),T=[T[0]-L[0]*A,T[1]-L[1]*A,T[2]-L[2]*A]);var t=E%2;0===t?(p=Vn(a.get(E/2-1)),z=Vn(a.get(E/2))):Y.p3=Vn(a.get((E-t)/2)),Y.s1=y,Y.s2=M,Y.t1=o,Y.t2=T
}else!H&&A&&(L=mm(T,y,!0),w=qj(y,T),A=Ik(A,w),y=[y[0]+L[0]*A,y[1]+L[1]*A,y[2]+L[2]*A],T=[T[0]-L[0]*A,T[1]-L[1]*A,T[2]-L[2]*A]),p=y,z=T;r.add({x:y[0],y:y[2],e:y[1]}),r.addAll(a),r.add({x:T[0],y:T[2],e:T[1]})}else{var i=Gk(W,Q,V,X,I);if(W._19Q||(i=-i),X){var R=y[0],N=y[1],J=y[2],u=b.getTall()/2+i;p=[R-i,N+u,J],z=[R+i,N+u,J],r.add({x:R-i,y:J,e:N}),r.add({x:R-i,y:J,e:N+u}),r.add({x:R+i,y:J,e:N+u}),r.add({x:R+i,y:J,e:N})}else{L=mm(T,y,!0),w=qj(y,T);var f={x:y[0],y:y[2]},e={x:T[0],y:T[2]},P=Qk(G,f,e,i),d=P.x-f.x,D=P.y-f.y;A=Ik(A,w),L[0]*=A,L[1]*=A,L[2]*=A,p=[y[0]+L[0]+d,y[1]+L[1],y[2]+L[2]+D],z=[T[0]-L[0]+d,T[1]-L[1],T[2]-L[2]+D],H?(r.add({x:y[0],y:y[2],e:y[1]}),r.add({x:p[0],y:p[2],e:p[1]}),r.add({x:z[0],y:z[2],e:z[1]}),r.add({x:T[0],y:T[2],e:T[1]})):(r.add({x:p[0],y:p[2],e:p[1]}),r.add({x:z[0],y:z[2],e:z[1]}))}}Y.c1=p,Y.c2=z}Y._lastPointsSegments={points:r,segments:F},Y.list=U(ig)===Jq?W.createTubeModel(r,F,q/2,$):W.createLineModel(r,F,q,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=G}});var Ns=function(R,d){ln(Ns,this,[R,d]),this._needRecoverPosition=!0};mj(Ns,Ks,{_80o:function(o,Y,V){var v=this,h=v.mat;if(h){var Z=v.gv,C=v.shapeModel;es(Z,h),C?io(Z,v.data,C,v,v.getBodyColor(),V):(yb(v,o,Y,"left",V),yb(v,o,Y,"front",V),yb(v,o,Y,"right",V),yb(v,o,Y,"back",V),yb(v,o,Y,"top",V),yb(v,o,Y,"bottom",V)),gf(Z)}},validate:function($,O){var h,v,p=this,E=p.s,A=p.data,j=A._thickness/2,i=A.isClosePath(),P=A.getPoints(),_=A.getSegments(),B=E(Po),H=$&&$.uv;if(p.clear(),p.dispatchBoundingBoxChanged(),0>j){try{var l=E("shape3d.image.projection");if(l&&l[4]){var R=A.p3(),r=R[0],S=R[2];l=[r+l[0],l[1]-S,r+l[2],l[3]-S]}v=p.shapeModel=tr(P,_,E(ah),E(tl),B,E(Eq),A.getTall(),A.getShapeElevation(),i,l)}catch(u){v=p.shapeModel={}}E(We)?E("shape3d.image")||delete v.uv:(delete v.vs,delete v.ns,delete v.uv),E("shape3d.top.image")||delete v.top_uv,E("shape3d.bottom.image")||delete v.bottom_uv}else if(E(ig)===Jq)h=ns(P,_,B,i),v=p.shapeModel={vs:[]},E("shape3d.image")&&(v.uv=[],v.sum=E(Eq)||Vc(h)||1,v.len=0),E(ah)&&!i&&(v.top_vs=[],E("shape3d.top.image")&&(v.top_uv=[])),E(tl)&&!i&&(v.bottom_vs=[],E("shape3d.bottom.image")&&(v.bottom_uv=[])),p._12O(h,j);else{var Y,K,o,X,z,g,b,U,t,M;if(h=ns(P,_,B,i),z=p.vf(rs,H,!1,O),j&&(g=p.vf(hb,H,!1,O),b=i?G:p.vf(xb,H,!1,O),U=i?G:p.vf(ui,H,!1,O),t=p.vf(am,H,!1,O),M=p.vf(ye,H,!1,O)),j){for(var e=0,m=h.length;m>e;e++)h[e]=p._tryRemoveBezierPoints(h[e],j);p._12O(h,j)}else z&&h.forEach(function(h){if(X=h.length,X>0)for(Y=h[0],o=1;X>o;o++)K=h[o],p.addV(z.vs,Y,K),Y=K});p._20Q(h),$||(z&&(z.ns=Gb(z.vs),_n(z,"vs"),_n(z,Wk)),j&&(g&&(g.ns=Gb(g.vs),_n(g,"vs"),_n(g,Wk)),b&&(b.ns=Gb(b.vs),_n(b,"vs"),_n(b,Wk)),U&&(U.ns=Gb(U.vs),_n(U,"vs"),_n(U,Wk)),t&&(t.ns=Gb(t.vs),_n(t,"vs"),_n(t,Wk)),M&&(M.ns=Gb(M.vs),_n(M,"vs"),_n(M,Wk))))}var C=p.mat=A.getPointsMatrix3d().getElements();$&&(Wc(p,C,$,v),p.clear())},_20Q:function(e){var x,J,q,t,K,n,$,M=this,o=M.front,W=M.back,F=M.top,Q=M.bottom,E=o?o.tuv:G,D=W?W.tuv:G,X=F?F.tuv:G,P=Q?Q.tuv:G,v=0;(E||D||X||P)&&(x=M.s(Eq)||Vc(e)||1,e.forEach(function(c){if(J=c.length,J>0)for(n=c[0],q=1;J>q;q++)$=c[q],t=v/x,v+=qj(n,$),K=v/x,M._14O(o,t,K),M._14O(W,1-K,1-t),M._14O(F,t,K),M._14O(Q,t,K),n=$}))},_14O:function(F,y,q){if(F){var T=F.uv,s=F.tuv;if(s){if(T)var j=T[0]+(T[6]-T[0])*y,R=T[1]+(T[7]-T[1])*y,h=T[2]+(T[4]-T[2])*y,b=T[3]+(T[5]-T[3])*y,O=T[2]+(T[4]-T[2])*q,E=T[3]+(T[5]-T[3])*q,l=T[0]+(T[6]-T[0])*q,m=T[1]+(T[7]-T[1])*q;else j=y,R=0,h=y,b=1,O=q,E=1,l=q,m=0;s.push(h,b,O,E,l,m,l,m,j,R,h,b)}}},_13O:function(n){var q=n.uv,O=n.tuv;O&&(q?O.push(q[2],q[3],q[4],q[5],q[6],q[7],q[6],q[7],q[0],q[1],q[2],q[3]):O.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(f,V){var C=f.length;if(4>C)return f;var v,H,z,P,M,t,A=!1,q=function(X){return f[X]},R=function(X){return f[C-1-X]};for(M=0;1>=M;M++)for(t=M?R:q,H=t(0),z=t(1),v=2;C-1>v;v++)if(P=t(v),!P.remove)if(P.b){var Z=Qk(H,z,P,V);Z.adjust?(P.remove=!0,A=!0):(H=z,z=P)}else H=z,z=P;if(!A)return f;var l=[];for(v=0;C>v;v++)f[v].remove||l.push(f[v]);return l},_12O:function(m,B){var w,t,H,J,r,U=this.s("shape3d.point.epsilon"),n=this;m.forEach(function(i){if(r=i.length,r>0)for(w={p:i[0],n:!0},J=1;r>J;J++)t=i[J],H=r-1>J?i[J+1]:G,H&&Math.abs(t.x-H.x)<U&&Math.abs(t.y-H.y)<U||n.addPoint(w,t,H,B,i)})},addPoint:function(g,K,j,N,p){var R,D,f,F,$,O,u,V,J,m=this,s=g.p,X=g.f,T=g.b,w=m.s("shape3d.side")||om,x=m.s("shape3d.start.angle"),y=m.s("shape3d.sweep.angle"),Y=m.shapeModel,e=m.data.isClosePath();if(g.n&&(g.n=!1,X=e&&p.length>2?Qk(p[p.length-2],s,K,N):Qk(G,s,K,N),T=Pp(s,X),Y?Y.top_vs&&m._10O(T,X,w,x,y,Y.top_vs,Y.top_uv):(R=m.left)&&(m.addV(R.vs,T,X),m._13O(R))),D=j?Qk(s,K,j,N):e&&p.length>2?Qk(s,K,p[1],N):Qk(s,K,G,N),f=Pp(K,D),Y){var E,d,i=Y.vs,b=Y.uv,z=Y.sum;for(b&&(E=Y.len/z,Y.len+=qj(s,K),d=Y.len/z),O=m._9O(T,X,w,x,y),u=m._9O(f,D,w,x,y),V=0;w>V;V++)J=V+1,bi(i,O[J]),bi(i,u[V]),bi(i,O[V]),bi(i,u[V]),bi(i,O[J]),bi(i,u[J]),b&&(F=V/w,$=J/w,b.push(E,$,d,F,E,F,d,F,E,$,d,$));!j&&Y.bottom_vs&&m._10O(f,D,w,x,y,Y.bottom_vs,Y.bottom_uv,!0)}else!j&&(R=m.right)&&(m.addV(R.vs,D,f),m._13O(R)),(R=m.front)&&m.addV(R.vs,X,D),(R=m.back)&&m.addV(R.vs,f,T),(R=m.top)&&m.addH(R.vs,X,D,f,T,!0),(R=m.bottom)&&m.addH(R.vs,T,f,D,X);g.p=K,g.f=D,g.b=f},_10O:function(I,W,N,T,d,n,b,B){var X,Q,r=this,G=r.data,c=r._9O(I,W,N,T,d),t=(I.x+W.x)/2,l=(I.y+W.y)/2,O=G.getShapeElevation(),p=0;for(p=0;N>p;p++)B?(bi(n,c[p]),bi(n,c[p+1])):(bi(n,c[p+1]),bi(n,c[p])),bi(n,[t,O,l]),b&&(B?(X=k*(p+1)/N+T,Q=k*p/N+T):(X=k*p/N+T,Q=k*(p+1)/N+T),b.push(.5-.5*Z(Q),.5-.5*P(Q),.5-.5*Z(X),.5-.5*P(X),.5,.5))},_9O:function(q,T,U,u,a){var Q,Y,O=this,v=O.data,h=[],D=(q.x+T.x)/2,r=(q.y+T.y)/2,d=v.getTall()/2,L=v.getShapeElevation(),X=0;for(a==G&&(a=k);U>=X;X++)Q=a*X/U+u,Y=Z(Q),h.push([D+(q.x-D)*Y,L+d*P(Q),r+(q.y-r)*Y]);return h},addV:function(E,i,l){var P=i.x,v=i.y,k=l.x,T=l.y,O=this.data,d=O.getShapeElevation(),U=O.getTall()/2;E.push(P,d-U,v,k,d-U,T,k,d+U,T,k,d+U,T,P,d+U,v,P,d-U,v)},addH:function(Q,g,H,G,T,d){var l=this.data,k=l.getTall()/2,J=l.getShapeElevation()+(d?k:-k);Q.push(g.x,J,g.y,H.x,J,H.y,G.x,J,G.y,G.x,J,G.y,T.x,J,T.y,g.x,J,g.y)},vf:function(y,I,$,Z){var E,t=this,x=t.gv.getFaceVisible(t.data,y);return($||x)&&(E=dm(t,y,Z),E.vs=[],E.tuv=x&&(E.texture||I)?[]:G,E.visible=x),E}});var Os=function(L,v){ln(Os,this,[L,v])},Ps={},Qs=function(a){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(a)};mj(Os,Ks,{validate:function(){var z=this,K=z.gv,s=z.data,g=z.s,V=Xi(g("points.color")),E=g("points.size"),M=g("points.uv.offset"),d=g("points.image");!d||Qs(d)||Sb.test(d)||(Ps[d]||(Ps[d]=z._createCachedImage(d)),d=Ps[d]);var i,j,F=s._modelDirty,c=g("points.model");if(c){if(z._lastShapeModel!==c||!z.shapeModel){var u=ff(z,c);if(!u)return;var G=[],W={};z.eachShapeModel(function(O){for(var $=0,i=O.length;i>$;$+=3){var S=O[$],H=O[$+1],g=O[$+2],Y=""+S+"_"+H+"_"+g;W[Y]||(W[Y]=!0,G.push(S,H,g))}},u),z._setShapeModelPoints(new Hg(G)),z._lastShapeModel=c,F=!0}i=z.shapeModel.vs.length,j=i/3}else{var l=s.getPoints();if(j=i=l.length,F||s._pointsDirty||!z.shapeModel){for(var e=[],C=0;j>C;C++){var T=l[C];T&&e.push(T.x,T.e,T.y)}z._setShapeModelPoints(new Hg(e)),s._pointsDirty=!1,z._lastShapeModel=null,F=!0}}if(z.info={mat:Yb(s),size:E,diffuse:V,opacity:g("points.opacity"),texture:d,alphaTest:g("points.transparent")?0:g("alphaTest"),uvScale:g("points.uv.scale"),uvOffset:M,discardSelectable:g("points.discard.selectable")},F||s._colorsDirty){var b=!1,P=s.getColors();if(P&&P.length>0)for(var H=[],C=0;j>C;C++)for(var q=P[C],U=q?(b=!0,Xi(q)):V,I=4*C,N=0;4>N;N++)H[I+N]=U[N];z.shapeModel.cs=b?new Hg(H):null,s._colorsDirty=!1}if(F||s._sizesDirty){var m=!1,J=s.getSizes();if(J&&J.length>0)for(var r,Z=[],C=0;j>C;C++)r=J[C],r>=0?(Z.push(r),m=!0):Z.push(E);z.shapeModel.ss=m?new Hg(Z):null,s._sizesDirty=!1}if(F||s._offsetsDirty){var A=!1,$=s.getUvoffsets();if($&&$.length>0)for(var B,x,n,L=[],C=0;j>C;C++)B=2*C,x=$[B],n=$[B+1],x!=D&&n!=D?(L.push(x,n),A=!0):L.push(M[0],M[1]);z.shapeModel.os=A?new Hg(L):null,s._offsetsDirty=!1}if(F||z._lastPointNumber!==j){this.dispose();var k=K.pickColorMap,f=z._startPickId=k._pickIdUsed;k._pickIdUsed=f+j;for(var e=[],C=0;j>C;C++){var t=f+C,h=Ml(t);e.push(h[0],h[1],h[2],h[3]),k[t]||(k[t]={data:s,part:C})}z.shapeModel.ps=new Hg(e),z._lastPointNumber=j}s._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(T){var b=this,q=b.shapeModel,E=b.shapeModel={vs:T};if(!q)return E;var H=T.length,d=Math.round(H/3);return q.cs&&q.cs.length==4*d&&(E.cs=q.cs),q.ss&&q.ss.length==d&&(E.ss=q.ss),q.os&&q.os.length==2*d&&(E.os=q.os),q.ps&&q.ps.length==4*d&&(E.ps=q.ps),E},_createCachedImage:function(m){var g=128,N=Ae(),r=N.getContext("2d");Ek(N,g,g,1),Rb(r,{width:g,height:g,comps:[{type:m,background:"white",borderWidth:0,rect:[0,0,g,g]}]},0,0,g,g);var y=q.Math.generateUUID();return Sn[y]=N,y},_80o:function(K,l){var F=this,c=F.gv,C=c._picking;if(!C||c.isSelectable(F.data)){var E=F.shapeModel,p=F.info;if(E&&E.vs&&E.vs.length){var W=Gh.for(K);W.useProgram(F._asureProgram(K));var Y=W.directUniforms(),b=W.directAttribs();Y.modelMatrix=p.mat,Y.modelViewMatrix=Sg([],c._viewMatrix,p.mat),Y.projectionMatrix=c._projectMatrix,Y.viewMatrix=c._viewMatrix,Y.scale=c.getHeight()/2,Y.size=p.size,Y.diffuse=p.diffuse,Y.opacity=p.opacity,Y.map=c.getTexture(p.texture,F.data),Y.alphaTest=p.alphaTest,Y.resolution=c.getDevicePixelRatio(),Y.discardSelectable=p.discardSelectable,Y.uvScale=p.uvScale,b.uvOffset=!C&&E.os?im(K,c._buffer.os,E.os,G):p.uvOffset,Y.blackout=K._blooming&&!F.data.s("bloom"),b.position=im(K,c._buffer.vs,E.vs,G),C?(Y.picking=!0,b.pickColor=im(K,c._buffer.ps,E.ps,G),Y.useColor=!1,b.color=null):(Y.picking=!1,b.pickColor=null,E.cs?(Y.useColor=!0,b.color=im(K,c._buffer.cs,E.cs,G)):(Y.useColor=!1,b.color=null)),E.ss?(Y.useSizeArray=!0,b.sizeArray=im(K,c._buffer.ss,E.ss,G)):(Y.useSizeArray=!1,b.sizeArray=null),co(K,0,E.vs.length/3,K.POINTS),W.useProgram(l),b.disable(),c.shadowMap.enable&&c.shadowMap.createShadow()}}},_asureProgram:function(L){return L._pointsShader||(L._pointsShader=this.gv._postProcessing.createShader(L,Os.shaderSrc)),L._pointsShader.program},dispose:function(){Os.superClass.dispose.call(this);var r=this._startPickId,k=this._lastPointNumber;if(r&&k){for(var j=this.gv.pickColorMap,R=0;k>R;R++){var G=r+R;j[G]&&delete j[G]}delete this._startPickId,delete this._lastPointNumber}}}),Os.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var Rs=function(s,E){ln(Rs,this,[s,E]),this._needRecoverPosition=!0};mj(Rs,Js,{_25Q:1,validate:function(y){var h=this,$=h.data,D=h.s,b=$.getPoints(),_=b.size();h.dispatchBoundingBoxChanged();var K=$.p3(),I=h.mat=Mj();pe(I,K),hc(I,$.getFinalRotation3d(),$.getRotationMode());var F=$.getScale3d(),W=$._dynamicScale3d;if(W&&(F[0]*=W[0],F[1]*=W[1],F[2]*=W[2]),Ac(I,F),pe(I,eg(K)),(!h.s("geometry.cache")||!h.shapeModel)&&(h.shapeModel=h.info=h.lineShapeModel=G,_>1)){var V=h.info={},r=$.getSegments(),M=$.getThickness(),u=Vn(b.get(0)),v=Vn(b.get(_-1)),T=_%2;0===T?(V.c1=Vn(b.get(_/2-1)),V.c2=Vn(b.get(_/2))):V.p3=Vn(b.get((_-T)/2)),V.s1=u,V.s2=Vn(b.get(1)),V.t1=Vn(b.get(_-2)),V.t2=v,V.list=D(ig)===Jq?h.createTubeModel(b,r,M/2,y):h.createLineModel(b,r,M,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=G},_80o:function(j,r,g){var $=this,h=$.shapeModel;if(h){var S=$.gv;es(S,$.mat),io(S,$.data,h,$,$.getBodyColor(),g),gf(S)}}});var Ss=q.graph3d.PostProcessing=function(h){function x(){if(!S){var i=h.getGL();S=new Dl.RenderTarget(h,i,null,null,{samples:e.renderTextureSamples||1,minFilter:i.LINEAR,magFilter:i.LINEAR}),R=new Mr.Shader(i,u.vs,u.fs),s=Mr.Buffer.createIndexBuffer(i,new Uint16Array([0,2,1,1,2,3])),H=Mr.Buffer.createVertexBuffer(i,new Float32Array([0,0,1,0,0,1,1,1]))}}var S,R,s,H,B=this,b={},N=!1;!function(){t.keys(Ss).forEach(function(Z){b[Z]=new Ss[Z](h)})}(),B.getModule=function(K){return K?b[K]:B},B.getModuleList=function(){return t.keys(b)},B._serializable=!0,B.handleDataModleChange=function(b,T){b&&(B._serializable&&b.setPostProcessingData(B.serialize()),b.removeSerializeListener(B.onDataModelSerialize,B)),T&&(T.addSerializeListener(B.onDataModelSerialize,B),B.deserialize(T))},B.onDataModelSerialize=function(f){"serialize"===f.type?B._serializable&&(h.dm()._postProcessingData=B.serialize()):"deserialize"===f.type&&B.deserialize(h.dm())},B.isDeserializeDisabled=function(p){return!B._serializable||p.a("sceneBloom")!==D},B.isSerializable=function(){return B._serializable},B.setSerializable=function(l){B._serializable=l,l||h.dm().setPostProcessingData(D)},B.serialize=function(){var u,U,r,z,w={};for(U in b)if(r=b[U],z=r.serializeProperties){u={},r.enable&&(u.enable=!0);for(var _ in z){var v=r[_];v!=z[_]&&(u[_]=v)}t.keys(u).length&&(w[U.toLowerCase()]=u)}return w},B.deserialize=function(R){var s,g,d,r,W,C={},l={};for(s in b){d=b[s],r=d.serializeProperties;var S={},N="scene"+s,V=R.a(N);V!==D&&(S.enable=V);for(var W in r)V=R.a(N+W[0].toUpperCase()+W.slice(1)),V!==D&&V!==r[W]&&(S[W]=V);_k(S)||(l[s[0].toLowerCase()+s.slice(1)]=S)}if(_k(l)&&(l=R.getPostProcessingData()),l)for(g in l)if(g&&(s=g[0].toUpperCase()+g.slice(1),d=b[s])){C[s]=!0,r=l[g];var c=!!r.enable;B.enableModule(s,c),s="scene"+s,R.a(s,c),d.resetProperties&&d.resetProperties();for(W in r)if("enable"!==W){var V=r[W];d[W]=V,R.a(s+W[0].toUpperCase()+W.slice(1),V)}}for(s in b)C[s]||(d=b[s],d.enable=!1,d.resetProperties&&d.resetProperties())},B.getRenderTarget=function(){return S},B.blitScreen=function(w,l,i,y,k){var Y=h.getGL();if(Y){w&&(w.bind(Y),h.setViewport(Y,0,0,w.width,w.height)),k&&k.clear===!1||Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),x(),i||(i=R),i.bind(),Y.activeTexture(Y.TEXTURE0+0),ik(Y,l);var e=i.uniforms;e.image=0;var c=1;if(y)for(var n in y){var D=y[n];D instanceof WebGLTexture&&(Y.activeTexture(Y.TEXTURE0+c),ik(Y,D),D=c,c++),e[n]=D}if(s.upload(),H.upload(),i.attributes.pos.pointer(H),Y.drawElements(Y.TRIANGLES,6,Y.UNSIGNED_SHORT,0),c>1)for(;--c>=0;)Y.activeTexture(Y.TEXTURE0+c),ik(Y,null);else ik(Y,null);w&&w.unbind(Y)}},B.decodeShader=function(_){var z,y,e,o="",Q="";for(e=0;e<_.length;e++)z=_[e],"%"===z?z="'":"a"===z?z='"':"]"===z&&(z="\\"),y=String.fromCharCode(z.charCodeAt(0)-1),e%2?Q+=y:o=y+o;return Q+o},B.createShader=function(S,P,h){var W,T;if("string"==typeof P){var q=P.indexOf("^#");W=B.decodeShader(P.substr(0,q)),T=B.decodeShader(P.substr(q+2))}else W=P.vs,T=P.fs;if(h){var G=h(W,T);G&&G.vs&&(W=G.vs),G&&G.fs&&(T=G.fs)}return new Mr.Shader(S,W,T)},B.enableModule=function(v,S){var u,f,j,e=v.split(",");for(u=0,f=e.length;f>u;u++)j=e[u].trim(),b[j]&&(b[j].enable=S);N=!1;for(j in b)if(b[j].enable){N=!0;break}N&&x()};var u=B.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};B.render=function(Q,W,G,R){if(N){S.setSize(Q,W,G),S.bind(Q);var Z=Q.getParameter(Q.COLOR_CLEAR_VALUE);Z&&0===Z[0]&&0===Z[1]&&0===Z[2]&&0===Z[3]?Z=null:lj(Q,[0,0,0,0]),Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT),h.setViewport(Q,0,0,W,G),R=R||{};var z=R.renderAxis!==!1,D=R.renderEdit!==!1;R.renderAxis=R.renderEdit=!1,h.renderScene(R),S.unbind(Q);for(var M=0,O=h._glCapabilities.maxAttributes;O>M;M++)Q.disableVertexAttribArray(M);var u,t=S;for(u in b)t=b[u]._42(Q,t)||t;h.setViewport(Q,0,0,W,G),Z&&lj(Q,Z);var I=B.getModule("Fxaa");return I&&I.enable?B.blitScreen(null,t.texture,I.getShader(Q),{resolution:[1/W,1/G]}):B.blitScreen(null,t.texture),Q.useProgram(h._prg),h._renderAxisAndEditHelper(z,D),!0}}},Ts=q.graph3d.PostProcessing.HueSaturation=function(U){function D(){_=!0;var k=U.getGL();R=new Dl.RenderTarget(U,k),s=U._postProcessing.createShader(k,Ts.hueSaturationShader),p=Mr.Buffer.createIndexBuffer(k,new Uint16Array([0,2,1,1,2,3])),T=Mr.Buffer.createVertexBuffer(k,new Float32Array([0,0,1,0,0,1,1,1]))}var p,T,s,R,w=this,N=!1,_=!1,x=[],S=[],A=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var b=this.serializeProperties;for(var t in b)this[t]=b[t]},this.resetProperties(),t.defineProperties(w,{enable:{get:function(){return N},set:function(W){!!N!=!!W&&(N=W,W&&!_&&D(),U.iv())}},hue:{get:function(){return x.map(function(V){return i(180*V)})},set:function(E){if(x!==E&&7===E.length){for(var u=0;7>u;u++)x[u]=E[u]/180;U.iv()}}},saturation:{get:function(){return S.map(function(A){return i(100*A)})},set:function(F){if(S!==F&&7===F.length){for(var O=0;7>O;O++)S[O]=F[O]/100;U.iv()}}},lightness:{get:function(){return A.map(function(t){return i(100*t)})},set:function(y){if(A!==y&&7===y.length){for(var L=0;7>L;L++)A[L]=y[L]/100;U.iv()}}}}),w._42=function(a,E){if(N){_||D();var F=E.width,J=E.height;if(F&&J){R.setSize(a,F,J),jk(a,R.frame),U.setViewport(a,0,0,R.width,R.height),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),s.bind(),a.activeTexture(a.TEXTURE0+0),ik(a,E.texture);var Q=s.uniforms;return Q.image=0,Q.hue=x,Q.saturation=S,Q.lightness=A,p.upload(),T.upload(),s.attributes.pos.pointer(T),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0),ik(a,null),Do(a),R}}}};Ts.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var Us=q.graph3d.PostProcessing.Bloom=function(o){function y(){var f=o.getGL();if(f)for(var I=o._postProcessing,W=0;m>W;W++)g[W]=I.createShader(f,Us._35Q,function(L,I){return{fs:I.replace(/DEFINE_VALUE/g,S[W]).replace("%OVERRIDE_ALPHA_DEFINE%",C?"#define OVERRIDE_ALPHA":"")}})}function e(){var C=o.getWidth(),D=o.getHeight();if(C&&D){U=[C,D],K=!0;var l,T=o.getGL(),J=Math.round(U[0]/2),X=Math.round(U[1]/2);for($=new Dl.RenderTarget(o,T,J,X),l=0;m>l;l++)n.push(new Dl.RenderTarget(o,T,J,X)),f.push(new Dl.RenderTarget(o,T,J,X)),J=Math.round(J/2),X=Math.round(X/2);var t=o._postProcessing;R=t.createShader(T,Us._34Q),y(),j=t.createShader(T,Us._36Q,function(Q,O){return{fs:O.replace(/NUM_MIPS/g,m)}}),O=t.createShader(T,Us.finalShader),q=Mr.Buffer.createIndexBuffer(T,new Uint16Array([0,2,1,1,2,3])),W=Mr.Buffer.createVertexBuffer(T,new Float32Array([0,0,1,0,0,1,1,1]))}}var u,B,I,C,N,q,W,Q,r=this,Y=!1,K=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var f=this.serializeProperties;for(var c in f)this[c]=f[c]},t.defineProperties(r,{enable:{get:function(){return Y},set:function(M){!!Y!=!!M&&(Y=M,M&&!K&&e(),o.iv())}},strength:{get:function(){return u},set:function(W){u!==W&&(u=W,o.iv())}},threshold:{get:function(){return B},set:function(X){B!==X&&(B=X,o.iv())}},radius:{get:function(){return I},set:function(X){I!==X&&(I=X,o.iv())}},overrideAlpha:{get:function(){return C},set:function(H){!!C!=!!H&&(C=H,K&&y(),o.iv())}},selective:{get:function(){return N},set:function(Y){!!N!=!!Y&&(N=!!Y,o.iv())}}}),this.resetProperties();var $,R,j,O,U=[256,256],n=[],f=[],m=5,S=[3,5,7,9,11],g=[];r._42=function(k,P){function l(N,I,Z,y){jk(k,I.frame),o.setViewport(k,0,0,I.width,I.height),y?y(k):k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),h!==N&&N.bind();var d=0;for(var f in Z){var O=Z[f];O instanceof WebGLTexture&&(k.activeTexture(k.TEXTURE0+d),ik(k,O),O=d,d++),N.uniforms[f]=O}for(h!==N&&(q.upload(),W.upload(),N.attributes.pos.pointer(W),h=N),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0);d--;)k.activeTexture(k.TEXTURE0+d),ik(k,null);Do(k)}if(Y&&(K||(e(),K))){var h;if(N){Q||(Q=new Dl.RenderTarget(o,k)),Q.setSize(k,P.width,P.height),Q.bind(k);var C=k.getParameter(k.COLOR_CLEAR_VALUE);C&&0===C[0]&&0===C[1]&&0===C[2]&&1===C[3]?C=null:lj(k,[0,0,0,1]),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),o.setViewport(k,0,0,P.width,P.height),k._blooming=!0,o.syncRenderState(),o.renderScene(),k._blooming=!1,C&&lj(k,C),Q.unbind(k)}l(R,$,{smoothWidth:.01,luminosityThreshold:B,tDiffuse:N?Q.texture:P.texture});var y,c=$,L=Math.round(U[0]/2),E=Math.round(U[1]/2);for(y=0;m>y;y++)l(g[y],n[y],{colorTexture:c.texture,direction:[1,0],texSize:[L,E]}),l(g[y],f[y],{colorTexture:n[y].texture,direction:[0,1],texSize:[L,E]}),L=Math.round(L/2),E=Math.round(E/2),c=f[y];return l(j,n[0],{blurTexture1:f[0].texture,blurTexture2:f[1].texture,blurTexture3:f[2].texture,blurTexture4:f[3].texture,blurTexture5:f[4].texture,bloomStrength:u,bloomRadius:I,bloomTintColor:[1,1,1]}),l(O,P,{image:n[0].texture},function(w){Gh.for(w).glState.blend.apply({enabled:!0,equation:w.FUNC_ADD,func:[w.SRC_ALPHA,w.ONE]})}),Gh.for(k).glState.blend.apply({equation:k.FUNC_ADD,func:[k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA]}),P}}};Us._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Us._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Us._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Us.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Vs=q.graph3d.PostProcessing.Dof=function(c){function y(){o=!0;var A=c.getGL();x=new Dl.RenderTarget(c,A),v=c._postProcessing.createShader(A,Vs._38Q),k=Mr.Buffer.createIndexBuffer(A,new Uint16Array([0,2,1,1,2,3])),w=Mr.Buffer.createVertexBuffer(A,new Float32Array([0,0,1,0,0,1,1,1]))}var x,v,k,w,V,u,i,M,h=this,S=!1,o=!1,J=pj.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var p=this.serializeProperties;for(var R in p)this[R]=p[R]},t.defineProperties(h,{enable:{get:function(){return S},set:function(H){!!S!=!!H&&(S=H,H&&!o&&y(),c.iv())}},image:{get:function(){return u},set:function(o){u!==o&&(u=o,V&&(c.deleteTexture(J),V=null),c.iv())}},maxblur:{get:function(){return i},set:function(F){i!==F&&(i=F,c.iv())}},aperture:{get:function(){return M},set:function(x){M!==x&&(M=x,c.iv())}}}),this.resetProperties(),h._42=function(G,Q){function Y(L,K,E,F){jk(G,K.frame),c.setViewport(G,0,0,K.width,K.height),F?F(G):G.clear(G.COLOR_BUFFER_BIT|G.DEPTH_BUFFER_BIT),p!==L&&L.bind();var Y=0;for(var v in E){var Z=E[v];Z instanceof WebGLTexture&&(G.activeTexture(G.TEXTURE0+Y),ik(G,Z),Z=Y,Y++),L.uniforms[v]=Z}for(p!==L&&(k.upload(),w.upload(),L.attributes.pos.pointer(w),p=L),G.drawElements(G.TRIANGLES,6,G.UNSIGNED_SHORT,0);Y--;)G.activeTexture(G.TEXTURE0+Y),ik(G,null);Do(G)}if(S){o||y();var p;if(!V){var i=Nd(this.image);if(!i||!i.comps&&!i.tagName)return Q;q.Default.setImage(J,i),V=c.getTexture(J)}var H=Q.width,l=Q.height;if(H&&l)return x.setSize(G,H,l),Y(v,x,{tColor:Q.texture,tDepth:V,aspect:H/l,aperture:this.aperture,maxblur:this.maxblur}),x}}};Vs._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";
var Ws=q.graph3d.PostProcessing.Blur=function(O){function s(){a=!0;var g=O.getGL();j=new Dl.RenderTarget(O,g),N=O._postProcessing.createShader(g,Ws.hBlurShader),J=O._postProcessing.createShader(g,Ws.vBlurShader)}var N,J,j,l,d,C,n,f,Y,m=this,B=!1,a=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var u=this.serializeProperties;for(var y in u)this[y]=u[y]},t.defineProperties(m,{enable:{get:function(){return B},set:function(d){!!B!=!!d&&(B=d,d?O.addRenderLayerListener(y,this):O.removeRenderLayerListener(y,this),d&&!a&&s(),O.iv())}},downSample:{get:function(){return n},set:function(W){n!==W&&(n=W,O.iv)}},value:{get:function(){return C},set:function(l){C!==l&&(C=l,O.iv())}},iterations:{get:function(){return f},set:function(g){f!==g&&(f=g,O.iv())}},layer:{get:function(){return Y},set:function(m){Y!==m&&(Y=m,O.iv())}}}),this.resetProperties();var y=function(T){if(B&&T.layer===Y&&"post"===T.phase){var G=O.getGL();if(!O._picking&&!O.isReflecting(G)){var Q=O._postProcessing.getRenderTarget();Q.unbind(G);for(var F=0,V=O._glCapabilities.maxAttributes;V>F;F++)G.disableVertexAttribArray(F);m.drawImpl(G,Q),Q.bind(G),G.useProgram(O._prg)}}};m._42=function(){},m.drawImpl=function(Q,X,R,T,U){a||s();var g,r;if(X?(g=X.width,r=X.height):(g=O._viewport[2],r=O._viewport[3]),g&&r){var Z=O._postProcessing;"boolean"!=typeof T&&(T=n),R==G&&(R=C),U==G&&(U=f),U=Math.max(1,Math.round(U));var A=Gh.for(Q).glState.depth,h=A.enabled;if(A.enabled=!1,T){R/=2;var y=[g,r];g/=2,r/=2,l||(l=new Dl.RenderTarget(O,Q),d=Z.createShader(Q,Ws.downSampleShader)),l.setSize(Q,g,r),Z.blitScreen(l,X.texture,d,{texelSize:[1/y[0],1/y[1]]}),X.setSize(Q,g,r)}else l&&l.setSize(0,0);j.setSize(Q,g,r);for(var $=[],u=0;U>u;u++)$.push(R),R=Math.max(1,Math.floor(R/2));for(var u=0;U>u;u++){var z=$[U-u-1],i=T&&0===u?l.texture:X.texture;Z.blitScreen(j,i,N,{value:z/g}),T&&u===U-1&&X.setSize(Q,y[0],y[1]),Z.blitScreen(X,j.texture,J,{value:z/r})}return A.enabled=h,X}}};Ws.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Ws.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",Ws.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var Xs=q.graph3d.PostProcessing.Fxaa=function(u){var K,b=this,D=!1;t.defineProperties(b,{enable:{get:function(){return D},set:function(_){!!D!=!!_&&(D=_,u.iv())}}}),b.getShader=function(C){if(K)return K;var $=u.getPostProcessingModule();return K=$.createShader(C,{vs:$.blitScreenShaderSrc.vs,fs:$.decodeShader(Xs.ShaderSourceFs)})},b._42=function(){}};Xs.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Jg(m,{accordionViewExpandIcon:kn(Hh),accordionViewCollapseIcon:kn(Hh,!0),accordionViewLabelColor:_l,accordionViewLabelFont:Dn,accordionViewTitleBackground:vj,accordionViewSelectBackground:Xg,accordionViewSelectWidth:3,accordionViewSeparatorColor:D,splitViewDividerSize:1,splitViewDividerBackground:vj,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:zg,rect:[2,2,12,12],background:Hh}]},propertyViewLabelColor:up,propertyViewLabelSelectColor:_l,propertyViewLabelFont:Dn,propertyViewExpandIcon:kn(Gl),propertyViewCollapseIcon:kn(Gl,!0),propertyViewBackground:Tk,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:nd,propertyViewColumnLineColor:nd,propertyViewSelectBackground:Xg,listViewLabelColor:up,listViewLabelSelectColor:_l,listViewLabelFont:Dn,listViewRowLineVisible:!1,listViewRowLineColor:nd,listViewSelectBackground:Xg,treeViewLabelColor:up,treeViewLabelSelectColor:_l,treeViewLabelFont:Dn,treeViewExpandIcon:kn(cg),treeViewCollapseIcon:kn(cg,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:nd,treeViewSelectBackground:Xg,treeViewDoubleClickToToggle:!0,tableViewLabelColor:up,tableViewLabelSelectColor:_l,tableViewLabelFont:Dn,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:nd,tableViewColumnLineColor:nd,tableViewSelectBackground:Xg,treeTableViewLabelColor:up,treeTableViewLabelSelectColor:_l,treeTableViewLabelFont:Dn,treeTableViewExpandIcon:kn(cg),treeTableViewCollapseIcon:kn(cg,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:nd,treeTableViewColumnLineColor:nd,treeTableViewSelectBackground:Xg,tableHeaderLabelColor:up,tableHeaderLabelFont:Dn,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:pb,tableHeaderBackground:Tk,tableHeaderMoveBackground:Uo,tableHeaderInsertColor:Xg,tableHeaderSortDescIcon:kp(Gl,!0),tableHeaderSortAscIcon:kp(Gl),tabViewTabGap:1,tabViewLabelColor:_l,tabViewLabelFont:Dn,tabViewTabBackground:vj,tabViewSelectWidth:3,tabViewSelectBackground:Xg,tabViewMoveBackground:Uo,tabViewInsertColor:Xg,toolbarLabelColor:up,toolbarLabelSelectColor:_l,toolbarLabelFont:Dn,toolbarBackground:Tk,toolbarSelectBackground:Xg,toolbarItemGap:8,toolbarSeparatorColor:kl},!0);var Ys={translateX:1,sortColumn:1},Zs={sortable:1,sortOrder:1,sortFunc:1},$s={focusData:1},_s={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},at={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},bt=function(R,t){t.add(R),R.hasChildren()&&R.eachChild(function(K){bt(K,t)})},ct=function(L,q,g,d,S,o,P,j,i,J,R){var h,l=g.getValueType(J),p=g.getAlign(J);if(g.getEnumValues(J)){var Z=g.toEnumLabel(q,J),k=zk||0,A=0,z=o,w=m.getTextSize(d,Z).width;return h=Nd(g.toEnumIcon(q,J)),h&&(A=o+zk/2,"center"===p?A+=(j-(k+w))/2:"right"===p&&(A=A+j-(k+w)),Si(L,h,A,P+i/2,J,R),z=A+zk/2),Z!=G&&(h?Se(L,Z,d,S,z,P,j-(z-o),i):Se(L,Z,d,S,o,P,j,i,p)),void 0}return q=g.formatValue(q),q!=G?l===Ld?(zd(L,o,P,j,i,q),void 0):l===zs||!l&&Xd(q)?(h=Nd(q?mg:sd),Si(L,h,o+j/2,P+i/2,J,R),void 0):(Se(L,q,d,S,o,P,j,i,p),void 0):void 0},dt=function(p,o){var T=o.view,L=tf(p),V=o.column||o.property;T.getDataModel().beginTransaction(),o.editor=p,p.info=o,T.setCurrentEditor(p),T.getView().insertBefore(L,T._79O),ne(p,o.editorRect),p.setFocus?p.setFocus():vb(p),p.commitValue=function(X,i){p._17Q&&(p=p._17Q),i||T.setValue(o.data,V,p.getValue?p.getValue():p.value),p.close&&p.close(),Rl(L)},V.onEditorCreated&&V.onEditorCreated(o)},et=function(l,y,F,V,b){var f=lp(l,F),o=y.value,L=y.view,E=b.getValueType(y.data);return f.onblur=f.onchange=function(){L.endEditing()},"input"===l?(o=b.formatValue(o),o!=G&&(f.value=o),f.onkeydown=function(l){lr(l)?L.endEditing():fp(l)&&L.endEditing(!0)},(E===Pn||E===In)&&$(f,Tg,m.numberListener)):l===dk&&V.forEach(function(h){var X=s.createElement("option");X.innerHTML=b.toEnumLabel(h),X.value=h,b.isEnumEqual(o,h)&&(X.selected=!0),ar(f,X)}),dt(f,y),f},ft=q.widget={},gt=function(j,l,f){mj(X+".widget."+j,l,f)};Jg(Qn,{ms_value:function(d){d.getValue=function(M){var l=this.getItemById(M),K=l.element;return on(K)?K:K?K.getValue?K.getValue():K.value:l.selected},d.setValue=function(U,Y){var i=this.getItemById(U);if(i){var H=i.element;H&&!on(H)?H.setValue?H.setValue(Y):H.value=Y:Xd(Y)?(i.selected=Y,this.iv()):(i.element=Y,this.iv())}},d.v=function(F,E){var P=this;if(2===arguments.length)P.setValue(F,E);else{if(!vc(F))return P.getValue(F);for(var K in F)P.setValue(K,F[K])}return P}},_46o:function(J){J._icon=G,J._accessType=G,J._valueType=G,J._editable=!1,J._batchEditable=!0,J._align=xb,J._nullable=!0,J._emptiable=!1,J.setParent=Ck,J.formatValue=function(b){var V=this,e=V._valueType;return V.getEnumValues()?V.toEnumLabel(b):e===zs?!!b:b!=G&&e===Pn?A(b):b},J.setEnum=function(z,O,q,T,P,E,X){var A=this;z&&!bf(z)&&z.values&&(T=z.editable,q=z.icons,O=z.labels,P=z.strict,E=z.maxHeight,X=z.dropDownWidth,z=z.values),Kc(z)&&(z=z._as),Kc(O)&&(O=O._as),Kc(q)&&(q=q._as),A._enumValues=z,A._enumLabels=O,A._enumIcons=q,A._enumEditable=T,A._enumStrict=P==G?!0:P,A._enumMaxHeight=E,A._enumDropDownWidth=X,z&&z.length&&Lk(z[0])&&(A._valueType=In),A.fp("enum",!1,!0)},J.getEnumDropDownWidth=function(){return this._enumDropDownWidth},J.getEnumMaxHeight=function(){return this._enumMaxHeight},J.isEnumEditable=function(){return this._enumEditable},J.getEnumValues=function(){return this._enumValues},J.getEnumLabels=function(){return this._enumLabels},J.getEnumIcons=function(){return this._enumIcons},J.isEnumStrict=function(){return this._enumStrict},J.isEnumEqual=function(H,D){return this._enumStrict?H===D:H==D},J.toEnumLabel=function(Y,H){var f=this,t=f.getEnumValues(H),k=f.getEnumLabels(H);if(t&&k)for(var $=0;$<t.length;$++)if(f.isEnumEqual(Y,t[$]))return k[$];return Y},J.toEnumIcon=function(B,E){var V=this,W=V.getEnumValues(E),L=V.getEnumIcons(E);if(W&&L)for(var K=0;K<W.length;K++)if(V.isEnumEqual(B,W[K]))return L[K];return D}},_45o:function(q){q._87o=function(h,P,c,L,t,p){if(h){var Q=this,K=Q._90I,y=Ic(1);Q._columnLineVisible&&(t-=1),Q._rowLineVisible&&(p-=1),0>=t||0>=p||(Q._90I||(K=Q._90I={}),K[P]||(K[P]=new pq),ne(y,Q.tx()+c,Q.ty()+L,t,p),ar(y,h),Q._view.insertBefore(y,Q._79O),h.onParentAdded&&h.onParentAdded(y),K[P].add(y))}},q._76o=function(){var h=this,v=h._90I;if(v){for(var x in v)v[x].each(function(w){Rl(w)});delete h._90I}},q._77o=function(k){var v=this;if(v._90I){var C=v._90I[k];C&&(C.each(function(p){Rl(p)}),delete v._90I[k])}}},_47o:function(N){N.getValue=function(D,e){return e.getValue?e.getValue(D,e,this):Gg(D,e.getAccessType(),e.getName())},N.setValue=function($,I,i){if(I.isEmptiable($)||""!==i||(i=D),I.isNullable($)||i!=G){var b=this,u=I.getName($),r=I.getAccessType($),w=I.getValueType($);w===Pn&&on(i)?i=Iq(i):w===In&&on(i)?i=parseFloat(i):w===zs&&on(i)&&(i="true"===i),b._batchEditable&&I._batchEditable&&b.isSelected($)?b.sm().each(function(O){I.setValue?I.setValue(O,I,i,b):$i(O,r,u,i)}):I.setValue?I.setValue($,I,i,b):$i($,r,u,i)}},N.setCurrentEditor=function(T){this.endEditing(),this._currentEditor=T,this.redraw()},N.isEditing=function(z,w){var k=this,a=k._currentEditor;if(!a)return!1;if(w){var E=a.info;return E?(E.column||E.property)===w&&E.data===z:!1}return!0},N.endEditing=function(Z){var N=this,q=N._currentEditor;q&&(delete N._currentEditor,q.commitValue&&q.commitValue(q.info,Z),N.redraw(),N.getDataModel().endTransaction())},N.beginEditing=function(X){this.endEditing();var B=this,u=X.column||X.property;if(u.beginEditing)u.beginEditing(X);else{var o=X.data,s=X.value,S=B.getSelectBackground(o),t=u.getEnumValues(o),n=u.getSlider(o),e=u.getColorPicker(o);if(n){var d=pg(ft.Slider,n);return d.setValue(s),d.getView().onblur=function(){B.endEditing()},d.isInstant()&&(d.onValueChanged=function(){B.setValue(o,u,d.getValue())}),dt(d,X),void 0}if(e||u.getValueType(o)===Ld){var L=pg(ft.ColorPicker,e);return L.setValue(s),L.onClosed=function(){B.endEditing()},L.isInstant()&&(L.onValueChanged=function(P,H){B.setValue(o,u,H)}),dt(L,X),L.open(),void 0}if(t){if(ft.ComboBox){var q=new ft.ComboBox;q.setValue(s),q.setValues(t),q.setLabels(u.getEnumLabels(o)),q.setIcons(u.getEnumIcons(o)),q.setEditable(u.isEnumEditable(o)),q.setStrict(u.isEnumStrict(o)),q.setMaxHeight(u.getEnumMaxHeight(o)),q.setDropDownWidth(u.getEnumDropDownWidth(o)),q.onClosed=function(){B.endEditing()},dt(q,X),q.open()}else et(dk,X,S,t,u);return}var F=u.getValueType(o);if(F===zs||Xd(s))return B.setValue(o,u,!s),void 0;if(u.getItemEditor(o)){var y=Kk(u.getItemEditor(o)),r=new y(o,u,B,X),O=r.getView();return O._17Q=r,r.setValue(s),vi(O),dt(O,X),r.editBeginning&&r.editBeginning(),void 0}et("input",X,S,G,u)}}},_44o:function(a){a.init=function(E){var o=this,b=o.th=new vt(E),H=o._view=Qo(1,o);o.tv=o._tableView=E,ar(H,b.getView()),ar(H,E.getView()),b.mp(function(i){i.property===Uc&&o.iv()}),o.iv()},a.getTableView=function(){return this.tv},a.getTableHeader=function(){return this.th},a.getDataModel=function(){return this.tv.dm()},a.getColumnModel=function(){return this.tv.getColumnModel()},a.setColumns=function(W){this.tv.setColumns(W)},a.addColumns=function(o){this.tv.addColumns(o)},a.endEditing=function(){this.tv.endEditing()},a.validateImpl=function(){var w=this,h=w.th,r=ao(h),H={x:0,y:0,width:w.getWidth(),height:r};ne(h,H),H.y=r,H.height=L(0,w.getHeight()-r),ne(w.tv,H)}},ms_vs:function(o){o._41o=function(){return this._29I.height<this._59I},o._43o=function(){var D=this;D._41o()&&(D._58I||(Qi(function(){D._94O()},fr),D.iv()),D._58I=new Date)},o._94O=function(){var T=this;if(T._58I){var _=new Date;_.getTime()-T._58I.getTime()>=fr?(delete T._58I,T.iv()):Qi(function(){T._94O()},fr)}},o._93I=function(){var r=this,Z=r._27I;if(r._58I||!r._autoHideScrollBar){Z||ar(r._79O,Z=r._27I=Ic());var x=r._29I,e=x.height,d=r._59I,W=r.getScrollBarSize(),M=x.width-W-2,K=e*(-r.ty()/d),R=e*(e/d),_=Z.style;d>e?(Xf>R&&(K=K+R/2-Xf/2,0>K&&(K=0),K+Xf>e&&(K=e-Xf),R=Xf),_.visibility=lb,_.background=r.getScrollBarColor(),_.borderRadius=W/2+Fn,ne(Z,M,K,W,R)):_.visibility=Bc}else Z&&(Z.style.visibility=Bc)}},ms_hs:function(q){q._40o=function(){return this._29I.width<this._91I},q._42o=function(){var L=this;L._40o()&&(L._95O||(Qi(function(){L._94I()},fr),L.iv()),L._95O=new Date)},q._94I=function(){var $=this;if($._95O){var e=new Date;e.getTime()-$._95O.getTime()>=fr?(delete $._95O,$.iv()):Qi(function(){$._94I()},fr)}},q._92I=function(){var W=this,R=W._28I;if(W._95O||!W._autoHideScrollBar){R||ar(W._79O,R=W._28I=Ic());var H=W._29I,M=H.width,q=W._91I,E=W.getScrollBarSize(),Y=H.height-E-2,f=M*(-W.tx()/q),o=M*(M/q),C=R.style;q>M?(Xf>o&&(f=f+o/2-Xf/2,0>f&&(f=0),f+Xf>M&&(f=M-Xf),o=Xf),C.visibility=lb,C.background=W.getScrollBarColor(),C.borderRadius=E/2+Fn,ne(R,f,Y,o,E)):C.visibility=Bc}else R&&(R.style.visibility=Bc)}}}),Ul(mg,Vl(16,16,[{type:Aq,rect:[1,1,14,14],background:Xg},{type:Lj,rect:[1,1,14,14],width:1,color:ko},{type:sj,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Ul(sd,Vl(16,16,{type:Lj,rect:[1,1,14,14],width:1,color:ko})),Ul(wo,Vl(16,16,[{type:Wh,rect:[2,2,12,12],borderWidth:1,borderColor:ko,background:"#FFF"},{type:Wh,rect:[4,4,8,8],background:Xg}])),Ul(Jk,Vl(16,16,{type:Wh,rect:[2,2,12,12],borderWidth:1,borderColor:ko})),Qn._15Q=function(K){K._29I=rg,K._59I=0,K._91I=0,K._5o=function(r){var P=this;P._30I=new pq,P._rows=new pq,P._rowMap={},P._31I=0,P._14I=0,P._view=Qo(1,P),P._canvas=Ae(P._view),ar(P._view,P._79O=Ic()),P.dm(r?r:new sn)},K.getCheckIcon=function(R){var u=this.sm(),_=u.co(R);return u.sg()?Nd(_?wo:Jk):Nd(_?mg:sd)},K.checkData=function(s){var _=this.sm(),A=_.co(s);_.sg()&&A||(this._32o=1,A?_.rs(s):_.as(s),delete this._32o)},K.getDataAt=function(q){q.target&&(q=this.lp(q));var c=i(q.y/this._rowHeight),X=this._rows;return 0>c||c>=X.size()?G:X.get(c)},K.onDataDoubleClicked=function(){},K.onDataClicked=function(){},K.adjustTranslateX=function(){return 0},K.adjustTranslateY=function(a){var J=this.getHeight()-this._59I;return J>a&&(a=J),a>0?0:A(a)},K.onPropertyChanged=function(e){var $=this,v=e.property;_s[v]?$.ivm():$s[v]||$.redraw(),v===zo?$._42o():v===Zp&&$._43o()},K.getLabel=function(q){return q.toLabel()},K.getLabelFont=function(){return this._labelFont},K.getLabelColor=function(r){var K=this;if(K.isCheckMode()){if(K._focusData===r)return K._labelSelectColor}else if(K.isSelected(r))return K._labelSelectColor;return K._labelColor},K.getStartRowIndex=function(){return this._31I},K.getEndRowIndex=function(){return this._14I},K.getRowDatas=function(){return this._rows},K.getRowIndex=function(L){return this._rowMap[L._id]},K.getRowSize=function(){return this._rows.size()},K.getViewRect=function(){return gl(this._29I)},K.isVisible=function($){return this._visibleFunc?this._visibleFunc($):!0},K.getCurrentSortFunc=function(){return this._sortFunc},K.setDataModel=function(Y){var T=this,H=T._dataModel,c=T._selectionModel;H!==Y&&(H&&(H.umm(T.handleDataModelChange,T),H.umd(T.handleDataPropertyChange,T),H.umh(T.handleHierarchyChange,T),c||H.sm().ums(T.handleSelectionChange,T)),T._dataModel=Y,Y.mm(T.handleDataModelChange,T),Y.md(T.handleDataPropertyChange,T),Y.mh(T.handleHierarchyChange,T),c?c._21I(Y):Y.sm().ms(T.handleSelectionChange,T),T.fp("dataModel",H,Y))},K.validateModel=function(){var g=this;g._rows.clear(),g._rowMap={},g.buildChildren(g._dataModel._roots);var v=g._rows=g._rows.toList(g.isVisible,g),m=0,A=g.getCurrentSortFunc(),E=v.size();for(A&&v.sort(A);E>m;m++)g._rowMap[v.get(m)._id]=m},K.buildChildren=function(X){var p=this;X.each(function(z){p._rows.add(z),p.buildChildren(z._children)})},K.handleDataModelChange=function(){this.ivm()},K.handleDataPropertyChange=function(x){"parent"===x.property?this.ivm():this.invalidateData(x.data)},K.handleHierarchyChange=function(){this.ivm()},K.handleSelectionChange=function(C){C.datas.each(this.invalidateData,this),this.onSelectionChanged(C)},K.onSelectionChanged=function(B){var Q=this,w=Q.sm();!Q.isAutoMakeVisible()||1!==w.size()||"set"!==B.kind&&"append"!==B.kind||Q._32o||Q.makeVisible(w.ld())},K.handleBackgroundClick=function(h){Cm(h)&&!this.isCheckMode()&&this.sm().cs()},K.makeVisible=function(k){k&&(this._23I=k,this.iv())},K.scrollToIndex=function(_){var O=this,S=O._29I,v=S.height,D=O._rowHeight,k=D*_;_>=0&&_<O._rows.size()&&v>0&&(k+D>S.y+v?O.ty(-k+v-D):k<S.y&&O.ty(-k))},K.autoScroll=function(G,X){var O=this,e=O._rowHeight,z=e,f=e/4,B=O._29I,W=O.lp(G),K={x:O.tx(),y:O.ty()};return e>0&&B&&(W.x-B.x<z?O.translate(f,0):B.x+B.width-W.x<z&&O.translate(-f,0),W.y-B.y<z?O.translate(0,f):B.y+B.height-W.y<z&&O.translate(0,-f)),K.x=O.tx()-K.x,K.y=O.ty()-K.y,X&&(X.x+=K.x,X.y+=K.y),K},K.getTopRowOrderSelection=function(){var m=this.sm().getTopSelection(),J={},V=new pq;return m.each(function(K){J[K._id]=K}),this._rows.each(function(f){J[f._id]&&V.add(f)}),V},K.getRowOrderSelection=function(){var H=new pq;return this._rows.each(function(I){this.isSelected(I)&&H.add(I)},this),H},K.ivm=function(){this.invalidateModel()},K.invalidateModel=function(){var t=this;t._96I||(t._96I=1,t._32I=1,delete t._24I),t.iv()},K.redraw=function(){var Y=this;Y._32I||(Y._32I=1,delete Y._24I,Y.iv())},K.invalidateData=function(k){var x=this;qi?x.redraw():x._32I||(x._24I||(x._24I={}),x._24I[k._id]=k,x.iv())},K.getFocusData=function(){return this._focusData},K.setFocusDataById=function(y){this.setFocusData(this.dm().getDataById(y))},K.setFocusData=function(v){var w=this,X=w._focusData;X!==v&&(w._focusData=v,w.fp("focusData",X,v),X&&w.invalidateData(X),v&&(w.invalidateData(v),w.isAutoMakeVisible()&&w.makeVisible(v)))},K.drawRowBackground=function(I,N,P,Y,G,E,m){var U=this,q=U.isCheckMode();(N===U._focusData&&q||P&&!q)&&zd(I,Y,G,E,m,U.getSelectBackground(N))},K.drawData=function(E,a,o){var C=this,r=C._rowHeight,x=r*o,p=C._29I,k=p.x,R=p.width;E.save(),E.beginPath(),E.rect(k,x,R,r),E.clip(),C._87o(C.drawRow(E,a,C.isSelected(a),k,x,R,r),o,k,x,R,r),E.restore(),C._rowLineVisible&&zd(E,k,x+r-1,R,1,C._rowLineColor)},K._12I=function(o){var L=this,n=L._31I,a=L._29I,I=a.x,K=a.y,t=a.width,u=a.height;for(o.beginPath(),o.rect(I,K,t,u),o.clip(),o.clearRect(I,K,t,u),L._76o(),L._93db(o);n<L._14I;n++)L.drawData(o,L._rows.get(n),n);L._92db(o)},K._13I=function(h){for(var I,x=this,u=x._rowHeight,H=x._29I,W=H.x,m=H.width,U=x._31I,Z=x._30I;U<x._14I;U++)I=x._rows.get(U),x._24I[I._id]&&Z.add({data:I,index:U});Z.isEmpty()||(h.beginPath(),Z.each(function(C){h.rect(W,C.index*u,m,u)}),h.clip(),Z.each(function(K){h.clearRect(W,K.index*u,m,u)}),Z.each(function(A){x._77o(A.index)}),x._93db(h),Z.each(function(p){x.drawData(h,p.data,p.index)}),x._92db(h),Z.clear())},K.preValidateModel=function(){this.endEditing&&this.endEditing()},K.validateImpl=function(){var x=this,R=x._canvas,Y=x.getWidth(),B=x.getHeight(),z=x._rowHeight,W=x._32I;(Y!==R.clientWidth||B!==R.clientHeight)&&(Ek(R,Y,B),W=1),x._96I&&(x.preValidateModel(),x.validateModel());var M=x._29I,O={x:-x.tx(),y:-x.ty(),width:Y,height:B},T=x._rows.size(),C=Nm(R),p=x._23I;W||pn(O,M)||(W=1),x._29I=O,x._59I=T*z,x._31I=i(O.y/z),x._14I=U((O.y+O.height)/z),x._31I<0&&(x._31I=0),x._14I>T&&(x._14I=T),x._99I&&W&&x._99I();var l=x.tx(),c=x.ty();(x._40o()||x._41o())&&(x._59I+=x.getScrollBarSize(),x._99I&&W&&(x._91I+=x.getScrollBarSize())),Ko&&!cj&&(C.save(),jf(C,Y/Jq.length,B/Jq.length,1)),jf(C,l,c,1),W?x._12I(C):x._24I&&x._13I(C),x._93I(),x._92I(),C.restore(),x._32I=x._24I=x._96I=G,p&&(x.scrollToIndex(x.getRowIndex(p)),delete x._23I),x.tx(x.tx()),x.ty(x.ty())},K.canHandleSelectMode=function(){return!0}},Qn._48o=function(V){V._rootVisible=!0,V._rootData=G,V._35o=function(){this._expandMap={},this._levelMap={}},V.validateModel=function(){var n=this,F=n._rootData;n._rows.clear(),n._levelMap={},n._rowMap={},n._currentLevel=0,F?n._rootVisible?n.isVisible(F)&&n.buildData(F):n.buildChildren(F):n.buildChildren(),delete n._currentLevel},V.buildData=function(P){var $=this,a=P._id,k=$._rows;$._rowMap[a]=k.size(),k.add(P),$._levelMap[a]=$._currentLevel,$.isExpanded(P)&&($._currentLevel++,$.buildChildren(P),$._currentLevel--)},V.buildChildren=function(T){var F=this,L=T?T._children:F._dataModel._roots,Y=F.getCurrentSortFunc();Y&&F.isChildrenSortable(T)?L.toList(F.isVisible,F).sort(Y).each(F.buildData,F):L.each(function(r){F.isVisible(r)&&F.buildData(r)})},V.getLevel=function(_){return this._levelMap[_._id]},V.getToggleIcon=function(z){var O=this,J=O._loader,M=O._collapseIcon;return J&&!J.isLoaded(z)?M:z.hasChildren()?O.isExpanded(z)?O._expandIcon:M:G},V.isCheckMode=function(){return this._checkMode!=G},V.isChildrenSortable=function(){return!0},V.handleDataModelChange=function(P){var $=this;P.kind===ai?delete $._expandMap[P.data._id]:P.kind===$k&&($._expandMap={}),$.ivm()},V.toggle=function(h){var N=this;N.isExpanded(h)?N.collapse(h):N.expand(h)},V.isExpanded=function(G){return 1===this._expandMap[G._id]},V.expand=function(I){var d=this,m=d._loader;d.isExpanded(I)||(m&&!m.isLoaded(I)&&m.load(I),d._expandMap[I._id]=1,d.ivm(),d.onExpanded(I))},V.onExpanded=function(){},V.collapse=function(o){var Q=this;Q.isExpanded(o)&&(delete Q._expandMap[o._id],Q.ivm(),Q.onCollapsed(o))},V.onCollapsed=function(){},V.expandAll=function(M){if(M)this.expand(M),M.eachChild(function(a){this.expandAll(a)},this);else{var p=this;p._dataModel.each(function(W){W.hasChildren()&&(p._expandMap[W._id]=1)}),p.ivm()}},V.collapseAll=function(){this._expandMap={},this.ivm()
},V.makeVisible=function(q){if(q){var C=this;if(!C._rootData||q.isDescendantOf(C._rootData)){for(var B=q._parent;B;)C.expand(B),B=B._parent;C._23I=q,C.iv()}}},V.checkData=function(c){var M,i=this,H=i._checkMode,v=i.sm(),$=v.co(c);if(!v.sg()||!$){if(i._32o=1,H===Qg)$?v.rs(c):v.as(c);else if(H===Uj)M=new pq(c),M.addAll(c._children);else if("descendant"===H)M=new pq,bt(c,M);else if("all"===H&&(M=new pq,bt(c,M),!$))for(var P=c._parent;P;)M.add(P),P=P._parent;M&&($?v.rs(M):v.as(M)),delete i._32o}},V.drawTree=function(q,N,r,X,x,d,U){var z=this,u=z._indent,o=z._levelMap[N._id],W=z.getIconWidth(N),F=Nd(z.getToggleIcon(N));F?(X+=u*o,Si(q,F,X+u/2,x+U/2,N,z),X+=u):X+=u*(o+1),z._checkMode&&(Si(q,z.getCheckIcon(N),X+u/2,x+U/2,N,z),X+=u),z.drawIcon(q,N,X,x,W,U),z.drawLabel(q,N,X+W,x,U)}},Qn._14Q=function(F){F.getIcon=function($){return $.getIcon()},F.getIconWidth=function(x){return this.getIcon(x)?this._indent:0},F.drawIcon=function(k,e,E,Q,I,g){if(I){var c=this,V=c.getBodyColor(e),s=Nd(c.getIcon(e),V);s&&(g-=c.isRowLineVisible()?1:0,gr(k,s,Im,E,Q,I,g,e,c,V),to(k,c.getBorderColor(e),E,Q,I,g))}},F.drawLabel=function(S,Y,o,p,d){var Q=this;Se(S,Q.getLabel(Y),Q.getLabelFont(Y),Q.getLabelColor(Y),o,p,0,d)}},Qn._50o=function(_){_._98I=function(){var x=this,j=x._39o=new sn;x._60I=new pq,j.mm(x._17o,x),j.md(x._18o,x),j.mh(x._19o,x)},_.setColumns=function(j){this._39o.clear(),this.addColumns(j)},_.addColumns=function(c){var w=this._39o;c.forEach(function(B){if(!(B instanceof it)){var D=Kk(B.className);B=pg(D?D:it,B)}w.add(B)})},_.onColumnClicked=function(){},_.onCheckColumnClicked=function(){},_._3Q=function(x){for(var S,i=0,a=this._60I,k=a.size();k>i;i++)if(S=a.get(i),S.column===x)return S;return G},_.getColumnAt=function(L){var k=this._4Q(L);return k?k.column:G},_._4Q=function(Q){for(var R=this,i=Q.target?R.lp(Q).x:Q.x,A=R._60I,M=0;M<A.size();M++){var r=A.get(M),t=r.startX;if(i>=t&&i<t+r.column.getWidth())return r}return G},_.getToolTip=function(E){var S=this,h=S.getDataAt(E),O=S.getColumnAt(E);return h&&O?O.getToolTip(h,S):G},_.adjustTranslateX=function(R){var U=this.getWidth()-this._91I;return U>R&&(R=U),R>0?0:A(R)},_._99I=function(){var x=this,m=x._29I,c=x._60I;c.clear(),x._91I=0,x._39o._roots.each(function(B){if(B.isVisible()){var a=x._91I+B.getWidth();x._91I<=m.x+m.width&&a>=m.x&&c.add({column:B,startX:x._91I}),x._91I=a}})},_.drawData=function(G,J,T){var g=this,V=g._rowHeight,u=V*T,L=g.isSelected(J),S=g._29I,f=S.x,h=S.width;g.drawRowBackground(G,J,L,f,u,h,V),g._60I.each(function(R){var r=R.column,s=R.startX,q=r.getWidth();q>0&&!g.isEditing(J,r)&&(G.save(),G.beginPath(),G.rect(s,u,q,V),G.clip(),g._87o(g.drawCell(G,J,L,r,s,u,q,V),T,s,u,q,V),g._columnLineVisible&&zd(G,s+q-1,u,1,V,g._columnLineColor),G.restore())}),g._rowLineVisible&&zd(G,f,u+V-1,h,1,g._rowLineColor)},_.drawCell=function(O,d,D,Q,Y,m,w,$){var s=this;if(Q.drawCell)return Q.drawCell(O,d,D,Q,Y,m,w,$,s);var A=s.getValue(d,Q);ct(O,A,Q,s.getLabelFont(d,Q,A),s.getLabelColor(d,Q,A),Y,m,w,$,d,s)},_.getColumnModel=function(){return this._39o},_._17o=function(){this.redraw()},_._18o=function(s){var Z=this;s.data===Z._sortColumn&&Zs[s.property]?Z.ivm():(Z._42o(),Z.redraw())},_._19o=function(){this.redraw()},_.getCurrentSortFunc=function(){var n=this,x=n._sortColumn;if(x&&x.isSortable()){var c=x.getSortFunc(),E=nb===x.getSortOrder()?1:-1;return c||(c=ke),function(m,i){return c.call(n,n.getValue(m,x),n.getValue(i,x),m,i)*E}}return n._sortFunc},_.isCellEditable=function(z,p,D){return p.isEditable()&&this.isEditable()?p.isCellEditable?p.isCellEditable(z,p,D,this):!0:!1},_._37O=function(B,y){if(Cm(y))for(var a=this,I=a.lp(y),e=a._60I,N=a._rowHeight,G=a._29I,c=G.x,E=G.y,K=G.width,V=G.height,f=0;f<e.size();f++){var Y=e.get(f),g=Y.startX,i=Y.column,Q=i.getWidth();if(i!==a._31o&&i!==a._4o&&I.x>=g&&I.x<g+Q&&a.isCellEditable(B,i,y)){var k={x:g,y:a.getRowIndex(B)*N,width:Q,height:N},n={x:k.x+a.tx(),y:k.y+a.ty(),width:k.width,height:k.height},r=0,D=0;return k.x<c?r=k.x-c:k.x+k.width>c+K&&(r=k.x+k.width-c-K),r&&(a.tx(a.tx()-r),n.x-=r),k.y<E?D=k.y-E:k.y+N>E+V&&(D=k.y+N-E-V),D&&(a.ty(a.ty()-D),n.y-=D),a.beginEditing({data:B,column:i,value:a.getValue(B,i),event:y,rect:k,editorRect:n,view:a}),void 0}}}},ft.BaseItemEditor=function(Y,$,v,k){this._data=Y,this._column=$,this._master=v,this._editInfo=k},gt("BaseItemEditor",t,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ht=q.Tab=function(){ln(ht,this)};Eg("Tab",Em,{ms_ac:["view","closable","disabled","visible"],_icon:G,_closable:!1,_disabled:!1,_visible:!0,setParent:Ck});var it=q.Column=function(){ln(it,this)};Eg("Column",Em,{_46o:1,ms_ac:["accessType","valueType",lb,rc,ak,_i,"align",Ld,"sortOrder",Hf,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:nb,_sortFunc:G,_sortable:!0,_clickable:!0,setWidth:function(S){16>S&&(S=16);var Q=this._width;this._width=S,this.fp(_i,Q,S)},getToolTip:function(S,i){return this.formatValue(i.getValue(S,this))}});var jt=q.Property=function(){ln(jt,this)};Eg("Property",Em,{_46o:1,ms_ac:["accessType","valueType",rc,ak,"categoryName",Ld,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:G,getToolTip:function(i,M,F){var x=this;return M?x.formatValue(F.getValue(i,x)):F.getPropertyName(x)}}),ft.AccordionView=function(){var p=this;p._20o={},p._21o=new pq,p._10o=G,p._9o=G,p._11o=G,p._view=Qo(0,p),p.iv()},gt("AccordionView",t,{ms_v:1,ms_fire:1,ms_ac:[Sm,Ge,"titleHeight",Hl,Vh,"titleBackground","selectWidth",Oe,"orientation","separatorColor"],_expandIcon:m.accordionViewExpandIcon,_collapseIcon:m.accordionViewCollapseIcon,_titleHeight:Lm,_labelColor:m.accordionViewLabelColor,_labelFont:m.accordionViewLabelFont,_titleBackground:m.accordionViewTitleBackground,_selectBackground:m.accordionViewSelectBackground,_selectWidth:m.accordionViewSelectWidth,_orientation:"v",_separatorColor:m.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(L,n,Y,Q){var f=this,l=Ic(),h={content:n,div:l,canvas:Ae(l),icon:Q};if(f._20o[L])throw L+" already exists";var x=h.downEventFunc=function(Z){Ji(Z)},i=h.upEventFunc=function(E){Ji(E),Cm(E)&&(f._10o===L?f.collapse():f.expand(L))};[Zh,jd].forEach(function(F){$(l,F,x)}),[Er,Fb].forEach(function(n){$(l,n,i)}),l.style.cursor=Cd,ar(f._view,l),f._20o[L]=h,f._21o.add(L),Y&&f.expand(L),f.iv()},remove:function(i){var O=this,f=O._20o[i];if(f){var b=f.div;Rl(b),[Zh,jd].forEach(function(d){J(b,d,f.downEventFunc)}),[Er,Fb].forEach(function(P){J(b,P,f.upEventFunc)}),delete O._20o[i],O._21o.remove(i),O.iv()}},clear:function(){var g=this;g._21o.toArray().forEach(g.remove,g),g._20o={},g._21o.clear(),g.iv()},isExpanded:function(c){return this._10o===c},expand:function(B){var M=this;M._20o[B]&&M._10o!==B&&(M._10o=B,M.onExpanded(B),M.iv())},onExpanded:function(){},collapse:function(){var y=this;y._10o&&(y.onCollapsed(y._10o),delete y._10o,y.iv())},onCollapsed:function(){},initCanvas:function(u,Y,N){Ek(u,Y,N);var b=Nm(u);return jf(b,0,0,1),b.clearRect(0,0,Y,N),b},drawTitle:function($,E,R,L,p){var U=this,u=Nd(p.icon),w=U.isExpanded(E),X=U._titleHeight,W=U._titleBackground,B=U._selectWidth,o=U._separatorColor,r=Nd(w?U._expandIcon:U._collapseIcon),H=B+4;zd($,0,0,R,L,W),w&&B&&zd($,0,0,B,L,U._selectBackground),(w||U._21o.get(U._21o.size()-1)!==E)&&zd($,0,L-1,R,1,o?o:bn(W)),u&&(Si($,u,H+Ur(u)/2,X/2),H+=Ur(u)+2),Se($,E,U.getLabelFont(E),U.getLabelColor(E),H,0,0,X),r&&Si($,r,R-Ur(r)/2-4,X/2)},validateImpl:function(){var Z=this,i=Z._view,t=0,Y=0,X=Z.getWidth(),j=Z.getHeight(),T=Z._titleHeight,w=Z._21o.size()*T,m=Z._11o,s=Z._9o;delete Z._11o,delete Z._9o,Z._21o.each(function(P){var x,H,I=Z._20o[P],G=I.content,k=Z._10o===P;wh(Z)?(ne(I.div,t,0,T,j),x=Z.initCanvas(I.canvas,T,j),ae(x,0,j),Ln(x,-Rm),Z.drawTitle(x,P,j,T,I),x.restore(),k?(H=L(0,X-w),G&&(Z._11o=G,Z._9o=tf(G),ne(G,t+T,0,H,j)),t+=T+H):t+=T):(ne(I.div,0,Y,X,T),x=Z.initCanvas(I.canvas,X,T),Z.drawTitle(x,P,X,T,I),x.restore(),k?(H=L(0,j-w),G&&(Z._11o=G,Z._9o=tf(G),ne(G,0,Y+T,X,H)),Y+=T+H):Y+=T)});var h=Z._9o;m&&m!==Z._11o&&m.endEditing&&m.endEditing(),h&&h!==s&&ar(i,h),s&&s!==h&&Rl(s)}}),ft.SplitView=function(b,l,M,i){var R=this,h=R._dividerDiv=Ic(),F=R._60O=Ae(),V=R._61O=Ae(),O=F.style,E=V.style;R._view=Qo(1,R),ar(R._view,h),O.msTouchAction=yc,O.pointerEvents=yc,O.cursor=Cd,E.msTouchAction=yc,E.pointerEvents=yc,E.cursor=Cd,b&&R.setLeftView(b),l&&R.setRightView(l),M&&R.setOrientation(M),i!=G&&R.setPosition(i),R.setStatus(wf),new kt(R)},gt("SplitView",t,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:m.splitViewDividerSize,_dividerBackground:m.splitViewDividerBackground,_dragOpacity:m.splitViewDragOpacity,_toggleIcon:m.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(t,b){var F=this,a=F._position;isNaN(t)||(b||(F._82O=0>t?-1:t>1?1:0),F._position=t,F.fp(Bm,a,t))},getLeftView:function(){return this._leftView},setLeftView:function(t){var i=this,g=i._leftView,J=i._view;if(i._leftView!==t){if(g&&g!==i._rightView){var C=tf(g);C.parentNode===J&&Rl(C)}if(i._leftView=t,t){var G=tf(t);G.parentNode!==J&&J.insertBefore(G,i._dividerDiv)}i.fp("leftView",g,t)}},getRightView:function(){return this._rightView},setRightView:function(W){var A=this,p=A._rightView,k=A._view;if(A._rightView!==W){if(p&&p!==A._leftView){var V=tf(p);V.parentNode===k&&Rl(V)}if(A._rightView=W,W){var e=tf(W);e.parentNode!==k&&k.insertBefore(e,A._dividerDiv)}A.fp("rightView",p,W)}},validateImpl:function(){var v=this,H=v._draggable,Q=v._position,h=v.getWidth(),K=v.getHeight(),t=v._dividerSize,N=v._dividerBackground,j=yr?18:8,b=v._dividerDiv,X=v._82O,x=v._60O,c=v._61O,u=v._toggleIcon,f=v._status,J=b.style,k=null,D=yr?20:4,q=u.comps[0];t>=j||0===t?v._coverDiv&&(Rl(v._coverDiv),delete v._coverDiv):v._coverDiv||(v._coverDiv=Ic(),jr&&(v._coverDiv.style.background=Dd),ar(b,v._coverDiv)),v._togglable?x.parentNode||(ar(b,x),ar(b,c)):(Rl(x),Rl(c));var y=v._coverDiv,F=v._leftView,l=v._rightView;if(wh(v)){if(t>h&&(t=h),f===wf)if(1===X)var R=S(Q,h),B=L(0,h-t-R);else-1===X?(B=S(-Q,h),R=L(0,h-t-B)):(R=A((h-t)*Q),B=L(0,h-t-R));else"cl"===f?(R=0,B=L(0,h-t)):"cr"===f&&(B=0,R=L(0,h-t));F&&ne(F,0,0,R,K),l&&ne(l,R+t,0,B,K),ne(b,R,0,t,K),v._22o=R,y&&(ne(y,t/2-j/2,0,j,K),y.style.cursor=H?qe:""),b.style.cursor=H?qe:"";var M=b.clientHeight/2,W=b.clientWidth;Ek(x,W,W),ne(x,0,M-W-D,W,W),k=Nm(x),jf(k,0,0,1),q.rotation=-Rm,Rb(k,u,0,0,W,W),k.restore(),Ek(c,W,W),ne(c,0,M+D,W,W),k=Nm(c),jf(k,0,0,1),q.rotation=Rm,Rb(k,u,0,0,W,W),k.restore()}else{if(t>K&&(t=K),f===wf)if(1===X)var V=S(Q,K),d=L(0,K-t-V);else-1===X?(d=S(-Q,K),V=L(0,K-t-d)):(V=A((K-t)*Q),d=L(0,K-t-V));else"cl"===f?(V=0,d=L(0,K-t)):"cr"===f&&(d=0,V=L(0,K-t));F&&ne(F,0,0,h,V),l&&ne(l,0,V+t,h,d),ne(b,0,V,h,t),v._22o=V,y&&(ne(y,0,t/2-j/2,h,j),y.style.cursor=H?Eh:""),J.cursor=H?Eh:"";var I=b.clientWidth/2,W=b.clientHeight;Ek(x,W,W),ne(x,I-W-D,0,W,W),k=Nm(x),jf(k,0,0,1),q.rotation=0,Rb(k,u,0,0,W,W),k.restore(),Ek(c,W,W),ne(c,I+D,0,W,W),k=Nm(c),jf(k,0,0,1),q.rotation=Y,Rb(k,u,0,0,W,W),k.restore()}J.background=N}});var kt=function(I){this.sv=I,this.addListeners()};mj(kt,t,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function($){var j=this,H=j.sv,K=H._dividerDiv,E=H._60O,f=H._61O,S=H._status,X=$.target;if(X===E)S===wf?H.setStatus("cl"):"cr"===S&&H.setStatus(wf);else if(X===f)S===wf?H.setStatus("cr"):"cl"===S&&H.setStatus(wf);else if(kr($)&&(X===K||X===H._coverDiv)&&(Ji($),H.isDraggable())){H.getLeftView(),H.getRightView();var o=j.maskDiv=Ic();if(o.style.left=0,o.style.top=0,o.style.width=H.getWidth()+"px",o.style.height=H.getHeight()+"px",H.getView().appendChild(o),!H.isContinuousLayout()){var g=j.resizeDiv=Ic();g.style.left=K.style.left,g.style.top=K.style.top,g.style.width=K.style.width,g.style.height=K.style.height,g.style.opacity=H.getDragOpacity(),g.style.background=H.getDividerBackground(),ar(j.getView(),g)}j._lastAbsPosition=H._22o,j._86o=wh(H)?Lp($).x:Lp($).y,nr(j,$)}},handleWindowTouchMove:function(f){kr(f)&&this.update(f,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(u){var z=this;z.update(u,!0),z.sv.setStatus(wf),z.maskDiv&&Rl(z.maskDiv),z.resizeDiv&&Rl(z.resizeDiv),z.maskDiv=z.resizeDiv=G},handle_mousedown:function(t){Cm(t)&&this.handle_touchstart(t)},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},update:function(U,I){var i=this,W=i.sv,K=wh(W)?W.getWidth():W.getHeight(),B=W._dividerSize,E=i._lastAbsPosition-i._86o;wh(W)?(E+=Lp(U).x,E>K-B&&(E=K-B),0>E&&(E=0),i.resizeDiv&&(i.resizeDiv.style.left=E+Fn)):(E+=Lp(U).y,E>K-B&&(E=K-B),0>E&&(E=0),i.resizeDiv&&(i.resizeDiv.style.top=E+Fn)),I&&K!==B&&(1===W._82O?W.setPosition(E,1):-1===W._82O?W.setPosition(E-K+B,1):W.setPosition(E/(K-B),1))}}),ft.TabView=function(){var Y=this,N=Y._view=Qo(1,Y),A=Y._91O=Ic(1),I=Y._tabModel=new sn,r=I.sm(),s=Y.invalidate;Y._7o=new pq,Y._canvas=Ae(A),ar(N,A),ar(N,Y._92O=Ic(1)),r.setSelectionMode(sl),r.ms(Y.handleSelectionChange,Y),I.mm(s,Y),I.mh(s,Y),I.md(s,Y),Y._interactor=new lt(Y),Y.iv()},gt("TabView",t,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Hl,Vh,"tabHPadding","tabBackground","selectWidth",Oe,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:am,_tabHeight:Lm,_tabGap:m.tabViewTabGap,_labelColor:m.tabViewLabelColor,_labelFont:m.tabViewLabelFont,_tabBackground:m.tabViewTabBackground,_selectWidth:m.tabViewSelectWidth,_selectBackground:m.tabViewSelectBackground,_moveBackground:m.tabViewMoveBackground,_insertColor:m.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(q,J,D){var W,L=this._tabModel;return q instanceof ht?(W=q,J&&W.setView(J)):(W=new ht,W.setName(q),W.setView(J)),L.add(W),D&&L.sm().ss(W),W},getLabel:function(J){return J.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(o){this._23o=o,this.iv()},get:function(q){var t=this,i=t._tabModel;if(Lk(q))return i._roots.get(q);if(on(q)){var S;return i.each(function(U){q===t.getLabel(U)&&(S=U)}),S}return q instanceof ht?q:G},select:function(G){this._tabModel.sm().ss(this.get(G))},remove:function(M){var A=this;if(M=A.get(M)){var o=A._tabModel,p=o._roots.indexOf(M);A._tabModel.remove(M),A.selectByIndex(--p)}},getCurrentTab:function(){return this._8o},hideTabView:function(U,z){z.parentNode===this._92O&&(vr(z)?(z.style.display=Yf,z._tab_=U):Rl(z),rn())},showTabView:function(_,o){vr(o)&&(o.style.display="block",o._tab_=_),o.parentNode!==this._92O&&(ar(this._92O,o),rn())},_24o:function(){var T,m=this,z=m._8o,X=m._9o,I=m._tabModel.sm().ld();I&&(T=tf(I.getView())),T!==X&&(X&&(z.getView()&&z.getView().endEditing&&z.getView().endEditing(),m.hideTabView(z,X)),T&&m.showTabView(I,T)),m._8o=I,m._9o=T,z!==I&&m.onTabChanged(z,I)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(M,G){this.selectByIndex(--G)},selectByIndex:function(u){var B=this,U=B._tabModel,l=U.size();if(l&&!U.sm().ld()){u==G&&(u=0),u>=l&&(u=l-1),0>u&&(u=0);for(var z=u;z>=0;z--){var v=B.get(z);if(!v.isDisabled())return B.select(v),v}for(z=u+1;l>z;z++)if(v=B.get(z),!v.isDisabled())return B.select(v),v}},getTabWidth:function(J){var O=this.getTabHPadding(),R=4+2*O,f=Nd(J.getIcon());f&&(R+=Ur(f,J)+4);var K=this.getLabel(J);return K&&(R+=Vd(this.getLabelFont(J),K).width+4),J.isClosable()&&(R+=10),R},drawTab:function(j,i,V,S,m,A,Q){var W,t=this,I=t._tabPosition,x=this.getTabHPadding(),f=V+4+x,y=t._selectWidth,B=Nd(i.getIcon()),q=i.isDisabled(),N=t.getLabelColor(i),L=t.getLabelFont(i),T=t.getLabel(i),O=t._selectBackground,K=I===xb+"-vertical",z=I===ui+"-vertical";(K||z)&&(f=S+4+x),q&&(j.globalAlpha=_m),zd(j,V,S,m,A,Q),i===t._8o&&y&&(I===am?zd(j,V,S+A-y,m,y,O):I===xb?zd(j,V+m-y,S,y,A,O):I===ui?zd(j,V,S,y,A,O):K?zd(j,V+m-y,S,y,A,O):z?zd(j,V,S,y,A,O):zd(j,V,S,m,y,O));var s=m/2;if(K&&(ae(j,s,S+A/2),Ln(j,Y),ae(j,-s,-S-A/2)),B){var r=wb(B,i),_=Ur(B,i);if(K||z){var P=V+m/2,w=f+r/2;ae(j,P,w),Ln(j,Rm),ae(j,-P,-w),Si(j,B,V+m/2,f+r/2,i,t),ae(j,P,w),Ln(j,-Rm),ae(j,-P,-w),f+=r+4}else Si(j,B,f+_/2,S+A/2,i,t),f+=_+4}return K||z?(ae(j,m/2,f+m/2),Ln(j,Rm),ae(j,-m/2,-f-m/2),Se(j,T,L,N,V,f,A,m),ae(j,m/2,f+m/2),Ln(j,-Rm),ae(j,-m/2,-f-m/2)):Se(j,T,L,N,f,S,m,A),K&&(ae(j,s,S+A/2),Ln(j,-Y),ae(j,-s,-S-A/2)),i.isClosable()&&(W=z?{x:V+m-12,y:S+A-12,width:12,height:12}:{x:V+m-12,y:S+2,width:12,height:12},this.drawCloseIcon(i,j,N,W)),q&&(j.globalAlpha=1),W},drawCloseIcon:function(Q,C,j,c){var F=c.x,P=c.y;C.strokeStyle=j,C.lineWidth=1,C.beginPath(),C.moveTo(F+2,P+8),C.lineTo(F+8,P+2),C.moveTo(F+8,P+8),C.lineTo(F+2,P+2),C.stroke()},getTabAt:function(G){var l=this._interactor._8Q(G);return l?l.tab:null},validateImpl:function(){var v=this;v._24o();var $,W=v._canvas,j=v._tabPosition,K=v._91O,e=v._92O,o=v._tabModel,Q=v.getWidth(),h=v.getHeight(),k=v._tabHeight,E=v._7o,c=v._tabGap,y=j===am,n=j===xb,Z=j===ui,R=j===xb+"-vertical",w=j===ui+"-vertical",q=v._23o,i=0;if((n||Z)&&o._roots.each(function(F){i=L(v.getTabWidth(F),i)}),y?(ne(K,0,0,Q,k),$={x:0,y:k,width:Q,height:L(0,h-k)}):n?(ne(K,0,0,i,h),$={x:i,y:0,width:L(0,Q-i),height:h}):Z?(ne(K,Q-i,0,i,h),$={x:0,y:0,width:L(0,Q-i),height:h}):R?(ne(K,0,0,k,h),$={x:k,y:0,width:L(0,Q-k),height:h}):w?(ne(K,Q-k,0,k,h),$={x:0,y:0,width:L(0,Q-k),height:h}):(ne(K,0,h-k,Q,k),$={x:0,y:0,width:Q,height:L(0,h-k)}),ne(e,$),R||w){v._9o&&($.x=0,ne(v._8o.getView(),$)),Ek(W,k,h);var u=Nm(W),X=0;if(jf(u,0,v.ty(),1),u.clearRect(0,0,k,h),E.clear(),o._roots.each(function(W){if(W.isVisible()){var l,Y=v.getTabWidth(W);if(!q||q.tab!==W){var O=v.getTabBackground(W);l=v.drawTab(u,W,0,X,k,Y,O)}E.add({_75o:l,tab:W,startY:X,endY:X+Y,height:Y}),X+=Y+c}}),v._23Q=L(0,X-c),q){var N=q.position;v.drawTab(u,q.tab,0,q.startY,k,q.height,v._moveBackground),zd(u,0,N,k,1,v._insertColor)}if(u.restore(),v._selectionChanged){v._selectionChanged=!1;for(var G=v.ty(),x=0;x<E.size();x++){var O=E.get(x);if(O.tab===v._8o){if(O.endY+G<0){v.ty(-O.startY);break}if(O.startY+G>h){v.ty(h-O.endY);break}}}}v.ty(v.ty())}else if(n||Z){v._9o&&($.x=0,ne(v._8o.getView(),$)),Ek(W,i,h);var u=Nm(W),X=0;if(jf(u,0,v.ty(),1),u.clearRect(0,0,i,h),E.clear(),o._roots.each(function(P){if(P.isVisible()){var x;if(!q||q.tab!==P){var U=v.getTabBackground(P);x=v.drawTab(u,P,0,X,i,k,U)}E.add({_75o:x,tab:P,startY:X,endY:X+k,height:k}),X+=k+c}}),v._23Q=L(0,X-c),q){var N=q.position;v.drawTab(u,q.tab,0,q.startY,i,q.height,v._moveBackground),zd(u,0,N,i,1,v._insertColor)}if(u.restore(),v._selectionChanged){v._selectionChanged=!1;for(var G=v.ty(),x=0;x<E.size();x++){var O=E.get(x);if(O.tab===v._8o){if(O.endY+G<0){v.ty(-O.startY);break}if(O.startY+G>h){v.ty(h-O.endY);break}}}}v.ty(v.ty())}else{v._9o&&($.y=0,ne(v._8o.getView(),$)),Ek(W,Q,k);var u=Nm(W),T=0;if(jf(u,v.tx(),0,1),u.clearRect(0,0,Q,k),E.clear(),o._roots.each(function(B){if(B.isVisible()){var m,H=v.getTabWidth(B);if(!q||q.tab!==B){var D=v.getTabBackground(B);m=v.drawTab(u,B,T,0,H,k,D)}E.add({_75o:m,tab:B,startX:T,endX:T+H,width:H}),T+=H+c}}),v._64I=L(0,T-c),q){var N=q.position;v.drawTab(u,q.tab,q.startX,0,q.width,k,v._moveBackground),Um(u,v._insertColor,N,0,k)}if(u.restore(),v._selectionChanged){v._selectionChanged=!1;for(var B=v.tx(),x=0;x<E.size();x++){var O=E.get(x);if(O.tab===v._8o){if(O.endX+B<0){v.tx(-O.startX);break}if(O.startX+B>Q){v.tx(Q-O.endX);break}}}}v.tx(v.tx())}for(var s=[],l=e.children,x=0;x<l.length;x++){var S=l[x],Y=S._tab_;Y&&!o.contains(Y)&&s.push(S)}s.forEach(function(n){e.removeChild(n)})}});var lt=function(q){this.tv=q,this.addListeners()};mj(lt,t,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(C){this.handleScroll(C,10*(C.wheelDelta/40))},handle_DOMMouseScroll:function(W){this.handleScroll(W,10*-W.detail)},handleScroll:function(R,n){Ji(R);var E=this.tv,h=E._tabPosition;!E._40o()||h!==am&&h!==ye||E.tx(this.tv.tx()+n),!E._41o()||h!==xb&&h!==ui&&h!==xb+"-vertical"&&h!==ui+"-vertical"||E.ty(this.tv.ty()+n)},_8Q:function(i){var T,u,I=this.tv,f=I._tabPosition,B=I._7o;if(f===am||f===ye){var m=I.lp(i).x;for(T=0;T<B.size();T++)if(u=B.get(T),u.startX<=m&&m<=u.endX)return u}else if(f===xb||f===ui||f===xb+"-vertical"||f===ui+"-vertical"){var t=I.lp(i).y;for(T=0;T<B.size();T++)if(u=B.get(T),u.startY<=t&&t<=u.endY)return u}return G},isClickable:function(A){var f=this.tv,V=f._tabPosition,F=this._73o=this._8Q(A);return!f._40o()||V!==am&&V!==ye?!f._41o()||V!==xb&&V!==ui&&V!==xb+"-vertical"&&V!==ui+"-vertical"?F&&(!F.tab.isDisabled()||f.isMovable()):!0:!0},handle_mousemove:function(U){var s=this;Mg?s._74o=s._8Q(U):s.getView().style.cursor=s.isClickable(U)?Cd:""},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(z){var O=this,h=O.tv,V=h._tabPosition;Ji(z),Cm(z)&&O.isClickable(z)&&(V===am||V===ye?(O.x=Lp(z).x,O.lp=h.lp(z),O.tx=h.tx()):(O.y=Lp(z).y,O.lp=h.lp(z),O.ty=h.ty()),nr(O,z))},handle_mouseup:function(M){this.handle_touchend(M)},handle_touchend:function(g){if(Jn(g)){var C=this._73o;if(!C)return;var l=this.tv,T=l.getTabModel(),D=C.tab;if(!D.isDisabled()&&D.isClosable()){var s=function(){var e=T._roots.indexOf(D);T.remove(D),l.onTabClosed(D,e)};l.onTabClosing(D,s)&&s()}}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(c){var V,b=this,O=b.tv,J=O._tabPosition,H=b._73o;if(J===am||J===ye){if(V=Lp(c).x-b.x,!b._25o&&!b.moving&&E(V)>2&&(O._40o()&&!hi(c)?b._25o=1:H&&O.isMovable()&&(b.moving=1)),b._25o)O.tx(b.tx+V);else if(b.moving){var i=b.lp.x+V,q=O._tabGap/2;O._7o.each(function(z){var g=z.endX,p=i-z.startX<g-i;i>=z.startX&&g>=i&&O._7Q({tab:H.tab,startX:H.startX+V,width:H.width,front:p,insertTab:z.tab,position:p?L(0,z.startX-q):S(O._64I,g+q)})})}}else if(V=Lp(c).y-b.y,!b._25o&&!b.moving&&E(V)>2&&(O._41o()&&!hi(c)?b._25o=1:H&&O.isMovable()&&(b.moving=1)),b._25o)O.ty(b.ty+V);else if(b.moving){var m=b.lp.y+V,q=O._tabGap/2;O._7o.each(function(r){var s=r.endY,B=m-r.startY<s-m;m>=r.startY&&s>=m&&O._7Q({tab:H.tab,startY:H.startY+V,height:H.height,front:B,insertTab:r.tab,position:B?L(0,r.startY-q):S(O._23Q,s+q)})})}},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},handleWindowTouchEnd:function(){var d=this,X=d.tv,A=X._tabPosition,k=X.getTabModel(),H=k._roots,R=d._73o;if(d.moving){var f=X._23o;if(f&&f.insertTab!==f.tab){var C=f.tab,r=H.remove(C),y=H.indexOf(f.insertTab);y>=0&&(f.front||y++,y<=H.size()&&(H.add(C,y),k._38I(C,r,y)))}X._7Q(G),delete d.moving}else if(!d._25o&&R){C=R.tab;var B=d._74o;if(!B||B.tab===C)if(!C.isDisabled()&&uq(R._75o,d.lp)){var V=function(){var x=H.indexOf(C);k.remove(C),X.onTabClosed(C,x)};X.onTabClosing(C,V)&&V()}else C.isDisabled()||X._8o===C||k.sm().ss(C)}d._25o=d._73o=d._74o=A===am||A===ye?d.x=d.lp=d.tx=G:d.y=d.lp=d.ty=G}}),ft.PropertyView=function(w){var V=this;V._view=Qo(1,V),V._canvas=Ae(V._view),ar(V._view,V._79O=Ic()),V._rows=new pq,V._28o=new pq,V._26o={},V._26Q={};var $=V._propertyModel=new sn,s=V.ivm;$.mm(s,V),$.md(s,V),$.mh(s,V),V.dm(w?w:new sn),new mt(V)},gt("PropertyView",t,{ms_ac:[Hl,ue,Vh,rc,ak,"categorizable",$r,Hf,Bd,Sm,Ge,Cb,To,ef,"selectRowIndex",Oe,"background",Ke,Cj,ug,Qb,Kh],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:rg,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:zk,_background:m.propertyViewBackground,_expandIcon:m.propertyViewExpandIcon,_collapseIcon:m.propertyViewCollapseIcon,_scrollBarColor:vq,_scrollBarSize:Wq,_autoHideScrollBar:Re,_selectBackground:m.propertyViewSelectBackground,_rowHeight:Wi,_rowLineVisible:m.propertyViewRowLineVisible,_rowLineColor:m.propertyViewRowLineColor,_10I:.5,_columnLineVisible:m.propertyViewColumnLineVisible,_columnLineColor:m.propertyViewColumnLineColor,_labelColor:m.propertyViewLabelColor,_labelSelectColor:m.propertyViewLabelSelectColor,_labelFont:m.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(O){0>O&&(O=0),O>1&&(O=1);var K=this,W=K._10I;K._10I=O,K.fp("columnPosition",W,O)},getPropertyName:function(l){return l.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(G,y,A){return A===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(o,a){return a===this._selectRowIndex?this._labelSelectColor:o.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(U){var b=this.getHeight()-this._59I;return b>U&&(U=b),U>0?0:A(U)},isExpanded:function(c){if(!c)return!0;var t=this._26o[c];return t?t.isExpanded:!(this._26Q[c]===!1)},toggle:function(V){var r=this;r.isExpanded(V)?r.collapse(V):r.expand(V)},expandAll:function(){this.validate();for(var M in this._26o)this.expand(M)},expand:function(g){if(g&&g!==Yf){var k=this,b=k._26o[g];b&&!b.isExpanded&&(b.isExpanded=!0,k.onExpanded(g),k.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var Z in this._26o)this.collapse(Z)},collapse:function(K){if(K&&K!==Yf){var h=this,F=h._26o[K];F&&F.isExpanded&&(F.isExpanded=!1,h.onCollapsed(K),h.ivm())}},onCollapsed:function(){},getCategoryName:function(O){if(!this.isCategorizable())return Yf;var s=O.getCategoryName();return s?s:Yf},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(E){var e=this,o=e._dataModel;o!==E&&(o&&(o.umd(e.handlePropertyChange,e),e._selectionModel||o.sm().ums(e.handleSelectionChange,e)),e._dataModel=E,E.md(e.handlePropertyChange,e),e._selectionModel?e._selectionModel._21I(E):E.sm().ms(e.handleSelectionChange,e),e.fp(Bp,o,E))},isVisible:function(V){return this._visibleFunc?this._visibleFunc(V):!0},onPropertyChanged:function(b){var K=this,B=b.property;at[B]?K.ivm():K.iv(),B===Zp&&K._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Vi},handlePropertyChange:function(Z){this._27o===Z.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var W=this;W._96I||(W.setSelectRowIndex(-1),W._96I=1,W.iv())},redraw:function(){this.iv()},validateModel:function(){var r=this,V=r._rows,S=r._28o,f={},y=new pq,l=r._27o;r.updateCurrentData(),l!==r._27o&&r.endEditing(),V.clear(),S.clear(),r.getRawProperties().each(function(p){if(r.isVisible(p)){y.add(p);var H=r.getCategoryName(p);f[H]||(S.add(H,H===Yf?0:D),f[H]={isExpanded:r.isExpanded(H),properties:new pq})}}),r._sortFunc&&y.sort(r._sortFunc);for(var T in r._26o)r._26Q[T]=r.isExpanded(T);r._26o=f,S.each(function(Y){Y!==Yf&&V.add(Y);var l=f[Y];l.isExpanded&&y.each(function(I){r.getCategoryName(I)===Y&&(l.properties.add(I),V.add({property:I,data:r._27o}))},r)})},validateImpl:function(){var n=this;n._76o(),n._96I&&(n.validateModel(),delete n._96I);var j=n._canvas,T=n.getWidth(),p=n.getHeight(),t=-n.ty(),h=n._rowHeight,L=n._indent,W=T-L,s=n._rows,P=s.size(),K=n._9I=L+W*n._10I,o=n._59I=P*h;Ek(j,T,p),n._29I={x:0,y:t,width:T,height:p},n._31I=i(t/h),n._14I=U((t+p)/h),n._31I<0&&(n._31I=0),n._14I>P&&(n._14I=P);var b,d=Nm(j),B=n._background;jf(d,0,-t,1),d.beginPath(),d.rect(0,t,T,p),d.clip(),d.clearRect(0,t,T,p),n._93db(d),B&&zd(d,0,0,L,o,B);for(var y=n._31I;y<n._14I;y++){var Y=s.get(y),t=h*y;if(on(Y))B&&zd(d,L,t,W,h,B),b=Nd(n.isExpanded(Y)?n._expandIcon:n._collapseIcon),b&&gr(d,b,Im,0,t,L,h),d.save(),d.beginPath(),d.rect(L,t,W,h),d.clip(),n.drawCategoryName(d,Y,y,L,t,W,h),d.restore();else{var l=Y.property,E=Y.data,b=Nd(l.getIcon()),H=n._selectRowIndex===y?n.getSelectBackground():G;if(b&&gr(d,b,Im,0,t,L,h),H&&zd(d,L,t,W,h,H),d.save(),d.beginPath(),d.rect(L,t,K-L,h),d.clip(),n.drawPropertyName(d,l,y,L,t,K-L,h),d.restore(),!n.isEditing(E,l)){var C=K+1,u=T-K-1;d.save(),d.beginPath(),d.rect(C,t,u,h),d.clip(),n._87o(n.drawPropertyValue(d,l,n.getValue(E,l),y,C,t,u,h,E),y,C,t,u,h),d.restore()}}n._rowLineVisible&&zd(d,L,t+h-1,W,1,n._rowLineColor)}n._columnLineVisible&&(zd(d,K,0,1,o,n._columnLineColor),zd(d,T-1,0,1,o)),n._92db(d),n._93I(),d.restore(),n.ty(n.ty())},drawCategoryName:function(V,o,e,K,j,k,n){Se(V,o,this.getCategoryFont(o),this.getCategoryColor(o),K,j,k,n)},drawPropertyName:function(C,K,s,$,f,B,M){return K.drawPropertyName?(K.drawPropertyName(C,K,s,$,f,B,M,this),void 0):(Se(C,this.getPropertyName(K),this.getPropertyFont(K,s),this.getPropertyColor(K,s),$,f,B,M),void 0)},drawPropertyValue:function(t,h,L,b,V,w,M,p,k){return h.drawPropertyValue?h.drawPropertyValue(t,h,L,b,V,w,M,p,k,this):(ct(t,L,h,this.getLabelFont(h,L,b),this.getLabelColor(h,L,b),V,w,M,p,k,this),void 0)},isPropertyEditable:function(E){return E.isEditable()&&this.isEditable()},setProperties:function(s){this._propertyModel.clear(),this.addProperties(s)},addProperties:function(t){if(t){var l=this._propertyModel;t.forEach(function(w){if(!(w instanceof jt)){var f=Kk(w.className);w=pg(f?f:jt,w)}l.add(w)})}},getRowIndexAt:function(O){var R=this,r=i(R.lp(O).y/R._rowHeight);return r>=0&&r<R._rows.size()?r:-1},getPropertyAt:function(l){var B=this,g=B.getRowIndexAt(l);return g>=0?B._rows.get(g).property:G},getToolTip:function(v){var g=this,u=g.getPropertyAt(v),E=g._27o;return u&&E?u.getToolTip(E,g._9I<g.lp(v).x,g):G}});var mt=function(j){this.pv=j,this.addListeners()};mj(mt,t,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(X){this.getView().style.cursor=X},clear:function(){var O=this;O._62O=O.cp=O.ty=O.p=G,O.setCursor(Qg)},handle_mousedown:function(M){this.handle_touchstart(M)},handle_touchstart:function(E){var X=this,F=X.pv;Ji(E),F.setFocus(E)&&(Cm(E)?(X.cp=Lp(E),X.ty=F.ty(),X.p=F.getColumnPosition(),X.handle_touchmove(E)):F.setSelectRowIndex(F.getRowIndexAt(E)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(y){this.handle_touchend(y)},handle_touchend:function(e){var m=this;if(m.cp&&!m._62O){var H=m.pv,X=H.lp(e),T=X.x,z=X.y,Q=H._indent,K=H.getRowIndexAt(e),v=H._9I;if(K>=0){var y=H._rowHeight,n=y*K,B=H._rows.get(K),U=B.property;if(on(B))Nd(H.isExpanded(B)?H._expandIcon:H._collapseIcon)&&T>=0&&Q>=T&&z>=n&&n+y>=z?H.toggle(B):bb(e)&&H.toggle(B);else if(T>v&&H.isPropertyEditable(U,e)){var q={x:v+1,y:n,width:H.getWidth()-v-1,height:y},R={x:q.x+H.tx(),y:q.y+H.ty(),width:q.width,height:q.height},j=0,O=H._29I;q.y<O.y?j=q.y-O.y:q.y+y>O.y+O.height&&(j=q.y+y-O.y-O.height),j&&(H.ty(H.ty()-j),R.y-=j),H.beginEditing({data:B.data,property:U,value:H.getValue(B.data,U),event:e,rect:q,editorRect:R,view:H})}}H.setSelectRowIndex(K)}m.clear()},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(c){var X=this,Q=X.pv,G=X.ty,B=X.cp,A=Lp(c),f=X._62O;if("p"===f)Q.setTranslateY(G+A.y-B.y);else if("c"===f){var u=Q.getWidth()-Q._indent;if(u>16){var S=X.p-(B.x-A.x)/u,i=16/u;i>S&&(S=i),S>1-i&&(S=1-i),Q.setColumnPosition(S)}}else"s"===f&&Q.setTranslateY(G+(B.y-A.y)*Q._59I/Q._29I.height)},handle_mousemove:function(f){this.handle_touchmove(f)},handle_touchmove:function(j){if(!Mg&&Cm(j)){var T=this,X=T.pv,p=E(X.lp(j).x-X._9I)<=(yr?8:3);T.cp?T._62O||(p?(T._62O="c",nr(T,j)):E(Lp(j).y-T.cp.y)>=2&&(T._62O=T.isV(j)?"s":"p",nr(T,j))):(p?T.setCursor(qe):T.setCursor(Qg),T.isV(j)&&X._43o())}},isV:function(R){var w=this.pv,u=w._29I;return w._41o()&&u.x+u.width-w.lp(R).x<Tj
},handle_mousewheel:function(P){this.handleScroll(P,P.wheelDelta/40)},handle_DOMMouseScroll:function(j){2===j.axis&&this.handleScroll(j,-j.detail)},handleScroll:function(r,J){var D=this.pv;Ji(r),D.endEditing(),D.translate(0,J*D.getRowHeight())},handle_keydown:function(K){var r=this.pv,g=r._rows.size(),W=r._selectRowIndex+(cn(K)?-1:1);(cn(K)||qo(K))&&(0>W&&(W=0),W>=g&&(W=g-1),r.setSelectRowIndex(W))}}),ft.ListView=function(P){this._5o(P),new nt(this)},gt("ListView",t,{ms_ac:[Hl,ue,Vh,Ke,$r,Cj,ug,Hf,Bd,Cb,To,ef,qg,Oe],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:zk,_rowHeight:Wi,_rowLineVisible:m.listViewRowLineVisible,_rowLineColor:m.listViewRowLineColor,_scrollBarColor:vq,_scrollBarSize:Wq,_autoMakeVisible:qd,_autoHideScrollBar:Re,_selectBackground:m.listViewSelectBackground,_labelColor:m.listViewLabelColor,_labelSelectColor:m.listViewLabelSelectColor,_labelFont:m.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(J){var w=this,y=w._checkMode;w._checkMode=J,w.fp(Wd,y,J)},drawRow:function(n,T,Z,a,s,o,k){var u=this,O=0,q=u._indent,H=u.getIconWidth(T);u.drawRowBackground(n,T,Z,a,s,o,k),u._checkMode&&(Si(n,Nd(u.getCheckIcon(T)),O+q/2,s+k/2,T,u),O+=q),u.drawIcon(n,T,O,s,H,k),u.drawLabel(n,T,O+H,s,k)}});var nt=function(_){this.list=_,this.addListeners()};mj(nt,t,{ms_listener:1,getView:function(){return this.list._view},clear:function(U){var m=this,H=m.list;U&&"d"===m._62O&&!m.dragCancel&&H.handleDragAndDrop(U,"end"),H.draggingData&&(H.draggingData=null,H.redraw()),m.dragCancel=m._62O=m._isV=m._isH=m.cp=m.tx=m.ty=G},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(o){var n=this,Y=n.list;if(Ji(o),Y.setFocus(o)){var d=Y.getDataAt(o);n.cp=Lp(o),n.tx=Y.tx(),n.ty=Y.ty(),Cm(o)?d&&Y.handleDragAndDrop&&!n.isV(o)&&!n.isH(o)&&(Y.draggingData=d,Y.redraw(),Y.handleDragAndDrop(o,"prepare")):(d?n._33o(o,d):this._cancelDataDoubleSelect(),n.clear(o))}},handleWindowMouseUp:function(i){this.clear(i)},handleWindowTouchEnd:function(S){this.clear(S)},handle_mouseup:function(m){this.handle_touchend(m)},handle_touchend:function(U){var k=this,I=k.list;if(!k._isV&&!k._isH&&k.cp&&!k._62O){var L=I.getDataAt(U);L?(I.isCheckMode()?k._34o(U,L):k._33o(U,L),bb(U)?I.onDataDoubleClicked(L,U):I.onDataClicked(L,U)):(k._cancelDataDoubleSelect(),I.handleBackgroundClick(U))}k.clear(U)},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(U){var p=this,C=p.list,e=p._62O,Q=p.tx,s=p.ty,J=p.cp,F=Lp(U),G=C._29I;"p"===e?C.setTranslate(Q+F.x-J.x,s+F.y-J.y):"v"===e?C.ty(s+(J.y-F.y)*C._59I/G.height):"h"===e?C.tx(Q+(J.x-F.x)*C._91I/G.width):"d"===e&&(p.dragCancel||C.handleDragAndDrop(U,"between"))},handle_mousemove:function(A){this.handle_touchmove(A)},handle_touchmove:function(x){if(!Mg&&Cm(x)){var y=this,i=y.list;if(y._isV=y.isV(x),y._isH=y.isH(x),y.cp){if(!y._62O){if(qj(Lp(x),y.cp)<2)return;y._isV?y._62O="v":y._isH?y._62O="h":i.draggingData&&!this.dragCancel?(y._62O="d",i.handleDragAndDrop(x,"begin")):y._62O="p",y._62O&&"d"!==y._62O&&i.draggingData&&(i.draggingData=null,i.redraw()),nr(y,x)}}else y._isV&&i._43o(),y._isH&&i._42o()}},isV:function(o){var Z=this.list,E=Z._29I;return Z._41o()&&E.x+E.width-Z.lp(o).x<Tj},isH:function(G){var k=this.list,t=k._29I;return k._40o()&&t.y+t.height-k.lp(G).y<Tj},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40,j.wheelDelta!==j.wheelDeltaX)},handle_DOMMouseScroll:function(d){this.handleScroll(d,-d.detail,1)},handleScroll:function(f,W,T){var b=this.list;Ji(f),b.endEditing&&b.endEditing(),T&&b._41o()?b.translate(0,W*b.getRowHeight()):b._40o()&&b.translate(10*W,0)},handle_keydown:function(V){if(!m.isInput(V.target)){var k,Q=this.list,S=Q.sm(),R=Q._rows,q=R.size();if(Xe(V))Q.selectAll();else if(ls(V))Q.handleDelete&&Q.handleDelete(V);else if(fp(V))"d"!==this._62O||this.dragCancel||(Q.handleDragAndDrop(V,"cancel"),this.dragCancel=!0);else if(tk(V))Q.isCheckMode()&&(k=Q.getFocusData(),k&&Q.checkData(k));else if(cn(V)||qo(V)){var G=Q.isCheckMode();if(k=G?Q.getFocusData():S.ld()){var e=Q.getRowIndex(k);e>=0&&(cn(V)?0!==e&&(k=R.get(e-1),G?Q.setFocusData(k):S.ss(k)):e!==q-1&&(k=R.get(e+1),G?Q.setFocusData(k):S.ss(k)))}else q>0&&(k=R.get(0),G?Q.setFocusData(k):S.ss(k))}}},_34o:function(i,h){var F=this.list,e=F.lp(i).x;return e>=0&&e<=F._indent?(F.checkData(h),void 0):(F.setFocusData(h),void 0)},_33o:function(t,_){var X=this.list,a=X.sm(),C=a.ld();if(!X.canHandleSelectMode(t,_))return this._cancelDataDoubleSelect(),void 0;if(hi(t))X.isSelected(_)?a.rs(_):a.as(_);else if(Fj(t))if(C)for(var P=X.getRowIndex(C),z=X.getRowIndex(_);P!==z;)P+=z>P?1:-1,a.as(X._rows.get(P));else a.ss(_);else Cm(t)?(a.contains(_)?X.handleDataDoubleSelect&&(this._handleDataDoubleSelect(t,_),bb(t)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),a.ss(_)):a.contains(_)||a.ss(_)},_handleDataDoubleSelect:function(K,u){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Qi(function(){this.list.handleDataDoubleSelect(K,u),this._doubleSelectTimer=D}.bind(this),m.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(ii(this._doubleSelectTimer),this._doubleSelectTimer=D)}}),ft.TreeView=function(p){var q=this;q._35o(),q._5o(p),new ot(q)},gt("TreeView",t,{ms_ac:[Hl,ue,Vh,"rootVisible",Wd,"rootData",Hf,Bd,Cb,To,ef,$r,Ke,Cj,ug,Sm,Ge,qg,Oe,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:G,_indent:zk,_rowHeight:Wi,_rowLineVisible:m.treeViewRowLineVisible,_rowLineColor:m.treeViewRowLineColor,_scrollBarColor:vq,_scrollBarSize:Wq,_autoHideScrollBar:Re,_expandIcon:m.treeViewExpandIcon,_collapseIcon:m.treeViewCollapseIcon,_autoMakeVisible:qd,_selectBackground:m.treeViewSelectBackground,_labelColor:m.treeViewLabelColor,_labelSelectColor:m.treeViewLabelSelectColor,_labelFont:m.treeViewLabelFont,_doubleClickToToggle:m.treeViewDoubleClickToToggle,drawRow:function(L,l,N,Y,_,j,D){var x=this;x.drawRowBackground(L,l,N,Y,_,j,D),x.drawTree(L,l,N,0,_,j,D)},isOnToggleIcon:function(d){var M=this.getDataAt(d);if(M){var o=this.getIndent(),e=this.lp(d).x;if(Nd(this.getToggleIcon(M))){var L=o*this.getLevel(M);if(e>=L&&L+o>=e)return!0}}return!1}});var ot=function(y){ln(ot,this,[y])};mj(ot,nt,{toggle:function(I,y,O,H){var P=this.list,Q=P.lp(I).x;if(Nd(P.getToggleIcon(y))){var k=O*H;if(Q>=k&&k+O>=Q)return P.toggle(y),!0}return P.isDoubleClickToToggle()&&bb(I)?(P.toggle(y),!0):!1},_34o:function(o,H){var u=this.list,$=u.lp(o).x,D=u._levelMap[H._id],v=u._indent,q=v*(D+1);return $>=q&&q+v>=$?(u.checkData(H),void 0):(this.toggle(o,H,v,D)||u.setFocusData(H),void 0)},_33o:function(d,c){var k=this,f=k.list;if(!k.toggle(d,c,f._indent,f.getLevel(c)))if(Fj(d)){var S=f.sm();if(S.size()>0){for(var M=f._rows,g=null,s=0,I=M.size();I>s;s++)if(f.isSelected(M.get(s))){g=s;break}for(var R=null,s=M.size()-1;s>=0;s--)if(f.isSelected(M.get(s))){R=s;break}var Z,H,F=f.getRowIndex(c);for(g>F?(Z=F-1,H=g):F>R?(Z=R,H=F):(Z=g,H=R);Z!==H;)Z++,S.as(f._rows.get(Z))}else S.ss(c)}else ot.superClass._33o.call(k,d,c)},handle_keydown:function(s){if(op(s)||tn(s)){var n=this.list,E=n._rows,Y=n.isCheckMode(),G=n.sm(),x=Y?n.getFocusData():G.ld();x?x.hasChildren()&&(op(s)?n.collapse(x):n.expand(x)):E.size()>0&&(x=E.get(0),Y?n.setFocusData(x):G.ss(x))}else ot.superClass.handle_keydown.call(this,s)}});var pt=ft.TableView=function(w){this._98I(),this._5o(w),new qt(this)};gt("TableView",t,{ms_ac:[Hl,ue,Vh,"sortMode",rc,ak,Ke,Cj,ug,Qb,Kh,"sortColumn",Hf,Bd,Cb,To,ef,qg,Oe],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:hl,_editable:!0,_batchEditable:!1,_rowHeight:Wi,_rowLineVisible:m.tableViewRowLineVisible,_rowLineColor:m.tableViewRowLineColor,_columnLineVisible:m.tableViewColumnLineVisible,_columnLineColor:m.tableViewColumnLineColor,_scrollBarColor:vq,_scrollBarSize:Wq,_autoHideScrollBar:Re,_autoMakeVisible:qd,_selectBackground:m.tableViewSelectBackground,_labelColor:m.tableViewLabelColor,_labelSelectColor:m.tableViewLabelSelectColor,_labelFont:m.tableViewLabelFont,getCheckColumn:function(){var p=this;if(!p._31o){var j=p._31o=new it;j.setEditable(!0),j.setWidth(40),j.getValue=p.getCheckColumValue,j.drawCell=p.drawCheckColumnCell}return p._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(F){var u=this,j=u._39o,e=u.getCheckColumn();F!==u.isCheckMode()&&(F?j.add(e,0):j.remove(e),u.fp(Wd,!F,F))},getCheckColumValue:function(y,h,w){return w.isSelected(y)},drawCheckColumnCell:function(g,l,H,a,k,F,V,E,i){Si(g,i.getCheckIcon(l),k+V/2,F+E/2,l,i)}});var qt=function(g){ln(qt,this,[g])};mj(qt,nt,{_34o:function(z,S){var c=this.list,_=c._31o;if(c.isCellEditable(S,_,z)){var t=c._3Q(_),E=c.lp(z).x;if(t&&E>=t.startX&&E<t.startX+_.getWidth())return c.checkData(S),void 0}c._37O(S,z),c.setFocusData(S)},_33o:function(p,T){this.list._37O(T,p),qt.superClass._33o.apply(this,arguments)}});var rt=ft.TreeTableView=function(T){var j=this,B=j._4o=new it;j._35o(),j._98I(),j._5o(T),B.setDisplayName("Name"),B.setEditable(!0),B.setWidth(180),B.drawCell=st,B.getValue=tt,j._39o.add(B),new ut(j)},st=function(f,b,W,U,r,S,k,F,H){H.drawTree(f,b,W,r,S,k,F)},tt=function(U,e,c){return c.getLabel(U)};gt("TreeTableView",t,{ms_ac:[Hl,ue,Vh,"sortMode",rc,ak,$r,Wd,"rootData","rootVisible",Hf,Bd,"sortColumn",Sm,Ge,Cb,To,ef,qg,ug,Ke,Cj,Qb,Kh,Oe,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:hl,_checkMode:G,_editable:!0,_batchEditable:!1,_indent:zk,_rowHeight:Wi,_rowLineVisible:m.treeTableViewRowLineVisible,_rowLineColor:m.treeTableViewRowLineColor,_columnLineVisible:m.treeTableViewColumnLineVisible,_columnLineColor:m.treeTableViewColumnLineColor,_expandIcon:m.treeTableViewExpandIcon,_collapseIcon:m.treeTableViewCollapseIcon,_scrollBarColor:vq,_scrollBarSize:Wq,_autoHideScrollBar:Re,_autoMakeVisible:qd,_selectBackground:m.treeTableViewSelectBackground,_labelColor:m.treeTableViewLabelColor,_labelSelectColor:m.treeTableViewLabelSelectColor,_labelFont:m.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var ut=function(y){ln(ut,this,[y])};mj(ut,nt,{_34o:function(N,L){var Q=this.list,J=Q._4o,p=Q._3Q(J),z=Q.lp(N).x;if(p){var l=Q._indent,W=p.startX+l*Q.getLevel(L);if(Nd(Q.getToggleIcon(L))&&z>=W&&W+l>=z)return Q.toggle(L),void 0;if(Q.isCellEditable(L,J)&&(W+=l,z>=W&&W+l>=z))return Q.checkData(L),void 0}Q._37O(L,N),Q.setFocusData(L)},_33o:function(z,$){var j=this.list,U=j.lp(z).x;if(Nd(j.getToggleIcon($))){var g=j._3Q(j._4o);if(g){var E=j._indent,X=g.startX+E*j.getLevel($);if(U>=X&&X+E>=U)return j.toggle($),void 0}}j._37O($,z),ut.superClass._33o.apply(this,arguments)}});var vt=ft.TableHeader=function(C){var w=this,k=w._view=Qo(1,w),h=w._39o=C.getColumnModel(),r=w.iv;w.tv=w._tableView=C,w._60I=new pq,w._canvas=Ae(k),k.style.background=m.tableHeaderBackground||"",k.style.height=hd+Fn,h.mm(r,w),h.md(r,w),h.mh(r,w),C.mp(function(Y){Ys[Y.property]&&w.iv()},w),new wt(w),w.iv()};gt("TableHeader",t,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Hl,Vh,$r,"moveBackground","insertColor",Qb,Kh,"resizable","movable"],_checkIcon:sd,_movable:!0,_resizable:!0,_labelColor:m.tableHeaderLabelColor,_labelFont:m.tableHeaderLabelFont,_columnLineColor:m.tableHeaderColumnLineColor,_columnLineVisible:m.tableHeaderColumnLineVisible,_sortDescIcon:m.tableHeaderSortDescIcon,_sortAscIcon:m.tableHeaderSortAscIcon,_moveBackground:m.tableHeaderMoveBackground,_insertColor:m.tableHeaderInsertColor,_indent:zk,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(z){return z.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(F){return F.getColor()||this._labelColor},getLabelAlign:function($){return $._align},onPropertyChanged:function(){this.iv()},_5Q:function(Y){this._61I=Y,this.iv()},getLogicalPoint:function($){return Dg($,this._canvas,this.tv.tx())},validateImpl:function(){var V=this,x=V._canvas,z=V.getWidth(),I=V.getHeight(),k=V.tv,f=V._60I,y=V._61I,m=-k.tx(),q=0;(z!==x.clientWidth||I!==x.clientHeight)&&Ek(x,z,I),f.clear(),V._39o._roots.each(function(O){if(O.isVisible()){var o=q+O.getWidth();m+z>=q&&o>=m&&f.add({column:O,startX:q}),q=o}});var T=Nm(x);if(jf(T,-m,0,1),T.beginPath(),T.rect(m,0,z,I),T.clip(),T.clearRect(m,0,z,I),f.each(function(f){var e=f.column,h=f.startX,c=e.getWidth();c>0&&(T.save(),T.beginPath(),T.rect(h,0,c,I),T.clip(),y&&y.column===e||V.drawColumn(T,e,h,0,c,I),V._columnLineVisible&&zd(T,h+c-1,0,1,I,V._columnLineColor),T.restore())}),y){var M=y.column,q=y.startX,g=y.position,A=M.getWidth();T.save(),T.beginPath(),T.rect(q,0,A,I),T.clip(),T.fillStyle=V._moveBackground,T.fill(),V.drawColumn(T,M,q,0,A,I),T.restore(),Um(T,V._insertColor,g,0,I)}T.restore()},_6Q:function(O){var z=this.tv;return z._31o===O&&z.sm().getSelectionMode()===xk},drawColumn:function(Y,I,B,$,V,h){var F=this,X=F.tv,t=Nd(I.getIcon()),G=F.getLabelAlign(I);if(F._6Q(I)){var N=Nd(F._checkIcon);Si(Y,N,B+V/2,$+h/2,I,F)}else{var O=F.getLabel(I),g=F.getLabelFont(I),p=F.getLabelColor(I),f=Vd(g,O).width,L=t?F._indent:0;G===xb?(t&&gr(Y,t,Im,B,$,L,h),Se(Y,O,g,p,B+L,$,V,h,xb)):G===ui?(t&&gr(Y,t,Im,B+V-f-L,$,L,h),Se(Y,O,g,p,B,$,V,h,ui)):(t&&gr(Y,t,Im,B+(V-f-L)/2,$,L,h),Se(Y,O,g,p,B+(V-f+L)/2,$,0,h,xb))}if(I.isSortable()&&X.getSortColumn()===I&&(t=Nd(I.getSortOrder()===nb?F._sortAscIcon:F._sortDescIcon))){var T=Ur(t,I)/2+2;Si(Y,t,G===ui?B+T:B+V-T,$+h/2,I,X)}}});var wt=function(z){var l=this;l.th=z,l.tv=z._tableView,l.addListeners()};mj(wt,t,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(Q){this.getView().style.cursor=Q},handle_mousemove:function(Q){if(!Mg){var V=this;delete V._29o,V.setCursor(Qg);for(var W=V.th,B=W._60I,n=W.lp(Q).x,c=B.size()-1;c>=0;c--){var Z=B.get(c),L=Z.column,p=Z.startX+L.getWidth();if(W.isResizable()&&E(p-n)<=(yr?10:3))return V._29o=Z,V.setCursor(qe),void 0;n>Z.startX&&p>n&&(V._29o=Z),(L.isClickable()||L.isSortable()||W.isMovable()||V.tv.getCheckColumn&&L===V.tv.getCheckColumn())&&n>Z.startX&&p>n&&V.setCursor(Cd)}}},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(K){var D=this;Ji(K),D.tv.endEditing(),D.handle_mousemove(K),D._29o&&(D.x=Lp(K).x,D.lx=D.th.lp(K).x,D.w=D._29o.column.getWidth(),nr(D,K))},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(x){var G=this,j=G.th,v=G.getView().style.cursor,R=G._29o,t=Lp(x).x-G.x;if(G.resizing||G.moving||(v===qe?G.resizing=1:j.isMovable()&&v===Cd&&E(t)>2&&(G.moving=1)),G.resizing)R.column.setWidth(G.w+t);else if(G.moving){var b=G.lx+t;j._60I.each(function(O){var f=O.startX,z=f+O.column.getWidth();if(b>=f&&z>=b){var L={column:R.column,startX:R.startX+t,front:z-b>b-f,insertColumn:O.column};L.position=L.front?f:z,j._5Q(L)}})}},_16Q:function(v,s){var q=this,o=q.tv,p=q.th,L=p._checkIcon;if(p._6Q(v)){var n=Nd(L),r=q.lx,R=v.getWidth(),O=Ur(n,v);if(r>=s+R/2-O&&s+R/2+O>=r){p.setCheckIcon(L===mg?sd:mg);var Z=o.sm(),T=o._rows;return L===mg?Z.rs(T):Z.ss(T),o.onCheckColumnClicked(v),!0}}return!1},handleWindowMouseUp:function(w){this.handleWindowTouchEnd(w)},handleWindowTouchEnd:function(k){var j=this,r=j.tv,M=j.th,c=j._29o;if(j.moving){var h=M._61I;if(h&&h.insertColumn!==h.column){var F=h.column,i=r.getColumnModel()._roots,Z=i.remove(F),U=i.indexOf(h.insertColumn);U>=0&&(h.front||U++,U<=i.size()&&(i.add(F,U),r.getColumnModel()._38I(F,Z,U)))}M._5Q(G),delete j.moving}else if(!j.resizing&&c){F=c.column;var e=M.lp(k).x,V=c.startX,D=!0;if(M.onColumnClicked){var y=M.onColumnClicked(F,k,V);y===!1&&(D=!1)}if(D&&e>=V&&e<=V+F.getWidth()&&!j._16Q(F,V)){if(F.isSortable()){var L=r.getSortMode(),f=F.getSortOrder();L===hl?r.getSortColumn()===F?(f===Jh&&r.setSortColumn(G),F.setSortOrder(f===nb?Jh:nb)):r.setSortColumn(F):"bistate"===L&&(r.getSortColumn()===F?F.setSortOrder(f===nb?Jh:nb):r.setSortColumn(F))}r.onColumnClicked(F,k,V)}}j._29o=j.resizing=j.x=j.lx=j.w=G}}),ft.TablePane=function(p){this.init(new pt(p))},gt("TablePane",t,{ms_v:1,_44o:1}),ft.TreeTablePane=function($){this.init(new rt($))},gt("TreeTablePane",t,{ms_v:1,_44o:1}),ft.Toolbar=function(f){var M=this,t=M._view=Qo(1,M),z=t.style;z.background=m.toolbarBackground||"",z.height=Lm+Fn,M._canvas=Ae(t),M._30o=new pq,M._90I=new pq,M.setItems(f||[]),t.handleGroupSelectedChanged=function(P){if(P.isSelected()){var d=P.getGroupId();null!=d&&M._items.forEach(function(k){var r=k.element;r&&r!==P&&r.setSelected&&r.getGroupId&&r.getGroupId()===d&&r.setSelected(!1)})}},new xt(M)},gt("Toolbar",t,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[gg,Hl,Vh,ue,Oe,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:m.toolbarLabelColor,_labelSelectColor:m.toolbarLabelSelectColor,_labelFont:m.toolbarLabelFont,_selectBackground:m.toolbarSelectBackground,_itemGap:m.toolbarItemGap,_separatorColor:m.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(C){var P=this.getItemInfoAt(C);return P?P.item.toolTip:G},getLabelColor:function(U){return U&&U.selected&&U.type!==mg&&U.type!==Qd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(E){this.iv(),E.property===gg&&this._items.forEach(function(L){Cc(L)})},redraw:function(){this.iv()},addItem:function(w,L){var X=this._items;L==G?X.push(w):X.splice(L,0,w),this.fp(gg,G,X)},removeItem:function(j){if(j)for(var f=this._items,w=0;w<f.length;w++)j===f[w]&&(f.splice(w,1),this.fp(gg,G,f))},removeItemById:function(b){if(b!=G)for(var X=this._items,i=0;i<X.length;i++)if(b===X[i].id){var u=X.splice(i,1)[0];return this.fp(gg,G,X),u}},getItemById:function(t){if(t!=G)for(var r=this._items,Z=0;Z<r.length;Z++){var R=r[Z];if(t===R.id)return R}},setItemVisible:function(e,q){var t=this.getItemById(e);t&&(t.visible=q)},getItemInfos:function(){return this._30o},getItemInfoAt:function(d){var N=this,D=0,P=N._30o,B=N.lp(d),z=B.x,I=B.y;if(I>=0&&I<=N.getHeight())for(;D<P.size();D++){var s=P.get(D);if(s.startX<=z&&z<=s.endX)return s}return G},drawItem:function(c,T,P,X,F){if(T.visible===!1)return 0;if(Yo(T.visible)&&!T.visible())return 0;var V=this,h=T.disabled;h&&(c.globalAlpha=_m);var N=V.drawItemImpl(c,T,P,X,F),C=V._itemGap;return h&&(c.globalAlpha=1),this._currentItem!==T||"separator"===T||T.separator===!0||T.unfocusable||to(c,V._separatorColor,P-C/2,0,N+C,X),N},drawItemImpl:function(z,_,R,t,$){var C=this,j=C._view,p=C._itemGap,k=t/2,m=_.type,b=_.element,J=_.label;on(b)&&(J=b,b=G);var X,U=C.getLabelFont(_),Y=C.getLabelColor(_),E=_.selected,A=Nd(_.icon),w=Ur(A,_),h=0,D=w+(J?Vd(U,J).width:0);if("separator"===_||_.separator===!0)return Um(z,C._separatorColor,R,t/4,k),1;if(b){A&&Si(z,A,R+w/2,k,_,C),Se(z,J,U,Y,R+w,0,0,t);var S=tf(b);$||C._90I.add(S),S.parentNode!==j&&ar(j,S),b.iv&&b.iv(),b.validate&&b.validate();var d=S.getBoundingClientRect(),Z=d.width,u=S.style;return vi(S),u.left=C.tx()+R+D+Fn,u.top=(t-d.height)/2+Fn,D+Z}return m===Qd?X=Nd(E?wo:Jk):m===mg&&(X=Nd(E?mg:sd)),X?(h=Ur(X,_),Si(z,X,R+h/2,k,_,C),R+=h,D+=h):E&&zd(z,R-p/2,0,D+p,t,C.getSelectBackground(_)),A&&Si(z,A,R+w/2,k,_,C),Se(z,J,U,Y,R+w,0,0,t),D},validateImpl:function(){var f=this,H=f._canvas,m=f.getWidth(),G=f.getHeight(),C=f._30o,z=f._items;Ek(H,m,G);var W=Nm(H),M=f._itemGap,r=M/2;jf(W,f.tx(),0,1),W.clearRect(0,0,m,G);var b=f._90I;f._90I=new pq,C.clear(),z.forEach(function(l){var $=f.drawItem(W,l,r,G);C.add({item:l,startX:r,endX:r+$,width:$}),$&&(r+=$+M)}),b.each(function(F){f._90I.contains(F)||Rl(F)});var A=f._64I;f._64I=L(0,r),W.restore(),f._stickToRight?(f._65O=0,W=Nm(H),r=m-f._64I+M,jf(W,0,0,1),W.clearRect(0,0,m,G),C.clear(),z.forEach(function(U){var Q=f.drawItem(W,U,r,G,!0);C.add({item:U,startX:r,endX:r+Q,width:Q}),Q&&(r+=Q+M)}),W.restore()):f.tx(f.tx()),A!==f._64I&&f.onSumWidthChanged(A,f._64I)},onSumWidthChanged:function(){},handleClick:function(B,A){var f=this,q=B.type,t=B.action,L=B.groupId,e=B.selected;B.disabled||(L!=G?e||(B.selected=!0,this._items.forEach(function(k){k.groupId===L&&B!==k&&(k.selected=!1)}),t&&B.action(B,f,A)):q===mg||"toggle"===q?(B.selected=!e,t&&B.action(B,f,A)):t&&B.action(B,f,A)),rn(),f.iv()}});var xt=function(i){this.tb=i,this.addListeners()};mj(xt,t,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(N){this.handleScroll(N,10*(N.wheelDelta/40))},handle_DOMMouseScroll:function(p){this.handleScroll(p,10*-p.detail)},handleScroll:function(o,v){Ji(o);var P=this.tb;P.isScrollable()&&!P._stickToRight&&(P.tx(P.tx()+v),Zm())},handle_mousemove:function(g){var P=this;Mg||P.setItem(g)},handle_mouseout:function(p){var i=this;p.target===i.getView()?i.tb.setCurrentItem(G):i.handle_mousemove(p)},handle_mousedown:function(k){this.handle_mousemove(k),this.handle_touchstart(k)},handle_touchstart:function(p){var S=this,K=S.tb,i=p.target;Cm(p)&&(i===S.getView()||i===K._canvas)&&(Ji(p),K.setFocus(p)&&(this.setItem(p,!0),(K.isScrollable()||S.info&&!S.info.item.disabled)&&(S.x=Lp(p).x,S.tx=K.tx(),nr(S,p))))},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(z){var T=this,K=T.tb;if(!K._stickToRight){var s=Lp(z).x-T.x;!T._25o&&E(s)>2&&K.isScrollable()&&(T._25o=1),T._25o&&K.tx(T.tx+s)}},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},handleWindowTouchEnd:function(f){var E=this,e=E.tb,j=E.info,P=E.tb.getItemInfoAt(f);if(!E._25o&&j){var h=j.item;P&&P.item===h&&e.handleClick(h,f)}E._25o=E.x=E.tx=G,E.setItem()},setItem:function(d,I){var Q=this,r=Q.tb,Z=Q.info=d?r.getItemInfoAt(d):G,H=Z?Z.item:G;r.setCurrentItem(H),I&&H&&Yo(H.onDown)&&H.onDown(d)}}),ft.BorderPane=function(){this._view=Qo(1,this),this.iv()},gt("BorderPane",t,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(n,k){this._12o("leftView",n),k!=G&&this.setLeftWidth(k)},getRightView:function(){return this._rightView},setRightView:function(Q,g){this._12o("rightView",Q),g!=G&&this.setRightWidth(g)},getTopView:function(){return this._topView},setTopView:function(v,J){this._12o("topView",v),J!=G&&this.setTopHeight(J)},getBottomView:function(){return this._bottomView},setBottomView:function(p,o){this._12o("bottomView",p),o!=G&&this.setBottomHeight(o)},getCenterView:function(){return this._centerView},setCenterView:function(o){this._12o("centerView",o)},_12o:function(E,c){var n=this,V="_"+E,H=n._view,Z=n[V];Z!==c&&(Z&&(Z.getView?Rl(Z.getView()):Rl(Z)),n[V]=c,c&&(c.getView?ar(H,c.getView(),1):ar(H,c,1)),n.fp(E,Z,c))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var F=this,$=F._topView,t=F._bottomView,Y=F._leftView,i=F._rightView,_=F._centerView,B=F.getWidth(),C=F.getHeight(),V=0,M=0,E=B,b=C,z=0,h=0,c=0,N=0;$&&(z=F._topHeight==G?ao($):F._topHeight,M=z),t&&(h=F._bottomHeight==G?ao(t):F._bottomHeight,b=C-h),Y&&(c=F._leftWidth==G?bp(Y):F._leftWidth,V=c),i&&(N=F._rightWidth==G?bp(i):F._rightWidth,E=B-N);var R=L(0,E-V),W=L(0,b-M);$&&ne($,0,0,B,z),t&&ne(t,0,b,B,h),Y&&ne(Y,0,M,c,W),i&&ne(i,E,M,N,W),_&&ne(_,V,M,R,W)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);