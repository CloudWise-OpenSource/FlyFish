(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{885:function(e,o,i){"use strict";i.r(o),function(e){var t=i(229),n=i(972),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,a=arguments[t];for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=Object(t.b)(function(e,t){return a({},t,{PluginListReducer:e.PluginListReducer})})(n.a);o.default=function(){return e.createElement(r,null)}}.call(this,i(1))},941:function(e,t,n){"use strict";n.d(t,"g",function(){return o}),n.d(t,"f",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return p}),n.d(t,"e",function(){return g});var a=n(14),s=n(173),r=n(23),o=function(e){return function(i){i({type:s.c}),a.a.request.postJSON(r.a.pluginList,e).then(function(e){var t,n,a,r,o;i((t=e.data,n=t.page,a=t.pageSize,r=t.totalCount,e=t.pageCount,t=t.list,o=[],t.forEach(function(n,a){var r=n.pluginList.length;n.pluginList.forEach(function(e,t){t={key:String(a)+String(t),hubStatus:n.hubStatus,hostIp:n.nodeIp,pluginName:e.pluginName,pluginType:e.pluginType,pluginStatus:e.status,task:e.taskCount,worker:n.hubStatus,pluginId:e.pluginId,nodePort:e.nodePort,instanceId:e.instanceId,hostNum:t,pluginLen:r};o.push(t)})}),{type:s.b,data:o,page:n,pageSize:a,totalCount:r,pageCount:e}))},function(e){a.a.prompt.error(e.msg)})}},i=function(){return function(t){a.a.request.get(r.a.hostAllList).then(function(e){t((e=e.data,{type:s.a,hostListData:e}))},function(e){a.a.prompt.error(e.msg)})}},u=function(e,t,n){return a.a.request.get(r.a.hostList,{page:e,pageSize:t,ip:n})},l=function(e){return a.a.request.postJSON(r.a.submitPlugin,e)},c=function(e){return a.a.request.postJSON(r.a.startPlugin,e)},p=function(e){return a.a.request.postJSON(r.a.stopPlugin,e)},g=function(e){return a.a.request.postJSON(r.a.uninstallPlugin,e)}},972:function(e,v,E){"use strict";!function(u){E.d(v,"a",function(){return n});E(115);var l=E(38),c=(E(183),E(68)),o=E(14),e=E(886),p=E.n(e),g=E(859),d=E(21),a=E(973),r=E(974),h=E(858),t=E(1),f=E(860),m=E(228),b=E(231),i=E(941),e=function(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e};function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var y=c.a.Option,n=o.a.decorator.contextTypes("router","store")((function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(P,t.PureComponent),e(P,[{key:"showPluginDispatch",value:function(e){var t=this,n=this.props.PluginListReducer.pluginListParams;o.a.helper.renderModal(u.createElement(a.a,{pluginListParams:n,record:e,getPluginList:function(){return t.getPluginList(n)}}))}},{key:"componentDidMount",value:function(){this.getPluginList(),this.context.store.dispatch(Object(i.f)())}},{key:"getPluginList",value:function(){var e=this.props.PluginListReducer.pluginListParams;this.context.store.dispatch(Object(i.g)(e))}},{key:"changeHost",value:function(e){var t=this.props.PluginListReducer.pluginListParams;t.ipList=e,this.context.store.dispatch(Object(i.g)(t))}},{key:"startPlugin",value:function(e){var t=e.hostIp,n=e.instanceId,e=e.nodePort,a=this.props.PluginListReducer.pluginListParams,r=this,e={nodeIp:t,instanceId:n,nodePort:e};Object(i.c)(e).then(function(e){r.context.store.dispatch(Object(i.g)(a))},function(e){o.a.prompt.error(e.msg)})}},{key:"stopPlugin",value:function(e){var t=e.hostIp,n=e.instanceId,e=e.nodePort,a=this.props.PluginListReducer.pluginListParams,r=this,e={nodeIp:t,instanceId:n,nodePort:e};Object(i.d)(e).then(function(e){r.context.store.dispatch(Object(i.g)(a))},function(e){o.a.prompt.error(e.msg)})}},{key:"unInstallPluginModal",value:function(e){var t=this,n=this.props.PluginListReducer.pluginListParams;o.a.helper.renderModal(u.createElement(r.a,{record:e,pluginListParams:n,getPluginList:function(){return t.getPluginList(n)}}))}},{key:"changePage",value:function(e){var t=e.current,e=this.props.PluginListReducer.pluginListParams;e.page=t,e.ipList=[],this.context.store.dispatch(Object(i.g)(e))}},{key:"mergeRow",value:function(e,t,n){e={children:e,props:{}};return e.props.rowSpan=0==n?t:0,e}},{key:"render",value:function(){var r=this,e=this.props.PluginListReducer,t=e.pluginListData,n=e.loading,a=e.hostListData,o=e.pluginListParams,i=e.totalCount,e=o.page,o=o.pageSize,s=this,o={current:e,pageSize:o,total:i},i=[{title:"Hub状态",dataIndex:"hubStatus",render:function(e,t,n){var a=u.createElement("div",{className:Number(e)===f.b.using.value?p.a[f.b.using.className]:p.a[f.b.stop.className]},u.createElement("span",null)),e=t.hostNum,t=t.pluginLen;return r.mergeRow(a,t,e)}},{title:"主机IP",dataIndex:"hostIp",render:function(e,t,n){var a=t.hostNum,t=t.pluginLen;return r.mergeRow(e,t,a)},key:"hostIp"},{title:"插件名称",dataIndex:"pluginName",key:"pluginName"},{title:"插件类型",dataIndex:"pluginType",render:function(t){return f.e.filter(function(e){return e.value===t})[0].label}},{title:"插件状态",dataIndex:"pluginStatus",render:function(e){return(Number(e)==f.b.using.value?f.b.using:f.b.stop).label}},{title:"任务",dataIndex:"task",render:function(e,t,n){return u.createElement(m.a,{to:{pathname:d.a.dHub_pluginTask,search:"?instanceId="+t.instanceId+"&nodeIp="+t.hostIp+"&nodePort="+t.nodePort+"&pluginType="+t.pluginType}},"("+e+")")}},{title:"worker",dataIndex:"worker",render:function(e,t,n){return u.createElement(m.a,{to:{pathname:d.a.dHub_pluginWorker,search:"?instanceId="+t.instanceId+"&nodeIp="+t.hostIp+"&nodePort="+t.nodePort}},"查看")}},{title:"插件管理",dataIndex:"pluginManage",render:function(e,t){return u.createElement("div",null,Number(t.pluginStatus)==f.b.using.value?u.createElement(l.a,{className:p.a.table_btn,type:"primary",icon:"minus-circle-o",onClick:function(){return r.stopPlugin(t)}},"暂停插件"):u.createElement(l.a,{className:p.a.table_btn,type:"primary",icon:"pause-circle-o",onClick:function(){return r.startPlugin(t)}},"启动插件"),u.createElement(m.a,{to:{pathname:d.a.dHub_pluginConf,search:"?instanceId="+t.instanceId+"&nodeIp="+t.hostIp+"&nodePort="+t.nodePort}},u.createElement(l.a,{className:p.a.table_btn,type:"primary",icon:"plus-square-o"},"配置")),u.createElement(m.a,{to:{pathname:d.a.dHub_pluginLog,search:"?instanceId="+t.instanceId+"&nodeIp="+t.hostIp+"&nodePort="+t.nodePort}},u.createElement(l.a,{className:p.a.table_btn,type:"primary",icon:"book"},"查看日志")),u.createElement(l.a,{className:p.a.table_btn,type:"primary",icon:"folder-add",onClick:function(){return s.showPluginDispatch(t)}},"分发插件"),u.createElement(l.a,{className:p.a.table_btn,type:"danger",icon:"download",onClick:function(){return s.unInstallPluginModal(t)}},"卸载"))}}];return u.createElement("div",null,u.createElement(b.b,{title:"采集器",rightRender:u.createElement(m.a,{to:{pathname:d.a.dHub_pluginUpload}},u.createElement(l.a,{type:"primary",icon:"plus"},"上传插件"))}),u.createElement(b.a,null,u.createElement("div",null,u.createElement("span",{className:p.a.hostName},"主机列表"),u.createElement(c.a,{style:{width:300},mode:"tags",className:p.a.host_sel,onChange:function(e){return r.changeHost(e)}},a.map(function(e,t){return u.createElement(y,{key:t,value:e.ip},e.ip)}))),u.createElement(h.a,{isNotData:!(0<t.length),loading:n},u.createElement(g.a,{pagination:o,dataSource:t,columns:i,onChange:function(e){return r.changePage(e)}}))))}}]),e=P))||e;function P(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}}.call(this,E(1))},973:function(e,y,P){"use strict";!function(u){P.d(y,"a",function(){return r});P(856);var l=P(857),c=(P(510),P(237)),p=(P(115),P(38)),g=(P(230),P(232)),d=(P(507),P(92)),h=(P(508),P(54)),e=P(887),f=P.n(e),o=P(14),t=P(0),n=P.n(t),m=P(858),e=P(1),s=P(941),t=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e};function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var r=o.a.decorator.propTypes({getPluginList:n.a.func.isRequired,pluginListParams:n.a.object.isRequired,record:n.a.object.isRequired})((function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(b,e.PureComponent),t(b,[{key:"componentDidMount",value:function(){this.showModal();var e=this.state,t=e.page,n=e.pageSize,e=e.ip;this.getPluginHostList(t,n,e),this.setState({loading:!0}),this.saveDispatchParams()}},{key:"getPluginHostList",value:function(e,t,n){var i=this;Object(s.a)(e,t,n).then(function(e){var t=e.data,n=t.page,a=t.pageSize,r=t.totalCount,e=t.pageCount,t=t.list,o=[];t.map(function(e,t){e={key:String(t),operator:"",hostName:e.ip,port:e.port};o.push(e)}),i.setState({page:n,pageSize:a,totalCount:r,pageCount:e,list:o,loading:!1})},function(e){o.a.prompt.error(e.msg)})}},{key:"saveDispatchParams",value:function(){var e=this.props.record,t=e.pluginId,n=e.nodePort,e=e.hostIp;this.setState({dispatchParams:{fromHost:{ip:e,port:n},pluginId:t,toHostList:[]}})}},{key:"searchHost",value:function(e){e=e.target.value;this.setState({ip:e})}},{key:"searchBtn",value:function(){var e=this.state,t=e.page,n=e.pageSize,e=e.ip;this.getPluginHostList(t,n,e)}},{key:"changePage",value:function(e){var t=e.current,e=e.pageSize;this.getPluginHostList(t,e,"")}},{key:"render",value:function(){var t=this,n=this,e=this.props.record,a=this.state,r=a.selectedRows,o=a.list,i=a.loading,s={current:a.page,pageSize:a.pageSize,total:a.totalCount},a={onChange:function(e,t){n.setState({selectedRows:t})}};return u.createElement(l.a,{cancelText:"取消",okText:"提交",title:"插件分发",width:800,visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel},u.createElement(d.a,null,u.createElement(h.a,{span:1}),u.createElement(h.a,{span:3},"待分发插件:"),u.createElement(h.a,{span:19},e.pluginName),u.createElement(h.a,{span:1})),u.createElement(d.a,{className:f.a.host_row},u.createElement(h.a,{span:1}),u.createElement(h.a,{span:3},"待分发主机:"),u.createElement(h.a,{span:8},"当前已勾选"+r.length+"台待分发主机"),u.createElement(h.a,{span:11},u.createElement(g.a,{className:f.a.search_input,onChange:function(e){return t.searchHost(e)}}),u.createElement(p.a,{type:"primary",className:f.a.search_btn,onClick:function(){return t.searchBtn()}},"搜索")),u.createElement(h.a,{span:1})),u.createElement(d.a,{className:f.a.table_row},u.createElement(m.a,{loading:i,isNotData:!(0<o.length)},u.createElement(c.a,{size:"small",pagination:s,rowSelection:a,dataSource:o,columns:[{title:"操作",dataIndex:"operator",key:"operator"},{title:"主机名称",dataIndex:"hostName",key:"hostName"}],onChange:function(e){return t.changePage(e)}}))))}}]),t=b))||t;function b(){var e,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a=i(this,(e=b.__proto__||Object.getPrototypeOf(b)).call.apply(e,[this].concat(n)))).state={loading:!1,selectedRows:[],visible:!1,page:1,pageSize:10,ip:"",totalCount:"",pageCount:"",list:[],dispatchParams:{fromHost:{ip:"",port:""},pluginId:"",toHostList:[]}},a.showModal=function(){a.setState({visible:!0})},a.handleOk=function(){var e=a.state,n=e.dispatchParams,e=e.selectedRows,t=a.props.pluginListParams;n.toHostList=[],e.map(function(e,t){e={ip:e.hostName,port:e.port};n.toHostList.push(e)}),0<n.toHostList.length?Object(s.b)(n).then(function(e){a.setState({visible:!1}),a.props.getPluginList(t)},function(e){o.a.prompt.error(e.msg)}):o.a.prompt.error("请选择主机名称")},a.handleCancel=function(){a.setState({visible:!1})},i(a,e)}}.call(this,P(1))},974:function(e,h,f){"use strict";!function(t){f.d(h,"a",function(){return g});f(856);var n=f(857),a=(f(507),f(92)),r=(f(508),f(54)),e=f(0),o=f.n(e),i=f(888),s=f.n(i),u=f(14),e=f(1),l=f(941),i=function(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e};function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=u.a.decorator.propTypes({getPluginList:o.a.func.isRequired,pluginListParams:o.a.object.isRequired,record:o.a.object.isRequired})((function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,e.PureComponent),i(d,[{key:"unInstallPlugin",value:function(){var t=this,e=this.props,n=e.pluginListParams,e=e.record,e={nodeIp:e.hostIp,instanceId:e.instanceId,nodePort:e.nodePort};Object(l.e)(e).then(function(e){t.setState({visible:!1}),t.props.getPluginList(n)},function(e){u.a.prompt.error(e.msg)})}},{key:"render",value:function(){var e=this.props.record;return t.createElement(n.a,{cancelText:"取消",okText:"提交",title:"卸载插件",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel},t.createElement(a.a,{className:s.a.row_sru_top},t.createElement(r.a,{span:2}),t.createElement(r.a,{span:20,className:s.a.col_sru_top},"您正准备卸载主机",t.createElement("span",null,e.hostIp),"上的插件",t.createElement("span",null,e.pluginType)),t.createElement(r.a,{span:2})),t.createElement(a.a,{className:s.a.row_sru_bottom},t.createElement(r.a,{span:2}),t.createElement(r.a,{span:20,className:s.a.col_sru_bottom},"插件一旦卸载，将不再执行采集任务！"),t.createElement(r.a,{span:2})))}}]),i=d))||i;function d(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);for(var n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t=p(this,(e=d.__proto__||Object.getPrototypeOf(d)).call.apply(e,[this].concat(a)))).state={visible:!0},t.showModal=function(){t.setState({visible:!0})},t.handleCancel=function(){t.setState({visible:!1})},t.handleOk=function(){t.unInstallPlugin()},p(t,e)}}.call(this,f(1))}}]);