(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{881:function(e,a,i){"use strict";i.r(a),function(e){var t=i(229),r=i(964),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=Object(t.b)(function(e,t){return n({},t,{groupListReducer:e.groupListReducer})})(r.a);a.default=function(){return e.createElement(o,null)}}.call(this,i(1))},938:function(e,t,r){"use strict";r.d(t,"h",function(){return u}),r.d(t,"c",function(){return l}),r.d(t,"a",function(){return c}),r.d(t,"e",function(){return s}),r.d(t,"b",function(){return p}),r.d(t,"f",function(){return d}),r.d(t,"d",function(){return f}),r.d(t,"g",function(){return g});var n=r(172),o=r(14),a=r(872),i=r(864),u=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t){t({type:n.b}),Object(a.c)(e).then(function(e){t({type:n.c,groupList:e.data})},function(e){o.a.prompt.error(e.msg)})}},l=function(e){return Object(a.b)(e)},c=function(e){return{type:n.a,group_id:e}},s=function(e){return Object(a.d)(e)},p=function(e){return Object(a.a)(e)},d=function(e,t){return Object(a.f)(e,t)},f=function(e){return o.a.request.all(Object(i.c)(),Object(a.e)(e))},g=function(e,t,r){return Object(a.g)(e,t,r)}},964:function(e,E,w){"use strict";!function(i){w.d(E,"a",function(){return v});w(507);var e=w(92),r=(w(230),w(232)),n=(w(508),w(54)),u=(w(115),w(38)),t=w(0),o=w.n(t),l=w(14),c=w(859),a=w(965),s=w(967),p=w(1),d=w(231),f=w(938),g=function(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e};function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=l.a.decorator.contextTypes("store")((y(b,p["PureComponent"]),g(b,[{key:"componentDidMount",value:function(){this.getGroupList()}},{key:"getGroupList",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.context.store.dispatch(Object(f.h)(e))}},{key:"addOrUpdateGroup",value:function(e,t,r){var n=this;l.a.helper.renderModal(i.createElement(a.a,{groupTree:e,root_group_id:t,parent_group_id:r,group_id:3<arguments.length&&void 0!==arguments[3]&&arguments[3],getGroupList:function(){return n.getGroupList()}}))}},{key:"delGroup",value:function(e){var t=this;l.a.prompt.confirm(function(){return Object(f.c)(e).then(function(){t.context.store.dispatch(Object(f.a)(e)),l.a.prompt.success("删除成功")},function(e){l.a.prompt.error(e.msg)})},{title:"确定删除？"})}},{key:"render",value:function(){var r=this,e=this.props.groupListReducer,t=e.loading,n=e.groupList,o=n[0]?n[0].group_id:null,a=n[0]?n[0].children:[],e=[{title:"分组名",dataIndex:"group_name"},{title:"描述",dataIndex:"description"},{title:"操作",render:function(e,t){return[i.createElement(u.a,{key:1,type:"primary",icon:"eye-o",onClick:function(){return l.a.helper.renderModal(i.createElement(s.a,{group_id:t.group_id}))}},"成员"),i.createElement(u.a,{key:2,type:"primary",icon:"edit",onClick:function(){return r.addOrUpdateGroup(n,o,t.parent_group_id,t.group_id)},style:{marginLeft:5}},"修改"),i.createElement(u.a,{key:3,type:"danger",icon:"delete",onClick:function(){return r.delGroup(t.group_id)},style:{marginLeft:5}},"删除")]}}];return i.createElement("div",null,i.createElement(d.b,{title:"分组列表",rightRender:i.createElement(u.a,{type:"primary",icon:"plus",onClick:function(){return r.addOrUpdateGroup(n,o,o)}},"添加分组")}),i.createElement(d.a,null,i.createElement(c.a,{columns:e,dataSource:a,loading:t,rowKey:function(e){return e.group_id}})))}}]),t=b))||t;function b(){return m(this,b),_(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}l.a.decorator.propTypes({doSearch:o.a.func.isRequired})((y(O,p["PureComponent"]),g(O,[{key:"render",value:function(){var t=this;return i.createElement(e.a,{gutter:0,type:"flex",align:"middle",style:{marginBottom:5}},i.createElement(n.a,{span:1},i.createElement("span",null,"名称：")),i.createElement(n.a,{span:4},i.createElement(r.a,{value:this.state.group_name,onChange:function(e){return t.setState({group_name:e.target.value.trim()})},onBlur:function(){return t.doSearch()},onKeyDown:function(e){return 13===e.keyCode&&t.doSearch()}})))}}]),g=O));function O(){m(this,O);var r=_(this,(O.__proto__||Object.getPrototypeOf(O)).call(this));return r.doSearch=function(){var e=r.props.doSearch,t=l.a.lodash.clone(r.state);l.a.lodash.isEmpty(t.group_name)&&delete t.group_name,e(t)},r.state={group_name:null},r}}.call(this,w(1))},965:function(e,j,C){"use strict";!function(l){C.d(j,"a",function(){return E});C(856);var c=C(857),s=(C(230),C(232)),p=(C(882),C(928)),d=(C(861),C(862)),f=(C(514),C(159)),e=C(0),t=C.n(e),g=C(14),h=C(858),r=C(1),m=C(966),_=C(938),y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},e=(u(b,r["PureComponent"]),n(b,[{key:"render",value:function(){var e=this.props,t=e.visible,r=e.saving,n=e.loading,o=e.onCancel,a=e.onCreate,i=e.form,u=e.formData,e=i.getFieldDecorator,i=u.groupTree;return l.createElement(c.a,{visible:t,title:u.group_id?"编辑分组":"创建分组",okText:"保存",cancelText:"取消",confirmLoading:r,onCancel:o,onOk:a},l.createElement(h.a,{loading:n},l.createElement(d.a,null,l.createElement(d.a.Item,y({},v,{label:"是否为子分组"}),e("is_children_group",{initialValue:u.is_children_group,rules:[{required:!0,message:"请填写分组名!"}]})(l.createElement(f.a.Group,{onChange:this.handleIsChildrenChange},Object.values(m.a).map(function(e){return l.createElement(f.a,{key:e.value,value:e.value},e.label)})))),this.state.is_children_group==m.a.yes.value?l.createElement(d.a.Item,y({},v,{label:"父分组"}),e("parent_group_id",{initialValue:u.parent_group_id.toString()})(l.createElement(p.a,{placeholder:"Please select",treeDefaultExpandAll:!0,treeData:i}))):null,l.createElement(d.a.Item,y({},v,{label:"分组名"}),e("group_name",{initialValue:u.group_name,rules:[{required:!0,message:"请填写分组名!"}]})(l.createElement(s.a,null))),l.createElement(d.a.Item,y({},v,{label:"描述"}),e("description",{initialValue:u.description})(l.createElement(s.a.TextArea,{rows:4}))))))}}]),b);function b(e){a(this,b);var t=i(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return t.handleIsChildrenChange=function(e){t.setState({is_children_group:e.target.value})},t.state={is_children_group:e.formData.is_children_group},t}var O=d.a.create()(e),E=g.a.decorator.propTypes({groupTree:t.a.array,root_group_id:t.a.oneOfType([t.a.string,t.a.number]),parent_group_id:t.a.oneOfType([t.a.string,t.a.number]),group_id:t.a.oneOfType([t.a.string,t.a.bool,t.a.number]),getGroupList:t.a.func.isRequired})((u(w,r["PureComponent"]),n(w,[{key:"componentDidMount",value:function(){var t=this;this.showModal();var e=this.props.group_id;e&&this.setState({loading:!0},function(){Object(_.e)(e).then(function(e){t.setState({loading:!1,data:{group_name:e.data.group_name,description:e.data.description}})},function(e){g.a.prompt.error(e.msg)})})}},{key:"render",value:function(){var t=this;return l.createElement(O,{ref:function(e){return t.form=e},formData:y({groupTree:this.formatGroupTree(this.props.groupTree),group_id:this.props.group_id,parent_group_id:this.props.parent_group_id,root_group_id:this.props.root_group_id,is_children_group:(this.props.parent_group_id==this.props.root_group_id?m.a.no:m.a.yes).value},this.state.data),visible:this.state.visible,saving:this.state.saving,loading:this.state.loading,onCancel:this.handleCancel,onCreate:this.handleCreate})}}]),w.defaultProps={groupTree:[],root_group_id:null,parent_group_id:null,group_id:null},n=w))||n;function w(){var e,s;a(this,w);for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=s=i(this,(e=w.__proto__||Object.getPrototypeOf(w)).call.apply(e,[this].concat(r)))).state={visible:!1,saving:!1,loading:!1,data:{group_name:null,description:null}},s.showModal=function(){return s.setState({visible:!0})},s.handleCancel=function(){return s.setState({visible:!1})},s.handleCreate=function(){var c=s.form;c.validateFields(function(e,t){if(e)return!1;var e=s.props,r=e.group_id,n=e.root_group_id,o=e.getGroupList,a=t.group_name,i=t.parent_group_id,u=t.is_children_group,l=t.description;s.setState({saving:!0},function(){var e,t=[function(){c.resetFields(),o(),s.setState({saving:!1}),s.handleCancel(),g.a.prompt.success("保存成功")},function(e){s.setState({saving:!1}),g.a.prompt.error(e.msg)}];i=u==m.a.no.value?n:i,r?(e=Object(_.f)(r,{parent_group_id:i,group_name:a,description:l})).then.apply(e,t):(e=Object(_.b)({parent_group_id:i,group_name:a,description:l})).then.apply(e,t)})})},s.formatGroupTree=function(e){var t=[];if(!e)return t;for(var r=0;r<e.length;r++){var n=e[r],o=n.group_id,a=n.group_name,n=n.children,o={label:a,value:o.toString(),key:o,children:null};Array.isArray(n)&&0<n.length&&(o.children=s.formatGroupTree(n)),t.push(o)}return t},i(s,e)}}.call(this,C(1))},966:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n={yes:{label:"是",value:1},no:{label:"否",value:0}}},967:function(e,O,E){"use strict";!function(o){E.d(O,"a",function(){return _});E(870);var a=E(874),i=(E(856),E(857)),u=(E(507),E(92)),l=(E(508),E(54)),e=E(0),t=E.n(e),c=E(14),s=E(858),r=E(1),p=E(938),n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=function(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e};function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _=c.a.decorator.propTypes({group_id:t.a.oneOfType([t.a.string,t.a.number])})((m(y,r["PureComponent"]),d(y,[{key:"componentDidMount",value:function(){this.showModal()}},{key:"render",value:function(){var t=this,e=this.state,r=e.visible,n=e.saving,e=this.props.group_id;return o.createElement(i.a,{width:900,visible:r,title:"管理成员",okText:"确定",cancelText:"取消",confirmLoading:n,onCancel:this.handleCancel,onOk:this.handleSave},o.createElement(u.a,{type:"flex",justify:"center"},o.createElement(l.a,null,o.createElement(v,{group_id:parseInt(e),ref:function(e){return t.refMember=e}}))))}}]),e=y))||e;function y(){var e,n;g(this,y);for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n=h(this,(e=y.__proto__||Object.getPrototypeOf(y)).call.apply(e,[this].concat(r)))).state={visible:!1,saving:!1},n.refMember=null,n.showModal=function(){return n.setState({visible:!0})},n.handleCancel=function(){return n.setState({visible:!1})},n.handleSave=function(){n.setState({saving:!0},function(){var e=n.refMember.getData(),t=e.group_id,r=e.addUsers,e=e.delUsers;Object(p.g)(t,r,e).then(function(){c.a.prompt.success("操作成功"),n.setState({saving:!1,visible:!1})},function(e){c.a.prompt.error(e.msg),n.setState({saving:!1,visible:!1})})})},h(n,e)}var v=c.a.decorator.propTypes({group_id:t.a.number.isRequired})((m(b,r["PureComponent"]),d(b,[{key:"componentDidMount",value:function(){var r=this;this.setState({loading:!0},function(){Object(p.d)(r.props.group_id).then(function(e){var t=n(e,2),e=t[0],t=t[1];r.setState({loading:!1,userOutGroup:e.data.map(function(e){return{key:e.user_id,userName:e.user_name,userEmail:e.user_email}}),userIdInGroup:t.data.map(function(e){return e.user_id})},function(){return r.originUserIdInGroup=c.a.lodash.clone(r.state.userIdInGroup)})},function(e){c.a.prompt.error(e.msg),r.setState({loading:!1})})})}},{key:"getData",value:function(){return{group_id:this.props.group_id,delUsers:c.a.lodash.difference(this.originUserIdInGroup,this.state.userIdInGroup),addUsers:c.a.lodash.difference(this.state.userIdInGroup,this.originUserIdInGroup)}}},{key:"render",value:function(){var t=this,e=this.state,r=e.loading,n=e.userIdInGroup,e=e.userOutGroup;return o.createElement(s.a,{loading:r},o.createElement(a.a,{dataSource:e,showSearch:!0,listStyle:{width:350,height:300},titles:["待添加成员","已添加成员"],searchPlaceholder:"搜索成员",operations:["添加","移除"],targetKeys:n,onChange:function(e){return t.setState({userIdInGroup:e})},render:function(e){return e.userName+"-"+e.userEmail}}))}}]),d=b))||d;function b(){var e,t;g(this,b);for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t=h(this,(e=b.__proto__||Object.getPrototypeOf(b)).call.apply(e,[this].concat(n)))).state={loading:!1,userOutGroup:[],userIdInGroup:[]},t.originUserIdInGroup=[],h(t,e)}}.call(this,E(1))}}]);