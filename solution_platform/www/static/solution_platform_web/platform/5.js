(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{880:function(e,o,i){"use strict";i.r(o),function(e){var t=i(230),n=i(963),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=Object(t.b)(function(e,t){return r({},t)})(n.a);o.default=function(){return e.createElement(a,null)}}.call(this,i(1))},939:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={user:{label:"用户",value:1},role:{label:"角色",value:2},group:{label:"分组",value:3}}},943:function(e,t,n){"use strict";n.d(t,"c",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"a",function(){return d});var r=n(863),a=n(868),o=n(871),t=n(14),i=n(23),t=t.a.request,u=t.get,c=(t.postJSON,t.del,t.put),l=n(939),s=n(862),p=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};switch(e){case l.a.user.value:return Object(r.c)(t,s.a.all.value,n);case l.a.role.value:return Object(a.c)(t,n);case l.a.group.value:return Object(o.c)(t,n)}},f=function(e,t){return u(i.a.permission_getMenuPermission,{subject_id:e,subject_type:t})},d=function(e,t,n){return c(i.a.permission_disposeMenuPermission,{subject_id:e,subject_type:t,permission:n})}},963:function(e,l,s){"use strict";!function(e){s.d(l,"a",function(){return u});s(510);var t=s(185),n=s(964),r=(s(966),s(1)),a=s(231),o=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,r.PureComponent),o(c,[{key:"render",value:function(){return e.createElement("div",null,e.createElement(a.b,{title:"权限分配"}),e.createElement(a.a,null,e.createElement(t.a,{type:"card"},e.createElement(t.a.TabPane,{tab:"栏目权限",key:"1"},e.createElement(n.a,null)))))}}]),c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}}.call(this,s(1))},964:function(e,_,j){"use strict";!function(l){j.d(_,"a",function(){return n});j(506);var s=j(92),p=(j(183),j(68)),f=(j(507),j(54)),r=(j(115),j(38)),a=j(14),d=j(858),o=j(965),e=j(1),b=j(939),h=j(870),i=j(943),t=function(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e};function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(n){function e(e,t){return l.createElement(r.a,{type:"primary",icon:"edit",onClick:function(){return a.a.helper.renderModal(l.createElement(o.a,{subject_type:n,subject_id:function(e,t){switch(e){case b.a.user.value:return t.user_id;case b.a.role.value:return t.role_id;case b.a.group.value:return t.group_id}}(n,t)}))}},"修改权限")}var t;return(y(t={},b.a.user.value,[{title:"用户名",dataIndex:"user_name"},{title:"邮箱",dataIndex:"user_email"},{title:"手机号",dataIndex:"user_phone"},{title:"创建时间",dataIndex:"created_at",render:function(e){return a.a.helper.dateFormat(e)}},{title:"操作",render:e}]),y(t,b.a.role.value,[{title:"角色名",dataIndex:"role_name"},{title:"描述",dataIndex:"description"},{title:"操作",render:e}]),y(t,b.a.group.value,[{title:"分组名",dataIndex:"group_name"},{title:"描述",dataIndex:"description"},{title:"操作",render:e}]),t)[n]}var v={count:0,pageSize:1,currentPage:1,data:[]},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(g,e.PureComponent),t(g,[{key:"componentDidMount",value:function(){this.getTargetList()}},{key:"getTargetList",value:function(){var t=this,n=this.state.subject_type;this.setState({loading:!0},function(){Object(i.c)(n).then(function(e){t.setState({loading:!1,userList:n==b.a.user.value?e.data:[],roleList:n==b.a.role.value?e.data:[],groupList:n==b.a.group.value?e.data:[]})},function(e){a.a.prompt.error(e.msg),t.setState({loading:!1})})})}},{key:"render",value:function(){var t=this,e=this.state,n=e.subject_type,r=e.loading,a=e.userList,o=e.roleList,i=e.groupList,u=m(n),c=[];return n==b.a.role.value&&o.forEach(function(e){e.role_type!=h.a.admin.value&&c.push(e)}),l.createElement("div",null,l.createElement(s.a,{gutter:0,type:"flex",align:"middle",style:{marginBottom:5}},l.createElement(f.a,{span:1},l.createElement("span",null,"对象类型：")),l.createElement(f.a,{span:4},l.createElement(p.a,{onChange:function(e){return t.setState({subject_type:e,list:v},function(){return t.getTargetList()})},value:n,style:{width:"100%"}},Object.values(b.a).map(function(e){return l.createElement(p.a.Option,{key:e.value,value:e.value},e.label)})))),function(){switch(n){case b.a.user.value:return l.createElement(d.a,{columns:u,dataSource:a,loading:r,rowKey:function(e){return e.user_id}});case b.a.role.value:return l.createElement(d.a,{columns:u,dataSource:c,loading:r,rowKey:function(e){return e.role_id}});case b.a.group.value:return l.createElement(d.a,{columns:u,dataSource:i[0]?i[0].children:[],loading:r,rowKey:function(e){return e.group_id}})}}())}}]),g);function g(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t=c(this,(e=g.__proto__||Object.getPrototypeOf(g)).call.apply(e,[this].concat(r)))).state={subject_type:b.a.role.value,loading:!1,userList:[],roleList:[],groupList:[]},c(t,e)}}.call(this,j(1))},965:function(e,m,v){"use strict";!function(o){v.d(m,"a",function(){return h});v(855);var r=v(856),a=(v(506),v(92)),i=(v(507),v(54)),u=(v(881),v(926)),e=v(0),t=v.n(e),c=v(14),n=v(1),l=v(943),s=v(76),p=v(857),e=function(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e};function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b=c.a.lodash.cloneDeep(s.b),h=c.a.decorator.propTypes({subject_type:t.a.number.isRequired,subject_id:t.a.number.isRequired})((function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,n.PureComponent),e(y,[{key:"componentDidMount",value:function(){this.showModal(),this.loadPermission()}},{key:"loadPermission",value:function(){var t=this,e=this.props,n=e.subject_type,r=e.subject_id;this.setState({loading:!0},function(){Object(l.b)(r,n).then(function(e){t.setState({loading:!1,permission:c.a.lodash.isEmpty(e.data.permission)?[]:e.data.permission})},function(e){c.a.prompt.error(e.msg),t.setState({loading:!1})})})}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.saving,e=e.loading;return o.createElement(r.a,{visible:t,title:"设置栏目权限",okText:"确定",cancelText:"取消",confirmLoading:n,onCancel:this.handleCancel,onOk:this.handleCreateOrUpdate},o.createElement(p.a,{loading:e},o.createElement(a.a,{type:"flex",justify:"center"},o.createElement(i.a,null,o.createElement(u.a,{checkable:!0,defaultExpandedKeys:b[0].childrenMenu.map(function(e){return e.uniqueIdentity}),autoExpandParent:this.state.autoExpandParent,onCheck:this.onCheck,checkedKeys:this.state.permission},this.renderTreeNodes(b[0].childrenMenu))))))}}]),e=y))||e;function y(){var e,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=a=d(this,(e=y.__proto__||Object.getPrototypeOf(y)).call.apply(e,[this].concat(n)))).state={loading:!1,saving:!1,autoExpandParent:!0,permission:[]},a.showModal=function(){return a.setState({visible:!0})},a.handleCancel=function(){return a.setState({visible:!1})},a.onCheck=function(e){console.log("onCheck",e),a.setState({permission:e})},a.handleCreateOrUpdate=function(){var e=a.props,t=e.subject_type,n=e.subject_id,r=a.state.permission;a.setState({saving:!0},function(){Object(l.a)(n,t,r).then(function(e){c.a.prompt.success("操作成功"),a.setState({saving:!1,visible:!1})},function(e){c.a.prompt.error(e.msg),a.setState({saving:!1})})})},a.renderTreeNodes=function(e){return e.map(function(e){return e.children&&0<e.children.length?o.createElement(u.a.TreeNode,{title:e.label,key:e.uniqueIdentity},a.renderTreeNodes(e.children)):e.uiPermission&&0<e.uiPermission.length?o.createElement(u.a.TreeNode,{title:e.label,key:e.uniqueIdentity},a.renderTreeNodes(e.uiPermission)):o.createElement(u.a.TreeNode,{title:e.label,key:e.uniqueIdentity})})},d(a,e)}}.call(this,v(1))},966:function(e,t,o){"use strict";!function(e){var t=o(1),n=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(a,t.PureComponent),n(a,[{key:"render",value:function(){return e.createElement("div",null,e.createElement("h2",null,"数据权限有待开发..."))}}]);function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}}.call(this,o(1))}}]);