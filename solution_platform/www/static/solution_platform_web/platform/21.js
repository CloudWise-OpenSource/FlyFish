(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1011:function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return i}),r.d(e,"c",function(){return u});var o=r(14),a=r(23),n=function(t,e,r){return o.a.request.postJSON(a.a.getWorkerList,{instanceId:t,nodeIp:e,nodePort:r})},i=function(t,e,r,n){return o.a.request.postJSON(a.a.startWorker,{instanceId:t,nodeIp:e,nodePort:r,workName:n})},u=function(t,e,r,n){return o.a.request.postJSON(a.a.stopWorker,{instanceId:t,nodeIp:e,nodePort:r,workName:n})}},899:function(t,a,i){"use strict";i.r(a),function(t){var e=i(229),r=i(985),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r,n=arguments[e];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=Object(e.b)(function(t,e){return n({},e)})(r.a);a.default=function(){return t.createElement(o,null)}}.call(this,i(1))},985:function(t,w,h){"use strict";!function(o){h.d(w,"a",function(){return m});h(115);var a=h(38),t=h(900),i=h.n(t),c=h(14),r=h(21),u=h(859),e=h(1),s=h(231),l=h(860),p=h(228),f=h(1011),t=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var m=c.a.decorator.contextTypes("router","store")((function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(k,e.PureComponent),t(k,[{key:"componentDidMount",value:function(){this.getWorkerList()}},{key:"getWorkerList",value:function(){var e=this,t=this.getQueryString(),r=t.instanceId,n=t.nodeIp,t=t.nodePort;Object(f.a)(r,n,t).then(function(t){t=e.dataFormat(t.data);e.setState({workerList:t})},function(t){c.a.prompt.error(t.msg)})}},{key:"dataFormat",value:function(t){var i=[];return t.map(function(t,e){var r=t.nodeIp,n=t.workName,o=t.status,a=t.id,t=t.num,t={key:String(e),nodeIp:r,workName:n,status:o,id:a,num:t};i.push(t)}),i}},{key:"startWorker",value:function(t,e){var r=this,n=this.state.workerList,o=this.getQueryString(),a=o.instanceId,i=o.nodeIp,o=o.nodePort,t=t.workName,u=10;n[e].status=2,this.setState({workerList:n}),Object(f.b)(a,i,o,t).then(function(t){},function(t){c.a.prompt.error(t.msg),r.getWorkerList()});var s=window.setInterval(function(){u-=1,r.setState({time:u}),0==u&&(window.clearInterval(s),r.getWorkerList())},1e3)}},{key:"stopWorker",value:function(t,e){var r=this,n=this.state.workerList,o=this.getQueryString(),a=o.instanceId,i=o.nodeIp,o=o.nodePort,t=t.workName;n[e].status=2;var u=10;this.setState({workerList:n}),Object(f.c)(a,i,o,t).then(function(t){},function(t){c.a.prompt.error(t.msg),r.getWorkerList()});var s=window.setInterval(function(){u-=1,r.setState({time:u}),0==u&&(window.clearInterval(s),r.getWorkerList())},1e3)}},{key:"render",value:function(){var n=this,t=this.state.workerList,e=[{title:"worker状态",dataIndex:"status",render:function(t,e,r){return o.createElement("div",{className:Number(t)===l.h.start.value?i.a[l.h.start.className]:i.a[l.h.stop.className]},o.createElement("span",null))}},{title:"主机IP",dataIndex:"nodeIp",key:"nodeIp"},{title:"worker名称",dataIndex:"workName",key:"workName"},{title:"操作",dataIndex:"operator",render:function(t,e,r){return Number(e.status)==l.h.start.value?o.createElement(a.a,{type:"primary",icon:"pause-circle-o",onClick:function(){return n.startWorker(e,r)}},"开启worker"):Number(e.status)==l.h.stop.value?o.createElement(a.a,{type:"primary",icon:"minus-circle-o",onClick:function(){return n.stopWorker(e,r)}},"暂停worker"):Number(e.status==l.h.countDown.value)?n.state.time:void 0}}];return o.createElement("div",null,o.createElement(s.b,{title:"worker",rightRender:o.createElement(p.a,{to:r.a.dHub_pluginList},o.createElement(a.a,{type:"primary",icon:"rollback"},"返回插件列表"))}),o.createElement(s.a,null,o.createElement(u.a,{pagination:!1,dataSource:t,columns:e})))}}]),t=k))||t;function k(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,k);for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e=d(this,(t=k.__proto__||Object.getPrototypeOf(k)).call.apply(t,[this].concat(n)))).state={workerList:[],time:10},e.getQueryString=function(){return c.a.queryString.parse(e.context.router.route.location.search)},d(e,t)}}.call(this,h(1))}}]);