(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{877:function(e,a,i){"use strict";i.r(a),function(e){var t=i(230),n=i(956),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=Object(t.b)(function(e,t){return r({},t,{roleListReducer:e.roleListReducer})})(n.a);a.default=function(){return e.createElement(o,null)}}.call(this,i(1))},934:function(e,t,n){"use strict";n.d(t,"h",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"a",function(){return c}),n.d(t,"e",function(){return s}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"d",function(){return d}),n.d(t,"g",function(){return h});var r=n(171),o=n(14),a=n(868),i=n(863),l=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(t){t({type:r.b}),Object(a.e)(e,n).then(function(e){t({type:r.c,roleList:e.data})},function(e){o.a.prompt.error(e.msg)})}},u=function(e){return Object(a.b)(e)},c=function(e){return{type:r.a,role_ids:e}},s=function(e){return Object(a.d)(e)},f=function(e){return Object(a.a)(e)},p=function(e,t){return Object(a.g)(e,t)},d=function(e){return o.a.request.all(Object(i.c)(),Object(a.f)(e))},h=function(e,t,n){return Object(a.h)(e,t,n)}},956:function(e,E,S){"use strict";!function(l){S.d(E,"a",function(){return _});S(506);var e=S(92),n=(S(229),S(232)),r=(S(507),S(54)),u=(S(115),S(38)),t=S(0),o=S.n(t),c=S(14),s=S(858),a=S(957),f=S(958),i=S(1),p=S(231),d=S(934),h=S(870),m=function(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e};function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _=c.a.decorator.contextTypes("store")((g(O,i["PureComponent"]),m(O,[{key:"componentDidMount",value:function(){this.getRoleList()}},{key:"getRoleList",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.search=Object.assign({},this.search,t||{}),this.context.store.dispatch(Object(d.h)(e,t))}},{key:"addOrUpdateRole",value:function(){var e=this;c.a.helper.renderModal(l.createElement(a.a,{role_id:0<arguments.length&&void 0!==arguments[0]&&arguments[0],getRoleList:function(){return e.getRoleList()}}))}},{key:"delRole",value:function(e){var t=this;e=Array.isArray(e)?e:[e],c.a.prompt.confirm(function(){return Object(d.c)(e).then(function(){t.context.store.dispatch(Object(d.a)(e)),c.a.prompt.success("删除成功"),t.handerRefresh()},function(e){c.a.prompt.error(e.msg)})},{title:"确定删除？"})}},{key:"handerRefresh",value:function(){var e=this.props.roleListReducer.roleList,t=e.currentPage,t=1===e.data.length&&1<t?t-1:t;this.getRoleList(t,this.search)}},{key:"render",value:function(){var n=this,e=this.props.roleListReducer,t=e.loading,r=e.roleList,o=r.count,a=r.pageSize,i=r.currentPage,e=r.data,r=[{title:"角色名",dataIndex:"role_name"},{title:"描述",dataIndex:"description"},{title:"操作",render:function(e,t){return[l.createElement(u.a,{key:1,type:"primary",icon:"user",onClick:function(){return c.a.helper.renderModal(l.createElement(f.a,{role_id:t.role_id}))}},"成员"),t.role_type==h.a.admin.value?null:l.createElement(u.a,{key:2,type:"primary",icon:"edit",onClick:function(){return n.addOrUpdateRole(t.role_id)},style:{marginLeft:5}},"修改"),t.role_type==h.a.admin.value?null:l.createElement(u.a,{key:3,type:"danger",icon:"delete",onClick:function(){return n.delRole([t.role_id])},style:{marginLeft:5}},"删除")]}}];return l.createElement("div",null,l.createElement(p.b,{title:"角色列表",rightRender:l.createElement(u.a,{type:"primary",icon:"plus",onClick:function(){return n.addOrUpdateRole()}},"添加角色")}),l.createElement(p.a,null,l.createElement(w,{doSearch:function(e){return n.getRoleList(1,e)}}),l.createElement(s.a,{dataSource:e,columns:r,pagination:{current:i,pageSize:a,total:o,onChange:function(e){return n.getRoleList(e)}},loading:t,rowKey:function(e){return e.role_id}})))}}]),t=O))||t;function O(e){v(this,O);e=b(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,e));return e.search={},e}var w=c.a.decorator.propTypes({doSearch:o.a.func.isRequired})((g(j,i["PureComponent"]),m(j,[{key:"render",value:function(){var t=this;return l.createElement(e.a,{gutter:0,type:"flex",align:"middle",style:{marginBottom:5}},l.createElement(r.a,{span:1},l.createElement("span",null,"名称：")),l.createElement(r.a,{span:4},l.createElement(n.a,{value:this.state.role_name,onChange:function(e){return t.setState({role_name:e.target.value.trim()})},onBlur:function(){return t.doSearch()},onKeyDown:function(e){return 13===e.keyCode&&t.doSearch()}})))}}]),m=j))||m;function j(){v(this,j);var n=b(this,(j.__proto__||Object.getPrototypeOf(j)).call(this));return n.doSearch=function(){var e=n.props.doSearch,t=c.a.lodash.clone(n.state);c.a.lodash.isEmpty(t.role_name)&&delete t.role_name,e(t)},n.state={role_name:null},n}}.call(this,S(1))},957:function(e,v,b){"use strict";!function(l){b.d(v,"a",function(){return i});b(855);var u=b(856),c=(b(229),b(232)),s=(b(860),b(861)),e=b(0),t=b.n(e),f=b(14),p=b(857),n=b(1),d=b(934),e=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},a=s.a.create()(function(e){var t=e.visible,n=e.saving,r=e.loading,o=e.onCancel,a=e.onCreate,i=e.form,e=e.formData,i=i.getFieldDecorator;return l.createElement(u.a,{visible:t,title:e.role_id?"编辑角色":"创建角色",okText:"保存",cancelText:"取消",confirmLoading:n,onCancel:o,onOk:a},l.createElement(p.a,{loading:r},l.createElement(s.a,null,l.createElement(s.a.Item,h({},m,{label:"角色名"}),i("role_name",{initialValue:e.role_name,rules:[{required:!0,message:"请填写角色名!"}]})(l.createElement(c.a,null))),l.createElement(s.a.Item,h({},m,{label:"描述"}),i("description",{initialValue:e.description})(l.createElement(c.a.TextArea,{rows:4}))))))}),i=f.a.decorator.propTypes({role_id:t.a.oneOfType([t.a.string,t.a.bool,t.a.number]),getRoleList:t.a.func.isRequired})((function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,n.PureComponent),e(y,[{key:"componentDidMount",value:function(){var t=this;this.showModal();var e=this.props.role_id;e&&this.setState({loading:!0},function(){Object(d.e)(e).then(function(e){t.setState({loading:!1,data:{role_name:e.data.role_name,description:e.data.description}})},function(e){f.a.prompt.error(e.msg)})})}},{key:"render",value:function(){var t=this;return l.createElement(a,{ref:function(e){return t.form=e},formData:h({role_id:this.props.role_id},this.state.data),visible:this.state.visible,saving:this.state.saving,loading:this.state.loading,onCancel:this.handleCancel,onCreate:this.handleCreate})}}]),y.defaultProps={role_id:null},e=y))||e;function y(){var e,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=l=o(this,(e=y.__proto__||Object.getPrototypeOf(y)).call.apply(e,[this].concat(n)))).state={visible:!1,saving:!1,loading:!1,data:{role_name:null,description:null}},l.showModal=function(){return l.setState({visible:!0})},l.handleCancel=function(){return l.setState({visible:!1})},l.handleCreate=function(){var i=l.form;i.validateFields(function(e,t){if(e)return!1;var e=l.props,n=e.role_id,r=e.getRoleList,o=t.role_name,a=t.description;l.setState({saving:!0},function(){var e,t=[function(){i.resetFields(),r(),l.setState({saving:!1}),l.handleCancel(),f.a.prompt.success("保存成功")},function(e){l.setState({saving:!1}),f.a.prompt.error(e.msg)}];n?(e=Object(d.f)(n,{role_name:o,description:a})).then.apply(e,t):(e=Object(d.b)({role_name:o,description:a})).then.apply(e,t)})})},o(l,e)}}.call(this,b(1))},958:function(e,O,w){"use strict";!function(o){w.d(O,"a",function(){return v});w(869);var a=w(873),i=(w(855),w(856)),l=(w(506),w(92)),u=(w(507),w(54)),e=w(0),t=w.n(e),c=w(14),s=w(857),n=w(1),f=w(934),r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},p=function(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e};function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=c.a.decorator.propTypes({role_id:t.a.oneOfType([t.a.string,t.a.number])})((y(b,n["PureComponent"]),p(b,[{key:"componentDidMount",value:function(){this.showModal()}},{key:"render",value:function(){var t=this,e=this.state,n=e.visible,r=e.saving,e=this.props.role_id;return o.createElement(i.a,{width:900,visible:n,title:"管理成员",okText:"确定",cancelText:"取消",confirmLoading:r,onCancel:this.handleCancel,onOk:this.handleSave},o.createElement(l.a,{type:"flex",justify:"center"},o.createElement(u.a,null,o.createElement(g,{role_id:parseInt(e),ref:function(e){return t.refMember=e}}))))}}]),e=b))||e;function b(){var e,r;h(this,b);for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r=m(this,(e=b.__proto__||Object.getPrototypeOf(b)).call.apply(e,[this].concat(n)))).state={visible:!1,saving:!1},r.refMember=null,r.showModal=function(){return r.setState({visible:!0})},r.handleCancel=function(){return r.setState({visible:!1})},r.handleSave=function(){r.setState({saving:!0},function(){var e=r.refMember.getData(),t=e.role_id,n=e.addUsers,e=e.delUsers;Object(f.g)(t,n,e).then(function(){c.a.prompt.success("操作成功"),r.setState({saving:!1,visible:!1})},function(e){c.a.prompt.error(e.msg),r.setState({saving:!1,visible:!1})})})},m(r,e)}var g=c.a.decorator.propTypes({role_id:t.a.number.isRequired})((y(_,n["PureComponent"]),p(_,[{key:"componentDidMount",value:function(){var n=this;this.setState({loading:!0},function(){Object(f.d)(n.props.role_id).then(function(e){var t=r(e,2),e=t[0],t=t[1];n.setState({loading:!1,userOutGroup:e.data.map(function(e){return{key:e.user_id,disabled:1===e.user_id,userName:e.user_name,userEmail:e.user_email}}),userIdInGroup:t.data.map(function(e){return e.user_id})},function(){return n.originUserIdInGroup=c.a.lodash.clone(n.state.userIdInGroup)})},function(e){c.a.prompt.error(e.msg),n.setState({loading:!1})})})}},{key:"getData",value:function(){return{role_id:this.props.role_id,delUsers:c.a.lodash.difference(this.originUserIdInGroup,this.state.userIdInGroup),addUsers:c.a.lodash.difference(this.state.userIdInGroup,this.originUserIdInGroup)}}},{key:"render",value:function(){var t=this,e=this.state,n=e.loading,r=e.userIdInGroup,e=e.userOutGroup;return o.createElement(s.a,{loading:n},o.createElement(a.a,{dataSource:e,showSearch:!0,listStyle:{width:350,height:300},titles:["待添加成员","已添加成员"],searchPlaceholder:"搜索成员",operations:["添加","移除"],targetKeys:r,onChange:function(e){return t.setState({userIdInGroup:e})},render:function(e){return e.userName+"-"+e.userEmail}}))}}]),p=_))||p;function _(){var e,t;h(this,_);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t=m(this,(e=_.__proto__||Object.getPrototypeOf(_)).call.apply(e,[this].concat(r)))).state={loading:!1,userOutGroup:[],userIdInGroup:[]},t.originUserIdInGroup=[],m(t,e)}}.call(this,w(1))}}]);