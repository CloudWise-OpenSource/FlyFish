(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1257:function(e,t,n){"use strict";n.r(t),function(e){var r=n(309),o=n(1297),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=Object(r.b)(function(e,t){return a({},t,{roleListReducer:e.roleListReducer})})(o.a);t.default=function(){return e.createElement(i,null)}}.call(this,n(0))},1270:function(e,t,n){"use strict";var r=n(204),o=n(7),a=n(16),i=o.a.request,u=i.get,l=i.postJSON,c=i.del,s=i.put,f=n(1241);n.d(t,"h",function(){return d}),n.d(t,"c",function(){return p}),n.d(t,"a",function(){return h}),n.d(t,"e",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"f",function(){return y}),n.d(t,"d",function(){return g}),n.d(t,"g",function(){return b});var d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){n({type:r.b}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(a.a.role_getPageList,{page:e,search:t})}(e,t).then(function(e){n({type:r.c,roleList:e.data})},function(e){o.a.prompt.error(e.msg)})}},p=function(e){return function(e){return c(a.a.role_del,{role_ids:e})}(e)},h=function(e){return{type:r.a,role_ids:e}},m=function(e){return function(e){return u(a.a.role_getDetail,{role_id:e})}(e)},v=function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(a.a.role_add,e)}(e)},y=function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(a.a.role_update,Object.assign({role_id:e},t))}(e,t)},g=function(e){return o.a.request.all(Object(f.c)(),function(e){return u(a.a.role_userByRole,{role_id:e})}(e))},b=function(e,t,n){return function(e,t,n){return s(a.a.role_updateRoleMember,{role_id:e,addUsers:t,delUsers:n})}(e,t,n)}},1294:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={admin:{label:"管理员",value:1},custom:{label:"自定义",value:2}}},1295:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return _});n(1256);var r,o,a=n(1264),i=(n(606),n(1226)),u=(n(143),n(81)),l=(n(70),n(40)),c=n(1),s=n.n(c),f=n(7),d=n(308),p=n(0),h=n(1270),m=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _=f.a.decorator.propTypes({role_id:s.a.oneOfType([s.a.string,s.a.number])})(r=function(t){function n(){var e,t,r;y(this,n);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=r=g(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(a))),r.state={visible:!1,saving:!1},r.refMember=null,r.showModal=function(){return r.setState({visible:!0})},r.handleCancel=function(){return r.setState({visible:!1})},r.handleSave=function(){r.setState({saving:!0},function(){var e=r.refMember.getData(),t=e.role_id,n=e.addUsers,o=e.delUsers;Object(h.g)(t,n,o).then(function(){f.a.prompt.success("操作成功"),r.setState({saving:!1,visible:!1})},function(e){f.a.prompt.error(e.msg),r.setState({saving:!1,visible:!1})})})},g(r,t)}return b(n,p["PureComponent"]),v(n,[{key:"componentDidMount",value:function(){this.showModal()}},{key:"render",value:function(){var t=this,n=this.state,r=n.visible,o=n.saving,a=this.props.role_id;return e.createElement(i.a,{width:900,visible:r,title:"管理成员",okText:"确定",cancelText:"取消",confirmLoading:o,onCancel:this.handleCancel,onOk:this.handleSave},e.createElement(u.a,{type:"flex",justify:"center"},e.createElement(l.a,null,e.createElement(O,{role_id:parseInt(a),ref:function(e){return t.refMember=e}}))))}}]),n}())||r,O=f.a.decorator.propTypes({role_id:s.a.number.isRequired})(o=function(t){function n(){var e,t,r;y(this,n);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=r=g(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(a))),r.state={loading:!1,userOutGroup:[],userIdInGroup:[]},r.originUserIdInGroup=[],g(r,t)}return b(n,p["PureComponent"]),v(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0},function(){Object(h.d)(e.props.role_id).then(function(t){var n=m(t,2),r=n[0],o=n[1];e.setState({loading:!1,userOutGroup:r.data.map(function(e){return{key:e.user_id,disabled:1===e.user_id,userName:e.user_name,userEmail:e.user_email}}),userIdInGroup:o.data.map(function(e){return e.user_id})},function(){return e.originUserIdInGroup=f.a.lodash.clone(e.state.userIdInGroup)})},function(t){f.a.prompt.error(t.msg),e.setState({loading:!1})})})}},{key:"getData",value:function(){return{role_id:this.props.role_id,delUsers:f.a.lodash.difference(this.originUserIdInGroup,this.state.userIdInGroup),addUsers:f.a.lodash.difference(this.state.userIdInGroup,this.originUserIdInGroup)}}},{key:"render",value:function(){var t=this,n=this.state,r=n.loading,o=n.userIdInGroup,i=n.userOutGroup;return e.createElement(d.a,{loading:r},e.createElement(a.a,{dataSource:i,showSearch:!0,listStyle:{width:350,height:300},titles:["待添加成员","已添加成员"],searchPlaceholder:"搜索成员",operations:["添加","移除"],targetKeys:o,onChange:function(e){return t.setState({userIdInGroup:e})},render:function(e){return e.userName+"-"+e.userEmail}}))}}]),n}())||o}).call(this,n(0))},1296:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return _});n(606);var r,o,a,i=n(1226),u=(n(1233),n(1266)),l=(n(223),n(303)),c=n(1),s=n.n(c),f=n(7),d=n(308),p=n(0),h=n(1270),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},b=u.a.create()(function(t){var n=t.visible,r=t.saving,o=t.loading,a=t.onCancel,c=t.onCreate,s=t.form,f=t.formData,p=s.getFieldDecorator;return e.createElement(i.a,{visible:n,title:f.role_id?"编辑角色":"创建角色",okText:"保存",cancelText:"取消",confirmLoading:r,onCancel:a,onOk:c},e.createElement(d.a,{loading:o},e.createElement(u.a,null,e.createElement(u.a.Item,v({},g,{label:"角色名"}),p("role_name",{initialValue:f.role_name,rules:[{required:!0,message:"请填写角色名!"}]})(e.createElement(l.a,null))),e.createElement(u.a.Item,v({},g,{label:"描述"}),p("description",{initialValue:f.description})(e.createElement(l.a.TextArea,{rows:4}))))))}),_=f.a.decorator.propTypes({role_id:s.a.oneOfType([s.a.string,s.a.bool,s.a.number]),getRoleList:s.a.func.isRequired})((a=o=function(t){function n(){var e,t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=r=y(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(a))),r.state={visible:!1,saving:!1,loading:!1,data:{role_name:null,description:null}},r.showModal=function(){return r.setState({visible:!0})},r.handleCancel=function(){return r.setState({visible:!1})},r.handleCreate=function(){var e=r.form;e.validateFields(function(t,n){if(t)return!1;var o=r.props,a=o.role_id,i=o.getRoleList,u=n.role_name,l=n.description;r.setState({saving:!0},function(){var t,n,o=[function(){e.resetFields(),i(),r.setState({saving:!1}),r.handleCancel(),f.a.prompt.success("保存成功")},function(e){r.setState({saving:!1}),f.a.prompt.error(e.msg)}];a?(t=Object(h.f)(a,{role_name:u,description:l})).then.apply(t,o):(n=Object(h.b)({role_name:u,description:l})).then.apply(n,o)})})},y(r,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,p["PureComponent"]),m(n,[{key:"componentDidMount",value:function(){var e=this;this.showModal();var t=this.props.role_id;t&&this.setState({loading:!0},function(){Object(h.e)(t).then(function(t){e.setState({loading:!1,data:{role_name:t.data.role_name,description:t.data.description}})},function(e){f.a.prompt.error(e.msg)})})}},{key:"render",value:function(){var t=this;return e.createElement(b,{ref:function(e){return t.form=e},formData:v({role_id:this.props.role_id},this.state.data),visible:this.state.visible,saving:this.state.saving,loading:this.state.loading,onCancel:this.handleCancel,onCreate:this.handleCreate})}}]),n}(),o.defaultProps={role_id:null},r=a))||r}).call(this,n(0))},1297:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return E});n(143);var r,o,a=n(81),i=(n(70),n(40)),u=(n(223),n(303)),l=(n(82),n(45)),c=n(1),s=n.n(c),f=n(7),d=n(1234),p=n(1296),h=n(1295),m=n(0),v=n(310),y=n(1270),g=n(1294),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var E=f.a.decorator.contextTypes("store")(r=function(t){function n(e){_(this,n);var t=O(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.search={},t}return w(n,m["PureComponent"]),b(n,[{key:"componentDidMount",value:function(){this.getRoleList()}},{key:"getRoleList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.search=Object.assign({},this.search,t||{}),this.context.store.dispatch(Object(y.h)(e,t))}},{key:"addOrUpdateRole",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];f.a.helper.renderModal(e.createElement(p.a,{role_id:n,getRoleList:function(){return t.getRoleList()}}))}},{key:"delRole",value:function(e){var t=this;e=Array.isArray(e)?e:[e],f.a.prompt.confirm(function(){return Object(y.c)(e).then(function(){t.context.store.dispatch(Object(y.a)(e)),f.a.prompt.success("删除成功"),t.handerRefresh()},function(e){f.a.prompt.error(e.msg)})},{title:"确定删除？"})}},{key:"handerRefresh",value:function(){var e=this.props.roleListReducer.roleList,t=e.currentPage,n=1===e.data.length&&t>1?t-1:t;this.getRoleList(n,this.search)}},{key:"render",value:function(){var t=this,n=this.props.roleListReducer,r=n.loading,o=n.roleList,a=o.count,i=o.pageSize,u=o.currentPage,c=o.data,s=[{title:"角色名",dataIndex:"role_name"},{title:"描述",dataIndex:"description"},{title:"操作",render:function(n,r){return[e.createElement(l.a,{key:1,type:"primary",icon:"user",onClick:function(){return f.a.helper.renderModal(e.createElement(h.a,{role_id:r.role_id}))}},"成员"),r.role_type==g.a.admin.value?null:e.createElement(l.a,{key:2,type:"primary",icon:"edit",onClick:function(){return t.addOrUpdateRole(r.role_id)},style:{marginLeft:5}},"修改"),r.role_type==g.a.admin.value?null:e.createElement(l.a,{key:3,type:"danger",icon:"delete",onClick:function(){return t.delRole([r.role_id])},style:{marginLeft:5}},"删除")]}}];return e.createElement("div",null,e.createElement(v.b,{title:"角色列表",rightRender:e.createElement(l.a,{type:"primary",icon:"plus",onClick:function(){return t.addOrUpdateRole()}},"添加角色")}),e.createElement(v.a,null,e.createElement(j,{doSearch:function(e){return t.getRoleList(1,e)}}),e.createElement(d.a,{dataSource:c,columns:s,pagination:{current:u,pageSize:i,total:a,onChange:function(e){return t.getRoleList(e)}},loading:r,rowKey:function(e){return e.role_id}})))}}]),n}())||r,j=f.a.decorator.propTypes({doSearch:s.a.func.isRequired})(o=function(t){function n(){_(this,n);var e=O(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.doSearch=function(){var t=e.props.doSearch,n=f.a.lodash.clone(e.state);f.a.lodash.isEmpty(n.role_name)&&delete n.role_name,t(n)},e.state={role_name:null},e}return w(n,m["PureComponent"]),b(n,[{key:"render",value:function(){var t=this;return e.createElement(a.a,{gutter:0,type:"flex",align:"middle",style:{marginBottom:5}},e.createElement(i.a,{span:1},e.createElement("span",null,"名称：")),e.createElement(i.a,{span:4},e.createElement(u.a,{value:this.state.role_name,onChange:function(e){return t.setState({role_name:e.target.value.trim()})},onBlur:function(){return t.doSearch()},onKeyDown:function(e){return 13===e.keyCode&&t.doSearch()}})))}}]),n}())||o}).call(this,n(0))}}]);