(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1241:function(e,t,n){"use strict";n.r(t),function(e){var a=n(309),r=n(1271),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=Object(a.b)(function(e,t){return o({},t)})(r.a);t.default=function(){return e.createElement(i,null)}}.call(this,n(0))},1271:function(e,t,n){"use strict";n(82);var a=n(45),r=(n(1237),n(1264)),o=(n(605),n(1224)),i=n(0),s=n.n(i),l=n(310),c=n(308),u=n(1232),p=n(7),f=n(606),d=(n(1231),n(1262)),h=(n(607),n(1225)),m=(n(1233),n(1259)),b=(n(145),n(14)),y=(n(223),n(303)),g=(n(16),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var E={labelCol:{span:4},wrapperCol:{span:20}},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!0,fileList:[],uploadProgress:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),v(t,[{key:"handleOk",value:function(){var e=this;(0,this.props.form.validateFields)(function(t,n){t||f.c(g({},n,{sceneId:e.props.record.sceneId})).then(function(t){if(e.state.fileList.length>0){var a=new FormData;e.state.fileList.forEach(function(e){a.append("file",e)});f.h(a,function(t){e.setState(g({},e.state,{uploadProgress:Math.round(100*t.loaded/t.total)}))}).then(function(t){f.e(g({},n,t.data,{sceneId:e.props.record.sceneId})).then(function(t){t&&(e.closeModal(),e.setState(g({},e.state,{uploadProgress:0})),p.a.prompt.success(t.msg),e.props.sceneIns.initList())},function(e){p.a.prompt.error(e.msg)})},function(e){p.a.prompt.error(e.msg)})}else f.e(g({},n,{sceneId:e.props.record.sceneId})).then(function(t){t&&(e.closeModal(),e.setState(g({},e.state,{uploadProgress:0})),p.a.prompt.success(t.msg),e.props.sceneIns.initList())},function(e){p.a.prompt.error(e.msg)})},function(e){p.a.prompt.error(e.msg)})})}},{key:"handleCancel",value:function(){this.closeModal()}},{key:"closeModal",value:function(){this.setState(g({},this.state,{visible:!1}))}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,n=this.props.record;return s.a.createElement(o.a,{title:"修改场景",visible:this.state.visible,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this)},s.a.createElement(d.a,null,s.a.createElement(d.a.Item,g({label:"场景名称"},E),t("sceneName",{initialValue:n.sceneName,rules:[{required:!0,message:"请输入场景名称!"}]})(s.a.createElement(y.a,{placeholder:"场景名称"}))),s.a.createElement(d.a.Item,g({label:"场景描述"},E),t("desc",{initialValue:n.desc,rules:[{max:20,message:"不能超过20字!"}]})(s.a.createElement(y.a,{placeholder:"场景描述"}))),s.a.createElement(d.a.Item,g({label:"开发者"},E),t("author",{initialValue:n.author,rules:[{max:20,message:"不能超过20字!"}]})(s.a.createElement(y.a,{placeholder:"开发者"}))),s.a.createElement(d.a.Item,g({label:"场景文件"},E),t("dirPath",{})(s.a.createElement(m.a,{accept:".zip",fileList:this.state.fileList,beforeUpload:function(t,n){return t.size/1024/1024<100?n&&n.length>0&&e.setState(g({},e.state,{fileList:[n[n.length-1]]})):p.a.prompt.error("上传文件不能大于100M!"),!1},onRemove:function(t){100==e.state.uploadProgress&&e.setState(function(e){var n=e.fileList.indexOf(t),a=e.fileList.slice();return a.splice(n,1),{fileList:a,uploadProgress:0}})}},s.a.createElement(a.a,null,s.a.createElement(b.a,{type:"upload"})," 选择文件"))),s.a.createElement(h.a,{style:{display:this.state.uploadProgress>0?"block":"none"},percent:this.state.uploadProgress,size:"small"}))))}}]),t}(),O=d.a.create({name:"editScene"})(w),k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},P=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var S={labelCol:{span:4},wrapperCol:{span:20}},j=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!0,fileList:[],uploadProgress:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),P(t,[{key:"handleOk",value:function(){var e=this;(0,this.props.form.validateFields)(function(t,n){t||f.b(k({},n)).then(function(t){var a=new FormData;e.state.fileList.forEach(function(e){a.append("file",e)});f.h(a,function(t){e.setState(k({},e.state,{uploadProgress:Math.round(100*t.loaded/t.total)}))}).then(function(t){f.a(k({},n,t.data)).then(function(t){t&&(e.closeModal(),e.setState(k({},e.state,{uploadProgress:0})),p.a.prompt.success(t.msg),e.props.sceneIns.initList())},function(e){p.a.prompt.error(e.msg)})},function(e){p.a.prompt.error(e.msg)})},function(e){p.a.prompt.error(e.msg)})})}},{key:"handleCancel",value:function(){this.closeModal()}},{key:"closeModal",value:function(){this.setState(k({},this.state,{visible:!1}))}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return s.a.createElement(o.a,{title:"上传场景",visible:this.state.visible,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this)},s.a.createElement(d.a,null,s.a.createElement(d.a.Item,k({label:"场景名称"},S),t("sceneName",{rules:[{required:!0,message:"请输入场景名称!"}]})(s.a.createElement(y.a,{placeholder:"场景名称"}))),s.a.createElement(d.a.Item,k({label:"场景描述"},S),t("desc",{rules:[{max:20,message:"不能超过20字!"}]})(s.a.createElement(y.a,{placeholder:"场景描述"}))),s.a.createElement(d.a.Item,k({label:"开发者"},S),t("author",{rules:[{max:20,message:"不能超过20字!"}]})(s.a.createElement(y.a,{placeholder:"开发者"}))),s.a.createElement(d.a.Item,k({label:"场景文件"},S),t("dirPath",{rules:[{required:!0,message:"请选择文件!"}]})(s.a.createElement(m.a,{accept:".zip",fileList:this.state.fileList,beforeUpload:function(t,n){return n&&n.length>0&&e.setState(k({},e.state,{fileList:[n[n.length-1]]})),!1},onRemove:function(t){e.setState(function(e){var n=e.fileList.indexOf(t),a=e.fileList.slice();return a.splice(n,1),{fileList:a,uploadProgress:0}})}},s.a.createElement(a.a,null,s.a.createElement(b.a,{type:"upload"})," 选择文件"))),s.a.createElement(h.a,{style:{display:this.state.uploadProgress>0?"block":"none"},percent:this.state.uploadProgress,size:"small"}))))}}]),t}(),L=d.a.create({name:"addScene"})(j),I=n(4),C=n.n(I),_=(n(1238),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}),M=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var x=o.a.confirm,z=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,datas:[],current:1,pageSize:10,total:100},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),M(t,[{key:"componentDidMount",value:function(){this.initList()}},{key:"initList",value:function(){var e=this,t={page:this.state.current,pageSize:this.state.pageSize};f.g(t).then(function(t){e.setState({datas:t.data.result.map(function(e){return e.id=e.sceneId,e}),total:t.data.total})})}},{key:"render",value:function(){var e=this,t=[{key:"sceneName",title:"场景名称",dataIndex:"sceneName"},{key:"desc",title:"场景描述",dataIndex:"desc"},{key:"author",title:"开发者",dataIndex:"author"},{key:"createTime",title:"创建时间",dataIndex:"createTime",render:function(e){return C()(Number(e)).format("YYYY-MM-DD HH:mm:ss")}},{key:"operate",title:"操作",render:function(t,n){return[s.a.createElement(a.a,{key:1,type:"primary",icon:"edit",onClick:function(){return p.a.helper.renderModal(s.a.createElement(O,{sceneIns:e,record:n}))}},"修改"),s.a.createElement(a.a,{key:3,disabled:!0,type:"primary",icon:"download",onClick:function(){},style:{marginLeft:5}},"导出"),s.a.createElement(a.a,{key:4,type:"danger",icon:"delete",onClick:function(){x({title:"确定要删除吗?",onOk:function(){f.d(n.sceneId).then(function(t){if(t&&"success"==t.msg){r.a.success("删除成功!");var n=e.state,a=n.current,o=n.datas;e.setState({current:1===o.length&&a>1?a-1:a},function(){e.initList()})}else r.a.error("删除失败!")})}})},style:{marginLeft:5}},"删除")]}}];return s.a.createElement("div",null,s.a.createElement(l.b,{title:"场景管理",rightRender:s.a.createElement(s.a.Fragment,null,s.a.createElement(a.a,{type:"primary",icon:"picture",style:{marginRight:20},onClick:function(){window.open("http://"+window.location.hostname+":5566/index3d.html")}},"场景开发"),s.a.createElement(a.a,{type:"primary",icon:"cloud-upload",onClick:function(){return p.a.helper.renderModal(s.a.createElement(L,{sceneIns:e}))}},"场景上传"))}),s.a.createElement(l.a,null,s.a.createElement(c.a,{loading:this.state.loading},s.a.createElement(u.a,{dataSource:this.state.datas,columns:t,pagination:{showSizeChanger:!0,current:this.state.current,pageSize:this.state.pageSize,total:this.state.total,onChange:function(t,n){e.setState(_({},e.state,{current:t,pageSize:n}),function(){e.initList()})},onShowSizeChange:function(t,n){e.setState(_({},e.state,{current:1,pageSize:n}),function(){e.initList()})}},loading:this.state.loading,rowKey:function(e){return e.id}}))))}}]),t}();t.a=z}}]);